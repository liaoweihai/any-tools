import{i as Yl}from"./rolldown-runtime-CKFmjIRy.js";import{C as dn,E as z,H as Xl,I as me,L as Ll,O as ur,P as Dt,R as ye,S as ln,_ as Zt,b as Kt,c as Xe,ct as Mt,d as K,f as B,g as $t,h as Br,i as no,l as r,lt as mt,m as tn,n as lo,o as rr,r as oo,st as Ge,t as so,u as nn,w as an}from"./codemirror-B25QCqWr.js";import{d as Rl,f as Ce,h as Kl,m as Qr,n as ao,o as io,p as uo,r as co,s as po,u as rn}from"./vendor-vue-C93_ecI2.js";import{t as un}from"./index-D7SmQqDE.js";import{t as ct}from"./componentStorage-k4mRdpgu.js";import"./echarts-xBohgwka.js";import{t as go}from"./DraggableBox-q1OvycWq.js";function zr(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function fo(y){var g,$;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((g=n.backgroundGradient.colors)!=null&&g.length)){const S=n.backgroundGradient.angle||0,P=n.backgroundGradient.colors[0]||"#000000",le=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${S}deg, ${P}, ${le})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"){n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textIndent&&e.push(`text-indent:${n.textIndent}`);const S=n.textOrientation;if(S==="vertical"?(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")):S==="horizontal"&&e.push("writing-mode:horizontal-tb"),n.textGradient&&(($=n.textGradient.colors)!=null&&$.length)){const P=n.textGradient.angle||0,le=n.textGradient.colors[0]||"#000000",Se=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${P}deg, ${le}, ${Se})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}}return y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),e.join(";")}function yo(y){var g;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),y.type!=="text"&&(n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((g=n.backgroundGradient.colors)!=null&&g.length))){const $=n.backgroundGradient.angle||0,S=n.backgroundGradient.colors[0]||"#000000",P=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${S}, ${P})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}return e.join(";")}function mo(y){const n=y.style||{},e=[];return n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.color&&e.push(`fill:${n.color}`),e.join(";")}function bo(y){var f,v,L,V;const n=Math.max(1,Math.round(y.width||1)),e=Math.max(1,Math.round(y.height||1)),g=n/2,$=e/2,S=((f=y.style)==null?void 0:f.arcText)||{},P=Math.max(1,Number((v=S.radius)!=null?v:Math.min(n,e)/2-4)),le=Number((L=S.startAngle)!=null?L:0),Se=Math.max(0,Number((V=S.sweepAngle)!=null?V:180)),N=S.clockwise!==!1,ie=le*Math.PI/180,$e=(le+Se)*Math.PI/180,ne=g+P*Math.cos(ie),fe=$+P*Math.sin(ie),se=g+P*Math.cos($e),F=$+P*Math.sin($e);return`M ${ne} ${fe} A ${P} ${P} 0 ${Se>180?1:0} ${N?1:0} ${se} ${F}`}function xo(y){var e;const n=((e=y.style)==null?void 0:e.textAlign)||"center";return n==="left"?"0%":n==="right"?"100%":"50%"}function ho(y){var e;const n=((e=y.style)==null?void 0:e.textAlign)||"center";return n==="left"?"start":n==="right"?"end":"middle"}function Zl(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function vo(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Zl(e)} }`)}function $o(y){const n=[],e=g=>{g.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const S=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!S||!P)return;/\{[^}]*\}/.test(P)?n.push(vo(P)):n.push(`.${S} { ${Zl(P)} }`)}})};return e(y),n.join(`
`)}function wo(y){return y.replace(/[A-Z]/g,n=>`-${n.toLowerCase()}`)}function zt(y){return`\`
${Object.entries(y).map(([n,e])=>`      ${wo(n)}: ${e};`).join(`
`)}
    \``}function Vl(y,n,e,g,$){const S=y.replace(/[^A-Za-z0-9_]/g,"_");let P=0;const le=`lc-${S}-root`,Se=`lc-${S}-bg`,N=`lc-${S}-flex-left`,ie=`lc-${S}-flex-center`,$e=`lc-${S}-flex-right`,ne=[],fe=[],se=[],F=new Map,f=new Map,v=[],L=new Set;function V(s){if(!L.has(s))return L.add(s),s;let oe=2;for(;L.has(`${s}_${oe}`);)oe++;const be=`${s}_${oe}`;return L.add(be),be}function U(s){var Ut;const oe=s.style||{},be=[],Ne=oe.color,ke=oe.textGradient;if(ke&&((Ut=ke.colors)!=null&&Ut.length)){const Yt=ke.angle||0,rt=ke.colors[0]||"#000000",nt=ke.colors[1]||"#000000";be.push(`background-image:linear-gradient(${Yt}deg, ${rt}, ${nt})`),be.push("-webkit-background-clip:text"),be.push("background-clip:text"),be.push("color:transparent")}else Ne&&be.push(`color:${Ne}`);const Ee=oe.fontWeight;Ee&&be.push(`font-weight:${Ee}`);const X=oe.fontStyle;X&&be.push(`font-style:${X}`);const wt=oe.textOrientation;wt==="vertical"?(be.push("writing-mode:vertical-rl"),be.push("text-orientation:upright")):wt==="horizontal"&&be.push("writing-mode:horizontal-tb");const xt=be.join(";"),It=be.join(";");return{key:xt,css:It}}function q(){const s=[],oe=Ne=>{Ne.forEach(ke=>{if((ke.type==="group"||ke.type==="container")&&Array.isArray(ke.children))oe(ke.children);else if(ke.type==="text"){const Ee=((ke.style||{}).fontFamily||"").trim();Ee&&!F.has(Ee)&&(s.push(Ee),F.set(Ee,`lc-${S}-f${s.length}`));const{key:X,css:wt}=U(ke);if(X){const xt=f.get(X);xt?xt.count++:f.set(X,{count:1,css:wt})}}})};oe(e);let be=1;Array.from(f.entries()).forEach(([Ne,ke])=>{ke.count>=3&&(ke.className=`lc-${S}-s${be++}`)})}q();const ze=n.backgroundUrl||"",Z=n.backgroundColor||"transparent",T=n.globalFontFamily||"",Q=n.globalFontSize||14,De=n.globalColor||"#000000",ot=e.some(s=>s.type==="chart"),Y=g!=null&&g.backgroundFileName&&g.backgroundFileName.trim()?`require('./imgs/${g.backgroundFileName.replace(/'/g,"\\'")}')`:ze?`'${ze.replace(/'/g,"\\'")}'`:"''";function Ue(s){const oe=String(s||"").trim();if(!oe)return"";let be=oe.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(be[0]||"")||(be="_"+be),be}function w(s){if(!s.hidden)return"";const oe=Ue(s.hiddenLabel);return oe?` ${g&&g.hideDirective==="show"?"v-show":"v-if"}="${oe}"`:""}function t(s,oe){var xt,It,Ut,Yt,rt,nt,At,Qt,Ot,Vt,at,er,nr,lr,Pt,Wt,Ft,or;const be=s.type==="text"?yo(s):fo(s),Ne=s.zIndex||1,ke=s.className&&s.className.trim()?` class="${s.className.trim()}"`:"",Ee=s.eventBinding,X=Ee&&Ee.enabled&&Ee.handlerName?` @click="${String(Ee.handlerName)}($event)"`:"";if(s.type==="group"&&Array.isArray(s.children)){const Ze=s.children.map((ft,Qe)=>t(ft,Qe)).join(`
        `),pe=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`group_${oe}`,Pe=V(pe),Te={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Te.width=`${Math.round(s.width)}px`),s.height&&(Te.height=`${Math.round(s.height)}px`)),v.push(`'${Pe.replace(/'/g,"\\'")}' : ${zt(Te)}`),`<div${ke}${w(s)} :style="pos['${Pe.replace(/'/g,"\\'")}']" >
        ${Ze}
      </div>`}if(s.type==="text"){const Ze=(()=>{var et;const tt=((et=s.style)==null?void 0:et.textAlign)||"left";return tt==="center"?ie:tt==="right"?$e:N})(),pe=s.style||{},Pe=(pe.fontFamily||"").trim(),Te=Pe&&F.get(Pe)||"",ft=(()=>{const{key:tt}=U(s),et=tt?f.get(tt):void 0;return et&&et.className?et.className:""})(),Qe=[(xt=s.className)==null?void 0:xt.trim(),Ze,Te,ft].filter(Boolean).join(" "),Re=Qe?` class="${Qe}"`:"",lt=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`text_${oe}`,Ve=V(lt),Fe={};if(pe.fontSize!==void 0&&(Fe.fontSize=`${pe.fontSize}px`),pe.letterSpacing!==void 0&&pe.letterSpacing!==null&&(Fe.letterSpacing=`${pe.letterSpacing}px`),pe.lineHeight!==void 0&&(Fe.lineHeight=pe.lineHeight),pe.textIndent&&(Fe.textIndent=String(pe.textIndent)),pe.textGradient&&((It=pe.textGradient.colors)!=null&&It.length)){const tt=pe.textGradient.angle||0,et=pe.textGradient.colors[0]||"#000000",Nt=pe.textGradient.colors[1]||"#000000";Fe.backgroundImage=`linear-gradient(${tt}deg, ${et}, ${Nt})`,Fe["-webkit-background-clip"]="text",Fe.backgroundClip="text",Fe.color="transparent"}else pe.color&&(Fe.color=pe.color);pe.fontWeight&&(Fe.fontWeight=pe.fontWeight),pe.fontStyle&&(Fe.fontStyle=pe.fontStyle);const Bt=pe.textOrientation;Bt==="vertical"?(Fe.writingMode="vertical-rl",Fe.textOrientation="upright"):Bt==="horizontal"&&(Fe.writingMode="horizontal-tb");const st=s.elementId&&s.elementId.trim()?s.elementId.trim():`text_${oe}`,it=!!(pe.textWave&&pe.textWave.enabled),Et=!!pe.skewFlowEnabled;if(it||Et){const tt=s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath?{type:"dynamic",obj:s.dynamic.objectName,path:s.dynamic.propertyPath}:{type:"static",text:s.text||""};ne.push(`'${st.replace(/'/g,"\\'")}' : ${JSON.stringify(tt)}`);const et={textWaveEnabled:it,amplitude:(Yt=(Ut=pe.textWave)==null?void 0:Ut.amplitude)!=null?Yt:0,frequency:(nt=(rt=pe.textWave)==null?void 0:rt.frequency)!=null?nt:0,phase:(Qt=(At=pe.textWave)==null?void 0:At.phase)!=null?Qt:0,skewFlowEnabled:Et,skewAngle:(Ot=pe.skewAngle)!=null?Ot:0,textOrientation:pe.textOrientation||"horizontal",fontSize:(Vt=pe.fontSize)!=null?Vt:Q,letterSpacing:(at=pe.letterSpacing)!=null?at:0};if(fe.push(`'${st.replace(/'/g,"\\'")}' : ${JSON.stringify(et)}`),s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath){const Xt=String(s.dynamic.propertyPath),Lt=`${s.dynamic.objectName}.${Xt}`,sr=V(Lt),Gt={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Gt.width=`${Math.round(s.width)}px`),s.height&&(Gt.height=`${Math.round(s.height)}px`)),Object.assign(Gt,Fe),v.push(`'${sr.replace(/'/g,"\\'")}' : ${zt(Gt)}`),`<div${Re}${w(s)}${X} :style="pos['${sr.replace(/'/g,"\\'")}']" >
        <span v-for="(p,pi) in getTextPieces('${st.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
      </div>`}const Nt={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Nt.width=`${Math.round(s.width)}px`),s.height&&(Nt.height=`${Math.round(s.height)}px`)),Object.assign(Nt,Fe),v.push(`'${Ve.replace(/'/g,"\\'")}' : ${zt(Nt)}`),`<div${Re}${w(s)}${X} :style="pos['${Ve.replace(/'/g,"\\'")}']" >
        <span v-for="(p,pi) in getTextPieces('${st.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
      </div>`}if(s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath){const tt=`${s.dynamic.objectName}.${s.dynamic.propertyPath}`,et=String(s.dynamic.propertyPath),Nt=`${s.dynamic.objectName}.${et}`,Xt=V(Nt),Lt={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Lt.width=`${Math.round(s.width)}px`),s.height&&(Lt.height=`${Math.round(s.height)}px`)),Object.assign(Lt,Fe),v.push(`'${Xt.replace(/'/g,"\\'")}' : ${zt(Lt)}`),`<div${Re}${w(s)}${X} :style="pos['${Xt.replace(/'/g,"\\'")}']" >{{ ${tt} }}</div>`}else{const tt=zr(s.text||""),et={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(et.width=`${Math.round(s.width)}px`),s.height&&(et.height=`${Math.round(s.height)}px`)),Object.assign(et,Fe),v.push(`'${Ve.replace(/'/g,"\\'")}' : ${zt(et)}`),`<div${Re}${w(s)}${X} :style="pos['${Ve.replace(/'/g,"\\'")}']" >${tt}</div>`}}if(s.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[s.id]){const ft=g.imageFileMap[s.id],Qe=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`img_${oe}`,Re=V(Qe),lt=s.elementId&&s.elementId.trim()?` id="${Re}"`:"",Ve=s.style||{},Fe={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Fe.width=`${Math.round(s.width)}px`),s.height&&(Fe.height=`${Math.round(s.height)}px`)),Ve.objectFit&&(Fe.objectFit=String(Ve.objectFit)),v.push(`'${Re.replace(/'/g,"\\'")}' : ${zt(Fe)}`),`<img${ke}${lt}${w(s)}${X} src="./imgs/${ft}" :style="pos['${Re.replace(/'/g,"\\'")}']" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[P]){const ft=g.imageFileNames[P++],Qe=s.elementId&&s.elementId.trim()?` id="${s.elementId.trim()}"`:"",Re=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`img_${oe}`,lt=s.style||{},Ve={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Ve.width=`${Math.round(s.width)}px`),s.height&&(Ve.height=`${Math.round(s.height)}px`)),lt.objectFit&&(Ve.objectFit=String(lt.objectFit)),v.push(`'${Re.replace(/'/g,"\\'")}' : ${zt(Ve)}`),`<img${ke}${Qe}${w(s)}${X} src="./imgs/${ft}" :style="pos['${Re.replace(/'/g,"\\'")}']" alt="" />`}const Ze=s.elementId&&s.elementId.trim()?s.elementId.trim():`img_${oe}`,pe=s.elementId&&s.elementId.trim()?` id="${s.elementId.trim()}"`:"",Pe=s.style||{},Te={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Te.width=`${Math.round(s.width)}px`),s.height&&(Te.height=`${Math.round(s.height)}px`)),Pe.objectFit&&(Te.objectFit=String(Pe.objectFit)),v.push(`'${Ze.replace(/'/g,"\\'")}' : ${zt(Te)}`),`<img${ke}${pe}${w(s)}${X} :src="images['${Ze}']" :style="pos['${Ze.replace(/'/g,"\\'")}']" alt="" />`}if(s.type==="chart"){const Ze=zr(s.text||"chart"),pe=s.elementId&&s.elementId.trim()?s.elementId.trim():`chart_${oe}`,Pe=V(pe),Te={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};return s.autoSize||(s.width&&(Te.width=`${Math.round(s.width)}px`),s.height&&(Te.height=`${Math.round(s.height)}px`)),v.push(`'${Pe.replace(/'/g,"\\'")}' : ${zt(Te)}`),`<div${ke}${w(s)}${X} id="${Pe}" :style="pos['${Pe.replace(/'/g,"\\'")}']">${Ze}</div>`}if(s.type==="container"){const Ze=s.comment?`<!-- ${s.comment.replace(/-->/g,"")} -->
      `:"";if(Array.isArray(s.children)){const lt=s.children.map((Et,tt)=>t(Et,tt)).join(`
        `),Ve=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`container_${oe}`,Fe=V(Ve),Bt=s.elementId&&s.elementId.trim()?` id="${Fe}"`:"",st={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};s.autoSize||(s.width&&(st.width=`${Math.round(s.width)}px`),s.height&&(st.height=`${Math.round(s.height)}px`));const it=s.style||{};if(it.borderRadius&&(st.borderRadius=it.borderRadius),it.backgroundColor&&(st.backgroundColor=it.backgroundColor),it.backgroundGradient&&((er=it.backgroundGradient.colors)!=null&&er.length)){const Et=it.backgroundGradient.angle||0,tt=it.backgroundGradient.colors[0]||"#000000",et=it.backgroundGradient.colors[1]||"#000000";st.backgroundImage=`linear-gradient(${Et}deg, ${tt}, ${et})`,st.backgroundSize="cover",st.backgroundRepeat="no-repeat"}return v.push(`'${Fe.replace(/'/g,"\\'")}' : ${zt(st)}`),`${Ze}<div${ke}${w(s)}${X}${Bt} :style="pos['${Fe.replace(/'/g,"\\'")}']" >
        ${lt}
      </div>`}const pe=zr(s.text||""),Pe=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`container_${oe}`,Te=V(Pe),ft=s.elementId&&s.elementId.trim()?` id="${Te}"`:"",Qe={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Ne};s.autoSize||(s.width&&(Qe.width=`${Math.round(s.width)}px`),s.height&&(Qe.height=`${Math.round(s.height)}px`));const Re=s.style||{};if(Re.borderRadius&&(Qe.borderRadius=Re.borderRadius),Re.backgroundColor&&(Qe.backgroundColor=Re.backgroundColor),Re.backgroundGradient&&((nr=Re.backgroundGradient.colors)!=null&&nr.length)){const lt=Re.backgroundGradient.angle||0,Ve=Re.backgroundGradient.colors[0]||"#000000",Fe=Re.backgroundGradient.colors[1]||"#000000";Qe.backgroundImage=`linear-gradient(${lt}deg, ${Ve}, ${Fe})`,Qe.backgroundSize="cover",Qe.backgroundRepeat="no-repeat"}return v.push(`'${Te.replace(/'/g,"\\'")}' : ${zt(Qe)}`),`${Ze}<div${ke}${w(s)}${X}${ft} :style="pos['${Te.replace(/'/g,"\\'")}']" >${pe}</div>`}if(s.type==="line"){const Ze=s.style||{},pe=Ze.lineColor||"#ffffff",Pe=(lr=Ze.lineThickness)!=null?lr:2,Te=Ze.lineOrientation||"horizontal",ft=Ze.lineStyle==="dashed",Qe=(Pt=Ze.lineDashLength)!=null?Pt:6,Re=(Wt=Ze.lineDashGap)!=null?Wt:4,lt=Math.max(1,Math.round((Ft=s.width)!=null?Ft:Te==="horizontal"?200:2)),Ve=Math.max(1,Math.round((or=s.height)!=null?or:Te==="horizontal"?2:200)),Fe=Math.round(Ve/2),Bt=Math.round(lt/2),st=ft?` stroke-dasharray="${Qe} ${Re}"`:"",it=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`line_${oe}`,Et=V(it),tt={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,width:`${lt}px`,height:`${Ve}px`,zIndex:Ne};return v.push(`'${Et.replace(/'/g,"\\'")}' : ${zt(tt)}`),Te==="horizontal"?`<svg${ke}${w(s)}${X} viewBox="0 0 ${lt} ${Ve}" preserveAspectRatio="none" :style="pos['${Et.replace(/'/g,"\\'")}']"><line x1="0" y1="${Fe}" x2="${lt}" y2="${Fe}" stroke="${pe}" stroke-width="${Pe}"${st} fill="none" /></svg>`:`<svg${ke}${w(s)}${X} viewBox="0 0 ${lt} ${Ve}" preserveAspectRatio="none" :style="pos['${Et.replace(/'/g,"\\'")}']"><line x1="${Bt}" y1="0" x2="${Bt}" y2="${Ve}" stroke="${pe}" stroke-width="${Pe}"${st} fill="none" /></svg>`}if(s.type==="arc-text"){const Ze=Math.max(1,Math.round(s.width||1)),pe=Math.max(1,Math.round(s.height||1)),Pe=`arc_${s.id.replace(/"/g,"").replace(/'/g,"\\'")}`,Te=mo(s),ft=xo(s),Qe=ho(s),Re=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`arc_${oe}`,lt=V(Re),Ve={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,width:`${Ze}px`,height:`${pe}px`,zIndex:Ne};v.push(`'${lt.replace(/'/g,"\\'")}' : ${zt(Ve)}`);const Fe=s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath?`{{ ${`${s.dynamic.objectName}.${s.dynamic.propertyPath}`} }}`:zr(s.text||"");return`<svg${ke}${w(s)}${X} viewBox="0 0 ${Ze} ${pe}" preserveAspectRatio="none" :style="pos['${lt.replace(/'/g,"\\'")}']">
        <defs>
          <path id="${Pe}" d="${bo(s)}" fill="none" />
        </defs>
        <text style="${Te}">
          <textPath :href="'#${Pe}'" startOffset="${ft}" text-anchor="${Qe}">${Fe}</textPath>
        </text>
      </svg>`}const wt=zr(s.text||"element");return`<div${ke}${w(s)}${X} style="${be};z-index:${Ne}">${wt}</div>`}const ue=e.map((s,oe)=>t(s,oe)).join(`
      `),Me=$o(e);function Ke(s,oe){s.forEach(be=>{(be.type==="group"||be.type==="container")&&Array.isArray(be.children)?(oe(be),Ke(be.children,oe)):oe(be)})}const Le=new Set;Ke(e,s=>{(s.type==="text"||s.type==="arc-text")&&s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&Le.add(String(s.dynamic.objectName))});const Ae=Array.from(Le),pt=!$||Ae.length===0?"":Ae.map(s=>{try{const oe=$[s],be=JSON.stringify(oe!=null?oe:{},null,2).split(`
`).map((Ne,ke)=>ke===0?Ne:`    ${Ne}`).join(`
`);return`    ${s}: ${be},`}catch{return`    ${s}: {},`}}).join(`
`),gt=(()=>{const s=[];let oe=0;return Ke(e,be=>{if(be.type==="chart"){const Ne=be.elementId&&be.elementId.trim()?be.elementId.trim():`chart_${oe}`;oe++;const ke=be.chartOption||{};try{s.push(`'${Ne.replace(/'/g,"\\'")}' : ${JSON.stringify(ke,null,2)}`)}catch{s.push(`'${Ne.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${s.join(", ")} }`})(),bt=(()=>{const s=new Set;return Ke(e,oe=>{const be=String(oe.hiddenLabel||"").trim(),Ne=Ue(be),ke=!!oe.hidden;Ne&&ke&&s.add(Ne)}),Array.from(s).map(oe=>`      ${oe}: false,`).join(`
`)})(),Ct=(()=>{const s=new Map;function oe(Ne){Ne.forEach(ke=>{const Ee=ke.eventBinding;Ee&&Ee.enabled&&Ee.handlerName&&s.set(String(Ee.handlerName),String(Ee.code||"")),Array.isArray(ke.children)&&oe(ke.children)})}oe(e);const be=Array.from(s.entries());return be.length?be.map(([Ne,ke])=>`${Ne}(e) {
${ke}
}`).join(`,
`):""})(),_t=`export default {
    ${v.join(`,
    `)}
  };`,qt=`
  ${ot?`const chartOptions = ${gt};`:"const chartOptions = {};"}

  export const ${S}_data = {
    chartOptions,
    ${pt?`${pt}`:""}
    textSources: { ${ne.join(", ")} },
    textEffects: { ${fe.join(", ")} },
    elemStyles: { ${se.join(", ")} },
    ${bt?bt.replace(/\n\s*/g,""):""}
  };
  `;return{indexVue:`<template>
  <div class="${le}" :style="containerStyle">
    <img v-if="config.backgroundUrl" class="${Se}" :src="bgSrc" alt="" />
    ${ue}
    <div v-for="(opt, id) in chartOptions" :key="id" :id="id" :style="pos[id]"></div>
  </div>
</template>

<script>
import posEntries from './style/pos.js';
import { ${S}_data } from './data/index.js';
${ot?"import * as echarts from 'echarts';":""}

function parseCss(css) {
  const style = {};
  if (!css) return style;
  css.split(';').forEach(line => {
    const part = line.trim();
    if (!part) return;
    const splitIdx = part.indexOf(':');
    if (splitIdx > 0) {
      const key = part.slice(0, splitIdx).trim();
      const val = part.slice(splitIdx + 1).trim();
      style[key] = val;
    }
  });
  return style;
}

const pos = {};
for (const key in posEntries) {
  pos[key] = parseCss(posEntries[key]);
}

export default {
  name: '${S}',
  data() {
    return {
      config: {
        width: ${n.width},
        height: ${n.height},
        backgroundColor: '${Z}',
        backgroundUrl: '${((g==null?void 0:g.backgroundFileName)||ze).replace(/'/g,"\\'")}',
        globalFontFamily: '${T.replace(/'/g,"\\'")}',
        globalFontSize: ${Math.round(Q)},
        globalColor: '${De}',
      },
      ${g!=null&&g.imageFileNames?`// 使用本地资源路径，动态映射不再需要
      images: {},`:`// 图片 src 动态映射，初始写入 base64（若存在），blob 留空待替换
      images: {},`}
      // 引入分离的样式与数据
      pos,
      ...${S}_data
    };
  },
  computed: {
    containerStyle() {
      const base = {
        position: 'relative',
        width: this.config.width + 'px',
        height: this.config.height + 'px',
        fontFamily: this.config.globalFontFamily,
        fontSize: this.config.globalFontSize + 'px',
        color: this.config.globalColor,
        backgroundColor: this.config.backgroundColor || 'transparent',
      };
      return base;
    },
    bgSrc() {
       return ${Y};
    }
  },
  methods: {
    ${Ct?Ct+",":""}
    ${fe.length?`
    getByPath(obj, path) {
      try {
        const segs = String(path).split('.');
        return segs.reduce((acc, k) => (acc ? acc[k] : undefined), obj);
      } catch(e) {
        return undefined;
      }
    },
    getTextValue(id) {
      const srcMap = this.textSources || {};
      const src = srcMap[id];
      if (!src) return '';
      if (src.type === 'static') return String(src.text || '');
      const root = this[src.obj] || {};
      const v = this.getByPath(root, src.path);
      return v != null ? String(v) : '';
    },
    getTextPieces(id) {
      const text = this.getTextValue(id);
      const effMap = this.textEffects || {};
      const eff = effMap[id] || {};
      const orientation = eff.textOrientation || 'horizontal';
      const fontSize = Number(eff.fontSize || (this.config && this.config.globalFontSize) || 14);
      const letterSpacing = Number(eff.letterSpacing || 0);
      const step = fontSize * 0.6 + letterSpacing;

      const amp = eff.textWaveEnabled ? Number(eff.amplitude || 0) : 0;
      const freq = eff.textWaveEnabled ? Number(eff.frequency || 0) : 0;
      const phase = eff.textWaveEnabled ? Number(eff.phase || 0) : 0;
      const skew = eff.skewFlowEnabled ? Number(eff.skewAngle || 0) : 0;
      
      return String(text).split('').map((char, i) => {
        const offset = i * step;
        const waveY = amp * Math.sin((offset * freq) + phase);
        // 简单模拟布局倾斜：每个字符垂直位移随水平位置线性变化
        // skewAngle 正切值 * offset
        const skewY = skew ? offset * Math.tan(skew * Math.PI / 180) : 0;
        
        const style = {
          display: 'inline-block',
          transform: \`translateY(\${waveY + skewY}px)\`,
          fontSize: fontSize + 'px',
          letterSpacing: letterSpacing + 'px'
        };
        if (orientation === 'vertical') {
          style.writingMode = 'vertical-rl';
          style.textOrientation = 'upright';
        }
        return { char, style: { ...style, whiteSpace: 'pre-wrap' } };
      });
    },
    `:""}
    ${ot?`
    initCharts() {
      this.$nextTick(() => {
        const opts = this.chartOptions || {};
        Object.keys(opts).forEach((id) => {
          const dom = document.getElementById(id);
          if (dom) {
            const chart = echarts.init(dom);
            chart.setOption(opts[id]);
          }
        });
      });
    },
    `:""}
  },
  mounted() {
    ${ot?"this.initCharts();":""}
  }
};
<\/script>

<style scoped>
.${le} { overflow: hidden; }
.${Se} { position:absolute; left:0; top:0; width:100%; height:100%; object-fit:cover; z-index:0; pointer-events:none; }
.${N} { display:flex; align-items:center; justify-content:flex-start; }
.${ie} { display:flex; align-items:center; justify-content:center; }
.${$e} { display:flex; align-items:center; justify-content:flex-end; }
${Array.from(F.entries()).map(([s,oe])=>`.${oe}{ font-family:'${s.replace(/'/g,"\\'")}'; }`).join(`
`)}
${Array.from(f.values()).filter(s=>s.className&&s.css).map(s=>`.${s.className} { ${s.css} }`).join(`
`)}
${Me}
</style>
`,files:{"style/pos.js":_t,"data/index.js":qt}}}function on(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Eo(y){var $,S;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&(($=n.backgroundGradient.colors)!=null&&$.length)){const P=n.backgroundGradient.angle||0,le=n.backgroundGradient.colors[0]||"#000000",Se=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${P}deg, ${le}, ${Se})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&((S=n.textGradient.colors)!=null&&S.length))){const P=n.textGradient.angle||0,le=n.textGradient.colors[0]||"#000000",Se=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${P}deg, ${le}, ${Se})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const g=y.eventBinding;return g&&g.enabled&&g.cursor&&e.push(`cursor:${g.cursor}`),e.join(";")}function Ql(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function ko(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Ql(e)} }`)}function So(y){const n=[],e=g=>{g.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const S=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!S||!P)return;/\{[^}]*\}/.test(P)?n.push(ko(P)):n.push(`.${S} { ${Ql(P)} }`)}})};return e(y),n.join(`
`)}function eo(y){const n=String(y||"").trim();if(!n)return"";let e=n.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(e[0]||"")||(e="_"+e),e}function Mo(y,n){if(!y.hidden)return"";const e=eo(y.hiddenLabel);return e?` ${n!=null&&n.useShow?"v-show":"v-if"}="${e}"`:""}function Pl(y,n,e,g){const $=`lc-${y.replace(/[^A-Za-z0-9_]/g,"_")}-root`;let S=0;const P=e.some(v=>v.type==="chart");function le(v,L){var De,ot,Y,Ue,w;const V=Eo(v),U=v.zIndex||1,q=v.className&&v.className.trim()?` class="${v.className.trim()}"`:"",ze=Mo(v,{useShow:(g==null?void 0:g.hideDirective)==="show"}),Z=v.eventBinding,T=Z&&Z.enabled&&Z.handlerName?` @click="${String(Z.handlerName)}($event)"`:"",Q=v.elementId&&v.elementId.trim()?` id="${v.elementId.trim()}"`:"";if((v.type==="group"||v.type==="container")&&Array.isArray(v.children)){const t=v.children.map((ue,Me)=>le(ue,Me)).join(`
        `);return`<div${q}${ze}${T}${Q} style="${V};z-index:${U}">
        ${t}
      </div>`}if(v.type==="text"){const t=on(v.text||"");return`<div${q}${ze}${T} style="${V};z-index:${U}">${t}</div>`}if(v.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[v.id]){const t=g.imageFileMap[v.id],ue=v.elementId&&v.elementId.trim()?` id="${v.elementId.trim()}"`:"";return`<img${q}${ue}${ze}${T} :src="assetUrl('./imgs/${t}')" style="${V};z-index:${U}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[S]){const t=g.imageFileNames[S++],ue=v.elementId&&v.elementId.trim()?` id="${v.elementId.trim()}"`:"";return`<img${q}${ue}${ze}${T} :src="assetUrl('./imgs/${t}')" style="${V};z-index:${U}" alt="" />`}return`<div${q}${ze}${T} style="${V};z-index:${U}"></div>`}if(v.type==="line"){const t=v.style||{},ue=t.lineColor||"#ffffff",Me=(De=t.lineThickness)!=null?De:2,Ke=t.lineOrientation||"horizontal",Le=t.lineStyle==="dashed",Ae=(ot=t.lineDashLength)!=null?ot:6,pt=(Y=t.lineDashGap)!=null?Y:4,gt=Math.max(1,Math.round((Ue=v.width)!=null?Ue:Ke==="horizontal"?200:2)),bt=Math.max(1,Math.round((w=v.height)!=null?w:Ke==="horizontal"?2:200)),Ct=Math.round(bt/2),_t=Math.round(gt/2),qt=Le?` stroke-dasharray="${Ae} ${pt}"`:"";return Ke==="horizontal"?`<svg${q}${ze}${T} viewBox="0 0 ${gt} ${bt}" preserveAspectRatio="none" style="${V};z-index:${U}"><line x1="0" y1="${Ct}" x2="${gt}" y2="${Ct}" stroke="${ue}" stroke-width="${Me}"${qt} fill="none" /></svg>`:`<svg${q}${ze}${T} viewBox="0 0 ${gt} ${bt}" preserveAspectRatio="none" style="${V};z-index:${U}"><line x1="${_t}" y1="0" x2="${_t}" y2="${bt}" stroke="${ue}" stroke-width="${Me}"${qt} fill="none" /></svg>`}if(v.type==="chart"){const t=v.elementId&&v.elementId.trim()?v.elementId.trim():`chart_${L}`,ue=on(v.text||"chart");return`<div${q}${ze}${T} id="${t}" style="${V};z-index:${U}">${ue}</div>`}return`<div${q}${ze}${T} style="${V};z-index:${U}">${on(v.text||"")}</div>`}const Se=e.map((v,L)=>le(v,L)).join(`
      `),N=So(e),ie=n.backgroundUrl||"",$e=n.backgroundColor||"transparent",ne=n.globalFontFamily||"",fe=n.globalFontSize||14,se=n.globalColor||"#000000",F=(()=>{const v=[];let L=0;return e.forEach(V=>{if(V.type==="chart"){const U=V.elementId&&V.elementId.trim()?V.elementId.trim():`chart_${L}`;L++;const q=V.chartOption||{};try{v.push(`'${U.replace(/'/g,"\\'")}' : ${JSON.stringify(q)}`)}catch{v.push(`'${U.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${v.join(", ")} }`})(),f=(()=>{const v=new Set;return e.forEach(L=>{const V=String(L.hiddenLabel||"").trim(),U=eo(V),q=!!L.hidden;U&&q&&v.add(U)}),Array.from(v).map(L=>`const ${L} = ref(false)`).join(`
`)})();return`
<template>
  <div class="${$}" :style="containerStyle">
    ${Se}
  </div>
</template>

<script setup lang="ts">
import { onMounted, ref, computed } from 'vue'
${P?`import * as echarts from 'echarts'
`:""}
function assetUrl(p: string): string { try { return new URL(p, import.meta.url).href } catch { return p } }
const config = {
  width: ${Math.round(n.width)},
  height: ${Math.round(n.height)},
  backgroundColor: '${$e.replace(/'/g,"\\'")}',
  globalFontFamily: '${ne.replace(/'/g,"\\'")}',
  globalFontSize: ${Math.round(fe)},
  globalColor: '${se}',
}
const backgroundUrl: string = ${g!=null&&g.backgroundFileName?`assetUrl('./imgs/${String(g.backgroundFileName).replace(/'/g,"\\'")}')`:`'${ie.replace(/'/g,"\\'")}'`}
const images: Record<string, string> = {}
${P?`const chartOptions: Record<string, any> = ${F}`:""}
${f?`${f}
`:""}
const containerStyle = computed(() => {
  const base: Record<string, string> = {
    position: 'relative',
    width: config.width + 'px',
    height: config.height + 'px',
    fontFamily: config.globalFontFamily,
    fontSize: config.globalFontSize + 'px',
    color: config.globalColor,
    backgroundColor: (config.backgroundColor || 'transparent') as string,
  }
  if (backgroundUrl) {
    return Object.assign({}, base, {
      backgroundImage: 'url(' + backgroundUrl + ')',
      backgroundSize: 'cover',
      backgroundRepeat: 'no-repeat',
    }) as Record<string, string>
  }
  return base
})
// 事件处理函数
${(()=>{const v=new Map,L=V=>{V.forEach(U=>{const q=U.eventBinding;q&&q.enabled&&q.handlerName&&v.set(String(q.handlerName),String(q.code||"")),Array.isArray(U.children)&&L(U.children)})};return L(e),Array.from(v.entries()).map(([V,U])=>`function ${V}(e: MouseEvent){
${U}
}`).join(`
`)})()}
${P?`onMounted(() => {
  Object.keys(chartOptions || {}).forEach((id) => {
    const el = document.getElementById(id)
    if (el && (echarts as any)) { const inst = (echarts as any).init(el); inst.setOption((chartOptions as any)[id], true) }
  })
})`:""}
<\/script>

<style scoped>
.container { box-sizing: border-box; }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${N}
</style>
`}function Or(y){return String(y).replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Co(y){const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||y.x||0)}px`),e.push(`top:${Math.round(y.top||y.y||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&n.backgroundGradient.colors&&n.backgroundGradient.colors.length){const $=n.backgroundGradient.angle||0,S=n.backgroundGradient.colors[0]||"#000000",P=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${S}, ${P})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&n.textGradient.colors&&n.textGradient.colors.length)){const $=n.textGradient.angle||0,S=n.textGradient.colors[0]||"#000000",P=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${S}, ${P})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const g=y.eventBinding;return g&&g.enabled&&g.cursor&&e.push(`cursor:${g.cursor}`),y.hidden&&e.push("display:none"),e.join(";")}function to(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function No(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${to(e)} }`)}function Io(y){const n=[],e=g=>{g.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const S=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!S||!P)return;/\{[^}]*\}/.test(P)?n.push(No(P)):n.push(`.${S} { ${to(P)} }`)}})};return e(y),n.join(`
`)}function Wl(y,n,e,g){function $(f){for(const v of f)if((v.type==="group"||v.type==="container")&&Array.isArray(v.children)){if($(v.children))return!0}else if(v.type==="chart")return!0;return!1}const S=$(e),P=n.backgroundUrl||"",le=g!=null&&g.backgroundFileName?`background-image:url('./imgs/${g.backgroundFileName}');background-size:cover;background-repeat:no-repeat;`:P?`background-image:url('${P}');background-size:cover;background-repeat:no-repeat;`:"";let Se=0;const N={};(function(v){let L=0;const V=U=>{U.forEach(q=>{if((q.type==="group"||q.type==="container")&&Array.isArray(q.children))V(q.children);else if(q.type==="chart"){const ze=q.elementId&&String(q.elementId).trim()?String(q.elementId).trim():`chart_${L++}`;N[q.id]=ze}})};V(v)})(e);function ie(f){var Z,T,Q,De,ot;const v=Co(f),L=f.zIndex||1,V=f.className&&f.className.trim()?` class="${f.className.trim()}"`:"",U=f.eventBinding,q=U&&U.enabled&&U.handlerName?` onclick="${String(U.handlerName)}(event)"`:"",ze=f.elementId&&f.elementId.trim()?` id="${f.elementId.trim()}"`:"";if((f.type==="group"||f.type==="container")&&Array.isArray(f.children)&&f.children.length>0){const Y=f.children.map(Ue=>ie(Ue)).join(`
        `);return`<div${V}${q}${ze} style="${v};z-index:${L}">
        ${Y}
      </div>`}if(f.type==="text"){const Y=(f.style||{}).textAlign||"left",Ue=Y==="center"?"text-flex-center":Y==="right"?"text-flex-right":"text-flex-left",w=[(f.className||"").trim(),Ue].filter(Boolean).join(" ");return`<div${w?` class="${w}"`:""}${q} style="${v};z-index:${L}">${Or(f.text||"")}</div>`}if(f.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[f.id]){const Y=g.imageFileMap[f.id];return`<img${V}${q} src="./imgs/${Y}" style="${v};z-index:${L}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[Se]){const Y=g.imageFileNames[Se++];return`<img${V}${q} src="./imgs/${Y}" style="${v};z-index:${L}" alt="" />`}return`<div${V}${q} style="${v};z-index:${L}"></div>`}if(f.type==="line"){const Y=f.style||{},Ue=Y.lineColor||"#ffffff",w=(Z=Y.lineThickness)!=null?Z:2,t=Y.lineOrientation||"horizontal",ue=Y.lineStyle==="dashed",Me=(T=Y.lineDashLength)!=null?T:6,Ke=(Q=Y.lineDashGap)!=null?Q:4,Le=Math.max(1,Math.round((De=f.width)!=null?De:t==="horizontal"?200:2)),Ae=Math.max(1,Math.round((ot=f.height)!=null?ot:t==="horizontal"?2:200)),pt=Math.round(Ae/2),gt=Math.round(Le/2),bt=ue?` stroke-dasharray="${Me} ${Ke}"`:"";return t==="horizontal"?`<svg${V}${q} viewBox="0 0 ${Le} ${Ae}" preserveAspectRatio="none" style="${v};z-index:${L}"><line x1="0" y1="${pt}" x2="${Le}" y2="${pt}" stroke="${Ue}" stroke-width="${w}"${bt} fill="none" /></svg>`:`<svg${V}${q} viewBox="0 0 ${Le} ${Ae}" preserveAspectRatio="none" style="${v};z-index:${L}"><line x1="${gt}" y1="0" x2="${gt}" y2="${Ae}" stroke="${Ue}" stroke-width="${w}"${bt} fill="none" /></svg>`}if(f.type==="chart"){const Y=N[f.id]||String(f.elementId||"");return`<div${V}${q} id="${Y}" style="${v};z-index:${L}">${Or(f.text||"chart")}</div>`}return f.type==="container"?`<div${V}${q} style="${v};z-index:${L}">${Or(f.text||"")}</div>`:`<div${V}${q} style="${v};z-index:${L}">${Or(f.text||"")}</div>`}const $e=e.map(f=>ie(f)).join(`
      `),ne=Io(e),fe=g!=null&&g.fontFaces&&g.fontFaces.length>0?g.fontFaces.map(f=>`@font-face { font-family: '${String(f.family).replace(/'/g,"\\'")}'; src: url('./fonts/${String(f.file)}'); font-weight: normal; font-style: normal; }`).join(`
`):"";function se(f,v){f.forEach(L=>{if((L.type==="group"||L.type==="container")&&Array.isArray(L.children))se(L.children,v);else if(L.type==="chart"){const V=N[L.id]||String(L.elementId||"");try{v.push(`chartOptions['${V.replace(/'/g,"\\'")}'] = ${JSON.stringify(L.chartOption||{})};`)}catch{v.push(`chartOptions['${V.replace(/'/g,"\\'")}'] = {};`)}}})}const F=S?`
    (function(){
      var chartOptions = {};
      ${(()=>{const f=[];return se(e,f),f.join(`
      `)})()}
      Object.keys(chartOptions).forEach(function(id){
        var el = document.getElementById(id);
        if (el && window.echarts) { var inst = window.echarts.init(el); inst.setOption(chartOptions[id], true); }
      });
    })();
  `:"";return`<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>${Or(y)}</title>
<style>
.container { position:relative; width:${Math.round(n.width)}px; height:${Math.round(n.height)}px; font-family:${String(n.globalFontFamily||"").replace(/'/g,"\\'")}; font-size:${Math.round(n.globalFontSize)}px; color:${String(n.globalColor)}; background-color:${String(n.backgroundColor||"transparent")}; ${le} }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${fe}
${ne}
</style>
${S?'<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"><\/script>':""}
</head>
<body>
<div class="container">
  ${$e}
</div>
<script>
${(()=>{const f=new Map,v=L=>{L.forEach(V=>{const U=V.eventBinding;U&&U.enabled&&U.handlerName&&f.set(String(U.handlerName),String(U.code||"")),Array.isArray(V.children)&&v(V.children)})};return v(e),Array.from(f.entries()).map(([L,V])=>`function ${L}(event){
${V}
}`).join(`
`)})()}
${F}
<\/script>
</body>
</html>`}function en(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Hl(y){var g,$;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((g=n.backgroundGradient.colors)!=null&&g.length)){const S=n.backgroundGradient.angle||0,P=n.backgroundGradient.colors[0]||"#000000",le=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${S}deg, ${P}, ${le})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&(($=n.textGradient.colors)!=null&&$.length))){const S=n.textGradient.angle||0,P=n.textGradient.colors[0]||"#000000",le=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${S}deg, ${P}, ${le})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}return y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),y.hidden&&e.push("display:none"),e.join(";")}function ro(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function Ao(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${ro(e)} }`)}function Fo(y){const n=[],e=g=>{g.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const S=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!S||!P)return;/\{[^}]*\}/.test(P)?n.push(Ao(P)):n.push(`.${S} { ${ro(P)} }`)}})};return e(y),n.join(`
`)}function Jl(y,n,e,g){const $=y.replace(/[^A-Za-z0-9_]/g,"_"),S=`lc-${$}-root`,P=`lc-${$}-flex-left`,le=`lc-${$}-flex-center`,Se=`lc-${$}-flex-right`,N=e.some(f=>f.type==="chart");let ie=0;const $e=e.map((f,v)=>{var q,ze,Z,T,Q;const L=Hl(f),V=f.zIndex||1,U=f.className&&f.className.trim()?` class="${f.className.trim()}"`:"";if((f.type==="group"||f.type==="container")&&Array.isArray(f.children)){const De=f.children.map(Y=>{const Ue=Hl(Y),w=Y.zIndex||1,t=Y.className&&Y.className.trim()?` class="${Y.className.trim()}"`:"",ue=Y.elementId&&Y.elementId.trim()?` id="${Y.elementId.trim()}"`:"";if(Y.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[Y.id]){const Me=g.imageFileMap[Y.id];return`<img${t}${ue} src="/imgs/${Me}" style="${Ue};z-index:${w}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[ie]){const Me=g.imageFileNames[ie++];return`<img${t}${ue} src="/imgs/${Me}" style="${Ue};z-index:${w}" alt="" />`}}return`<div${t}${ue} style="${Ue};z-index:${w}">${en(Y.text||"")}</div>`}).join(`
        `),ot=f.elementId&&f.elementId.trim()?` id="${f.elementId.trim()}"`:"";return`<div${U}${ot} style="${L};z-index:${V}">${De}</div>`}if(f.type==="text")return`<div${U} style="${L};z-index:${V}">${en(f.text||"")}</div>`;if(f.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[f.id]){const De=g.imageFileMap[f.id];return`<img${U} src="/imgs/${De}" style="${L};z-index:${V}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[ie]){const De=g.imageFileNames[ie++];return`<img${U} src="/imgs/${De}" style="${L};z-index:${V}" alt="" />`}return`<div${U} style="${L};z-index:${V}"></div>`}if(f.type==="line"){const De=f.style||{},ot=De.lineColor||"#ffffff",Y=(q=De.lineThickness)!=null?q:2,Ue=De.lineOrientation||"horizontal",w=De.lineStyle==="dashed",t=(ze=De.lineDashLength)!=null?ze:6,ue=(Z=De.lineDashGap)!=null?Z:4,Me=Math.max(1,Math.round((T=f.width)!=null?T:Ue==="horizontal"?200:2)),Ke=Math.max(1,Math.round((Q=f.height)!=null?Q:Ue==="horizontal"?2:200)),Le=Math.round(Ke/2),Ae=Math.round(Me/2),pt=w?` stroke-dasharray="${t} ${ue}"`:"";return Ue==="horizontal"?`<svg${U} viewBox="0 0 ${Me} ${Ke}" preserveAspectRatio="none" style="${L};z-index:${V}"><line x1="0" y1="${Le}" x2="${Me}" y2="${Le}" stroke="${ot}" stroke-width="${Y}"${pt} fill="none" /></svg>`:`<svg${U} viewBox="0 0 ${Me} ${Ke}" preserveAspectRatio="none" style="${L};z-index:${V}"><line x1="${Ae}" y1="0" x2="${Ae}" y2="${Ke}" stroke="${ot}" stroke-width="${Y}"${pt} fill="none" /></svg>`}if(f.type==="chart"){const De=f.elementId&&f.elementId.trim()?f.elementId.trim():`chart_${v}`;return`<div${U} id="${De}" style="${L};z-index:${V}">${en(f.text||"chart")}</div>`}return`<div${U} style="${L};z-index:${V}">${en(f.text||"")}</div>`}).join(`
      `),ne=Fo(e),fe=g!=null&&g.fontFaces&&g.fontFaces.length>0?g.fontFaces.map(f=>`@font-face { font-family: '${f.family.replace(/'/g,"\\'")}'; src: url('/fonts/${f.file}'); font-weight: normal; font-style: normal; }`).join(`
`):"",se=(()=>{const f=[];return e.forEach((v,L)=>{if(v.type==="chart"){const V=v.elementId&&v.elementId.trim()?v.elementId.trim():`chart_${L}`,U=v.chartOption||{};try{f.push(`'${V.replace(/'/g,"\\'")}' : ${JSON.stringify(U)}`)}catch{f.push(`'${V.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${f.join(", ")} }`})(),F=g!=null&&g.backgroundFileName?`'/imgs/${String(g.backgroundFileName).replace(/'/g,"\\'")}'`:`'${(n.backgroundUrl||"").replace(/'/g,"\\'")}'`;return`import React, { useEffect } from 'react';
${N?`import * as echarts from 'echarts';
`:""}
export default function ${y.replace(/[^A-Za-z0-9_]/g,"_")}() {
  const config = { width: ${Math.round(n.width)}, height: ${Math.round(n.height)}, backgroundColor: '${(n.backgroundColor||"transparent").replace(/'/g,"\\'")}', globalFontFamily: '${(n.globalFontFamily||"").replace(/'/g,"\\'")}', globalFontSize: ${Math.round(n.globalFontSize)}, globalColor: '${n.globalColor}' };
  const backgroundUrl = ${F};
  ${N?`const chartOptions = ${se};
  useEffect(() => {
    Object.keys(chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) { const inst = echarts.init(el); inst.setOption(chartOptions[id], true); }
    });
  }, []);
`:""}  const containerStyle = { position:'relative', width: config.width + 'px', height: config.height + 'px', fontFamily: config.globalFontFamily, fontSize: config.globalFontSize + 'px', color: config.globalColor, backgroundColor: config.backgroundColor, ...(backgroundUrl ? { backgroundImage: 'url(' + backgroundUrl + ')', backgroundSize: 'cover', backgroundRepeat: 'no-repeat' } : {}) };
  return (
    <div className="${S}" style={containerStyle}>
      <style>{\`.${P}{display:flex;align-items:center;justify-content:flex-start}.${le}{display:flex;align-items:center;justify-content:center}.${Se}{display:flex;align-items:center;justify-content:flex-end${fe?"\\n"+fe:""}${ne?"\\n"+ne:""}\`}</style>
      <div dangerouslySetInnerHTML={{ __html: \`${$e.replace(/`/g,"\\`")}\` }} />
    </div>
  );
}
`}var _l=Yl(ao()),jo=["placeholder"],zo={key:0,class:"absolute z-10 bg-gray-900 border border-gray-700 rounded w-full mt-1 max-h-40 overflow-auto shadow custom-scrollbar"},Oo=["onMousedown"],Bo={key:0,class:"px-2 py-2 text-xs text-gray-400"},Go=Zt({__name:"SearchableSelect",props:{modelValue:{},options:{},placeholder:{},numeric:{type:Boolean}},emits:["update:modelValue"],setup(y,{emit:n}){const e=y,g=n,$=ye(!1),S=ye(""),P=ye(null),le=ye("");let Se=null;const N=ye(!1);Dt(()=>e.modelValue,U=>{U==null?S.value="":S.value=String(U)},{immediate:!0});const ie=Xe(()=>e.options.map(U=>String(U))),$e=Xe(()=>{const U=le.value.trim().toLowerCase();return U?ie.value.filter(q=>q.toLowerCase().includes(U)):ie.value});function ne(U){S.value=U;const q=e.numeric?Number(U):U;g("update:modelValue",q),$.value=!1}function fe(){const U=S.value.trim();if(!U){g("update:modelValue",(e.numeric,null)),$.value=!1;return}const q=e.numeric?Number(U):U;g("update:modelValue",q),$.value=!1}function se(){N.value=!1,$.value=!0,v(S.value)}function F(){}function f(U){U.key==="Enter"&&fe()}function v(U){Se&&window.clearTimeout(Se),Se=window.setTimeout(()=>{le.value=U},180)}function L(){N.value=!0,$.value=!0,v(S.value)}function V(U){P.value&&(P.value.contains(U.target)||($.value=!1))}return an(()=>{window.addEventListener("click",V),le.value=S.value}),dn(()=>{window.removeEventListener("click",V),Se&&window.clearTimeout(Se)}),(U,q)=>(z(),B("div",{class:"relative",ref_key:"root",ref:P},[me(r("input",{class:"border border-gray-700 bg-gray-900 text-gray-100 rounded w-full px-2 py-1",placeholder:y.placeholder||"搜索选择或直接输入","onUpdate:modelValue":q[0]||(q[0]=ze=>S.value=ze),onInput:L,onFocus:se,onBlur:F,onKeydown:f},null,40,jo),[[Ce,S.value]]),$.value?(z(),B("div",zo,[(z(!0),B(rr,null,ur($e.value,ze=>(z(),B("div",{key:ze,class:"px-2 py-1 hover:bg-gray-700 cursor-pointer text-sm text-gray-100",onMousedown:Kl(Z=>ne(ze),["prevent"])},mt(ze),41,Oo))),128)),$e.value.length===0?(z(),B("div",Bo,"无匹配项，回车使用当前输入")):K("",!0)])):K("",!0)],512))}}),Tt=Go,To={class:"space-y-3"},Do={class:"flex items-center justify-between"},Uo={class:"inline-flex items-center cursor-pointer"},Lo={class:"flex items-center justify-between"},Ro={class:"inline-flex items-center cursor-pointer"},Vo=Zt({__name:"CanvasSettingsPanel",props:{spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean}},emits:["update:spacingEnabled","update:alignmentEnabled"],setup(y,{emit:n}){const e=y,g=n,$=Xe({get:()=>e.spacingEnabled,set:P=>g("update:spacingEnabled",P)}),S=Xe({get:()=>e.alignmentEnabled,set:P=>g("update:alignmentEnabled",P)});return(P,le)=>(z(),B("div",To,[le[6]||(le[6]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"辅助间距",-1)),r("div",Do,[le[3]||(le[3]=r("label",{class:"text-xs text-gray-400"},"显示间距标注",-1)),r("label",Uo,[me(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":le[0]||(le[0]=Se=>$.value=Se)},null,512),[[rn,$.value]]),le[2]||(le[2]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ge(["ml-3 text-xs",$.value?"text-cyan-300":"text-gray-300"])},mt($.value?"已开启":"已关闭"),3)])]),r("div",Lo,[le[5]||(le[5]=r("label",{class:"text-xs text-gray-400"},"显示对齐参考线",-1)),r("label",Ro,[me(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":le[1]||(le[1]=Se=>S.value=Se)},null,512),[[rn,S.value]]),le[4]||(le[4]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ge(["ml-3 text-xs",S.value?"text-cyan-300":"text-gray-300"])},mt(S.value?"已开启":"已关闭"),3)])])]))}}),Po=Vo,Wo={class:"space-y-3"},Ho={key:0,class:"text-sm text-gray-400"},Jo={key:1,class:"space-y-2"},_o=Zt({__name:"LayersList",props:{elements:{},selectedId:{}},emits:["select","reorderTop"],setup(y,{emit:n}){const e=y,g=n,$=Xe(()=>e.elements),S=ye({});function P(se){S.value[se]=!S.value[se]}function le(se){const F=se.children;return Array.isArray(F)&&F.length>0}function Se(se){const F=se.children;return Array.isArray(F)?F:[]}const N=ye(null),ie=ye(null);function $e(se){const F=(se.elementId||"").trim(),f=(se.className||"").trim(),v=(se.text||"").trim();return F||f||v||se.id}function ne(se){const F=String(se.type||"").toLowerCase();return F==="text"?{label:"文本",cls:"bg-blue-600/30 text-blue-200"}:F==="arc-text"?{label:"环绕",cls:"bg-cyan-600/30 text-cyan-200"}:F==="image"?{label:"图片",cls:"bg-emerald-600/30 text-emerald-200"}:F==="chart"?{label:"图表",cls:"bg-orange-600/30 text-orange-200"}:F==="line"?{label:"线条",cls:"bg-slate-600/30 text-slate-200"}:F==="container"?{label:"容器",cls:"bg-cyan-600/30 text-cyan-200"}:F==="group"?{label:"分组",cls:"bg-purple-600/30 text-purple-200"}:{label:"元素",cls:"bg-gray-600/30 text-gray-200"}}const fe=Zt({name:"LayerNode",props:{node:{type:Object,required:!0},selectedId:{type:String,default:null},depth:{type:Number,default:0},index:{type:Number,default:-1}},emits:["select","reorderTop"],setup(se,{emit:F}){return()=>{const f=se.node,v=se.depth===0,L=f.id===se.selectedId,V=ne(f),U=Kt("div",{class:"flex items-center gap-2"},[v&&se.index>=0?Kt("span",{class:"px-1.5 py-0.5 text-[10px] rounded bg-cyan-600/30 text-cyan-200"},String(se.index+1)):null,le(f)?Kt("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:Z=>{Z.stopPropagation(),P(f.id)},title:S.value[f.id]?"收起":"展开"},S.value[f.id]?"▼":"▶"):null,Kt("span",{class:`px-1.5 py-0.5 text-[10px] rounded ${V.cls}`},V.label),Kt("span",{class:"text-left text-sm text-gray-100 truncate whitespace-nowrap max-w-[180px]",title:$e(f)},$e(f))]),q=Kt("div",{class:["bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2 cursor-grab hover:bg-gray-700/60 transition-colors",L?"ring-2 ring-cyan-400/40 bg-gray-700/70":"",v&&ie.value===se.index?"border-purple-400":"",se.depth>0?"ml-3":""].filter(Boolean).join(" "),onClick:()=>F("select",f.id),draggable:v?!0:void 0,onDragstart:Z=>{v&&(N.value=se.index,Z.target.classList.add("cursor-grabbing"))},onDragover:Z=>{v&&(Z.preventDefault(),ie.value=se.index)},onDragenter:()=>{v&&(ie.value=se.index)},onDrop:Z=>{if(!v)return;Z.preventDefault();const T=N.value,Q=se.index;N.value=null,ie.value=null,typeof T=="number"&&typeof Q=="number"&&T!==Q&&F("reorderTop",{from:T,to:Q})},onDragend:Z=>{N.value=null,ie.value=null,Z.target.classList.remove("cursor-grabbing")}},[U,null]),ze=S.value[f.id]&&le(f)?Kt("div",{class:"mt-2 space-y-2 pl-3"},[...Se(f)].map(Z=>Kt(fe,{node:Z,selectedId:se.selectedId,depth:se.depth+1,index:-1,onSelect:T=>F("select",T)}))):null;return Kt("div",{},[q,ze])}}});return(se,F)=>(z(),B("div",Wo,[F[2]||(F[2]=r("div",{class:"text-xs text-gray-400"},"所有元素按层叠从上到下显示，支持展开分组/容器",-1)),$.value.length===0?(z(),B("div",Ho,"暂无元素")):(z(),B("div",Jo,[(z(!0),B(rr,null,ur($.value,(f,v)=>(z(),nn(Xl(fe),{key:f.id,node:f,selectedId:y.selectedId,depth:0,index:v,onSelect:F[0]||(F[0]=L=>g("select",L)),onReorderTop:F[1]||(F[1]=L=>g("reorderTop",L))},null,8,["node","selectedId","index"]))),128))]))]))}}),qo=_o,Yo={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},Xo={class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Ko={class:"flex items-center gap-2"},Zo={key:0,class:"space-y-2"},Qo={key:1,class:"space-y-2"},es={class:"grid grid-cols-2 gap-2"},ts={key:2,class:"space-y-2"},rs={class:"flex gap-2"},ns={key:3,class:"space-y-2"},ls={class:"flex gap-2"},os=["value"],ss={key:4,class:"space-y-3"},as={class:"space-y-2"},is={class:"space-y-2"},ds={class:"space-y-2"},us={key:6,class:"space-y-2 pt-4 border-t border-cyan-500/30"},cs={class:"relative"},ps={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},gs={class:"relative w-[520px] max-w-[90vw] p-4 bg-gray-900/95 backdrop-blur-md border border-emerald-500/40 rounded-xl shadow-2xl"},fs={class:"flex items-center justify-between mb-3"},ys={class:"grid grid-cols-2 gap-2"},ms={key:7,class:"space-y-3"},bs=Zt({__name:"CanvasSidebar",props:{exportName:{},config:{},fontLibrary:{},spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean},elements:{},selectedId:{}},emits:["update:exportName","update:configWidth","update:configHeight","update:backgroundColor","update:globalFontFamily","update:globalFontSize","update:globalColor","update:spacingEnabled","update:alignmentEnabled","backgroundFileChange","openPreview","downloadByFormat","downloadAllFormats","resetCanvas","selectElement","moveElementUp","moveElementDown","moveElementTop","moveElementBottom","reorderTopElements"],setup(y,{emit:n}){const e=y,g=n,$=Xe({get:()=>e.exportName,set:Z=>g("update:exportName",Z)}),S=Xe({get:()=>e.config.width,set:Z=>g("update:configWidth",Z)}),P=Xe({get:()=>e.config.height,set:Z=>g("update:configHeight",Z)}),le=Xe({get:()=>e.config.backgroundColor||"",set:Z=>g("update:backgroundColor",Z)}),Se=Xe({get:()=>e.config.globalFontFamily||"",set:Z=>g("update:globalFontFamily",Z)}),N=Xe({get:()=>e.config.globalFontSize||14,set:Z=>g("update:globalFontSize",Z)}),ie=Xe({get:()=>e.config.globalColor||"#ffffff",set:Z=>g("update:globalColor",Z)}),$e=Xe({get:()=>e.spacingEnabled,set:Z=>g("update:spacingEnabled",Z)}),ne=Xe({get:()=>e.alignmentEnabled,set:Z=>g("update:alignmentEnabled",Z)});function fe(Z){try{return String(Z||"#000000")}catch{return"#000000"}}const se=Xe({get:()=>F.value,set:Z=>F.value=Z}),F=ye(!1),f=ye("settings");function v(Z){g("backgroundFileChange",Z)}function L(){g("openPreview")}function V(){F.value=!F.value}function U(Z){g("downloadByFormat",Z),F.value=!1}function q(){g("downloadAllFormats"),F.value=!1}function ze(){g("resetCanvas")}return(Z,T)=>(z(),B("div",Yo,[T[31]||(T[31]=r("div",{class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),Br(" 画布设置 ")])],-1)),r("div",Xo,[r("div",Ko,[r("button",{class:Ge(["px-3 py-1 text-xs rounded bg-gradient-to-r from-cyan-600 to-blue-600 text-white",f.value==="settings"?"":"opacity-50"]),onClick:T[0]||(T[0]=Q=>f.value="settings")},"设置",2),r("button",{class:Ge(["px-3 py-1 text-xs rounded bg-gradient-to-r from-purple-600 to-pink-600 text-white",f.value==="layers"?"":"opacity-50"]),onClick:T[1]||(T[1]=Q=>f.value="layers")},"容器层级",2)]),f.value==="settings"?(z(),B("div",Zo,[T[21]||(T[21]=r("label",{class:"block text-sm font-medium text-cyan-300"},"组件名称",-1)),me(r("input",{"onUpdate:modelValue":T[2]||(T[2]=Q=>$.value=Q),class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"GeneratedComponent"},null,512),[[Ce,$.value]])])):K("",!0),f.value==="settings"?(z(),B("div",Qo,[T[22]||(T[22]=r("label",{class:"block text-sm font-medium text-cyan-300"},"画布尺寸",-1)),r("div",es,[me(r("input",{"onUpdate:modelValue":T[3]||(T[3]=Q=>S.value=Q),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"宽度"},null,512),[[Ce,S.value,void 0,{number:!0}]]),me(r("input",{"onUpdate:modelValue":T[4]||(T[4]=Q=>P.value=Q),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"高度"},null,512),[[Ce,P.value,void 0,{number:!0}]])])])):K("",!0),f.value==="settings"?(z(),B("div",ts,[T[23]||(T[23]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景图片",-1)),r("div",rs,[r("input",{type:"file",onChange:v,accept:"image/*",class:"flex-1 text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-cyan-600 file:text-white hover:file:bg-cyan-500 file:cursor-pointer"},null,32)])])):K("",!0),f.value==="settings"?(z(),B("div",ns,[T[24]||(T[24]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景颜色",-1)),r("div",ls,[r("input",{value:fe(le.value),type:"color",onInput:T[5]||(T[5]=Q=>g("update:backgroundColor",Q.target.value)),class:"w-16 h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,40,os),me(r("input",{"onUpdate:modelValue":T[6]||(T[6]=Q=>le.value=Q),type:"text",class:"flex-1 px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"#000000 或 rgba(...)"},null,512),[[Ce,le.value]])])])):K("",!0),f.value==="settings"?(z(),B("div",ss,[T[28]||(T[28]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"全局字体设置",-1)),r("div",as,[T[25]||(T[25]=r("label",{class:"block text-xs text-gray-400"},"字体族",-1)),$t(Tt,{options:y.fontLibrary,modelValue:Se.value,"onUpdate:modelValue":T[7]||(T[7]=Q=>Se.value=Q),placeholder:"选择字体"},null,8,["options","modelValue"])]),r("div",is,[T[26]||(T[26]=r("label",{class:"block text-xs text-gray-400"},"字号 (px)",-1)),me(r("input",{"onUpdate:modelValue":T[8]||(T[8]=Q=>N.value=Q),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-cyan-500/30 rounded text-gray-100 text-sm focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,N.value,void 0,{number:!0}]])]),r("div",ds,[T[27]||(T[27]=r("label",{class:"block text-xs text-gray-400"},"颜色",-1)),me(r("input",{"onUpdate:modelValue":T[9]||(T[9]=Q=>ie.value=Q),type:"color",class:"w-full h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,512),[[Ce,ie.value]])])])):K("",!0),f.value==="settings"?(z(),nn(Po,{key:5,spacingEnabled:$e.value,alignmentEnabled:ne.value,"onUpdate:spacingEnabled":T[10]||(T[10]=Q=>$e.value=Q),"onUpdate:alignmentEnabled":T[11]||(T[11]=Q=>ne.value=Q)},null,8,["spacingEnabled","alignmentEnabled"])):K("",!0),f.value==="settings"?(z(),B("div",us,[r("button",{onClick:L,class:"w-full px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"},"预览（新窗口）"),r("div",cs,[r("button",{onClick:V,class:"w-full px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},"导出"),se.value?(z(),B("div",ps,[r("div",{class:"absolute inset-0 bg-black/60",onClick:T[12]||(T[12]=Q=>se.value=!1)}),r("div",gs,[r("div",fs,[T[29]||(T[29]=r("h3",{class:"text-sm font-medium text-emerald-300"},"选择导出格式",-1)),r("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:T[13]||(T[13]=Q=>se.value=!1)},"关闭")]),r("div",ys,[r("button",{onClick:T[14]||(T[14]=Q=>U("vue2")),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded"},"Vue2 组件"),r("button",{onClick:T[15]||(T[15]=Q=>U("vue3")),class:"px-3 py-2 text-xs bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-500 hover:to-cyan-500 text-white rounded"},"Vue3 组件"),r("button",{onClick:T[16]||(T[16]=Q=>U("react")),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"React 组件"),r("button",{onClick:T[17]||(T[17]=Q=>U("html")),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded"},"纯 HTML 页面"),r("button",{onClick:T[18]||(T[18]=Q=>q()),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded col-span-2"},"一键导出（全部）")])])])):K("",!0)]),r("button",{onClick:ze,class:"w-full px-4 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"清空画布")])):K("",!0),f.value==="layers"?(z(),B("div",ms,[T[30]||(T[30]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器层级",-1)),$t(qo,{elements:e.elements||[],selectedId:e.selectedId||null,onSelect:T[19]||(T[19]=Q=>g("selectElement",Q)),onReorderTop:T[20]||(T[20]=Q=>g("reorderTopElements",Q))},null,8,["elements","selectedId"])])):K("",!0)])]))}}),xs=bs,ql=Yl(co()),hs={class:"relative w-full"},vs=Zt({__name:"CssEditor",props:{modelValue:{},height:{},debounceMs:{}},emits:["update:modelValue"],setup(y,{emit:n}){const e=y,g=n,$=ye(e.modelValue||"");let S=null;const P=typeof e.debounceMs=="number"?Math.max(0,e.debounceMs):250;Dt(()=>e.modelValue,$e=>{S&&(clearTimeout(S),S=null);const ne=$e||"";ne!==$.value&&($.value=ne)}),Dt($,$e=>{S&&clearTimeout(S),S=window.setTimeout(()=>{g("update:modelValue",$e),S=null},P)}),dn(()=>{S&&(clearTimeout(S),S=null)});function le(){const $e=$.value||"";if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText($e).catch(()=>{try{const ne=document.createElement("textarea");ne.value=$e,document.body.appendChild(ne),ne.select(),document.execCommand("copy"),document.body.removeChild(ne)}catch{}});else try{const ne=document.createElement("textarea");ne.value=$e,document.body.appendChild(ne),ne.select(),document.execCommand("copy"),document.body.removeChild(ne)}catch{}}function Se(){S&&(clearTimeout(S),S=null),$.value="",g("update:modelValue","")}const N=[no,lo(),so],ie=Xe(()=>{var $e;return($e=e.height)!=null?$e:"180px"});return($e,ne)=>(z(),B("div",hs,[r("div",{class:"absolute right-2 top-2 z-10 flex gap-2"},[r("button",{type:"button",class:"px-2 py-1 text-xs bg-gray-700/70 hover:bg-gray-700 text-gray-100 rounded",onClick:le},"复制"),r("button",{type:"button",class:"px-2 py-1 text-xs bg-red-600/70 hover:bg-red-600 text-white rounded",onClick:Se},"清空")]),$t(Xl(oo),{modelValue:$.value,"onUpdate:modelValue":ne[0]||(ne[0]=fe=>$.value=fe),extensions:N,style:Mt({height:ie.value,width:"100%"}),class:"w-full rounded border border-purple-500/30 bg-gray-800/50"},null,8,["modelValue","style"])]))}}),$s=un(vs,[["__scopeId","data-v-c1c6cbbe"]]);function ws(y,n,e,g,$,S){y&&(y.style=y.style||{},y.style.boxShadow=`${n}px ${e}px ${g}px ${$}px ${S}`)}function Es(y){y.style=y.style||{},y.style.textGradient=y.style.textGradient||{colors:["#00A3FF","#ffffff"],angle:0}}function ks(y){y.style=y.style||{},y.style.backgroundGradient=y.style.backgroundGradient||{colors:["#00A3FF","#ffffff"],angle:90}}function Ss(y,n){var ie,$e,ne;const e=(ie=n==null?void 0:n.maxDepth)!=null?ie:6,g=($e=n==null?void 0:n.maxEntries)!=null?$e:400,$=(ne=n==null?void 0:n.includeIntermediate)!=null?ne:!1,S=[],P=new WeakSet;function le(fe){return Object.prototype.toString.call(fe)==="[object Object]"}function Se(fe){S.length<g&&S.push(fe)}function N(fe,se,F){if(!(F>e)&&fe!=null){if(typeof fe!="object"){Se(se);return}if(!P.has(fe)){if(P.add(fe),Array.isArray(fe)){Se(se);const f=Math.min(fe.length,20);for(let v=0;v<f;v++)N(fe[v],`${se}[${v}]`,F+1);return}if(le(fe)){$&&Se(se);const f=Object.keys(fe).slice(0,50);for(const v of f)N(fe[v],se?`${se}.${v}`:v,F+1);return}Se(se)}}}return N(y,"",0),S.filter(Boolean)}function Ms(y,n){try{if(!y||!n)return"";const e=n.replace(/\[(\d+)\]/g,".$1").replace(/\['([^']+)'\]/g,".$1").replace(/\["([^\"]+)"\]/g,".$1").split(".").filter(Boolean);let g=y;for(const $ of e){if(g==null)return"";g=g[$]}return typeof g=="object"?JSON.stringify(g):g!=null?g:""}catch{return""}}function Cs(y,n){var $;if(!n||!(($=n.dynamic)!=null&&$.enabled)||!n.dynamic.objectName||!n.dynamic.propertyPath)return"";const e=n.dynamic,g=y[e.objectName];return String(Ms(g,e.propertyPath))}var Ns={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20 flex flex-col"},Is={key:0,class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},As={class:"space-y-3"},Fs={class:"grid grid-cols-2 gap-2"},js={class:"col-span-2"},zs={key:0,class:"space-y-3"},Os={class:"space-y-2"},Bs={class:"grid grid-cols-2 gap-2"},Gs={class:"grid grid-cols-2 gap-2"},Ts={class:"grid grid-cols-2 gap-2"},Ds=["value"],Us=["value"],Ls={class:"space-y-2"},Rs={class:"flex gap-1"},Vs=["value"],Ps=["value"],Ws={class:"space-y-2"},Hs={class:"grid grid-cols-3 gap-1"},Js={class:"space-y-2"},_s={class:"grid grid-cols-2 gap-2"},qs=["value"],Ys=["value"],Xs=["value"],Ks=["value"],Zs={class:"grid grid-cols-4 gap-1"},Qs={class:"space-y-3"},ea={class:"flex items-center justify-between"},ta={class:"inline-flex items-center cursor-pointer"},ra={key:0,class:"grid grid-cols-2 gap-2"},na={key:1},la={class:"space-y-3"},oa={class:"space-y-2"},sa={class:"flex items-center justify-between"},aa={key:0},ia={class:"flex gap-2"},da={key:1},ua={key:2},ca={key:3,class:"space-y-2 pt-2 border-t border-purple-500/20"},pa={class:"flex items-center justify-between"},ga={class:"inline-flex items-center cursor-pointer"},fa=["checked"],ya={key:0,class:"space-y-1"},ma=["value"],ba={key:1,class:"space-y-3"},xa={class:"flex items-center gap-2"},ha=["value"],va=["value"],$a={class:"space-y-2"},wa={class:"flex items-center justify-between"},Ea={class:"flex items-center gap-1 text-xs text-gray-300"},ka=["checked"],Sa={key:0,class:"grid grid-cols-3 gap-2 items-end"},Ma={class:"flex items-center gap-2"},Ca=["value"],Na=["value"],Ia={class:"flex items-center gap-2"},Aa=["value"],Fa=["value"],ja={class:"space-y-1"},za=["value"],Oa=["value"],Ba={class:"space-y-2"},Ga={class:"flex items-center justify-between"},Ta={class:"flex items-center gap-1 text-xs text-gray-300"},Da=["checked"],Ua={key:0,class:"space-y-1"},La={class:"flex items-center gap-2"},Ra={key:0,class:"space-y-1"},Va=["value"],Pa=["value"],Wa={key:1,class:"space-y-1"},Ha=["value"],Ja={class:"flex items-center gap-1"},_a=["value"],qa={class:"space-y-2"},Ya={class:"flex items-center justify-between"},Xa={class:"flex items-center gap-1 text-xs text-gray-300"},Ka=["checked"],Za={key:0,class:"space-y-2"},Qa=["value"],ei={class:"space-y-1"},ti={class:"flex items-center gap-2"},ri=["value"],ni=["value"],li={class:"space-y-1"},oi={class:"flex items-center gap-2"},si=["value"],ai=["value"],ii={class:"space-y-1"},di={class:"flex items-center gap-2"},ui=["value"],ci=["value"],pi={class:"space-y-1"},gi={class:"flex items-center gap-2"},fi=["value"],yi=["value"],mi={class:"space-y-1"},bi={key:0,class:"flex items-center gap-2"},xi=["value"],hi=["value"],vi={key:2,class:"space-y-3"},$i={class:"flex items-center gap-2"},wi={key:0,class:"space-y-2"},Ei=["value"],ki={class:"grid grid-cols-2 gap-2"},Si=["value"],Mi=["value"],Ci={key:0,class:"grid grid-cols-2 gap-2"},Ni=["value"],Ii=["value"],Ai={key:1,class:"grid grid-cols-2 gap-2"},Fi={key:2,class:"grid grid-cols-3 gap-2 items-end"},ji={key:1},zi={class:"flex items-center justify-between mt-2"},Oi={key:0,class:"text-xs text-red-400"},Bi={key:3,class:"space-y-3"},Gi={class:"space-y-2"},Ti={class:"flex gap-1"},Di=["value"],Ui=["value"],Li={class:"grid grid-cols-2 gap-2"},Ri={class:"grid grid-cols-2 gap-1"},Vi=["value"],Pi={class:"grid grid-cols-2 gap-2"},Wi=["value"],Hi={key:0},Ji=["value"],_i={key:0,class:"grid grid-cols-2 gap-2"},qi=["value"],Yi={key:4,class:"space-y-3"},Xi={class:"space-y-2"},Ki={class:"space-y-2 mt-2"},Zi={class:"flex items-center gap-2"},Qi=["checked"],ed={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},td={class:"text-xs text-gray-400"},rd={class:"space-y-2"},nd={class:"grid grid-cols-2 gap-1"},ld={class:"grid grid-cols-2 gap-2"},od={class:"grid grid-cols-2 gap-2"},sd={class:"grid grid-cols-2 gap-2"},ad=["value"],id=["value"],dd={class:"space-y-2"},ud=["value"],cd={class:"space-y-2"},pd={class:"flex gap-1"},gd=["value","disabled"],fd=["value","disabled"],yd={key:0,class:"text-xs text-yellow-400 mt-1"},md={class:"space-y-2"},bd={class:"flex gap-1"},xd=["value"],hd=["value"],vd={class:"space-y-2"},$d={class:"grid grid-cols-3 gap-1"},wd={class:"space-y-2"},Ed={class:"grid grid-cols-2 gap-1"},kd={class:"space-y-2"},Sd={class:"flex items-center gap-2"},Md={class:"flex items-center gap-2 mt-1"},Cd={class:"space-y-2"},Nd={class:"flex items-center justify-between"},Id={class:"flex gap-1"},Ad={key:0,class:"grid grid-cols-3 gap-2 items-center"},Fd={class:"col-span-1"},jd={class:"col-span-1"},zd={class:"col-span-1"},Od={class:"space-y-2"},Bd={class:"grid grid-cols-3 gap-1"},Gd={class:"space-y-2"},Td={class:"flex items-center justify-between"},Dd={class:"flex gap-1"},Ud={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Ld={class:"grid grid-cols-2 gap-2"},Rd={class:"flex gap-1"},Vd={class:"flex gap-1"},Pd={class:"block text-xs text-gray-400 mb-1"},Wd={class:"space-y-2"},Hd={class:"flex items-center justify-between"},Jd={class:"flex gap-1"},_d={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},qd={class:"grid grid-cols-2 gap-2"},Yd={class:"flex gap-1"},Xd={class:"flex gap-1"},Kd={class:"block text-xs text-gray-400 mb-1"},Zd={key:5,class:"space-y-3"},Qd={class:"space-y-2"},eu={key:0,class:"space-y-2"},tu={class:"max-h-32 overflow-y-auto custom-scrollbar bg-gray-800/30 rounded p-2"},ru={class:"grid grid-cols-4 gap-2"},nu=["onClick"],lu=["src","alt"],ou={key:0,class:"text-xs text-gray-500 text-center py-2"},su={class:"grid grid-cols-3 gap-2"},au={class:"space-y-2"},iu={class:"pt-4 border-t border-purple-500/30 space-y-2"},du={key:1,class:"p-4 text-center text-gray-400 flex-1 flex flex-col justify-center"},uu={},cu=Zt({...uu,__name:"ElementSettingsPanel",props:{selectedEl:{},config:{},fontLibrary:{},fontSizeLibrary:{},fontWeightOptions:{},fontStyleOptions:{},databaseObjects:{},dbMap:{},iconLibrary:{},defaultChartOption:{type:Function},safeHex:{type:Function},initCustomClassSkeleton:{type:Function},refreshAllCustomClassCss:{type:Function},removeCustomClassCssForElement:{type:Function},getIconDataUrlById:{type:Function}},emits:["duplicateSelected","removeSelected","saveSelectedAsComponent"],setup(y,{emit:n}){const e=y,g=n,$=ye("visual"),S=ye(""),P=ye("");Dt(()=>{var w;return(w=e.selectedEl)==null?void 0:w.id},()=>{var t;const w=e.selectedEl;w&&w.type==="chart"&&($.value="visual",P.value="",S.value=JSON.stringify((t=w.chartOption)!=null?t:e.defaultChartOption(w.chartType||"line"),null,2))});const le=Xe(()=>{var ue,Me;const w=(Me=(ue=e.selectedEl)==null?void 0:ue.dynamic)==null?void 0:Me.objectName;if(!w)return[];const t=e.dbMap[w];try{return Ss(t,{maxDepth:6,maxEntries:400})}catch{return[]}});function Se(w){return Cs(e.dbMap,w)}function N(w){return typeof w=="string"&&w.trim().endsWith("%")?"%":"px"}function ie(w){if(w==null)return 0;if(typeof w=="number")return w;const t=String(w).trim();if(t.endsWith("%")){const Me=Number(t.replace("%",""));return Number.isFinite(Me)?Me:0}const ue=Number(t.replace("px",""));return Number.isFinite(ue)?ue:0}function $e(w,t){const ue=e.selectedEl;ue&&(ue.style=ue.style||{},ue.style.borderRadius=`${w}${t}`)}function ne(w){const t={x:0,y:8,blur:24,spread:0,color:"#000000"};if(!w||!w.trim())return t;const ue=w.split(/\s+/).filter(Boolean);if(ue.length<3)return t;const Me=ue.slice(0,4).map(bt=>Number(String(bt).replace("px",""))),Ke=ue.slice(4).join(" ")||t.color,[Le=NaN,Ae=NaN,pt=NaN,gt=NaN]=Me;return{x:Number.isFinite(Le)?Le:t.x,y:Number.isFinite(Ae)?Ae:t.y,blur:Number.isFinite(pt)?pt:t.blur,spread:Number.isFinite(gt)?gt:t.spread,color:Ke}}function fe(w,t,ue,Me,Ke){ws(e.selectedEl,w,t,ue,Me,Ke)}function se(w){Es(w)}function F(w){ks(w)}function f(){P.value="";try{const w=JSON.parse(S.value);e.selectedEl&&e.selectedEl.type==="chart"&&(e.selectedEl.chartOption=w)}catch(w){P.value=`JSON 解析失败：${(w==null?void 0:w.message)||String(w)}`}}function v(w,t){if(!e.selectedEl||e.selectedEl.type!=="chart"||!e.selectedEl.chartOption)return;const ue=e.selectedEl.chartOption,Me=ue.series||[],Ke={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:w},{offset:1,color:t}],global:!1};Me.forEach(Le=>{Le.type==="bar"&&(Le.itemStyle=Le.itemStyle||{},Le.itemStyle.color=Ke)}),S.value=JSON.stringify(ue,null,2)}function L(){const w=e.selectedEl;return!w||w.type!=="chart"?null:(w.chartOption||(w.chartOption=e.defaultChartOption(w.chartType||"line")),w.chartOption)}function V(w){const t=L();t&&(t.title=t.title||{},t.title.text=w,S.value=JSON.stringify(t,null,2))}function U(w){const t=L();t&&(t.color=w.split(",").map(ue=>ue.trim()).filter(Boolean),S.value=JSON.stringify(t,null,2))}function q(w){const t=L();t&&(t.legend=t.legend||{},t.legend.show=w==="1",S.value=JSON.stringify(t,null,2))}function ze(w){var ue;const t=(ue=w.target.files)==null?void 0:ue[0];if(t&&e.selectedEl){const Me=new FileReader;Me.onload=()=>{e.selectedEl&&(e.selectedEl.src=String(Me.result),e.selectedEl.iconId=void 0)},Me.readAsDataURL(t)}}async function Z(w){const t=e.selectedEl;if(!t||t.type!=="image")return;const ue=await e.getIconDataUrlById(w.id);if(!ue)return;t.src=ue,t.iconId=w.id;const Me=new Image;Me.onload=()=>{e.selectedEl&&e.selectedEl.id===t.id&&(e.selectedEl.width=Me.naturalWidth,e.selectedEl.height=Me.naturalHeight)},Me.src=ue}function T(){const w=e.selectedEl;if(!w||w.type!=="image"||!w.src)return;const t=new Image;t.onload=()=>{e.selectedEl&&(e.selectedEl.width=t.naturalWidth,e.selectedEl.height=t.naturalHeight)},t.src=w.src}function Q(){}const De=Xe({get(){const w=e.selectedEl;return!!(w&&w.eventBinding&&w.eventBinding.enabled)},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!1,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.enabled=w,(t.eventBinding.handlerName==null||String(t.eventBinding.handlerName).trim()==="")&&(t.eventBinding.handlerName="handleClick"),(t.eventBinding.cursor==null||String(t.eventBinding.cursor).trim()==="")&&(t.eventBinding.cursor="pointer"),t.eventBinding.code==null&&(t.eventBinding.code=""))}}),ot=Xe({get(){var w,t;return(t=(w=e.selectedEl)==null?void 0:w.eventBinding)==null?void 0:t.cursor},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.cursor=w)}}),Y=Xe({get(){var w,t;return(t=(w=e.selectedEl)==null?void 0:w.eventBinding)==null?void 0:t.handlerName},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.handlerName=w)}}),Ue=Xe({get(){var w,t;return(t=(w=e.selectedEl)==null?void 0:w.eventBinding)==null?void 0:t.code},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.code=w)}});return(w,t)=>{var ue,Me,Ke,Le,Ae,pt,gt,bt,Ct,_t,qt,s,oe,be,Ne,ke,Ee,X,wt,xt,It,Ut,Yt,rt,nt,At,Qt,Ot,Vt,at,er,nr,lr,Pt,Wt,Ft,or,Ze,pe,Pe,Te,ft,Qe,Re,lt,Ve,Fe,Bt,st,it,Et,tt,et,Nt,Xt,Lt,sr,Gt,Rt,hr,ar,vr,Gr,Tr,Dr,dt,tr,Ur,Lr,$r,wr,Er,Rr,ir,cr,pr,gr,kr,Sr,Vr,Mr,Ht,kt,Pr,Wr,Hr,Jr,_r,qr,Cr,fr,yr,Nr,mr,br,Yr,dr,Ir,Xr,Ar,Fr,Kr,jr,l,o,i,c,m,p,M,k,C,I,d,u,G,H,de,ge,ae,he,xe,ee,te,J,re,Oe,b,h,R,j,D,_,x,W,E,ce,je,ve,Ie,Be,We,ht,yt,St,ut,jt,vt,Jt,xr,Zr,cn,pn,gn,fn,yn,mn,bn,xn,hn,vn,$n,wn,En,kn,Sn,Mn,Cn,Nn,In,An,Fn,jn,zn,On,Bn,Gn,Tn,Dn,Un,Ln,Rn,Vn,Pn,Wn,Hn,Jn,_n,qn,Yn,Xn,Kn,Zn,Qn,el,tl,rl,nl,ll,ol,sl,al,il,dl,ul,cl,pl,gl,fl,yl,ml,bl,xl,hl,vl,$l,wl,El,kl,Sl,Ml,Cl,Nl,Il,Al,Fl,jl,zl,Ol,Bl,Gl,Tl,Dl,Ul;return z(),B("div",Ns,[t[272]||(t[272]=r("div",{class:"p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-purple-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),Br(" 元素设置 ")])],-1)),e.selectedEl?(z(),B("div",Is,[r("div",As,[t[149]||(t[149]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"位置和尺寸",-1)),r("div",Fs,[r("div",null,[t[144]||(t[144]=r("label",{class:"block text-xs text-gray-400 mb-1"},"X",-1)),me(r("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.selectedEl.left=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.left,void 0,{number:!0}]])]),r("div",null,[t[145]||(t[145]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y",-1)),me(r("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.selectedEl.top=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.top,void 0,{number:!0}]])]),r("div",null,[t[146]||(t[146]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度",-1)),me(r("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>e.selectedEl.width=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[147]||(t[147]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度",-1)),me(r("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>e.selectedEl.height=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.height,void 0,{number:!0}]])]),r("div",js,[t[148]||(t[148]=r("label",{class:"block text-xs text-gray-400 mb-1"},"层级（z-index）",-1)),me(r("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>e.selectedEl.zIndex=a),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.zIndex,void 0,{number:!0}]])])])]),e.selectedEl&&e.selectedEl.type==="arc-text"?(z(),B("div",zs,[t[165]||(t[165]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"环绕文字设置",-1)),r("div",Os,[t[150]||(t[150]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),me(r("textarea",{"onUpdate:modelValue":t[5]||(t[5]=a=>e.selectedEl.text=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[Ce,e.selectedEl.text]])]),r("div",Bs,[r("div",null,[t[151]||(t[151]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),$t(Tt,{options:e.fontSizeLibrary,modelValue:((ue=e.selectedEl.style)==null?void 0:ue.fontSize)||e.config.globalFontSize,"onUpdate:modelValue":t[6]||(t[6]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=a)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[t[152]||(t[152]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),$t(Tt,{options:e.fontLibrary,modelValue:((Me=e.selectedEl.style)==null?void 0:Me.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[7]||(t[7]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=a)})},null,8,["options","modelValue"])])]),r("div",Gs,[r("div",null,[t[153]||(t[153]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),$t(Tt,{options:e.fontWeightOptions,modelValue:((Ke=e.selectedEl.style)==null?void 0:Ke.fontWeight)||"400","onUpdate:modelValue":t[8]||(t[8]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=a)})},null,8,["options","modelValue"])]),r("div",null,[t[154]||(t[154]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),$t(Tt,{options:e.fontStyleOptions,modelValue:((Le=e.selectedEl.style)==null?void 0:Le.fontStyle)||"normal","onUpdate:modelValue":t[9]||(t[9]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=a)})},null,8,["options","modelValue"])])]),r("div",Ts,[r("div",null,[t[155]||(t[155]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:(pt=(Ae=e.selectedEl.style)==null?void 0:Ae.letterSpacing)!=null?pt:0,onInput:t[10]||(t[10]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(a.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ds)]),r("div",null,[t[156]||(t[156]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:(bt=(gt=e.selectedEl.style)==null?void 0:gt.lineHeight)!=null?bt:1.5,onInput:t[11]||(t[11]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(a.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Us)])]),r("div",Ls,[t[157]||(t[157]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",Rs,[r("input",{value:((_t=(Ct=e.selectedEl)==null?void 0:Ct.style)==null?void 0:_t.color)||e.config.globalColor,onInput:t[12]||(t[12]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Vs),r("input",{value:(oe=(s=(qt=e.selectedEl)==null?void 0:qt.style)==null?void 0:s.color)!=null?oe:e.config.globalColor,onInput:t[13]||(t[13]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,40,Ps)])]),r("div",Ws,[t[158]||(t[158]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对齐方式",-1)),r("div",Hs,[r("button",{onClick:t[14]||(t[14]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((be=e.selectedEl.style)==null?void 0:be.textAlign)||"center")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左",2),r("button",{onClick:t[15]||(t[15]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Ne=e.selectedEl.style)==null?void 0:Ne.textAlign)||"center")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"中",2),r("button",{onClick:t[16]||(t[16]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ke=e.selectedEl.style)==null?void 0:ke.textAlign)||"center")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右",2)])]),r("div",Js,[t[164]||(t[164]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆弧参数",-1)),r("div",_s,[r("div",null,[t[159]||(t[159]=r("label",{class:"block text-xs text-gray-400 mb-1"},"半径(px)",-1)),r("input",{value:(xt=(wt=(X=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:X.arcText)==null?void 0:wt.radius)!=null?xt:Math.min(e.selectedEl.width||0,e.selectedEl.height||0)/2,onInput:t[17]||(t[17]=a=>{if(e.selectedEl){const O=Number(a.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.radius=O}}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,qs)]),r("div",null,[t[160]||(t[160]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始角(°)",-1)),r("input",{value:(rt=(Yt=(Ut=(It=e.selectedEl)==null?void 0:It.style)==null?void 0:Ut.arcText)==null?void 0:Yt.startAngle)!=null?rt:0,onInput:t[18]||(t[18]=a=>{if(e.selectedEl){const O=Number(a.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=O}}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ys)]),r("div",null,[t[161]||(t[161]=r("label",{class:"block text-xs text-gray-400 mb-1"},"扫过角(°)",-1)),r("input",{value:(Ot=(Qt=(At=(nt=e.selectedEl)==null?void 0:nt.style)==null?void 0:At.arcText)==null?void 0:Qt.sweepAngle)!=null?Ot:180,onInput:t[19]||(t[19]=a=>{if(e.selectedEl){const O=Number(a.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.sweepAngle=O}}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Xs)]),r("div",null,[t[163]||(t[163]=r("label",{class:"block text-xs text-gray-400 mb-1"},"顺时针",-1)),r("select",{value:(nr=(er=(at=(Vt=e.selectedEl)==null?void 0:Vt.style)==null?void 0:at.arcText)==null?void 0:er.clockwise)==null||nr?"1":"0",onChange:t[20]||(t[20]=a=>{if(e.selectedEl){const O=a.target.value==="1";e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.clockwise=O}}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[162]||(t[162]=[r("option",{value:"1"},"是",-1),r("option",{value:"0"},"否",-1)])],40,Ks)])]),r("div",Zs,[r("button",{onClick:t[21]||(t[21]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=180,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"上"),r("button",{onClick:t[22]||(t[22]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=0,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下"),r("button",{onClick:t[23]||(t[23]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=90,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左"),r("button",{onClick:t[24]||(t[24]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=270,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右")])])])):K("",!0),r("div",Qs,[t[172]||(t[172]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"事件绑定",-1)),r("div",ea,[t[167]||(t[167]=r("label",{class:"text-xs text-gray-400"},"开启事件绑定",-1)),r("label",ta,[me(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":t[25]||(t[25]=a=>De.value=a)},null,512),[[rn,De.value]]),t[166]||(t[166]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ge(["ml-3 text-xs",De.value?"text-cyan-300":"text-gray-300"])},mt(De.value?"已开启":"已关闭"),3)])]),De.value?(z(),B("div",ra,[r("div",null,[t[169]||(t[169]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Cursor",-1)),me(r("select",{"onUpdate:modelValue":t[26]||(t[26]=a=>ot.value=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[168]||(t[168]=[tn('<option value="pointer" data-v-4b22c81b>pointer</option><option value="default" data-v-4b22c81b>default</option><option value="move" data-v-4b22c81b>move</option><option value="crosshair" data-v-4b22c81b>crosshair</option><option value="grab" data-v-4b22c81b>grab</option>',5)])],512),[[Rl,ot.value]])]),r("div",null,[t[170]||(t[170]=r("label",{class:"block text-xs text-gray-400 mb-1"},"函数名",-1)),me(r("input",{"onUpdate:modelValue":t[27]||(t[27]=a=>Y.value=a),type:"text",placeholder:"handleClick",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[Ce,Y.value]])])])):K("",!0),De.value?(z(),B("div",na,[t[171]||(t[171]=r("label",{class:"block text-xs text-gray-400 mb-1"},"事件代码",-1)),me(r("textarea",{"onUpdate:modelValue":t[28]||(t[28]=a=>Ue.value=a),rows:"6",placeholder:"function body...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[Ce,Ue.value]])])):K("",!0)]),r("div",la,[t[182]||(t[182]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"元素属性",-1)),r("div",oa,[r("div",sa,[t[173]||(t[173]=r("label",{class:"text-xs text-gray-400"},"启用 Class 样式",-1)),me(r("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=a=>e.selectedEl.enableClassStyle=a),onChange:t[30]||(t[30]=a=>{e.selectedEl&&a.target.checked?(e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss()):e.selectedEl&&!a.target.checked&&e.removeCustomClassCssForElement(e.selectedEl.id)}),class:"rounded border-purple-500/30 text-purple-400 focus:ring-purple-400"},null,544),[[rn,e.selectedEl.enableClassStyle]])]),(lr=e.selectedEl)!=null&&lr.enableClassStyle?(z(),B("div",aa,[t[174]||(t[174]=r("label",{class:"block text-xs text-gray-400 mb-1"},"CSS Class",-1)),r("div",ia,[me(r("input",{"onUpdate:modelValue":t[31]||(t[31]=a=>e.selectedEl.className=a),type:"text",placeholder:"自动生成唯一类名，可修改",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.className]]),r("button",{type:"button",onClick:t[32]||(t[32]=()=>{e.selectedEl&&(e.selectedEl.className=`cls-${String(e.selectedEl.id).slice(0,8)}`,e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss())}),class:"px-2 py-1 text-xs bg-purple-600/60 hover:bg-purple-600 rounded text-white"},"生成默认")])])):K("",!0),(Pt=e.selectedEl)!=null&&Pt.enableClassStyle?(z(),B("div",da,[t[175]||(t[175]=r("label",{class:"block text-xs text-gray-400 mb-1"},"自定义样式（CSS 声明）",-1)),$t($s,{modelValue:String((Wt=e.selectedEl.customClassCss)!=null?Wt:""),"onUpdate:modelValue":t[33]||(t[33]=a=>{e.selectedEl.customClassCss=a,e.refreshAllCustomClassCss()}),height:"180px"},null,8,["modelValue"]),t[176]||(t[176]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"提示：已为当前类名生成 .className { } 模板；也可直接填写声明，系统会自动包裹并追加 !important。",-1))])):K("",!0),e.selectedEl&&(e.selectedEl.type==="chart"||e.selectedEl.type==="container")?(z(),B("div",ua,[t[177]||(t[177]=r("label",{class:"block text-xs text-gray-400 mb-1"},"元素ID",-1)),me(r("input",{"onUpdate:modelValue":t[34]||(t[34]=a=>e.selectedEl.elementId=a),type:"text",placeholder:"输入元素ID",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.elementId]])])):K("",!0),e.selectedEl?(z(),B("div",ca,[t[181]||(t[181]=r("h3",{class:"text-sm font-medium text-purple-300"},"显示与隐藏",-1)),r("div",pa,[t[179]||(t[179]=r("label",{class:"text-xs text-gray-400"},"隐藏该元素",-1)),r("label",ga,[r("input",{type:"checkbox",class:"sr-only peer",checked:!!e.selectedEl.hidden,onChange:t[35]||(t[35]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.hidden=O,O&&!e.selectedEl.hiddenLabel&&(e.selectedEl.hiddenLabel=`hidden-${String(e.selectedEl.id).slice(0,8)}`))})},null,40,fa),t[178]||(t[178]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-purple-600 peer-checked:to-pink-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ge(["ml-3 text-xs",e.selectedEl.hidden?"text-purple-300":"text-gray-300"])},mt(e.selectedEl.hidden?"已隐藏":"显示中"),3)])]),e.selectedEl.hidden?(z(),B("div",ya,[t[180]||(t[180]=r("label",{class:"block text-xs text-gray-400"},"隐藏标识",-1)),r("input",{type:"text",value:e.selectedEl.hiddenLabel||"",onInput:t[36]||(t[36]=a=>{e.selectedEl&&(e.selectedEl.hiddenLabel=a.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1",placeholder:"hidden-xxxx"},null,40,ma)])):K("",!0)])):K("",!0)])]),e.selectedEl&&e.selectedEl.type==="container"?(z(),B("div",ba,[t[204]||(t[204]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器样式",-1)),r("div",null,[t[183]||(t[183]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色（HEX）",-1)),r("div",xa,[r("input",{type:"color",value:((or=(Ft=e.selectedEl)==null?void 0:Ft.style)==null?void 0:or.backgroundColor)||"#000000",onInput:t[37]||(t[37]=a=>{const O=a.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=O)}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,ha),r("input",{type:"text",value:((pe=(Ze=e.selectedEl)==null?void 0:Ze.style)==null?void 0:pe.backgroundColor)||"",placeholder:"#1e293b 或 transparent",onInput:t[38]||(t[38]=a=>{const O=a.target.value.trim();e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=O)}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,va)]),t[184]||(t[184]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"支持 #RGB/#RRGGBB 或 CSS 颜色名；启用渐变时该颜色被覆盖。",-1))]),r("div",null,[t[185]||(t[185]=r("label",{class:"block text-xs text-gray-400 mb-1"},"容器注释（导出可见）",-1)),me(r("textarea",{"onUpdate:modelValue":t[39]||(t[39]=a=>e.selectedEl.comment=a),rows:"2",placeholder:"输入注释，方便代码维护...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.comment]])]),r("div",$a,[r("div",wa,[t[187]||(t[187]=r("label",{class:"block text-xs text-gray-400 mb-1"},"渐变背景",-1)),r("label",Ea,[r("input",{type:"checkbox",checked:!!((Te=(Pe=e.selectedEl)==null?void 0:Pe.style)!=null&&Te.backgroundGradient),onChange:t[40]||(t[40]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},O?e.selectedEl.style.backgroundGradient||(e.selectedEl.style.backgroundGradient={colors:["#42b883","#0ea5e9"],angle:90}):delete e.selectedEl.style.backgroundGradient)})},null,40,ka),t[186]||(t[186]=Br(" 启用 ",-1))])]),(Qe=(ft=e.selectedEl)==null?void 0:ft.style)!=null&&Qe.backgroundGradient?(z(),B("div",Sa,[r("div",null,[t[188]||(t[188]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"起始色（HEX）",-1)),r("div",Ma,[r("input",{type:"color",value:((Fe=(Ve=(lt=(Re=e.selectedEl)==null?void 0:Re.style)==null?void 0:lt.backgroundGradient)==null?void 0:Ve.colors)==null?void 0:Fe[0])||"#42b883",onInput:t[41]||(t[41]=a=>{var we;const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const A=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};A.colors=(we=A.colors)!=null&&we.length?A.colors:["","#"],A.colors[0]=O,e.selectedEl.style.backgroundGradient=A}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,Ca),r("input",{type:"text",value:((Et=(it=(st=(Bt=e.selectedEl)==null?void 0:Bt.style)==null?void 0:st.backgroundGradient)==null?void 0:it.colors)==null?void 0:Et[0])||"",placeholder:"#42b883",onInput:t[42]||(t[42]=a=>{var we;const O=a.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const A=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};A.colors=(we=A.colors)!=null&&we.length?A.colors:["","#"],A.colors[0]=O,e.selectedEl.style.backgroundGradient=A}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Na)])]),r("div",null,[t[189]||(t[189]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"结束色（HEX）",-1)),r("div",Ia,[r("input",{type:"color",value:((Xt=(Nt=(et=(tt=e.selectedEl)==null?void 0:tt.style)==null?void 0:et.backgroundGradient)==null?void 0:Nt.colors)==null?void 0:Xt[1])||"#0ea5e9",onInput:t[43]||(t[43]=a=>{var we;const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const A=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};A.colors=(we=A.colors)!=null&&we.length?A.colors:["","#"],A.colors[1]=O,e.selectedEl.style.backgroundGradient=A}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,Aa),r("input",{type:"text",value:((Rt=(Gt=(sr=(Lt=e.selectedEl)==null?void 0:Lt.style)==null?void 0:sr.backgroundGradient)==null?void 0:Gt.colors)==null?void 0:Rt[1])||"",placeholder:"#0ea5e9",onInput:t[44]||(t[44]=a=>{var we;const O=a.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const A=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};A.colors=(we=A.colors)!=null&&we.length?A.colors:["","#"],A.colors[1]=O,e.selectedEl.style.backgroundGradient=A}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Fa)])]),r("div",ja,[t[190]||(t[190]=r("label",{class:"block text-[11px] text-gray-400"},"角度（0-360）",-1)),r("input",{type:"range",min:"0",max:"360",step:"1",value:(Gr=(vr=(ar=(hr=e.selectedEl)==null?void 0:hr.style)==null?void 0:ar.backgroundGradient)==null?void 0:vr.angle)!=null?Gr:90,onInput:t[45]||(t[45]=a=>{const O=Number(a.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const A=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};A.angle=O,e.selectedEl.style.backgroundGradient=A}),class:"w-full"},null,40,za),r("input",{type:"number",value:(tr=(dt=(Dr=(Tr=e.selectedEl)==null?void 0:Tr.style)==null?void 0:Dr.backgroundGradient)==null?void 0:dt.angle)!=null?tr:90,onInput:t[46]||(t[46]=a=>{const O=Number(a.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const A=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};A.angle=O,e.selectedEl.style.backgroundGradient=A}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Oa)])])):K("",!0),t[191]||(t[191]=r("p",{class:"text-[11px] text-gray-500"},"提示：仅在启用后显示渐变设置；未启用时使用背景色。",-1))]),r("div",Ba,[r("div",Ga,[t[193]||(t[193]=r("label",{class:"block text-xs text-gray-400"},"圆角",-1)),r("label",Ta,[r("input",{type:"checkbox",checked:!!((Lr=(Ur=e.selectedEl)==null?void 0:Ur.style)!=null&&Lr.borderRadius)&&ie((wr=($r=e.selectedEl)==null?void 0:$r.style)==null?void 0:wr.borderRadius)>0,onChange:t[47]||(t[47]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},O?e.selectedEl.style.borderRadius||(e.selectedEl.style.borderRadius="8px"):e.selectedEl.style.borderRadius="0")})},null,40,Da),t[192]||(t[192]=Br(" 启用 ",-1))])]),(Rr=(Er=e.selectedEl)==null?void 0:Er.style)!=null&&Rr.borderRadius&&ie((cr=(ir=e.selectedEl)==null?void 0:ir.style)==null?void 0:cr.borderRadius)>=0?(z(),B("div",Ua,[r("div",La,[t[194]||(t[194]=r("span",{class:"text-[11px] text-gray-400"},"单位",-1)),r("button",{type:"button",class:Ge(["px-2 py-0.5 rounded text-[11px]",N((gr=(pr=e.selectedEl)==null?void 0:pr.style)==null?void 0:gr.borderRadius)==="px"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[48]||(t[48]=()=>{var O,A;const a=ie((A=(O=e.selectedEl)==null?void 0:O.style)==null?void 0:A.borderRadius);$e(a,"px")})},"px",2),r("button",{type:"button",class:Ge(["px-2 py-0.5 rounded text-[11px]",N((Sr=(kr=e.selectedEl)==null?void 0:kr.style)==null?void 0:Sr.borderRadius)==="%"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[49]||(t[49]=()=>{var O,A;const a=ie((A=(O=e.selectedEl)==null?void 0:O.style)==null?void 0:A.borderRadius);$e(a,"%")})},"%",2)]),N((Mr=(Vr=e.selectedEl)==null?void 0:Vr.style)==null?void 0:Mr.borderRadius)==="px"?(z(),B("div",Ra,[r("input",{type:"range",min:"0",max:"64",step:"1",value:ie((kt=(Ht=e.selectedEl)==null?void 0:Ht.style)==null?void 0:kt.borderRadius),onInput:t[50]||(t[50]=a=>{const O=Number(a.target.value)||0;$e(O,"px")}),class:"w-full"},null,40,Va),r("input",{type:"number",value:ie((Wr=(Pr=e.selectedEl)==null?void 0:Pr.style)==null?void 0:Wr.borderRadius),onInput:t[51]||(t[51]=a=>{const O=Number(a.target.value)||0;$e(O,"px")}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Pa)])):(z(),B("div",Wa,[r("input",{type:"range",min:"0",max:"100",step:"1",value:ie((Jr=(Hr=e.selectedEl)==null?void 0:Hr.style)==null?void 0:Jr.borderRadius),onInput:t[52]||(t[52]=a=>{const O=Number(a.target.value)||0;$e(O,"%")}),class:"w-full"},null,40,Ha),r("div",Ja,[r("input",{type:"number",value:ie((qr=(_r=e.selectedEl)==null?void 0:_r.style)==null?void 0:qr.borderRadius),onInput:t[53]||(t[53]=a=>{const O=Number(a.target.value)||0;$e(O,"%")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,_a),t[195]||(t[195]=r("span",{class:"text-xs text-gray-400"},"%",-1))])]))])):K("",!0)]),r("div",qa,[r("div",Ya,[t[197]||(t[197]=r("label",{class:"block text-xs text-gray-400"},"阴影（box-shadow）",-1)),r("label",Xa,[r("input",{type:"checkbox",checked:!!((fr=(Cr=e.selectedEl)==null?void 0:Cr.style)!=null&&fr.boxShadow),onChange:t[54]||(t[54]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},O?e.selectedEl.style.boxShadow||(e.selectedEl.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)"):delete e.selectedEl.style.boxShadow)})},null,40,Ka),t[196]||(t[196]=Br(" 启用 ",-1))])]),(Nr=(yr=e.selectedEl)==null?void 0:yr.style)!=null&&Nr.boxShadow?(z(),B("div",Za,[r("input",{type:"text",value:((br=(mr=e.selectedEl)==null?void 0:mr.style)==null?void 0:br.boxShadow)||"",placeholder:"例如: 0 8px 24px rgba(0,0,0,0.25)",onInput:t[55]||(t[55]=a=>{const O=a.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.boxShadow=O)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Qa),r("div",ei,[t[198]||(t[198]=r("label",{class:"block text-[11px] text-gray-400"},"X 偏移",-1)),r("div",ti,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:ne((dr=(Yr=e.selectedEl)==null?void 0:Yr.style)==null?void 0:dr.boxShadow).x,onInput:t[56]||(t[56]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe(O!=null?O:0,(Je=A.y)!=null?Je:0,(_e=A.blur)!=null?_e:0,(qe=A.spread)!=null?qe:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"flex-1"},null,40,ri),r("input",{type:"number",value:ne((Xr=(Ir=e.selectedEl)==null?void 0:Ir.style)==null?void 0:Xr.boxShadow).x,onInput:t[57]||(t[57]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe(O!=null?O:0,(Je=A.y)!=null?Je:0,(_e=A.blur)!=null?_e:0,(qe=A.spread)!=null?qe:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ni)])]),r("div",li,[t[199]||(t[199]=r("label",{class:"block text-[11px] text-gray-400"},"Y 偏移",-1)),r("div",oi,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:ne((Fr=(Ar=e.selectedEl)==null?void 0:Ar.style)==null?void 0:Fr.boxShadow).y,onInput:t[58]||(t[58]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,O!=null?O:0,(_e=A.blur)!=null?_e:0,(qe=A.spread)!=null?qe:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"flex-1"},null,40,si),r("input",{type:"number",value:ne((jr=(Kr=e.selectedEl)==null?void 0:Kr.style)==null?void 0:jr.boxShadow).y,onInput:t[59]||(t[59]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,O!=null?O:0,(_e=A.blur)!=null?_e:0,(qe=A.spread)!=null?qe:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ai)])]),r("div",ii,[t[200]||(t[200]=r("label",{class:"block text-[11px] text-gray-400"},"模糊",-1)),r("div",di,[r("input",{type:"range",min:"0",max:"128",step:"1",value:ne((o=(l=e.selectedEl)==null?void 0:l.style)==null?void 0:o.boxShadow).blur,onInput:t[60]||(t[60]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,(_e=A.y)!=null?_e:0,O!=null?O:0,(qe=A.spread)!=null?qe:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"flex-1"},null,40,ui),r("input",{type:"number",value:ne((c=(i=e.selectedEl)==null?void 0:i.style)==null?void 0:c.boxShadow).blur,onInput:t[61]||(t[61]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,(_e=A.y)!=null?_e:0,O!=null?O:0,(qe=A.spread)!=null?qe:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ci)])]),r("div",pi,[t[201]||(t[201]=r("label",{class:"block text-[11px] text-gray-400"},"扩散",-1)),r("div",gi,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:ne((p=(m=e.selectedEl)==null?void 0:m.style)==null?void 0:p.boxShadow).spread,onInput:t[62]||(t[62]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,(_e=A.y)!=null?_e:0,(qe=A.blur)!=null?qe:0,O!=null?O:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"flex-1"},null,40,fi),r("input",{type:"number",value:ne((k=(M=e.selectedEl)==null?void 0:M.style)==null?void 0:k.boxShadow).spread,onInput:t[63]||(t[63]=a=>{var we,He,Je,_e,qe,Ye;const O=Number(a.target.value)||0,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,(_e=A.y)!=null?_e:0,(qe=A.blur)!=null?qe:0,O!=null?O:0,(Ye=A.color)!=null?Ye:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,yi)])])])):K("",!0),r("div",mi,[t[202]||(t[202]=r("label",{class:"block text-[11px] text-gray-400"},"阴影颜色",-1)),(I=(C=e.selectedEl)==null?void 0:C.style)!=null&&I.boxShadow?(z(),B("div",bi,[r("input",{type:"color",value:ne((u=(d=e.selectedEl)==null?void 0:d.style)==null?void 0:u.boxShadow).color||"#000000",onInput:t[64]||(t[64]=a=>{var we,He,Je,_e,qe,Ye;const O=a.target.value,A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,(_e=A.y)!=null?_e:0,(qe=A.blur)!=null?qe:0,(Ye=A.spread)!=null?Ye:0,O||"#000000")}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,xi),r("input",{type:"text",value:ne((H=(G=e.selectedEl)==null?void 0:G.style)==null?void 0:H.boxShadow).color||"",placeholder:"#000000 或 rgba(...)",onInput:t[65]||(t[65]=a=>{var we,He,Je,_e,qe,Ye;const O=a.target.value.trim(),A=ne((He=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:He.boxShadow);fe((Je=A.x)!=null?Je:0,(_e=A.y)!=null?_e:0,(qe=A.blur)!=null?qe:0,(Ye=A.spread)!=null?Ye:0,O||"#000000")}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,hi)])):K("",!0)]),t[203]||(t[203]=r("p",{class:"text-[11px] text-gray-500"},"支持滑动或数字输入；颜色可选色块与 HEX 文本。",-1))])])):K("",!0),e.selectedEl&&e.selectedEl.type==="chart"?(z(),B("div",vi,[t[219]||(t[219]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"图表配置",-1)),r("div",$i,[r("button",{onClick:t[66]||(t[66]=a=>$.value="visual"),class:Ge(["px-3 py-1 rounded text-sm",$.value==="visual"?"bg-purple-600/60":"bg-gray-700"])},"可视化",2),r("button",{onClick:t[67]||(t[67]=a=>$.value="json"),class:Ge(["px-3 py-1 rounded text-sm",$.value==="json"?"bg-purple-600/60":"bg-gray-700"])},"JSON",2)]),$.value==="visual"?(z(),B("div",wi,[r("div",null,[t[205]||(t[205]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图表类型",-1)),$t(Tt,{options:["line","bar","pie","mix"],modelValue:e.selectedEl.chartType||"line","onUpdate:modelValue":t[68]||(t[68]=a=>{e.selectedEl&&(e.selectedEl.chartType=a,e.selectedEl.chartOption=e.defaultChartOption(a),S.value=JSON.stringify(e.selectedEl.chartOption,null,2))})},null,8,["modelValue"])]),r("div",null,[t[206]||(t[206]=r("label",{class:"block text-xs text-gray-400 mb-1"},"标题",-1)),r("input",{value:((ae=(ge=(de=e.selectedEl)==null?void 0:de.chartOption)==null?void 0:ge.title)==null?void 0:ae.text)||"",onInput:t[69]||(t[69]=a=>V(a.target.value)),type:"text",placeholder:"输入图表标题",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ei)]),r("div",ki,[r("div",null,[t[207]||(t[207]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色列表（逗号分隔）",-1)),r("input",{value:((ee=(xe=(he=e.selectedEl)==null?void 0:he.chartOption)==null?void 0:xe.color)==null?void 0:ee.join(","))||"",onInput:t[70]||(t[70]=a=>U(a.target.value)),type:"text",placeholder:"#42b883,#ff9800",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Si)]),r("div",null,[t[209]||(t[209]=r("label",{class:"block text-xs text-gray-400 mb-1"},"显示图例",-1)),r("select",{value:(Oe=(re=(J=(te=e.selectedEl)==null?void 0:te.chartOption)==null?void 0:J.legend)==null?void 0:re.show)==null||Oe?"1":"0",onChange:t[71]||(t[71]=a=>q(a.target.value)),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[208]||(t[208]=[r("option",{value:"1"},"显示",-1),r("option",{value:"0"},"隐藏",-1)])],40,Mi)])]),e.selectedEl&&e.selectedEl.chartType!=="pie"?(z(),B("div",Ci,[r("div",null,[t[210]||(t[210]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最小值",-1)),r("input",{value:Array.isArray((h=(b=e.selectedEl)==null?void 0:b.chartOption)==null?void 0:h.yAxis)?(x=(_=(D=(j=(R=e.selectedEl)==null?void 0:R.chartOption)==null?void 0:j.yAxis)==null?void 0:D[0])==null?void 0:_.min)!=null?x:"":(je=(ce=(E=(W=e.selectedEl)==null?void 0:W.chartOption)==null?void 0:E.yAxis)==null?void 0:ce.min)!=null?je:"",onInput:t[72]||(t[72]=a=>{const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const A=e.selectedEl.chartOption.yAxis,we=O===""?null:Number(O);Array.isArray(A)?(A[0]=A[0]||{},A[0].min=we):(e.selectedEl.chartOption.yAxis=A||{},e.selectedEl.chartOption.yAxis.min=we),S.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ni)]),r("div",null,[t[211]||(t[211]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最大值",-1)),r("input",{value:Array.isArray((Ie=(ve=e.selectedEl)==null?void 0:ve.chartOption)==null?void 0:Ie.yAxis)?(St=(yt=(ht=(We=(Be=e.selectedEl)==null?void 0:Be.chartOption)==null?void 0:We.yAxis)==null?void 0:ht[0])==null?void 0:yt.max)!=null?St:"":(Jt=(vt=(jt=(ut=e.selectedEl)==null?void 0:ut.chartOption)==null?void 0:jt.yAxis)==null?void 0:vt.max)!=null?Jt:"",onInput:t[73]||(t[73]=a=>{const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const A=e.selectedEl.chartOption.yAxis,we=O===""?null:Number(O);Array.isArray(A)?(A[0]=A[0]||{},A[0].max=we):(e.selectedEl.chartOption.yAxis=A||{},e.selectedEl.chartOption.yAxis.max=we),S.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ii)])])):K("",!0),e.selectedEl&&(e.selectedEl.chartType==="line"||e.selectedEl.chartType==="mix")?(z(),B("div",Ai,[r("div",null,[t[213]||(t[213]=r("label",{class:"block text-xs text-gray-400 mb-1"},"折线平滑",-1)),r("select",{value:"1",onChange:t[74]||(t[74]=a=>{const O=a.target.value==="1";e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(A=>{A.type==="line"&&(A.smooth=O)}),S.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[212]||(t[212]=[r("option",{value:"1"},"平滑",-1),r("option",{value:"0"},"不平滑",-1)])],32)]),r("div",null,[t[214]||(t[214]=r("label",{class:"block text-xs text-gray-400 mb-1"},"线宽",-1)),r("input",{value:2,onInput:t[75]||(t[75]=a=>{const O=Number(a.target.value)||2;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(A=>{A.type==="line"&&(A.lineStyle=A.lineStyle||{},A.lineStyle.width=O)}),S.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):K("",!0),e.selectedEl&&(e.selectedEl.chartType==="bar"||e.selectedEl.chartType==="mix")?(z(),B("div",Fi,[r("div",null,[t[215]||(t[215]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变起始色",-1)),r("input",{type:"color",value:"#42b883",onInput:t[76]||(t[76]=a=>{const O=a.target.value;v(O,"#0ea5e9")}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[216]||(t[216]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变结束色",-1)),r("input",{type:"color",value:"#0ea5e9",onInput:t[77]||(t[77]=a=>{const O=a.target.value;v("#42b883",O)}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[217]||(t[217]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),r("input",{value:4,onInput:t[78]||(t[78]=a=>{const O=Number(a.target.value)||0;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(A=>{A.type==="bar"&&(A.itemStyle=A.itemStyle||{},A.itemStyle.borderRadius=[O,O,0,0])}),S.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):K("",!0)])):(z(),B("div",ji,[t[218]||(t[218]=r("label",{class:"block text-xs text-gray-400 mb-1"},"ECharts Option JSON",-1)),me(r("textarea",{"onUpdate:modelValue":t[79]||(t[79]=a=>S.value=a),rows:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs font-mono"},null,512),[[Ce,S.value]]),r("div",zi,[r("button",{onClick:t[80]||(t[80]=a=>f()),class:"px-3 py-1 bg-emerald-600 rounded text-sm"},"应用配置"),P.value?(z(),B("div",Oi,mt(P.value),1)):K("",!0)])]))])):K("",!0),e.selectedEl&&e.selectedEl.type==="line"?(z(),B("div",Bi,[t[227]||(t[227]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"线条设置",-1)),r("div",Gi,[t[220]||(t[220]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",Ti,[r("input",{value:e.safeHex(((Zr=(xr=e.selectedEl)==null?void 0:xr.style)==null?void 0:Zr.lineColor)||""),onInput:t[81]||(t[81]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Di),r("input",{value:(gn=(pn=(cn=e.selectedEl)==null?void 0:cn.style)==null?void 0:pn.lineColor)!=null?gn:"#ffffff",onInput:t[82]||(t[82]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,40,Ui)])]),r("div",Li,[r("div",null,[t[221]||(t[221]=r("label",{class:"block text-xs text-gray-400 mb-1"},"方向",-1)),r("div",Ri,[r("button",{onClick:t[83]||(t[83]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="horizontal")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((yn=(fn=e.selectedEl)==null?void 0:fn.style)==null?void 0:yn.lineOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[84]||(t[84]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="vertical")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((bn=(mn=e.selectedEl)==null?void 0:mn.style)==null?void 0:bn.lineOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)])]),r("div",null,[t[222]||(t[222]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细(px)",-1)),r("input",{value:(vn=(hn=(xn=e.selectedEl)==null?void 0:xn.style)==null?void 0:hn.lineThickness)!=null?vn:2,onInput:t[85]||(t[85]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineThickness=Number(a.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Vi)])]),r("div",Pi,[r("div",null,[t[224]||(t[224]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),r("select",{value:((wn=($n=e.selectedEl)==null?void 0:$n.style)==null?void 0:wn.lineStyle)||"solid",onChange:t[86]||(t[86]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineStyle=a.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[223]||(t[223]=[r("option",{value:"solid"},"实线",-1),r("option",{value:"dashed"},"虚线",-1)])],40,Wi)]),((kn=(En=e.selectedEl)==null?void 0:En.style)==null?void 0:kn.lineStyle)==="dashed"?(z(),B("div",Hi,[t[225]||(t[225]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线长度(px)",-1)),r("input",{value:(Cn=(Mn=(Sn=e.selectedEl)==null?void 0:Sn.style)==null?void 0:Mn.lineDashLength)!=null?Cn:6,onInput:t[87]||(t[87]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashLength=Number(a.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ji)])):K("",!0)]),((In=(Nn=e.selectedEl)==null?void 0:Nn.style)==null?void 0:In.lineStyle)==="dashed"?(z(),B("div",_i,[r("div",null,[t[226]||(t[226]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线间距(px)",-1)),r("input",{value:(jn=(Fn=(An=e.selectedEl)==null?void 0:An.style)==null?void 0:Fn.lineDashGap)!=null?jn:4,onInput:t[88]||(t[88]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashGap=Number(a.target.value))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,qi)])])):K("",!0)])):K("",!0),e.selectedEl&&e.selectedEl.type==="text"?(z(),B("div",Yi,[t[261]||(t[261]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"文本设置",-1)),r("div",Xi,[t[232]||(t[232]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),me(r("textarea",{"onUpdate:modelValue":t[89]||(t[89]=a=>e.selectedEl.text=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[Ce,e.selectedEl.text]]),r("div",Ki,[t[231]||(t[231]=r("label",{class:"block text-xs text-gray-400 mb-1"},"动态值",-1)),r("div",Zi,[r("input",{type:"checkbox",checked:!!((On=(zn=e.selectedEl)==null?void 0:zn.dynamic)!=null&&On.enabled),onChange:t[90]||(t[90]=a=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!1,objectName:"",propertyPath:""},e.selectedEl.dynamic.enabled=a.target.checked)}),class:"rounded accent-purple-600"},null,40,Qi),t[228]||(t[228]=r("span",{class:"text-xs text-gray-400"},"启用后从数据库对象绑定",-1))]),(Gn=(Bn=e.selectedEl)==null?void 0:Bn.dynamic)!=null&&Gn.enabled?(z(),B("div",ed,[r("div",null,[t[229]||(t[229]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择对象",-1)),$t(Tt,{options:e.databaseObjects.map(a=>a.name),modelValue:((Dn=(Tn=e.selectedEl)==null?void 0:Tn.dynamic)==null?void 0:Dn.objectName)||"","onUpdate:modelValue":t[91]||(t[91]=a=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.objectName=String(a||""))})},null,8,["options","modelValue"])]),r("div",null,[t[230]||(t[230]=r("label",{class:"block text-xs text-gray-400 mb-1"},"属性路径",-1)),$t(Tt,{options:le.value,modelValue:((Ln=(Un=e.selectedEl)==null?void 0:Un.dynamic)==null?void 0:Ln.propertyPath)||"","onUpdate:modelValue":t[92]||(t[92]=a=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.propertyPath=String(a||""))})},null,8,["options","modelValue"])]),r("div",td,"预览值: "+mt(Se(e.selectedEl)),1)])):K("",!0)])]),r("div",rd,[t[233]||(t[233]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",nd,[r("button",{onClick:t[93]||(t[93]=()=>{const a=e.selectedEl;!a||a.type!=="text"||(a.autoSize=!0)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize!==!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"自适应",2),r("button",{onClick:t[94]||(t[94]=()=>{const a=e.selectedEl;!a||a.type!=="text"||(a.autoSize=!1)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize===!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"固定尺寸",2)])]),r("div",ld,[r("div",null,[t[234]||(t[234]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),$t(Tt,{options:e.fontSizeLibrary,modelValue:((Rn=e.selectedEl.style)==null?void 0:Rn.fontSize)||14,"onUpdate:modelValue":t[95]||(t[95]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=a)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[t[235]||(t[235]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),$t(Tt,{options:e.fontLibrary,modelValue:((Vn=e.selectedEl.style)==null?void 0:Vn.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[96]||(t[96]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=a)})},null,8,["options","modelValue"])])]),r("div",od,[r("div",null,[t[236]||(t[236]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),$t(Tt,{options:e.fontWeightOptions,modelValue:((Pn=e.selectedEl.style)==null?void 0:Pn.fontWeight)||"400","onUpdate:modelValue":t[97]||(t[97]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=a)})},null,8,["options","modelValue"])]),r("div",null,[t[237]||(t[237]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),$t(Tt,{options:e.fontStyleOptions,modelValue:((Wn=e.selectedEl.style)==null?void 0:Wn.fontStyle)||"normal","onUpdate:modelValue":t[98]||(t[98]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=a)})},null,8,["options","modelValue"])])]),r("div",sd,[r("div",null,[t[238]||(t[238]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:((Hn=e.selectedEl.style)==null?void 0:Hn.letterSpacing)||0,onInput:t[99]||(t[99]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(a.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,ad)]),r("div",null,[t[239]||(t[239]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:((Jn=e.selectedEl.style)==null?void 0:Jn.lineHeight)||1.5,onInput:t[100]||(t[100]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(a.target.value))}),type:"number",step:"0.1",min:"0.5",max:"3",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,id)])]),r("div",dd,[t[240]||(t[240]=r("label",{class:"block text-xs text-gray-400 mb-1"},"缩进",-1)),r("input",{value:((_n=e.selectedEl.style)==null?void 0:_n.textIndent)||"",onInput:t[101]||(t[101]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textIndent=a.target.value)}),type:"text",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"例如: 2em 或 24px"},null,40,ud)]),r("div",cd,[t[241]||(t[241]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",pd,[r("input",{value:(Yn=(qn=e.selectedEl)==null?void 0:qn.style)!=null&&Yn.textGradient?"#000000":((Kn=(Xn=e.selectedEl)==null?void 0:Xn.style)==null?void 0:Kn.color)||e.config.globalColor,onInput:t[102]||(t[102]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"color",disabled:!!((Qn=(Zn=e.selectedEl)==null?void 0:Zn.style)!=null&&Qn.textGradient),class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"},null,40,gd),r("input",{value:(tl=(el=e.selectedEl)==null?void 0:el.style)!=null&&tl.textGradient?"transparent":(ll=(nl=(rl=e.selectedEl)==null?void 0:rl.style)==null?void 0:nl.color)!=null?ll:e.config.globalColor,onInput:t[103]||(t[103]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"text",disabled:!!((sl=(ol=e.selectedEl)==null?void 0:ol.style)!=null&&sl.textGradient),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"#000000"},null,40,fd)]),(il=(al=e.selectedEl)==null?void 0:al.style)!=null&&il.textGradient?(z(),B("div",yd,"文字渐变启用时，文字颜色自动设为透明")):K("",!0)]),r("div",md,[t[242]||(t[242]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色",-1)),r("div",bd,[r("input",{value:e.safeHex(((ul=(dl=e.selectedEl)==null?void 0:dl.style)==null?void 0:ul.backgroundColor)||""),onInput:t[104]||(t[104]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,xd),r("input",{value:(gl=(pl=(cl=e.selectedEl)==null?void 0:cl.style)==null?void 0:pl.backgroundColor)!=null?gl:"transparent",onInput:t[105]||(t[105]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"transparent"},null,40,hd)])]),r("div",vd,[t[243]||(t[243]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本对齐",-1)),r("div",$d,[r("button",{onClick:t[106]||(t[106]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((fl=e.selectedEl.style)==null?void 0:fl.textAlign)||"left")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左对齐",2),r("button",{onClick:t[107]||(t[107]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((yl=e.selectedEl.style)==null?void 0:yl.textAlign)||"left")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"居中",2),r("button",{onClick:t[108]||(t[108]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ml=e.selectedEl.style)==null?void 0:ml.textAlign)||"left")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右对齐",2)])]),r("div",wd,[t[244]||(t[244]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本方向",-1)),r("div",Ed,[r("button",{onClick:t[109]||(t[109]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="horizontal")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((xl=(bl=e.selectedEl)==null?void 0:bl.style)==null?void 0:xl.textOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[110]||(t[110]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="vertical")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((vl=(hl=e.selectedEl)==null?void 0:hl.style)==null?void 0:vl.textOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)]),t[245]||(t[245]=r("p",{class:"text-[11px] text-gray-400"},"纵向使用 CSS writing-mode 展示，适合竖排文本。",-1))]),r("div",kd,[t[247]||(t[247]=r("label",{class:"block text-xs text-gray-400 mb-1"},"布局倾斜",-1)),r("div",Sd,[me(r("input",{"onUpdate:modelValue":t[111]||(t[111]=a=>e.selectedEl.style.skewAngle=a),type:"range",min:"-45",max:"45",class:"flex-1"},null,512),[[Ce,e.selectedEl.style.skewAngle,void 0,{number:!0}]]),me(r("input",{"onUpdate:modelValue":t[112]||(t[112]=a=>e.selectedEl.style.skewAngle=a),type:"number",min:"-45",max:"45",class:"w-16 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.style.skewAngle,void 0,{number:!0}]])]),r("div",Md,[t[246]||(t[246]=r("label",{class:"text-xs text-gray-400"},"布局倾斜跟随",-1)),r("button",{onClick:t[113]||(t[113]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!0)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(wl=($l=e.selectedEl)==null?void 0:$l.style)!=null&&wl.skewFlowEnabled?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"开",2),r("button",{onClick:t[114]||(t[114]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!1)}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(kl=(El=e.selectedEl)==null?void 0:El.style)!=null&&kl.skewFlowEnabled?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-purple-600 text-white"])},"关",2)]),t[248]||(t[248]=r("p",{class:"text-[11px] text-gray-400"},"调整整体容器的 X 轴倾斜角度（-45° ~ 45°）。启用“跟随”后，文本布局按父视图倾斜线性排布，字符保持正立，可与波形叠加。",-1))]),r("div",Cd,[r("div",Nd,[t[249]||(t[249]=r("label",{class:"text-xs text-gray-400"},"文本波形",-1)),r("div",Id,[(Cl=(Ml=(Sl=e.selectedEl)==null?void 0:Sl.style)==null?void 0:Ml.textWave)!=null&&Cl.enabled?(z(),B("button",{key:1,onClick:t[116]||(t[116]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!1})}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):(z(),B("button",{key:0,onClick:t[115]||(t[115]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!0,amplitude:8,frequency:.5,phase:0})}),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用"))])]),(Al=(Il=(Nl=e.selectedEl)==null?void 0:Nl.style)==null?void 0:Il.textWave)!=null&&Al.enabled?(z(),B("div",Ad,[r("div",Fd,[t[250]||(t[250]=r("label",{class:"block text-xs text-gray-400 mb-1"},"幅度(px)",-1)),me(r("input",{"onUpdate:modelValue":t[117]||(t[117]=a=>e.selectedEl.style.textWave.amplitude=a),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.style.textWave.amplitude,void 0,{number:!0}]])]),r("div",jd,[t[251]||(t[251]=r("label",{class:"block text-xs text-gray-400 mb-1"},"频率(rad/字)",-1)),me(r("input",{"onUpdate:modelValue":t[118]||(t[118]=a=>e.selectedEl.style.textWave.frequency=a),type:"number",step:"0.1",min:"0.1",max:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.style.textWave.frequency,void 0,{number:!0}]])]),r("div",zd,[t[252]||(t[252]=r("label",{class:"block text-xs text-gray-400 mb-1"},"相位(rad)",-1)),me(r("input",{"onUpdate:modelValue":t[119]||(t[119]=a=>e.selectedEl.style.textWave.phase=a),type:"number",step:"0.1",min:"-100",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.style.textWave.phase,void 0,{number:!0}]])])])):K("",!0),t[253]||(t[253]=r("p",{class:"text-[11px] text-gray-400"},"每个字符沿 Y 轴按正弦位移，字符保持正立。",-1))]),r("div",Od,[t[254]||(t[254]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本装饰",-1)),r("div",Bd,[r("button",{onClick:t[120]||(t[120]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="underline"?"none":"underline")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Fl=e.selectedEl.style)==null?void 0:Fl.textDecoration)||"none")==="underline"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下划线",2),r("button",{onClick:t[121]||(t[121]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="line-through"?"none":"line-through")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((jl=e.selectedEl.style)==null?void 0:jl.textDecoration)||"none")==="line-through"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"删除线",2),r("button",{onClick:t[122]||(t[122]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration="none")}),class:Ge(["px-2 py-1 text-xs rounded transition-colors duration-200",(((zl=e.selectedEl.style)==null?void 0:zl.textDecoration)||"none")==="none"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"无",2)])]),r("div",Gd,[r("div",Td,[t[255]||(t[255]=r("label",{class:"text-xs text-gray-400"},"文本渐变",-1)),r("div",Dd,[(Ol=e.selectedEl.style)!=null&&Ol.textGradient?K("",!0):(z(),B("button",{key:0,onClick:t[123]||(t[123]=a=>se(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(Bl=e.selectedEl.style)!=null&&Bl.textGradient?(z(),B("button",{key:1,onClick:t[124]||(t[124]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.textGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):K("",!0)])]),(Gl=e.selectedEl.style)!=null&&Gl.textGradient?(z(),B("div",Ud,[r("div",Ld,[r("div",null,[t[256]||(t[256]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Rd,[me(r("input",{"onUpdate:modelValue":t[125]||(t[125]=a=>e.selectedEl.style.textGradient.colors[0]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Ce,e.selectedEl.style.textGradient.colors[0]]]),me(r("input",{"onUpdate:modelValue":t[126]||(t[126]=a=>e.selectedEl.style.textGradient.colors[0]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#DFDD5A"},null,512),[[Ce,e.selectedEl.style.textGradient.colors[0]]])])]),r("div",null,[t[257]||(t[257]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Vd,[me(r("input",{"onUpdate:modelValue":t[127]||(t[127]=a=>e.selectedEl.style.textGradient.colors[1]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Ce,e.selectedEl.style.textGradient.colors[1]]]),me(r("input",{"onUpdate:modelValue":t[128]||(t[128]=a=>e.selectedEl.style.textGradient.colors[1]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,512),[[Ce,e.selectedEl.style.textGradient.colors[1]]])])])]),r("div",null,[r("label",Pd,"角度: "+mt(e.selectedEl.style.textGradient.angle||0)+"°",1),me(r("input",{"onUpdate:modelValue":t[129]||(t[129]=a=>e.selectedEl.style.textGradient.angle=a),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[Ce,e.selectedEl.style.textGradient.angle,void 0,{number:!0}]])])])):K("",!0)]),r("div",Wd,[r("div",Hd,[t[258]||(t[258]=r("label",{class:"text-xs text-gray-400"},"背景渐变",-1)),r("div",Jd,[(Tl=e.selectedEl.style)!=null&&Tl.backgroundGradient?K("",!0):(z(),B("button",{key:0,onClick:t[130]||(t[130]=a=>F(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(Dl=e.selectedEl.style)!=null&&Dl.backgroundGradient?(z(),B("button",{key:1,onClick:t[131]||(t[131]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.backgroundGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):K("",!0)])]),(Ul=e.selectedEl.style)!=null&&Ul.backgroundGradient?(z(),B("div",_d,[r("div",qd,[r("div",null,[t[259]||(t[259]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Yd,[me(r("input",{"onUpdate:modelValue":t[132]||(t[132]=a=>e.selectedEl.style.backgroundGradient.colors[0]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Ce,e.selectedEl.style.backgroundGradient.colors[0]]]),me(r("input",{"onUpdate:modelValue":t[133]||(t[133]=a=>e.selectedEl.style.backgroundGradient.colors[0]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#00A3FF"},null,512),[[Ce,e.selectedEl.style.backgroundGradient.colors[0]]])])]),r("div",null,[t[260]||(t[260]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Xd,[me(r("input",{"onUpdate:modelValue":t[134]||(t[134]=a=>e.selectedEl.style.backgroundGradient.colors[1]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Ce,e.selectedEl.style.backgroundGradient.colors[1]]]),me(r("input",{"onUpdate:modelValue":t[135]||(t[135]=a=>e.selectedEl.style.backgroundGradient.colors[1]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,512),[[Ce,e.selectedEl.style.backgroundGradient.colors[1]]])])])]),r("div",null,[r("label",Kd,"角度: "+mt(e.selectedEl.style.backgroundGradient.angle||0)+"°",1),me(r("input",{"onUpdate:modelValue":t[136]||(t[136]=a=>e.selectedEl.style.backgroundGradient.angle=a),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[Ce,e.selectedEl.style.backgroundGradient.angle,void 0,{number:!0}]])])])):K("",!0)])])):K("",!0),e.selectedEl&&e.selectedEl.type==="image"?(z(),B("div",Zd,[t[270]||(t[270]=tn('<h3 class="text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1" data-v-4b22c81b>图片设置</h3><div class="space-y-2" data-v-4b22c81b><label class="block text-xs text-gray-400 mb-1" data-v-4b22c81b>图片来源</label><div class="grid grid-cols-2 gap-2" data-v-4b22c81b><button class="px-3 py-2 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200" data-v-4b22c81b>上传文件</button><button class="px-3 py-2 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200" data-v-4b22c81b>选择图标</button></div></div>',2)),r("div",Qd,[t[262]||(t[262]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图片文件",-1)),r("input",{type:"file",onChange:ze,accept:"image/*",class:"w-full text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-purple-600 file:text-white hover:file:bg-purple-500 file:cursor-pointer"},null,32)]),e.iconLibrary.length>0?(z(),B("div",eu,[t[263]||(t[263]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择图标",-1)),r("div",tu,[r("div",ru,[(z(!0),B(rr,null,ur(e.iconLibrary,a=>(z(),B("div",{key:a.id,onClick:O=>Z(a),class:"aspect-square bg-gray-700/50 rounded cursor-pointer hover:bg-gray-600/50 transition-colors duration-200 flex items-center justify-center p-1 border border-transparent hover:border-green-400/50"},[r("img",{src:a.url,alt:a.name,class:"max-w-full max-h-full object-contain",loading:"lazy"},null,8,lu)],8,nu))),128))])]),e.iconLibrary.length===0?(z(),B("div",ou,"暂无图标，请先在图标库管理中上传图标")):K("",!0)])):K("",!0),r("div",{class:"space-y-2"},[t[264]||(t[264]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",{class:"grid grid-cols-2 gap-2"},[r("button",{onClick:T,class:Ge(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-blue-600/30 hover:bg-blue-600/50 text-blue-300"])},"自适应（原始尺寸）"),r("button",{onClick:Q,class:Ge(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-purple-600/30 hover:bg-purple-600/50 text-purple-300"])},"固定大小")])]),r("div",su,[r("div",null,[t[265]||(t[265]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度(px)",-1)),me(r("input",{"onUpdate:modelValue":t[137]||(t[137]=a=>e.selectedEl.width=a),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[266]||(t[266]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度(px)",-1)),me(r("input",{"onUpdate:modelValue":t[138]||(t[138]=a=>e.selectedEl.height=a),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.height,void 0,{number:!0}]])]),r("div",null,[t[268]||(t[268]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对象适配",-1)),me(r("select",{"onUpdate:modelValue":t[139]||(t[139]=a=>e.selectedEl.style.objectFit=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[267]||(t[267]=[tn('<option value="contain" data-v-4b22c81b>contain（完整显示）</option><option value="cover" data-v-4b22c81b>cover（填充裁剪）</option><option value="fill" data-v-4b22c81b>fill（拉伸填充）</option><option value="scale-down" data-v-4b22c81b>scale-down（缩小适配）</option><option value="none" data-v-4b22c81b>none（不适配）</option>',5)])],512),[[Rl,e.selectedEl.style.objectFit]])])]),r("div",au,[t[269]||(t[269]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),me(r("input",{"onUpdate:modelValue":t[140]||(t[140]=a=>e.selectedEl.style.borderRadius=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,e.selectedEl.style.borderRadius,void 0,{number:!0}]])])])):K("",!0),r("div",iu,[r("button",{onClick:t[141]||(t[141]=a=>g("saveSelectedAsComponent")),class:"w-full px-3 py-2 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"},"保存为组件"),r("button",{onClick:t[142]||(t[142]=a=>g("duplicateSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-blue-500/25"},"复制元素"),r("button",{onClick:t[143]||(t[143]=a=>g("removeSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"删除元素")])])):K("",!0),e.selectedEl?K("",!0):(z(),B("div",du,[...t[271]||(t[271]=[r("div",{class:"w-16 h-16 mx-auto mb-4 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center"},[r("span",{class:"text-2xl"},"📝")],-1),r("p",{class:"text-sm"},"选择一个元素来编辑其属性",-1)])]))])}}}),pu=un(cu,[["__scopeId","data-v-4b22c81b"]]),gu={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},fu={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},yu={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},mu={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},bu={class:"flex gap-2"},xu={class:"relative"},hu={class:"grid grid-cols-2 gap-2"},vu={class:"flex items-center gap-2"},$u={class:"text-sm text-gray-400 min-w-[60px] text-center"},wu={key:0,class:"absolute inset-0 pointer-events-none z-50"},Eu={key:1,class:"absolute inset-0 z-[9999] select-none pointer-events-none"},ku={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Su={class:"relative w-[800px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-fuchsia-500/40 rounded-xl shadow-2xl"},Mu={class:"p-4 space-y-3"},Cu={class:"flex items-center gap-2"},Nu={key:0,class:"text-center text-sm text-gray-400 py-6"},Iu={key:1},Au={key:0,class:"text-center text-sm text-gray-400 py-6"},Fu={key:1,class:"grid grid-cols-3 gap-3"},ju={class:"aspect-video bg-gray-700/50 flex items-center justify-center"},zu=["src"],Ou={key:1,class:"text-gray-400 text-xs"},Bu={class:"p-3 space-y-1"},Gu={class:"flex items-center justify-between"},Tu=["title"],Du={class:"text-xs text-gray-500"},Uu={class:"flex flex-wrap gap-1 mt-1"},Lu={class:"pt-2"},Ru=["onClick"],Vu={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},Pu={class:"relative w-[600px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl"},Wu={class:"flex items-center justify-between p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20"},Hu={class:"p-4 space-y-3 max-h-[50vh] overflow-y-auto"},Ju={key:0,class:"text-center text-sm text-gray-400 py-6"},_u={key:1,class:"space-y-2"},qu=["title"],Yu=["onClick"],Xu=50,sn=1,Ku=Zt({__name:"LowCodeBuilder",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(y){const n=y,e=io(),g=po(),$=Xe(()=>{var l;return(l=n.projectId)!=null?l:e.params.id?String(e.params.id):void 0}),S=ye(null);async function P(){if($.value)try{const l=(await Se()).transaction(["projects"],"readonly").objectStore("projects").get($.value);l.onsuccess=()=>{S.value=l.result}}catch(l){console.error("加载项目信息失败:",l)}}function le(){if(!$.value)return;const l=n.isComponent?{path:`/project/${$.value}/preview`,query:{type:"component"}}:{path:`/project/${$.value}/preview`},o=g.resolve(l).href;window.open(o,"_blank")}async function Se(){return new Promise((l,o)=>{const i="lowcode-projects",c="projects",m=indexedDB.open(i);m.onerror=()=>o(m.error),m.onupgradeneeded=()=>{const p=m.result;p.objectStoreNames.contains(c)||p.createObjectStore(c,{keyPath:"id"})},m.onsuccess=()=>{const p=m.result;if(p.objectStoreNames.contains(c))l(p);else{const M=p.version+1;p.close();const k=indexedDB.open(i,M);k.onerror=()=>o(k.error),k.onupgradeneeded=()=>{const C=k.result;C.objectStoreNames.contains(c)||C.createObjectStore(c,{keyPath:"id"})},k.onsuccess=()=>l(k.result)}}})}const N=Ll({width:1024,height:576,backgroundUrl:"",backgroundColor:"#000000",globalFontFamily:"Arial, Helvetica, sans-serif",globalFontSize:14,globalColor:"#FFFFFF"}),ie=ye("GeneratedComponent"),$e=ye(["Arial, Helvetica, sans-serif","PingFang SC","Microsoft YaHei","Roboto","Inter"]),ne=ye([8,9,10,11,12,14,16,18,20,24,28,32,36,48,64]),fe=ye(["100","200","300","400","500","600","700","800","900"]),se=ye(["normal","italic","oblique"]),F=ye([]),f=ye(null),v=ye([]),L=ye({}),V=ye(null),U=ye([]),q=ye(!1),ze=ye(!1),Z=ye({id:null,steps:[],cursor:0,stage:0,active:!1}),T=ye(!1);function Q(){try{const l=JSON.parse(JSON.stringify(F.value));U.value.push(l),U.value.length>Xu&&U.value.shift()}catch(l){console.warn("pushHistory 序列化失败：",l)}}function De(){U.value.length!==0&&(F.value=U.value.pop(),f.value=null,Le.value=!1)}function ot(l){var p,M,k,C,I,d,u,G,H,de,ge,ae,he,xe,ee;function o(te){var re;if(!te)return!1;const J=(re=te.tagName)==null?void 0:re.toLowerCase();return te.isContentEditable||!!te.closest('[contenteditable="true"]')||J==="input"||J==="textarea"||J==="select"}const i=document.activeElement;if(o(i)||o(l.target))return;const c=l.metaKey||l.ctrlKey,m=l.key.toLowerCase();if(m==="arrowleft"||m==="arrowright"||m==="arrowup"||m==="arrowdown"){if(!f.value)return;const{el:te}=at(f.value);if(!te)return;ze.value||(Q(),ze.value=!0,Z.value={id:f.value,steps:[],cursor:0,stage:0,active:!0},T.value=!0),Y.shift=l.shiftKey,m==="arrowleft"&&(Y.left=!0),m==="arrowright"&&(Y.right=!0),m==="arrowup"&&(Y.up=!0),m==="arrowdown"&&(Y.down=!0);const J=l.shiftKey?10:1;ue(m==="arrowleft"?-J:m==="arrowright"?J:0,m==="arrowup"?-J:m==="arrowdown"?J:0),t!=null&&(clearTimeout(t),t=null),t=window.setTimeout(()=>{Me()},220),l.preventDefault();return}if(c&&m==="c"){if(Ft.value){try{V.value=JSON.parse(JSON.stringify(Ft.value))}catch{}l.preventDefault()}}else if(c&&m==="v"){if(V.value){const te=V.value,J=Er(te),{parentGroup:re}=at(te.id);if(re){const Oe=Number((M=(p=re.left)!=null?p:re.x)!=null?M:0),b=Number((C=(k=re.top)!=null?k:re.y)!=null?C:0),h=Number((I=re.width)!=null?I:0),R=Number((d=re.height)!=null?d:0),j=Oe+h,D=b+R,_=Number((u=te.width)!=null?u:0),x=Number((G=te.height)!=null?G:0);let W=_,E=x;if(!W||!E)if(te.type==="text"){const ht=Number((H=te.fontSize)!=null?H:16),yt=String((ge=(de=te.text)!=null?de:te.content)!=null?ge:"").trim();W=Math.max(_||50,Math.round((yt.length||2)*ht*.6)),E=Math.max(x||20,Math.round(ht*1.5))}else te.type==="image"?(W=_||200,E=x||150):te.type==="chart"?(W=_||240,E=x||160):te.type==="line"?(W=_||200,E=x||2):(W=_||100,E=x||60);const ce=10,je=Oe+h/2,ve=b+R/2;let Ie=!1,Be=j+ce,We=Math.round(ve-E/2);if(!Ie&&Be+W<=N.width&&(J.left=Math.max(0,Math.min(Be,Math.max(0,N.width-W))),J.top=Math.max(0,Math.min(We,Math.max(0,N.height-E))),Ie=!0),Be=Oe-W-ce,We=Math.round(ve-E/2),!Ie&&Be>=0&&(J.left=Math.max(0,Math.min(Be,Math.max(0,N.width-W))),J.top=Math.max(0,Math.min(We,Math.max(0,N.height-E))),Ie=!0),Be=Math.round(je-W/2),We=D+ce,!Ie&&We+E<=N.height&&(J.left=Math.max(0,Math.min(Be,Math.max(0,N.width-W))),J.top=Math.max(0,Math.min(We,Math.max(0,N.height-E))),Ie=!0),Be=Math.round(je-W/2),We=b-E-ce,!Ie&&We>=0&&(J.left=Math.max(0,Math.min(Be,Math.max(0,N.width-W))),J.top=Math.max(0,Math.min(We,Math.max(0,N.height-E))),Ie=!0),!Ie){const ht=Number((he=(ae=te.left)!=null?ae:te.x)!=null?he:0),yt=Number((ee=(xe=te.top)!=null?xe:te.y)!=null?ee:0),St=Oe+ht+ce,ut=b+yt+ce;J.left=Math.max(0,Math.min(Math.round(St),Math.max(0,N.width-W))),J.top=Math.max(0,Math.min(Math.round(ut),Math.max(0,N.height-E)))}J.x=J.left,J.y=J.top}Q(),F.value.push(J),f.value=J.id,l.preventDefault()}}else if(m==="delete"||m==="backspace"){if(f.value){Q();const{el:te,parentGroup:J}=at(f.value);te&&J&&Array.isArray(J.children)?J.children=J.children.filter(re=>re.id!==te.id):(F.value=F.value.filter(re=>re.id!==f.value),te&&te.type==="group"&&Qe(te.id)),f.value=null,l.preventDefault()}}else c&&m==="z"&&((()=>{var Oe,b;const J=Z.value,re=[20,15,10];if(T.value&&J.id&&J.cursor>0){const{el:h}=at(J.id);if(h){const R=Math.min(Math.max(J.stage,0),re.length-1),j=re[R],D=Math.min(j,J.cursor);let _=0,x=0;for(let W=J.cursor-D;W<J.cursor;W++){const E=J.steps[W];_+=E.dx,x+=E.dy}h.left=Math.round(((Oe=h.left)!=null?Oe:0)-_),h.top=Math.round(((b=h.top)!=null?b:0)-x),h.x=h.left,h.y=h.top,J.cursor-=D,J.stage=Math.min(J.stage+1,re.length-1),f.value=h.id,Ne();return}}De(),T.value=!1,Z.value.active=!1})(),l.preventDefault())}const Y=Ll({left:!1,right:!1,up:!1,down:!1,shift:!1});let Ue=null,w=0,t=null;function ue(l,o){var he,xe,ee,te,J,re,Oe,b;const i=f.value;if(!i)return;const{el:c,parentGroup:m}=at(i);if(!c)return;ze.value&&Z.value.active&&Z.value.id===i&&(Z.value.steps.push({dx:l,dy:o}),Z.value.cursor=Z.value.steps.length,T.value=!0);const p=(ee=(xe=c.width)!=null?xe:(he=L.value[i])==null?void 0:he.width)!=null?ee:0,M=(re=(J=c.height)!=null?J:(te=L.value[i])==null?void 0:te.height)!=null?re:0;let k=N.width,C=N.height;m&&m.width&&m.height&&(k=Number(m.width)||k,C=Number(m.height)||C);let I=((Oe=c.left)!=null?Oe:0)+l,d=((b=c.top)!=null?b:0)+o;I=Math.round(I),d=Math.round(d),I=Math.max(0,Math.min(I,k-(p||0))),d=Math.max(0,Math.min(d,C-(M||0))),c.left=I,c.top=d,c.x=c.left,c.y=c.top;const u=c.left,G=c.top,H=u+(p||0),de=G+(M||0),ge=u+(p||0)/2,ae=G+(M||0)/2;Qt({left:u,top:G,right:H,bottom:de,centerX:ge,centerY:ae})}function Me(){if(Ue!=null)return;w=Date.now();const l=()=>{if(!Y.left&&!Y.right&&!Y.up&&!Y.down){Ue!=null&&cancelAnimationFrame(Ue),Ue=null,Vt();return}const o=Date.now()-w,i=o>1500?8:o>800?4:o>300?2:1,c=(Y.shift?10:1)*i,m=(Y.left?-c:0)+(Y.right?c:0),p=(Y.up?-c:0)+(Y.down?c:0);ue(m,p),Ue=requestAnimationFrame(l)};Ue=requestAnimationFrame(l)}function Ke(l){const o=l.key.toLowerCase();o==="shift"&&(Y.shift=!1),o==="arrowleft"&&(Y.left=!1),o==="arrowright"&&(Y.right=!1),o==="arrowup"&&(Y.up=!1),o==="arrowdown"&&(Y.down=!1),t!=null&&(clearTimeout(t),t=null),!Y.left&&!Y.right&&!Y.up&&!Y.down&&Ue==null&&(ze.value=!1,Z.value.active=!1),!Y.left&&!Y.right&&!Y.up&&!Y.down&&Vt()}const Le=ye(!1),Ae=ye({left:0,top:0,right:0,bottom:0,centerX:0,centerY:0});function pt(l){L.value[l.id]=l}function gt(l){return l==="pie"?{backgroundColor:"transparent",tooltip:{trigger:"item"},legend:{top:"5%",left:"center",textStyle:{color:"#fff"},show:!0},series:[{name:"分类占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#111",borderWidth:2},label:{show:!0,color:"#fff"},labelLine:{show:!0},data:[{value:1048,name:"A"},{value:735,name:"B"},{value:580,name:"C"},{value:484,name:"D"},{value:300,name:"E"}]}]}:l==="mix"?{backgroundColor:"transparent",color:["#00bcd4","#ff9800"],tooltip:{trigger:"axis"},legend:{textStyle:{color:"#fff"},show:!0},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"销量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}},{name:"均价",type:"line",smooth:!0,data:[30,40,45,50,49,60,70],lineStyle:{width:2}}]}:l==="bar"?{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"数量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}}]}:{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"趋势",type:"line",smooth:!0,data:[150,230,224,218,135,147,260],lineStyle:{width:2}}]}}function bt(l){var te,J;const o=`${l}-${Date.now()}`,i=tr.value,c=dt.value||1,m=(te=i==null?void 0:i.clientWidth)!=null?te:0,p=(J=i==null?void 0:i.clientHeight)!=null?J:0,M=i?(i.scrollLeft+m/2)/c:20,k=i?(i.scrollTop+p/2)/c:20,C=l==="chart"?240:l==="image"||l==="line"?200:l==="container"?240:void 0,I=l==="chart"?160:l==="image"?150:l==="line"?2:l==="container"?160:void 0,d=Math.round(M-(C?C/2:10)),u=Math.round(k-(I?I/2:10)),G=Math.max(0,Math.min(d,Math.max(0,N.width-(C!=null?C:0)))),H=Math.max(0,Math.min(u,Math.max(0,N.height-(I!=null?I:0)))),de=(re,Oe,b,h)=>{const R=Math.max(0,Math.min(re,Math.max(0,N.width-(b!=null?b:0)))),j=Math.max(0,Math.min(Oe,Math.max(0,N.height-(h!=null?h:0))));return{cl:R,ct:j}},ge=F.value.map(re=>{var j,D,_,x,W,E;const Oe=(j=re.width)!=null?j:0,b=(D=re.height)!=null?D:0,h=Number((x=(_=re.left)!=null?_:re.x)!=null?x:0),R=Number((E=(W=re.top)!=null?W:re.y)!=null?E:0);return{l:h,t:R,r:h+Oe,b:R+b}}),ae=(re,Oe,b,h)=>{const R=re+(b!=null?b:0),j=Oe+(h!=null?h:0);for(const D of ge)if(!(b===void 0||h===void 0)&&!(R<=D.l||j<=D.t||re>=D.r||Oe>=D.b))return!0;return!1},he=24;let xe={cl:G,ct:H};if(C&&I&&ae(xe.cl,xe.ct,C,I)){let re=!1;for(let Oe=1;Oe<=20&&!re;Oe++)for(const b of[[Oe,0],[0,Oe],[-Oe,0],[0,-Oe]]){const[h,R]=b,j=d+h*he,D=u+R*he,_=de(j,D,C,I);if(!ae(_.cl,_.ct,C,I)){xe=_,re=!0;break}}}const ee={id:o,type:l,left:xe.cl,top:xe.ct,autoSize:l==="text",width:C,height:I,text:l==="text"?"文字":l==="image"||l==="line"?"":"图表",className:"",zIndex:1,style:{}};if(l==="text"?Object.assign(ee,{content:"文字",fontSize:16,fontWeight:"400",fontFamily:"Arial, Helvetica, sans-serif",color:"#ffffff",letterSpacing:"0px",lineHeight:"1.5",fontStyle:"normal",useGradient:!1,gradientStart:"#00A3FF",gradientEnd:"#ffffff",gradientDirection:"to right",x:xe.cl,y:xe.ct}):l==="image"&&(Object.assign(ee,{src:"",borderRadius:0,x:xe.cl,y:xe.ct}),ee.style={...ee.style||{},objectFit:"contain"}),l==="chart"&&Object.assign(ee,{elementId:`chart-${Date.now()}`,chartType:"line",chartOption:gt("line")}),l==="line"&&(ee.autoSize=!1,ee.style={...ee.style||{},lineColor:"#ffffff",lineThickness:2,lineOrientation:"horizontal",lineStyle:"solid",lineDashLength:6,lineDashGap:4}),l==="arc-text"){ee.autoSize=!1,ee.text="环绕文字";const re=60;ee.width=ee.width||re*2+20,ee.height=ee.height||re*2+20,ee.style={...ee.style||{},fontFamily:N.globalFontFamily,fontSize:Math.max(12,N.globalFontSize),color:N.globalColor,textAlign:"center",arcText:{radius:re,startAngle:0,sweepAngle:180,clockwise:!0}}}l==="container"&&(ee.autoSize=!1,ee.text="",ee.elementId=`container-${Date.now()}`,ee.style={...ee.style||{},backgroundColor:"transparent",borderRadius:"6px"}),Q(),F.value.push(ee),f.value=o}function Ct(l){bt(l),Ht.value=!1}function _t(l){const{el:o}=at(l.id);o&&(q.value||(Q(),q.value=!0),o.left=l.left,o.top=l.top,o.x=l.left,o.y=l.top)}function qt(l){const{el:o}=at(l.id);o&&(q.value||(Q(),q.value=!0),o.width=l.width,o.height=l.height,l.left!==void 0&&(o.left=l.left,o.x=l.left),l.top!==void 0&&(o.top=l.top,o.y=l.top))}function s(l){f.value=l,Ne()}function oe(l){f.value=l,Ne(),ln(()=>{const o=document.querySelector(`[data-el-id="${l}"]`);o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})}function be(l,o){if(l===o||l<0||o<0||l>=F.value.length||o>=F.value.length)return;Q();const[i]=F.value.splice(l,1);i&&(F.value.splice(o,0,i),f.value=i.id)}function Ne(){if(Ot(),!xt.value)return;const l=f.value;if(!l)return;const o=At.value.find(p=>p.id===l);if(!o)return;const i=At.value.filter(p=>p.id!==l),c={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY};Ae.value={left:c.left,top:c.top,right:c.right,bottom:c.bottom,centerX:c.centerX,centerY:c.centerY},Ee.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1};const m=4;for(const p of i)Math.abs(c.centerX-p.centerX)<=m&&p.w>0&&(Ee.value.centerV=!0,Ae.value.centerX=p.centerX),Math.abs(c.centerY-p.centerY)<=m&&p.h>0&&(Ee.value.centerH=!0,Ae.value.centerY=p.centerY),Math.abs(c.left-p.left)<=m&&(Ee.value.left=!0,Ae.value.left=p.left),Math.abs(c.right-p.right)<=m&&p.w>0&&(Ee.value.right=!0,Ae.value.right=p.right),Math.abs(c.top-p.top)<=m&&(Ee.value.top=!0,Ae.value.top=p.top),Math.abs(c.bottom-p.bottom)<=m&&p.h>0&&(Ee.value.bottom=!0,Ae.value.bottom=p.bottom);Le.value=Object.values(Ee.value).some(Boolean)}function ke(){f.value=null,Vt()}const Ee=ye({centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1}),X=ye({left:null,right:null,up:null,down:null}),wt=ye(!0),xt=ye(!0),It=ye(!1),Ut=Xe(()=>F.value.filter(l=>l.hidden));function Yt(l){const o=F.value.find(i=>i.id===l);o&&(o.hidden=!1,f.value=l,ln(()=>{const i=document.querySelector(`[data-el-id="${l}"]`);i&&i.scrollIntoView({behavior:"smooth",block:"center"}),It.value=!1}))}const rt=ye(null),nt=ye(null),At=Xe(()=>{const l=[];function o(i,c,m,p){var M,k,C,I;for(const d of i){const u=L.value[d.id],G=u?u.left:(M=d.left)!=null?M:0,H=u?u.top:(k=d.top)!=null?k:0,de=u?u.width:(C=d.width)!=null?C:0,ge=u?u.height:(I=d.height)!=null?I:0,ae=c+G,he=m+H;l.push({id:d.id,left:ae,top:he,right:ae+de,bottom:he+ge,centerX:ae+de/2,centerY:he+ge/2,w:de,h:ge,type:d.type,parentId:p}),(d.type==="group"||d.type==="container")&&Array.isArray(d.children)&&o(d.children,ae,he,d.id)}}return o(F.value,0,0,null),l});function Qt(l){q.value||(Q(),q.value=!0),Ae.value={left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.centerX,centerY:l.centerY},Ee.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},X.value={left:null,right:null,up:null,down:null};const o=.5,i=f.value,c=At.value.find(u=>u.id===i),m=c?c.parentId:null,p=At.value.filter(u=>u.parentId===m);function M(u,G,H,de){const ge=Math.max(u,H);return Math.min(G,de)-ge}let k=null,C=null,I=null,d=null;for(const u of p)if(!(!i||u.id===i)){if(Math.abs(l.centerX-u.centerX)<=o&&u.w>0&&(Ee.value.centerV=!0,Ae.value.centerX=u.centerX),Math.abs(l.centerY-u.centerY)<=o&&u.h>0&&(Ee.value.centerH=!0,Ae.value.centerY=u.centerY),Math.abs(l.left-u.left)<=o&&(Ee.value.left=!0,Ae.value.left=u.left),Math.abs(l.right-u.right)<=o&&u.w>0&&(Ee.value.right=!0,Ae.value.right=u.right),Math.abs(l.top-u.top)<=o&&(Ee.value.top=!0,Ae.value.top=u.top),Math.abs(l.bottom-u.bottom)<=o&&u.h>0&&(Ee.value.bottom=!0,Ae.value.bottom=u.bottom),M(l.top,l.bottom,u.top,u.bottom)>0){const G=l.left-u.right;G>=0&&(!k||G<k.gap)&&(k={gap:G,m:u});const H=u.left-l.right;H>=0&&(!C||H<C.gap)&&(C={gap:H,m:u})}if(M(l.left,l.right,u.left,u.right)>0){const G=l.top-u.bottom;G>=0&&(!I||G<I.gap)&&(I={gap:G,m:u});const H=u.top-l.bottom;H>=0&&(!d||H<d.gap)&&(d={gap:H,m:u})}}if(Le.value=Object.values(Ee.value).some(Boolean),!wt.value){X.value={left:null,right:null,up:null,down:null};return}if(k){const u=k.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(Math.max(l.top,u.top)+Math.min(l.bottom,u.bottom))/2;X.value.left={gap:Math.floor(k.gap),exact:k.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(C){const u=C.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(Math.max(l.top,u.top)+Math.min(l.bottom,u.bottom))/2;X.value.right={gap:Math.floor(C.gap),exact:C.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(I){const u=I.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(u.bottom+l.top)/2;X.value.up={gap:Math.floor(I.gap),exact:I.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(d){const u=d.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(l.bottom+u.top)/2;X.value.down={gap:Math.floor(d.gap),exact:d.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}xt.value||(Ee.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},Le.value=!1)}function Ot(){if(!wt.value){X.value={left:null,right:null,up:null,down:null};return}const l=f.value;if(!l){X.value={left:null,right:null,up:null,down:null};return}const o=At.value.find(u=>u.id===l);if(!o){X.value={left:null,right:null,up:null,down:null};return}const i={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY},c=o.parentId,m=At.value.filter(u=>u.id!==l&&u.parentId===c);function p(u,G,H,de){const ge=Math.max(u,H);return Math.min(G,de)-ge}let M=null,k=null,C=null,I=null;for(const u of m){if(p(i.top,i.bottom,u.top,u.bottom)>0){const G=i.left-u.right;G>=0&&(!M||G<M.gap)&&(M={gap:G,m:u});const H=u.left-i.right;H>=0&&(!k||H<k.gap)&&(k={gap:H,m:u})}if(p(i.left,i.right,u.left,u.right)>0){const G=i.top-u.bottom;G>=0&&(!C||G<C.gap)&&(C={gap:G,m:u});const H=u.top-i.bottom;H>=0&&(!I||H<I.gap)&&(I={gap:H,m:u})}}const d={left:null,right:null,up:null,down:null};if(M){const u=M.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(Math.max(i.top,u.top)+Math.min(i.bottom,u.bottom))/2;d.left={gap:Math.floor(M.gap),exact:M.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(k){const u=k.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(Math.max(i.top,u.top)+Math.min(i.bottom,u.bottom))/2;d.right={gap:Math.floor(k.gap),exact:k.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(C){const u=C.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(u.bottom+i.top)/2;d.up={gap:Math.floor(C.gap),exact:C.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(I){const u=I.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(i.bottom+u.top)/2;d.down={gap:Math.floor(I.gap),exact:I.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}X.value=d}function Vt(){q.value=!1,xt.value&&f.value?Ne():Le.value=!1,Ot()}function at(l){if(!l)return{el:null,parentGroup:null};const o=(i,c)=>{for(const m of i){if(m.id===l)return{el:m,parentGroup:c};if((m.type==="group"||m.type==="container")&&Array.isArray(m.children)){const p=o(m.children,m);if(p)return p}}return null};return o(F.value,null)||{el:null,parentGroup:null}}const er=ye(null);function nr(l,o){if(!l.children||!Array.isArray(l.children))return!1;const i=[...l.children];for(;i.length;){const c=i.pop();if((c==null?void 0:c.id)===o.id)return!0;c!=null&&c.children&&Array.isArray(c.children)&&i.push(...c.children)}return!1}function lr(l){var G,H,de,ge;const{id:o,globalLeft:i,globalTop:c}=l;if(!o)return;const m=(G=er.value)==null?void 0:G.getBoundingClientRect();if(!m)return;const{el:p,parentGroup:M}=at(o);if(!p)return;const k=(((H=L.value[o])==null?void 0:H.width)||Number(p.width)||0)*dt.value,C=(((de=L.value[o])==null?void 0:de.height)||Number(p.height)||0)*dt.value,I={left:i,top:c,right:i+k,bottom:c+C};function d(){const ae=I.left+1,he=I.top+1,xe=I.right-1,ee=I.bottom-1;return[{x:(I.left+I.right)/2,y:(I.top+I.bottom)/2},{x:ae,y:he},{x:xe,y:he},{x:ae,y:ee},{x:xe,y:ee}]}let u=null;for(const ae of d()){const he=document.elementsFromPoint(ae.x,ae.y);for(const xe of he){const ee=(ge=xe.closest("[data-box-id]"))==null?void 0:ge.getAttribute("data-box-id");if(!ee||ee===o)continue;const{el:te}=at(ee);if(te&&!(te.type!=="container"&&te.type!=="group")&&te.id!==p.id&&!nr(p,te)){u=ee;break}}if(u)break}if(M?Array.isArray(M.children)&&(M.children=M.children.filter(ae=>ae.id!==o)):F.value=F.value.filter(ae=>ae.id!==o),u){const{el:ae}=at(u);if(ae){const he=document.querySelector(`[data-box-id="${u}"]`);if(he){const xe=he.getBoundingClientRect(),ee=(i-xe.left)/dt.value,te=(c-xe.top)/dt.value;p.left=Math.round(ee),p.top=Math.round(te),p.x=p.left,p.y=p.top,ae.children||(ae.children=[]),ae.children.push(p)}}}else{const ae=(i-m.left)/dt.value,he=(c-m.top)/dt.value;p.left=Math.round(ae),p.top=Math.round(he),p.x=p.left,p.y=p.top,F.value.push(p)}Q(),ln(()=>{f.value=o})}function Pt(l){const o=X.value[l];o&&(rt.value=l,nt.value=o.gap)}function Wt(){var k,C,I,d,u;if(!rt.value||nt.value==null){rt.value=null,nt.value=null;return}const l=rt.value,o=X.value[l];if(!o){rt.value=null,nt.value=null;return}const i=At.value.find(G=>G.id===o.refId),c=nt.value,m=Ft.value;if(!i||!m){rt.value=null,nt.value=null;return}Q();const p=(k=o.exact)!=null?k:o.gap,M=c-p;l==="left"?m.left=Math.round(((C=m.left)!=null?C:0)+M):l==="right"?m.left=Math.round(((I=m.left)!=null?I:0)-M):l==="up"?m.top=Math.round(((d=m.top)!=null?d:0)+M):l==="down"&&(m.top=Math.round(((u=m.top)!=null?u:0)-M)),rt.value=null,nt.value=null,Ot()}Dt(f,()=>{q.value||Ot()}),Dt(L,()=>{q.value||Ot()},{deep:!0}),Dt(wt,l=>{l?Ot():(rt.value=null,nt.value=null,X.value={left:null,right:null,up:null,down:null})}),Dt(xt,l=>{l?Ne():(Ee.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},Le.value=!1)});const Ft=Xe(()=>f.value?at(f.value).el:null);async function or(){return new Promise((l,o)=>{const i="lowcode-db",c="objects",m=indexedDB.open(i);m.onerror=()=>o(m.error),m.onupgradeneeded=()=>{const p=m.result;if(!p.objectStoreNames.contains(c)){const M=p.createObjectStore(c,{keyPath:"id"});try{M.createIndex("projectId","projectId",{unique:!1}),M.createIndex("name","name",{unique:!1})}catch{}}},m.onsuccess=()=>{const p=m.result;if(p.objectStoreNames.contains(c))l(p);else{const M=p.version+1;p.close();const k=indexedDB.open(i,M);k.onerror=()=>o(k.error),k.onupgradeneeded=()=>{const C=k.result;if(!C.objectStoreNames.contains(c)){const I=C.createObjectStore(c,{keyPath:"id"});try{I.createIndex("projectId","projectId",{unique:!1}),I.createIndex("name","name",{unique:!1})}catch{}}},k.onsuccess=()=>l(k.result)}}})}async function Ze(){try{const l=(await or()).transaction(["objects"],"readonly").objectStore("objects").getAll();l.onsuccess=()=>{v.value=(l.result||[]).filter(o=>!o.projectId||o.projectId===(n.projectId||void 0))},l.onerror=()=>{console.warn("loadDatabaseObjects error",l.error)}}catch(l){console.warn("openDatabaseDB error",l)}}const pe=Xe(()=>{const l={};for(const o of v.value)o&&o.name&&(l[o.name]=o.content);return l}),Pe=ye({}),Te=Xe(()=>{const l={...pe.value};for(const o in Pe.value)Object.assign(l,Pe.value[o]);return l});function ft(l,o){const i={};for(const c of o)c&&c.name&&(i[c.name]=c.content);Pe.value[l]=i}function Qe(l){Pe.value[l]&&delete Pe.value[l];const o=`component-fonts-${l}`,i=document.getElementById(o);i&&i.parentNode&&i.parentNode.removeChild(i)}function Re(l,o="#000000"){try{const i=String(l||"").trim();return/^#([0-9a-fA-F]{6})$/.test(i)?i:o}catch{return o}}function lt(){if(!f.value)return;Q();const{el:l,parentGroup:o}=at(f.value);l&&o&&Array.isArray(o.children)?o.children=o.children.filter(i=>i.id!==l.id):(F.value=F.value.filter(i=>i.id!==f.value),l&&l.type==="group"&&Qe(l.id)),f.value=null}function Ve(l){(!l.className||!l.className.trim())&&(l.className=`cls-${String(l.id).slice(0,8)}`)}function Fe(l){try{Ve(l);const o=String(l.className||"").trim();String(l.customClassCss||"").trim()||(l.customClassCss=`.${o} {
  
}`)}catch{}}function Bt(l){const o=String(l||"").trim();return o?o.split(";").map(i=>{const c=i.trim();return c?/!important\s*$/.test(c)?c+";":c+" !important;":""}).filter(Boolean).join(`
`):""}function st(l){return String(l||"").replace(/\{([^}]*)\}/g,(o,i)=>`{
`+String(i||"").split(";").map(c=>{const m=c.trim();return m?m.startsWith("@")||!/:/.test(m)||/!important\s*$/.test(m)?m+";":m+" !important;":""}).filter(Boolean).join(`
`)+`
}`)}function it(l){try{if(!l.enableClassStyle)return;Ve(l);const o=String(l.customClassCss||"").trim();if(!o)return;const i=`custom-class-${l.id}`;let c=document.getElementById(i);if(c||(c=document.createElement("style"),c.id=i,document.head.appendChild(c)),/{[^}]*}/.test(o)){c.textContent=st(o);return}const m=Bt(o);c.textContent=`.${String(l.className).trim()} {
${m}
}`}catch(o){console.warn("注入自定义类样式失败：",o)}}function Et(l){try{const o=`custom-class-${l}`,i=document.getElementById(o);i&&i.remove()}catch{}}function tt(l,o){for(const i of l)o(i),(i.type==="group"||i.type==="container")&&Array.isArray(i.children)&&tt(i.children,o)}let et=null;function Nt(){et&&clearTimeout(et),et=setTimeout(()=>{try{tt(F.value,l=>{l.enableClassStyle&&l.customClassCss&&l.className?it(l):Et(l.id)})}catch(l){console.warn("刷新自定义类样式失败：",l)}},50)}async function Xt(){var l,o,i,c,m,p,M,k,C,I;try{const d=Ft.value;if(!d){alert("请先选中要保存的元素或分组");return}const u=ie.value||(d.type==="group"?"分组组件":"元素组件"),G=prompt("请输入组件名称",u);if(G===null)return;const H=(G||u).trim()||"未命名组件";let de=[];if(d.type==="group"&&Array.isArray(d.children)){const b=Number((o=(l=d.left)!=null?l:d.x)!=null?o:0),h=Number((c=(i=d.top)!=null?i:d.y)!=null?c:0);de=d.children.map(R=>{var ce,je,ve,Ie,Be,We;const j=JSON.parse(JSON.stringify(R)),D=Number((je=(ce=j.left)!=null?ce:j.x)!=null?je:0),_=Number((Ie=(ve=j.top)!=null?ve:j.y)!=null?Ie:0);j.left=b+D,j.top=h+_,j.x=j.left,j.y=j.top;const x=L.value[R.id],W=Number(j.width||0),E=Number(j.height||0);if(!(W>0)){const ht=(()=>{var yt,St,ut,jt,vt;if(j.type==="text"){const Jt=Number((yt=j.fontSize)!=null?yt:16),xr=String((St=j.text)!=null?St:"").trim();return Math.max(50,Math.round((xr.length||2)*Jt*.6))}if(j.type==="image")return 100;if(j.type==="chart")return 240;if(j.type==="line"){const Jt=Number((jt=(ut=j.style)==null?void 0:ut.lineThickness)!=null?jt:2);return(((vt=j.style)==null?void 0:vt.lineOrientation)||"horizontal")==="vertical"?Jt:100}return 50})();j.width=Math.max(1,Math.round((Be=x==null?void 0:x.width)!=null?Be:ht))}if(!(E>0)){const ht=(()=>{var yt,St,ut,jt;if(j.type==="text"){const vt=Number((yt=j.fontSize)!=null?yt:16);return Math.max(20,Math.round(vt*1.5))}if(j.type==="image")return 100;if(j.type==="chart")return 160;if(j.type==="line"){const vt=Number((ut=(St=j.style)==null?void 0:St.lineThickness)!=null?ut:2);return(((jt=j.style)==null?void 0:jt.lineOrientation)||"horizontal")==="vertical"?100:vt}return 20})();j.height=Math.max(1,Math.round((We=x==null?void 0:x.height)!=null?We:ht))}return j.id=`${j.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,j})}else{const b=JSON.parse(JSON.stringify(d)),h=Number((p=(m=b.left)!=null?m:b.x)!=null?p:0),R=Number((k=(M=b.top)!=null?M:b.y)!=null?k:0);b.left=h,b.top=R,b.x=b.left,b.y=b.top;const j=L.value[d.id],D=Number(b.width||0),_=Number(b.height||0);if(!(D>0)){const x=(()=>{var W,E,ce,je,ve;if(b.type==="text"){const Ie=Number((W=b.fontSize)!=null?W:16),Be=String((E=b.text)!=null?E:"").trim();return Math.max(50,Math.round((Be.length||2)*Ie*.6))}if(b.type==="image")return 100;if(b.type==="chart")return 240;if(b.type==="line"){const Ie=Number((je=(ce=b.style)==null?void 0:ce.lineThickness)!=null?je:2);return(((ve=b.style)==null?void 0:ve.lineOrientation)||"horizontal")==="vertical"?Ie:100}return 50})();b.width=Math.max(1,Math.round((C=j==null?void 0:j.width)!=null?C:x))}if(!(_>0)){const x=(()=>{var W,E,ce,je;if(b.type==="text"){const ve=Number((W=b.fontSize)!=null?W:16);return Math.max(20,Math.round(ve*1.5))}if(b.type==="image")return 100;if(b.type==="chart")return 160;if(b.type==="line"){const ve=Number((ce=(E=b.style)==null?void 0:E.lineThickness)!=null?ce:2);return(((je=b.style)==null?void 0:je.lineOrientation)||"horizontal")==="vertical"?100:ve}return 20})();b.height=Math.max(1,Math.round((I=j==null?void 0:j.height)!=null?I:x))}b.id=`${b.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,de=[b]}const ge=Math.min(...de.map(b=>{var h,R;return Number((R=(h=b.left)!=null?h:b.x)!=null?R:0)})),ae=Math.min(...de.map(b=>{var h,R;return Number((R=(h=b.top)!=null?h:b.y)!=null?R:0)})),he=Math.max(...de.map(b=>{var h,R,j;return Number((R=(h=b.left)!=null?h:b.x)!=null?R:0)+Number((j=b.width)!=null?j:0)})),xe=Math.max(...de.map(b=>{var h,R,j;return Number((R=(h=b.top)!=null?h:b.y)!=null?R:0)+Number((j=b.height)!=null?j:0)})),ee=Math.max(1,Math.round(he-ge)),te=Math.max(1,Math.round(xe-ae));de=de.map(b=>{var D,_,x,W;const h=JSON.parse(JSON.stringify(b)),R=Number((_=(D=h.left)!=null?D:h.x)!=null?_:0)-ge,j=Number((W=(x=h.top)!=null?x:h.y)!=null?W:0)-ae;return h.left=Math.max(0,Math.round(R)),h.top=Math.max(0,Math.round(j)),h.x=h.left,h.y=h.top,h});const J={width:ee,height:te,backgroundUrl:"",backgroundColor:"transparent",globalFontFamily:N.globalFontFamily,globalFontSize:N.globalFontSize,globalColor:N.globalColor},re=`${Date.now()}${Math.random().toString(36).slice(2,9)}`,Oe={id:re,name:H,description:"",tags:[],elements:de,config:J,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await ct.init(),await ct.saveComponent(JSON.parse(JSON.stringify(Oe))),await yr(`component-${re}`,{config:J,elements:de,exportName:H}),alert("组件已保存到组件库")}catch(d){console.warn("保存组件失败：",d),alert("保存组件失败，请稍后重试")}}const Lt=ye(null);function sr(l){var c;const o=(c=l.target.files)==null?void 0:c[0];if(!o)return;const i=new FileReader;i.onload=()=>{const m=String(i.result);N.backgroundUrl=m;const p=new Image;p.onload=()=>{Lt.value={width:p.naturalWidth,height:p.naturalHeight},N.width=p.naturalWidth,N.height=p.naturalHeight},p.src=m},i.readAsDataURL(o)}function Gt(l){var o;return l&&((o=l.split(",")[0])!=null?o:"").trim().replace(/^['"]|['"]$/g,"")||null}function Rt(l){return{"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","image/avif":"avif","image/apng":"apng","image/x-icon":"ico","image/vnd.microsoft.icon":"ico","font/ttf":"ttf","font/otf":"otf","font/woff":"woff","font/woff2":"woff2","application/font-ttf":"ttf","application/font-otf":"otf","application/font-woff":"woff","application/font-woff2":"woff2","application/x-font-ttf":"ttf","application/x-font-otf":"otf","application/x-font-woff":"woff","application/x-font-woff2":"woff2","application/vnd.ms-fontobject":"eot","application/octet-stream":"bin"}[l]||"bin"}function hr(l){var c;const o=/\.([A-Za-z0-9]+)$/.exec(l||"");if(!o)return null;const i=((c=o[1])!=null?c:"").toLowerCase();return i?["png","jpg","jpeg","gif","svg","webp","avif","apng","ico"].includes(i)?i==="jpeg"?"jpg":i:["ttf","otf","woff","woff2","eot"].includes(i)?i:null:null}async function ar(l){try{const o="lowcode-icons",i="icons",c=await new Promise((m,p)=>{const M=indexedDB.open(o);M.onsuccess=()=>{const k=M.result;if(k.objectStoreNames.contains(i))m(k);else{const C=k.version+1;k.close();const I=indexedDB.open(o,C);I.onupgradeneeded=()=>{const d=I.result;d.objectStoreNames.contains(i)||d.createObjectStore(i,{keyPath:"id"})},I.onsuccess=()=>m(I.result),I.onerror=()=>p(I.error)}},M.onerror=()=>p(M.error)});return await new Promise((m,p)=>{const M=c.transaction(i,"readonly").objectStore(i).get(l);M.onsuccess=()=>m(M.result||null),M.onerror=()=>p(M.error)})}catch{return null}}function vr(l){var o,i,c,m,p,M,k,C;try{const I=new Uint8Array(l),d=String.fromCharCode((o=I[0])!=null?o:0,(i=I[1])!=null?i:0,(c=I[2])!=null?c:0,(m=I[3])!=null?m:0);return d==="wOFF"?"woff":d==="wOF2"?"woff2":d==="OTTO"?"otf":(((p=I[0])!=null?p:0)===0&&((M=I[1])!=null?M:0)===1&&((k=I[2])!=null?k:0)===0&&((C=I[3])!=null?C:0)===0||d==="true"||d==="typ1","ttf")}catch{return"ttf"}}async function Gr(l){const o=prompt("请输入导出名称",ie.value||"GeneratedComponent");if(o===null)return;const i=o.trim()||"GeneratedComponent";ie.value=i;function c(b){const h=new Set,R={};function j(_){let x=Date.now(),W=`${_}-${x}`;for(;h.has(W);)x+=1,W=`${_}-${x}`;return W}function D(_){const x=JSON.parse(JSON.stringify(_)),W=String(x.id);let E=W;return h.has(E)&&(E=j(String(x.type||"el"))),h.add(E),R[W]=E,x.id=E,(x.type==="group"||x.type==="container")&&Array.isArray(x.children)&&(x.children=x.children.map(ce=>D(ce))),x}return{normalized:b.map(_=>D(_)),remap:R}}const{normalized:m}=c(F.value),p=[],M=b=>{for(const h of b)(h.type==="group"||h.type==="container")&&Array.isArray(h.children)?M(h.children):h.type==="image"&&(h.src||h.iconId)&&p.push(h)};M(m);const k={},C=new Map;let I=0;for(const b of p)try{let h;if(b.src)h=await(await fetch(String(b.src))).blob();else if(b.iconId){const x=b.iconId,W=await ar(x);if(!W)throw new Error("icon record missing: "+x);h=new Blob([W.buffer],{type:String(W.mime||"image/png")})}else continue;let R=Rt(h.type);if(R==="bin"&&b.iconId){const x=b.iconId,W=await ar(x);if(W){const E=Rt(String(W.mime||"")),ce=hr(String(W.originalName||""));R=E!=="bin"?E:ce||R}R==="bin"&&(R="png")}const j=await h.arrayBuffer(),D=await crypto.subtle.digest("SHA-256",j),_=Array.from(new Uint8Array(D)).map(x=>x.toString(16).padStart(2,"0")).join("");if(C.has(_)){const{fileName:x}=C.get(_);k[b.id]=x}else{const x=`${i}_img_${I}.${R}`;C.set(_,{fileName:x,blob:h}),I++,k[b.id]=x}}catch(h){console.warn("导出图片失败：",h)}const d=Array.from(C.values());let u=null,G=null;if(N.backgroundUrl)try{const b=await(await fetch(String(N.backgroundUrl))).blob(),h=Rt(b.type);u=`${i}_bg.${h}`,G=b}catch(b){console.warn("导出背景图片失败：",b)}const H=new Set,de=Gt(N.globalFontFamily);de&&H.add(de);const ge=b=>{var h;for(const R of b)if((R.type==="group"||R.type==="container")&&Array.isArray(R.children))ge(R.children);else if(R.type==="text"){const j=Gt((h=R.style)==null?void 0:h.fontFamily);j&&H.add(j)}};ge(F.value);const ae=[],he=[];if(H.size>0)try{const b="lowcode-fonts",h="fonts",R=await new Promise((x,W)=>{const E=indexedDB.open(b);E.onsuccess=()=>{const ce=E.result;if(ce.objectStoreNames.contains(h))x(ce);else{const je=ce.version+1;ce.close();const ve=indexedDB.open(b,je);ve.onupgradeneeded=()=>{const Ie=ve.result;Ie.objectStoreNames.contains(h)||Ie.createObjectStore(h,{keyPath:"id"})},ve.onsuccess=()=>x(ve.result),ve.onerror=()=>W(ve.error)}},E.onerror=()=>W(E.error)}),j=await new Promise((x,W)=>{const E=R.transaction(h,"readonly").objectStore(h).getAll();E.onsuccess=()=>x(E.result),E.onerror=()=>W(E.error)}),D=$.value,_=D?j.filter(x=>x.projectId===D):j.filter(x=>!x.projectId);for(const x of _)if(H.has(x.name)){const W=new Blob([x.buffer],{type:x.mime});let E=Rt(x.mime);if(E==="bin")try{E=vr(x.buffer)}catch{E="ttf"}const ce=x.name.replace(/[^A-Za-z0-9_\-]/g,"_"),je=`${i}_${ce}.${E}`;ae.push({family:x.name,file:je}),he.push({file:je,blob:W})}}catch(b){console.warn("读取字体库失败：",b)}const xe=new ql.default,ee=xe.folder(i),te=ee.folder("imgs");for(const b of d)te.file(b.fileName,b.blob);G&&u&&te.file(u,G);const J=ee.folder("fonts");for(const b of he)J.file(b.file,b.blob);let re="";if(l==="vue2"){const b=Vl(i,N,m,{imageFileNames:d.map(h=>h.fileName),imageFileMap:k,backgroundFileName:G&&u?u:null,fontFaces:ae,hideDirective:"if"},Te.value);re=b.indexVue,ee.file("index.vue",re),b.files&&Object.entries(b.files).forEach(([h,R])=>{ee.file(h,R)})}else l==="vue3"?(re=Pl(i,N,m,{imageFileNames:d.map(b=>b.fileName),imageFileMap:k,backgroundFileName:G&&u?u:null,fontFaces:ae,hideDirective:"if"}),ee.file("index.vue",re)):l==="react"?(re=Jl(i,N,m,{imageFileNames:d.map(b=>b.fileName),imageFileMap:k,backgroundFileName:G&&u?u:null,fontFaces:ae}),ee.file("index.jsx",re),ee.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。")):(re=Wl(i,N,m,{imageFileNames:d.map(b=>b.fileName),imageFileMap:k,backgroundFileName:G&&u?u:null,fontFaces:ae}),ee.file("index.html",re));const Oe=await xe.generateAsync({type:"blob"});(0,_l.saveAs)(Oe,`${i}.zip`)}async function Tr(){const l=prompt("请输入导出名称",ie.value||"GeneratedComponent");if(l===null)return;const o=l.trim()||"GeneratedComponent";ie.value=o;const i=[],c=b=>{for(const h of b)(h.type==="group"||h.type==="container")&&Array.isArray(h.children)?c(h.children):h.type==="image"&&h.src&&i.push(h)};c(F.value);const m={},p=new Map;let M=0;for(const b of i)try{let h;if(b.src)h=await(await fetch(String(b.src))).blob();else if(b.iconId){const x=b.iconId,W=await ar(x);if(!W)throw new Error("icon record missing: "+x);h=new Blob([W.buffer],{type:String(W.mime||"image/png")})}else continue;let R=Rt(h.type);if(R==="bin"&&b.iconId){const x=b.iconId,W=await ar(x);if(W){const E=Rt(String(W.mime||"")),ce=hr(String(W.originalName||""));R=E!=="bin"?E:ce||R}R==="bin"&&(R="png")}const j=await h.arrayBuffer(),D=await crypto.subtle.digest("SHA-256",j),_=Array.from(new Uint8Array(D)).map(x=>x.toString(16).padStart(2,"0")).join("");if(p.has(_)){const{fileName:x}=p.get(_);m[b.id]=x}else{const x=`${o}_img_${M}.${R}`;p.set(_,{fileName:x,blob:h}),M++,m[b.id]=x}}catch(h){console.warn("导出图片失败：",h)}const k=Array.from(p.values());let C=null,I=null;if(N.backgroundUrl)try{const b=await(await fetch(String(N.backgroundUrl))).blob(),h=Rt(b.type);C=`${o}_bg.${h}`,I=b}catch(b){console.warn("导出背景图片失败：",b)}const d=new Set,u=Gt(N.globalFontFamily);u&&d.add(u);const G=b=>{var h;for(const R of b)if((R.type==="group"||R.type==="container")&&Array.isArray(R.children))G(R.children);else if(R.type==="text"){const j=Gt((h=R.style)==null?void 0:h.fontFamily);j&&d.add(j)}};G(F.value);const H=[],de=[];if(d.size>0)try{const b="lowcode-fonts",h="fonts",R=await new Promise((x,W)=>{const E=indexedDB.open(b);E.onsuccess=()=>{const ce=E.result;if(ce.objectStoreNames.contains(h))x(ce);else{const je=ce.version+1;ce.close();const ve=indexedDB.open(b,je);ve.onupgradeneeded=()=>{const Ie=ve.result;Ie.objectStoreNames.contains(h)||Ie.createObjectStore(h,{keyPath:"id"})},ve.onsuccess=()=>x(ve.result),ve.onerror=()=>W(ve.error)}},E.onerror=()=>W(E.error)}),j=await new Promise((x,W)=>{const E=R.transaction(h,"readonly").objectStore(h).getAll();E.onsuccess=()=>x(E.result),E.onerror=()=>W(E.error)}),D=$.value,_=D?j.filter(x=>x.projectId===D):j.filter(x=>!x.projectId);for(const x of _)if(d.has(x.name)){const W=new Blob([x.buffer],{type:x.mime});let E=Rt(x.mime);if(E==="bin")try{E=vr(x.buffer)}catch{E="ttf"}const ce=x.name.replace(/[^A-Za-z0-9_\-]/g,"_"),je=`${o}_${ce}.${E}`;H.push({family:x.name,file:je}),de.push({file:je,blob:W})}}catch(b){console.warn("读取字体库失败：",b)}const ge=new ql.default,ae=ge.folder(`${o}_all`),he=[],xe={imageFileNames:k.map(b=>b.fileName),imageFileMap:m,backgroundFileName:I&&C?C:null,fontFaces:H,hideDirective:"if"},ee=Vl(o,N,F.value,xe,Te.value);he.push({key:"vue2",file:"index.vue",content:ee.indexVue,files:ee.files});const te=Pl(o,N,F.value,xe);he.push({key:"vue3",file:"index.vue",content:te});const J=Jl(o,N,F.value,xe);he.push({key:"react",file:"index.jsx",content:J});const re=Wl(o,N,F.value,xe);he.push({key:"html",file:"index.html",content:re});for(const b of he){const h=ae.folder(b.key);h.file(b.file,b.content),b.files&&Object.entries(b.files).forEach(([D,_])=>{h.file(D,_)}),b.key==="react"&&h.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。");const R=h.folder("imgs");for(const D of k)R.file(D.fileName,D.blob);I&&C&&R.file(C,I);const j=h.folder("fonts");for(const D of de)j.file(D.file,D.blob)}const Oe=await ge.generateAsync({type:"blob"});(0,_l.saveAs)(Oe,`${o}-all.zip`)}function Dr(){confirm("确认清空当前画布与元素吗？")&&(F.value=[],f.value=null)}const dt=ye(1),tr=ye(null);function Ur(){dt.value=Math.min(2,+(dt.value+.1).toFixed(2))}function Lr(){dt.value=Math.max(.2,+(dt.value-.1).toFixed(2))}function $r(){const l=tr.value;if(!l)return;const o=l.clientWidth-16,i=l.clientHeight-16,c=o/N.width,m=i/N.height;dt.value=+Math.max(.2,Math.min(2,Math.min(c,m))).toFixed(2)}an(async()=>{$r(),await Ze()});const wr=ye([]);function Er(l){const o=JSON.parse(JSON.stringify(l));let i=Date.now();function c(p){return i+=1,`${p}-${i}`}function m(p){p.id=c(String(p.type||"el")),p.elementId&&(p.elementId=String(p.elementId)+"_"+String(i%1e3)),(p.type==="group"||p.type==="container")&&Array.isArray(p.children)&&p.children.forEach(M=>m(M))}return m(o),o.left=(l.left||0)+10,o.top=(l.top||0)+10,o.x=o.left,o.y=o.top,o.zIndex=(l.zIndex||1)+1,o}function Rr(){var m,p,M,k,C,I,d,u,G,H,de,ge,ae,he,xe;if(!Ft.value)return;let l=Ft.value;const o=at(l.id);o.parentGroup&&(l=o.parentGroup);const i=Er(l),{parentGroup:c}=at(l.id);if(c){const ee=Number((p=(m=c.left)!=null?m:c.x)!=null?p:0),te=Number((k=(M=c.top)!=null?M:c.y)!=null?k:0),J=Number((C=c.width)!=null?C:0),re=Number((I=c.height)!=null?I:0),Oe=ee+J,b=te+re,h=Number((d=l.width)!=null?d:0),R=Number((u=l.height)!=null?u:0);let j=h,D=R;if(!j||!D)if(l.type==="text"){const ve=Number((G=l.fontSize)!=null?G:16),Ie=String((de=(H=l.text)!=null?H:l.content)!=null?de:"").trim();j=Math.max(h||50,Math.round((Ie.length||2)*ve*.6)),D=Math.max(R||20,Math.round(ve*1.5))}else l.type==="image"?(j=h||200,D=R||150):l.type==="chart"?(j=h||240,D=R||160):l.type==="line"?(j=h||200,D=R||2):(j=h||100,D=R||60);const _=10,x=ee+J/2,W=te+re/2;let E=!1,ce=Oe+_,je=Math.round(W-D/2);if(!E&&ce+j<=N.width&&(i.left=Math.max(0,Math.min(ce,Math.max(0,N.width-j))),i.top=Math.max(0,Math.min(je,Math.max(0,N.height-D))),E=!0),ce=ee-j-_,je=Math.round(W-D/2),!E&&ce>=0&&(i.left=Math.max(0,Math.min(ce,Math.max(0,N.width-j))),i.top=Math.max(0,Math.min(je,Math.max(0,N.height-D))),E=!0),ce=Math.round(x-j/2),je=b+_,!E&&je+D<=N.height&&(i.left=Math.max(0,Math.min(ce,Math.max(0,N.width-j))),i.top=Math.max(0,Math.min(je,Math.max(0,N.height-D))),E=!0),ce=Math.round(x-j/2),je=te-D-_,!E&&je>=0&&(i.left=Math.max(0,Math.min(ce,Math.max(0,N.width-j))),i.top=Math.max(0,Math.min(je,Math.max(0,N.height-D))),E=!0),!E){const ve=Number((ae=(ge=l.left)!=null?ge:l.x)!=null?ae:0),Ie=Number((xe=(he=l.top)!=null?he:l.y)!=null?xe:0),Be=ee+ve+_,We=te+Ie+_;i.left=Math.max(0,Math.min(Math.round(Be),Math.max(0,N.width-j))),i.top=Math.max(0,Math.min(Math.round(We),Math.max(0,N.height-D)))}i.x=i.left,i.y=i.top}Q(),F.value.push(i),f.value=i.id}const ir=ye(!1),cr=ye([]),pr=ye(""),gr=ye(!1),kr=Xe(()=>{const l=pr.value.trim().toLowerCase();return l?cr.value.filter(o=>o.name.toLowerCase().includes(l)||(o.description||"").toLowerCase().includes(l)||Array.isArray(o.tags)&&o.tags.some(i=>i.toLowerCase().includes(l))):cr.value});async function Sr(){try{gr.value=!0,await ct.init(),cr.value=(await ct.getAllComponents()||[]).sort((l,o)=>(o.updatedAt||0)-(l.updatedAt||0))}catch(l){console.warn("加载组件缓存失败：",l)}finally{gr.value=!1}}async function Vr(){await Sr(),ir.value=!0}function Mr(){ir.value=!1}const Ht=ye(!1);let kt=null;function Pr(){Ht.value=!0,kt&&(clearTimeout(kt),kt=null)}function Wr(){kt&&clearTimeout(kt),kt=setTimeout(()=>{Ht.value=!1,kt=null},120)}function Hr(){Ht.value=!0,kt&&(clearTimeout(kt),kt=null)}function Jr(){Ht.value=!1,kt&&(clearTimeout(kt),kt=null)}function _r(l){const o=[],i=[],c=[],m=[];function p(d){var H,de,ge,ae,he;const u=Number(d.width||0),G=Number(d.height||0);if(u>0&&G>0)return{w:u,h:G};if(d.type==="text"){const xe=Number((H=d.fontSize)!=null?H:16),ee=String((de=d.text)!=null?de:"").trim(),te=Math.max(50,Math.round((ee.length||2)*xe*.6)),J=Math.max(20,Math.round(xe*1.5));return{w:u||te,h:G||J}}if(d.type==="image")return{w:u||100,h:G||100};if(d.type==="chart")return{w:u||240,h:G||160};if(d.type==="line"){const xe=Number((ae=(ge=d.style)==null?void 0:ge.lineThickness)!=null?ae:2);return(((he=d.style)==null?void 0:he.lineOrientation)||"horizontal")==="vertical"?{w:u||xe,h:G||100}:{w:u||100,h:G||xe}}return{w:u||50,h:G||20}}for(const d of l){const u=Number(d.left||d.x||0),G=Number(d.top||d.y||0),{w:H,h:de}=p(d);o.push(u),i.push(G),c.push(u+(H||0)),m.push(G+(de||0))}const M=o.length?Math.min(...o):0,k=i.length?Math.min(...i):0,C=c.length?Math.max(...c):M,I=m.length?Math.max(...m):k;return{minX:M,minY:k,maxX:C,maxY:I,width:Math.max(0,C-M),height:Math.max(0,I-k)}}async function qr(l){var o,i,c,m,p,M,k,C,I,d;try{const u=await Nr(`component-${l.id}`),G=JSON.parse(JSON.stringify((u==null?void 0:u.elements)||l.elements||[]));if(!G||G.length===0){console.warn("该组件没有可插入的元素");return}let H=Date.now();const de=D=>{D.id=`${D.type||"el"}-${H++}-${Math.random().toString(36).slice(2,8)}`,(D.type==="chart"||D.type==="container")&&D.elementId&&(D.elementId=String(D.elementId)+"_"+String(H%1e3)),(D.type==="group"||D.type==="container")&&Array.isArray(D.children)&&D.children.forEach(_=>de(_))},ge=tr.value,ae=dt.value||1,he=(o=ge==null?void 0:ge.clientWidth)!=null?o:0,xe=(i=ge==null?void 0:ge.clientHeight)!=null?i:0,ee=ge?(ge.scrollLeft+he/2)/ae:20,te=ge?(ge.scrollTop+xe/2)/ae:20,J=_r(G),re=J.minX+J.width/2,Oe=J.minY+J.height/2,b=Math.round(ee-re),h=Math.round(te-Oe),R=F.value.reduce((D,_)=>Math.max(D,Number(_.zIndex||0)),0);let j=null;if(G.length===1){const D=G[0];if(!D){console.warn("单元素组件插入失败：源元素不存在");return}const x=JSON.parse(JSON.stringify(D));de(x);const W=Number((m=(c=x.left)!=null?c:x.x)!=null?m:0),E=Number((M=(p=x.top)!=null?p:x.y)!=null?M:0);x.left=Math.round(W+b),x.top=Math.round(E+h),x.x=x.left,x.y=x.top;const{w:ce,h:je}=(function(){var Be,We,ht,yt,St;const ve=Number(x.width||0),Ie=Number(x.height||0);if(ve>0&&Ie>0)return{w:ve,h:Ie};if(x.type==="text"){const ut=Number((Be=x.fontSize)!=null?Be:16),jt=String((We=x.text)!=null?We:"").trim(),vt=Math.max(50,Math.round((jt.length||2)*ut*.6)),Jt=Math.max(20,Math.round(ut*1.5));return{w:ve||vt,h:Ie||Jt}}if(x.type==="image")return{w:ve||100,h:Ie||100};if(x.type==="chart")return{w:ve||240,h:Ie||160};if(x.type==="line"){const ut=Number((yt=(ht=x.style)==null?void 0:ht.lineThickness)!=null?yt:2);return(((St=x.style)==null?void 0:St.lineOrientation)||"horizontal")==="vertical"?{w:ve||ut,h:Ie||100}:{w:ve||100,h:Ie||ut}}return{w:ve||50,h:Ie||20}})();if(x.width=ce,x.height=je,x.type==="image"&&!(x.src||"").startsWith("data:")&&x.iconId)try{dr(x.iconId).then(ve=>{ve&&(x.src=ve)}).catch(()=>{})}catch{}x.zIndex=Math.max(1,R+1),Q(),F.value=F.value.concat(x),f.value=x.id,j=x.id}else{const D=`group-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,_=[];for(const W of G){const E=JSON.parse(JSON.stringify(W));de(E);const ce=Number((C=(k=E.left)!=null?k:E.x)!=null?C:0),je=Number((d=(I=E.top)!=null?I:E.y)!=null?d:0);E.left=Math.round(ce-J.minX),E.top=Math.round(je-J.minY),E.x=E.left,E.y=E.top;const{w:ve,h:Ie}=(function(){var ht,yt,St,ut,jt;const Be=Number(E.width||0),We=Number(E.height||0);if(Be>0&&We>0)return{w:Be,h:We};if(E.type==="text"){const vt=Number((ht=E.fontSize)!=null?ht:16),Jt=String((yt=E.text)!=null?yt:"").trim(),xr=Math.max(50,Math.round((Jt.length||2)*vt*.6)),Zr=Math.max(20,Math.round(vt*1.5));return{w:Be||xr,h:We||Zr}}if(E.type==="image")return{w:Be||100,h:We||100};if(E.type==="chart")return{w:Be||240,h:We||160};if(E.type==="line"){const vt=Number((ut=(St=E.style)==null?void 0:St.lineThickness)!=null?ut:2);return(((jt=E.style)==null?void 0:jt.lineOrientation)||"horizontal")==="vertical"?{w:Be||vt,h:We||100}:{w:Be||100,h:We||vt}}return{w:Be||50,h:We||20}})();if(E.width=ve,E.height=Ie,E.type==="image"&&!(E.src||"").startsWith("data:")&&E.iconId)try{dr(E.iconId).then(Be=>{Be&&(E.src=Be)}).catch(()=>{})}catch{}_.push(E)}const x={id:D,type:"group",left:Math.round(J.minX+b),top:Math.round(J.minY+h),width:Math.max(1,Math.round(J.width)),height:Math.max(1,Math.round(J.height)),zIndex:Math.max(1,R+1),className:l.name?`component-${l.name.replace(/[^A-Za-z0-9_-]/g,"-")}`:void 0,children:_,componentId:l.id,editable:!0,style:{backgroundColor:"transparent"}};Q(),F.value=F.value.concat(x),f.value=x.id,j=D}try{if(j){const D=await ct.getFontsByComponentId(l.id);if(Array.isArray(D)&&D.length>0){let _=document.getElementById(`component-fonts-${j}`);_||(_=document.createElement("style"),_.id=`component-fonts-${j}`,document.head.appendChild(_));const x=[];for(const W of D){const E=String(W.name||"").replace(/[^A-Za-z0-9_\-]/g,"_"),ce=W.bufferBase64;ce&&x.push(`@font-face { font-family: '${E}'; src: url('${ce}'); font-weight: normal; font-style: normal; font-display: swap; }`)}_.textContent=x.join(`
`)}}}catch(D){console.warn("注入组件字体失败：",D)}try{if(j){const D=await ct.getDatabaseObjectsByComponentId(l.id);Array.isArray(D)&&D.length>0&&ft(j,D.map(_=>({name:_.name,content:_.content})))}}catch(D){console.warn("注入组件数据库对象失败：",D)}await ct.incrementUsageCount(l.id),ir.value=!1}catch(u){console.warn("插入组件失败：",u)}}const Cr=()=>$.value?`lowcode-builder-state-${$.value}`:"lowcode-builder-state-v1",fr=()=>$.value?n.isComponent?`component-${$.value}`:`project-${$.value}`:"default";async function yr(l,o){try{const i=JSON.parse(JSON.stringify(o));if(l.startsWith("component-")){const c=l.replace(/^component-/,"");await ct.saveBuilderStateForComponent(c,i)}else if(l.startsWith("project-")){const c=l.replace(/^project-/,"");await ct.saveBuilderStateForProject(c,i)}else await ct.saveBuilderStateForProject(l,i)}catch(i){console.warn("保存构建器状态失败：",i)}}async function Nr(l){try{if(l.startsWith("component-")){const o=l.replace(/^component-/,"");return await ct.getBuilderStateForComponent(o)}else if(l.startsWith("project-")){const o=l.replace(/^project-/,"");return await ct.getBuilderStateForProject(o)}return await ct.getBuilderStateForProject(l)}catch(o){return console.warn("恢复构建器状态失败：",o),null}}let mr=null;function br(){mr&&clearTimeout(mr),mr=setTimeout(()=>{const l={config:N,elements:F.value,exportName:ie.value,version:sn};try{const o=async()=>{if(await yr(fr(),l),n.isComponent&&$.value)try{const i=String($.value),c=await ct.getComponent(i),m={id:i,name:ie.value||(c==null?void 0:c.name)||"未命名组件",description:(c==null?void 0:c.description)||"",tags:(c==null?void 0:c.tags)||[],elements:F.value,config:N,usageCount:(c==null?void 0:c.usageCount)||0,createdAt:(c==null?void 0:c.createdAt)||Date.now(),updatedAt:Date.now()};await ct.saveComponent(JSON.parse(JSON.stringify(m))),jr()}catch(i){console.warn("同步保存组件记录失败：",i)}};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{o()}):o()}catch(o){console.warn("保存失败：",o)}},400)}Dt(N,br,{deep:!0}),Dt(F,br,{deep:!0}),Dt(ie,br),Dt(F,()=>{Nt()},{deep:!0});async function Yr(){try{const l="lowcode-icons",o="icons",i=await new Promise((p,M)=>{const k=indexedDB.open(l);k.onsuccess=()=>{const C=k.result;if(C.objectStoreNames.contains(o))p(C);else{const I=C.version+1;C.close();const d=indexedDB.open(l,I);d.onupgradeneeded=()=>{const u=d.result;u.objectStoreNames.contains(o)||u.createObjectStore(o,{keyPath:"id"})},d.onsuccess=()=>p(d.result),d.onerror=()=>M(d.error)}},k.onerror=()=>M(k.error)}),c=await new Promise((p,M)=>{const k=i.transaction(o,"readonly").objectStore(o).getAll();k.onsuccess=()=>p(k.result),k.onerror=()=>M(k.error)}),m=$.value;wr.value=(m?c.filter(p=>p.projectId===m):c.filter(p=>!p.projectId)).map(p=>{const M=new Blob([p.buffer],{type:p.mime}),k=URL.createObjectURL(M);return{id:p.id,url:k,name:p.name}})}catch(l){console.warn("图标库初始化失败：",l)}}async function dr(l){try{const o="lowcode-icons",i="icons",c=await new Promise((M,k)=>{const C=indexedDB.open(o);C.onsuccess=()=>{const I=C.result;if(I.objectStoreNames.contains(i))M(I);else{const d=I.version+1;I.close();const u=indexedDB.open(o,d);u.onupgradeneeded=()=>{const G=u.result;G.objectStoreNames.contains(i)||G.createObjectStore(i,{keyPath:"id"})},u.onsuccess=()=>M(u.result),u.onerror=()=>k(u.error)}},C.onerror=()=>k(C.error)}),m=await new Promise((M,k)=>{const C=c.transaction(i,"readonly").objectStore(i).get(l);C.onsuccess=()=>M(C.result),C.onerror=()=>k(C.error)});if(!m||!m.buffer)return null;const p=new Blob([m.buffer],{type:m.mime||"application/octet-stream"});return await new Promise((M,k)=>{const C=new FileReader;C.onload=()=>M(String(C.result)),C.onerror=()=>k(C.error),C.readAsDataURL(p)})}catch(o){return console.warn("读取图标数据失败：",o),null}}async function Ir(){const l=F.value.filter(o=>o.type==="image");for(const o of l){if((o.src||"").startsWith("data:")||!o.iconId)continue;const i=await dr(o.iconId);i&&(o.src=i)}}async function Xr(){try{const l="lowcode-fonts",o="fonts",i=await new Promise((m,p)=>{const M=indexedDB.open(l);M.onsuccess=()=>{const k=M.result;if(k.objectStoreNames.contains(o))m(k);else{const C=k.version+1;k.close();const I=indexedDB.open(l,C);I.onupgradeneeded=()=>{const d=I.result;d.objectStoreNames.contains(o)||d.createObjectStore(o,{keyPath:"id"})},I.onsuccess=()=>m(I.result),I.onerror=()=>p(I.error)}},M.onerror=()=>p(M.error)}),c=await new Promise((m,p)=>{const M=i.transaction(o,"readonly").objectStore(o).getAll();M.onsuccess=()=>m(M.result),M.onerror=()=>p(M.error)});if(c.length>0){let m=document.querySelector("style[data-font-lib]");m||(m=document.createElement("style"),m.setAttribute("data-font-lib",""),document.head.appendChild(m));const p=[],M=[],k=$.value,C=k?c.filter(d=>d.projectId===k):c.filter(d=>!d.projectId);for(const d of C){const u=new Blob([d.buffer],{type:d.mime}),G=URL.createObjectURL(u),H=d.name;M.push(H),p.push(`@font-face { font-family: '${H}'; src: url('${G}'); font-weight: normal; font-style: normal; }`)}m.textContent=p.join(`
`);const I=new Set([...$e.value,...M]);$e.value=Array.from(I)}}catch(l){console.warn("字体库初始化失败：",l)}}function Ar(l){const o=new Set,i=new Set,c=m=>{m.forEach(p=>{if((!p.id||o.has(p.id))&&(p.id=`${p.type||"el"}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`),o.add(p.id),p.elementId){const M=p.elementId.trim();if(i.has(M)){let k=2,C=`${M}_${k}`;for(;i.has(C);)k++,C=`${M}_${k}`;p.elementId=C}i.add(p.elementId)}(p.type==="group"||p.type==="container")&&Array.isArray(p.children)&&c(p.children)})};c(l)}an(async()=>{await P(),await Xr(),await Yr();try{if(n.isComponent&&$.value){const l=String($.value);if(!await ct.getComponent(l)){const o={id:l,name:ie.value||"未命名组件",description:"",tags:[],elements:[],config:N,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await ct.saveComponent(JSON.parse(JSON.stringify(o)))}}}catch(l){console.warn("预创建组件记录失败：",l)}try{const l=await Nr(fr());if(l){l.config&&Object.assign(N,l.config),Array.isArray(l.elements)&&(F.value=l.elements),typeof l.exportName=="string"&&l.exportName&&(ie.value=l.exportName),await Ir();try{F.value=F.value.map(o=>{if(o.type==="chart"&&o.style&&typeof o.style.border=="string"&&o.style.border.includes("dashed")){const i={...o,style:{...o.style}};return delete i.style.border,i}return o})}catch{}l.version!==sn&&Ar(F.value)}else{const o=localStorage.getItem(Cr());if(o){const i=JSON.parse(o);i&&i.config&&Object.assign(N,i.config),Array.isArray(i==null?void 0:i.elements)&&(F.value=i.elements),typeof(i==null?void 0:i.exportName)=="string"&&i.exportName&&(ie.value=i.exportName),await Ir();try{F.value=F.value.map(c=>{if(c.type==="chart"&&c.style&&typeof c.style.border=="string"&&c.style.border.includes("dashed")){const m={...c,style:{...c.style}};return delete m.style.border,m}return c})}catch{}Ar(F.value),await yr(fr(),{config:N,elements:F.value,exportName:ie.value,version:sn});try{localStorage.removeItem(Cr())}catch{}}}}catch(l){console.warn("恢复失败：",l)}Nt(),window.addEventListener("keydown",ot),window.addEventListener("keyup",Ke)}),dn(()=>{window.removeEventListener("keydown",ot),window.removeEventListener("keyup",Ke),jr()});let Fr=0;async function Kr(l,o){var i,c,m;try{const p=N.width||l.clientWidth||800,M=N.height||l.clientHeight||600,k=(i=o==null?void 0:o.maxWidth)!=null?i:420,C=(c=o==null?void 0:o.scale)!=null?c:Math.min(1,k/p),I=(m=o==null?void 0:o.quality)!=null?m:.85,d=l.cloneNode(!0);d.style.transform="none",d.style.transformOrigin="top left",d.style.width=`${p}px`,d.style.height=`${M}px`;const u=new XMLSerializer().serializeToString(d),G=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${Math.round(p*C)}" height="${Math.round(M*C)}">
  <foreignObject width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml" style="transform: scale(${C}); transform-origin: top left;">${u}</div>
  </foreignObject>
</svg>`,H="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(G),de=new Image;return await new Promise(ge=>{de.onload=()=>{try{const ae=document.createElement("canvas");ae.width=de.width,ae.height=de.height;const he=ae.getContext("2d");if(!he)return ge(null);he.drawImage(de,0,0);const xe=ae.toDataURL("image/jpeg",I);ge(xe)}catch{ge(null)}},de.onerror=()=>ge(null),de.src=H})}catch{return null}}async function jr(){try{const l=Date.now();if(l-Fr<5e3||(Fr=l,!n.isComponent||!$.value))return;const o=tr.value;if(!o)return;const i=o.firstElementChild;if(!i)return;const c=await Kr(i,{maxWidth:420,quality:.8});if(!c)return;const m=String($.value),p=await ct.getComponent(m);if(!p)return;const M={...p,previewDataUrl:c,updatedAt:Date.now()};await ct.saveComponent(JSON.parse(JSON.stringify(M)))}catch(l){console.warn("生成缩略图失败：",l)}}return(l,o)=>{var i,c,m,p,M,k,C,I;return z(),B(rr,null,[r("div",gu,[o[33]||(o[33]=tn('<div class="absolute inset-0 opacity-10" data-v-8c7c5bc3><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-8c7c5bc3></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-8c7c5bc3></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-8c7c5bc3></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-8c7c5bc3></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-8c7c5bc3></div>',2)),r("div",fu,[$t(xs,{exportName:ie.value,config:N,fontLibrary:$e.value,spacingEnabled:wt.value,alignmentEnabled:xt.value,"onUpdate:exportName":o[0]||(o[0]=d=>ie.value=d),"onUpdate:configWidth":o[1]||(o[1]=d=>N.width=d),"onUpdate:configHeight":o[2]||(o[2]=d=>N.height=d),"onUpdate:backgroundColor":o[3]||(o[3]=d=>N.backgroundColor=d),"onUpdate:globalFontFamily":o[4]||(o[4]=d=>N.globalFontFamily=d),"onUpdate:globalFontSize":o[5]||(o[5]=d=>N.globalFontSize=d),"onUpdate:globalColor":o[6]||(o[6]=d=>N.globalColor=d),"onUpdate:spacingEnabled":o[7]||(o[7]=d=>wt.value=d),"onUpdate:alignmentEnabled":o[8]||(o[8]=d=>xt.value=d),onBackgroundFileChange:sr,onOpenPreview:le,onDownloadByFormat:o[9]||(o[9]=d=>Gr(d)),onDownloadAllFormats:Tr,onResetCanvas:Dr,elements:F.value,selectedId:f.value,onSelectElement:o[10]||(o[10]=d=>oe(d)),onReorderTopElements:o[11]||(o[11]=d=>be(d.from,d.to))},null,8,["exportName","config","fontLibrary","spacingEnabled","alignmentEnabled","elements","selectedId"]),r("div",yu,[r("div",mu,[r("div",bu,[r("div",xu,[r("button",{onMouseenter:Pr,onMouseleave:Wr,onClick:o[12]||(o[12]=d=>Ht.value=!0),class:"px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"}," 插入元素 ",32),me(r("div",{onMouseenter:Hr,onMouseleave:Jr,class:"absolute left-0 top-full w-72 p-3 bg-gray-900/95 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl z-50"},[r("div",hu,[r("button",{onClick:o[13]||(o[13]=d=>Ct("text")),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded"},"文本"),r("button",{onClick:o[14]||(o[14]=d=>Ct("arc-text")),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-indigo-600 hover:from-cyan-500 hover:to-indigo-500 text-white rounded"},"环绕文字"),r("button",{onClick:o[15]||(o[15]=d=>Ct("image")),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500 text-white rounded"},"图片"),r("button",{onClick:o[16]||(o[16]=d=>Ct("chart")),class:"px-3 py-2 text-xs bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-500 hover:to-red-500 text-white rounded"},"图表"),r("button",{onClick:o[17]||(o[17]=d=>Ct("line")),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"线条"),r("button",{onClick:o[18]||(o[18]=d=>Ct("container")),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded col-span-2"},"容器")])],544),[[uo,Ht.value]])]),r("button",{onClick:o[19]||(o[19]=d=>It.value=!0),class:"px-4 py-2 bg-gradient-to-r from-gray-600 to-slate-700 hover:from-gray-500 hover:to-slate-600 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-gray-500/25"}," 隐藏元素 "),r("button",{onClick:Vr,class:"px-4 py-2 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-pink-500/25"}," 插入组件 ")]),r("div",vu,[r("button",{onClick:Lr,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[31]||(o[31]=[r("span",{class:"text-gray-300"},"-",-1)])]),r("span",$u,mt(Math.round(dt.value*100))+"%",1),r("button",{onClick:Ur,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[32]||(o[32]=[r("span",{class:"text-gray-300"},"+",-1)])]),r("button",{onClick:$r,class:"px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg text-xs text-gray-300 transition-colors duration-200"}," 适应 ")])]),r("div",{ref_key:"canvasScrollRef",ref:tr,class:"flex-1 overflow-auto bg-gray-800/30 p-4 min-h-0 custom-scrollbar"},[r("div",{ref_key:"canvasContentRef",ref:er,class:"relative border border-gray-600/50 bg-gray-100 shadow-2xl mx-auto",onMousedown:Kl(ke,["self"]),style:Mt({width:`${N.width}px`,height:`${N.height}px`,backgroundColor:N.backgroundColor||"transparent",backgroundImage:N.backgroundUrl?`url(${N.backgroundUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`scale(${dt.value})`,transformOrigin:"top left"})},[Le.value?(z(),B("div",wu,[Ee.value.left?(z(),B("div",{key:0,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:Mt([{"border-width":"0.5px"},{left:`${Ae.value.left}px`}])},null,4)):K("",!0),Ee.value.right?(z(),B("div",{key:1,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:Mt([{"border-width":"0.5px"},{left:`${Ae.value.right}px`}])},null,4)):K("",!0),Ee.value.top?(z(),B("div",{key:2,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:Mt([{"border-width":"0.5px"},{top:`${Ae.value.top}px`}])},null,4)):K("",!0),Ee.value.bottom?(z(),B("div",{key:3,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:Mt([{"border-width":"0.5px"},{top:`${Ae.value.bottom}px`}])},null,4)):K("",!0),Ee.value.centerV?(z(),B("div",{key:4,class:"absolute top-0 bottom-0 border-l border-dashed border-blue-400/60",style:Mt([{"border-width":"0.5px"},{left:`${Ae.value.centerX}px`}])},null,4)):K("",!0),Ee.value.centerH?(z(),B("div",{key:5,class:"absolute left-0 right-0 border-t border-dashed border-blue-400/60",style:Mt([{"border-width":"0.5px"},{top:`${Ae.value.centerY}px`}])},null,4)):K("",!0)])):K("",!0),wt.value&&(X.value.left||X.value.right||X.value.up||X.value.down)?(z(),B("div",Eu,[X.value.left&&rt.value!=="left"?(z(),B("div",{key:0,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Mt({left:`${X.value.left.x-14}px`,top:`${X.value.left.y-14}px`}),onDblclick:o[20]||(o[20]=d=>Pt("left"))},mt(X.value.left.gap)+"px ",37)):K("",!0),X.value.right&&rt.value!=="right"?(z(),B("div",{key:1,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Mt({left:`${X.value.right.x-14}px`,top:`${X.value.right.y-14}px`}),onDblclick:o[21]||(o[21]=d=>Pt("right"))},mt(X.value.right.gap)+"px ",37)):K("",!0),X.value.up&&rt.value!=="up"?(z(),B("div",{key:2,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Mt({left:`${X.value.up.x-14}px`,top:`${X.value.up.y-18}px`}),onDblclick:o[22]||(o[22]=d=>Pt("up"))},mt(X.value.up.gap)+"px ",37)):K("",!0),X.value.down&&rt.value!=="down"?(z(),B("div",{key:3,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Mt({left:`${X.value.down.x-14}px`,top:`${X.value.down.y-18}px`}),onDblclick:o[23]||(o[23]=d=>Pt("down"))},mt(X.value.down.gap)+"px ",37)):K("",!0),rt.value==="left"?me((z(),B("input",{key:4,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Mt({left:`${(((i=X.value.left)==null?void 0:i.x)||0)-28}px`,top:`${(((c=X.value.left)==null?void 0:c.y)||0)-14}px`}),"onUpdate:modelValue":o[24]||(o[24]=d=>nt.value=d),onKeydown:Qr(Wt,["enter"])},null,36)),[[Ce,nt.value,void 0,{number:!0}]]):K("",!0),rt.value==="right"?me((z(),B("input",{key:5,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Mt({left:`${(((m=X.value.right)==null?void 0:m.x)||0)-28}px`,top:`${(((p=X.value.right)==null?void 0:p.y)||0)-14}px`}),"onUpdate:modelValue":o[25]||(o[25]=d=>nt.value=d),onKeydown:Qr(Wt,["enter"])},null,36)),[[Ce,nt.value,void 0,{number:!0}]]):K("",!0),rt.value==="up"?me((z(),B("input",{key:6,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Mt({left:`${(((M=X.value.up)==null?void 0:M.x)||0)-28}px`,top:`${(((k=X.value.up)==null?void 0:k.y)||0)-18}px`}),"onUpdate:modelValue":o[26]||(o[26]=d=>nt.value=d),onKeydown:Qr(Wt,["enter"])},null,36)),[[Ce,nt.value,void 0,{number:!0}]]):K("",!0),rt.value==="down"?me((z(),B("input",{key:7,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Mt({left:`${(((C=X.value.down)==null?void 0:C.x)||0)-28}px`,top:`${(((I=X.value.down)==null?void 0:I.y)||0)-18}px`}),"onUpdate:modelValue":o[27]||(o[27]=d=>nt.value=d),onKeydown:Qr(Wt,["enter"])},null,36)),[[Ce,nt.value,void 0,{number:!0}]]):K("",!0)])):K("",!0),(z(!0),B(rr,null,ur(F.value,d=>(z(),nn(go,{key:d.id,element:d,selected:d.id===f.value,"selected-id":f.value,config:N,zoom:dt.value,dbMap:Te.value,"metrics-map":L.value,onSelect:s,"onUpdate:position":_t,"onUpdate:size":qt,onShowGuidelines:Qt,onHideGuidelines:Vt,onReportMetrics:pt,onDragEnd:lr},null,8,["element","selected","selected-id","config","zoom","dbMap","metrics-map"]))),128))],36)],512)]),$t(pu,{selectedEl:Ft.value,config:N,fontLibrary:$e.value,fontSizeLibrary:ne.value,fontWeightOptions:fe.value,fontStyleOptions:se.value,databaseObjects:v.value,dbMap:Te.value,iconLibrary:wr.value,defaultChartOption:gt,safeHex:Re,initCustomClassSkeleton:Fe,refreshAllCustomClassCss:Nt,removeCustomClassCssForElement:Et,getIconDataUrlById:dr,onDuplicateSelected:Rr,onRemoveSelected:lt,onSaveSelectedAsComponent:Xt},null,8,["selectedEl","config","fontLibrary","fontSizeLibrary","fontWeightOptions","fontStyleOptions","databaseObjects","dbMap","iconLibrary"])])]),ir.value?(z(),B("div",ku,[r("div",{class:"absolute inset-0 bg-black/60",onClick:Mr}),r("div",Su,[r("div",{class:"flex items-center justify-between p-4 border-b border-fuchsia-500/30 bg-gradient-to-r from-fuchsia-600/20 to-pink-600/20"},[o[34]||(o[34]=r("h3",{class:"text-lg font-bold text-pink-300"},"插入组件",-1)),r("button",{onClick:Mr,class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",Mu,[r("div",Cu,[me(r("input",{"onUpdate:modelValue":o[28]||(o[28]=d=>pr.value=d),type:"text",placeholder:"搜索名称、描述或标签",class:"flex-1 px-3 py-2 bg-gray-800/60 border border-fuchsia-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-fuchsia-400 focus:ring-1 focus:ring-fuchsia-400 focus:outline-none transition-all duration-200"},null,512),[[Ce,pr.value]]),r("button",{onClick:Sr,class:"px-3 py-2 bg-pink-600/70 hover:bg-pink-600 text-white rounded"},"刷新")]),gr.value?(z(),B("div",Nu,"正在加载组件...")):(z(),B("div",Iu,[kr.value.length===0?(z(),B("div",Au,"暂无匹配的组件")):(z(),B("div",Fu,[(z(!0),B(rr,null,ur(kr.value,d=>(z(),B("div",{key:d.id,class:"bg-gray-800/60 border border-pink-500/20 rounded-lg overflow-hidden"},[r("div",ju,[d.previewDataUrl?(z(),B("img",{key:0,src:d.previewDataUrl,alt:"预览",class:"max-w-full max-h-full object-contain"},null,8,zu)):(z(),B("div",Ou,"无预览"))]),r("div",Bu,[r("div",Gu,[r("div",{class:"text-sm text-gray-100 font-medium truncate",title:d.name},mt(d.name),9,Tu),r("div",Du,mt(d.usageCount||0)+" 次",1)]),r("div",Uu,[(z(!0),B(rr,null,ur(d.tags||[],u=>(z(),B("span",{key:u,class:"px-1.5 py-0.5 text-[10px] rounded bg-pink-600/30 text-pink-200"},mt(u),1))),128))]),r("div",Lu,[r("button",{onClick:u=>qr(d),class:"w-full px-3 py-1.5 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded text-sm transition"}," 插入到画布 ",8,Ru)])])]))),128))]))]))])])])):K("",!0),It.value?(z(),B("div",Vu,[r("div",{class:"absolute inset-0 bg-black/60",onClick:o[29]||(o[29]=d=>It.value=!1)}),r("div",Pu,[r("div",Wu,[o[35]||(o[35]=r("h3",{class:"text-lg font-bold text-cyan-300"},"隐藏元素列表",-1)),r("button",{onClick:o[30]||(o[30]=d=>It.value=!1),class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",Hu,[Ut.value.length===0?(z(),B("div",Ju,"暂无隐藏元素")):(z(),B("div",_u,[(z(!0),B(rr,null,ur(Ut.value,d=>(z(),B("div",{key:d.id,class:"flex items-center justify-between bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2"},[r("div",{class:"text-sm text-gray-100 truncate",title:d.hiddenLabel||d.className||d.id},mt(d.hiddenLabel||d.className||d.id),9,qu),r("button",{onClick:u=>Yt(d.id),class:"px-3 py-1 bg-cyan-600/70 hover:bg-cyan-600 text-white rounded text-sm"},"取消隐藏并定位",8,Yu)]))),128))]))])])])):K("",!0)],64)}}}),Zu=un(Ku,[["__scopeId","data-v-8c7c5bc3"]]),Qu=Zt({__name:"index",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(y){const n=y;return(e,g)=>(z(),nn(Zu,{"project-id":n.projectId,"current-project":n.currentProject,"is-component":n.isComponent},null,8,["project-id","current-project","is-component"]))}}),ac=Qu;export{ac as default};
