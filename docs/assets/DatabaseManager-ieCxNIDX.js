import{E as n,I as v,L as E,O as P,P as F,R as c,_ as R,c as Z,d as u,f as i,h as C,l as t,lt as m,m as q,o as H,st as k,w as Q}from"./codemirror-B25QCqWr.js";import{f,h as G}from"./vendor-vue-C93_ecI2.js";import{n as _,t as K}from"./index-BvtxZ7eM.js";import"./componentStorage-k4mRdpgu.js";import{t as W}from"./useProjectResources-BTYOD2BO.js";var X={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},Y={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},ee={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},te={class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},ae={class:"flex items-center justify-between"},re={class:"flex gap-2"},se={class:"p-4 space-y-2 overflow-y-auto flex-1 custom-scrollbar"},oe={class:"mb-4"},le={key:0,class:"text-center text-gray-400 py-8"},ne=["onClick"],ie={class:"flex items-center justify-between"},de={class:"flex-1 min-w-0"},ue={class:"flex items-center gap-2 mb-1"},ce={class:"text-sm font-medium text-white truncate"},pe={key:0,class:"text-xs text-gray-400 truncate"},ve=["onClick"],fe={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},ge={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},xe={class:"text-lg font-bold text-purple-300 flex items-center gap-2"},be={key:0,class:"flex gap-2"},ye={class:"flex-1 overflow-y-auto p-4 custom-scrollbar"},me={key:0,class:"flex items-center justify-center h-full text-gray-400"},he={key:1,class:"space-y-6"},we={class:"space-y-4"},ke={class:"grid grid-cols-2 gap-4"},_e={class:"space-y-2"},Oe={class:"space-y-2"},Se={class:"space-y-4"},je={class:"space-y-2"},Ce={key:0,class:"text-xs text-red-400"},Ne={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Je={class:"bg-gray-900/95 border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 p-6 w-96 max-w-[90vw]"},De={class:"flex items-center justify-between mb-4"},Ve={class:"space-y-4"},Me={class:"space-y-2"},Ae={class:"space-y-2"},Be={class:"flex gap-2 mt-6"},Le={key:1,class:"fixed top-4 right-4 z-50"},ze=R({__name:"DatabaseManager",props:{projectId:{}},setup(N){const J=N,{dbObjects:D,refreshDatabaseObjects:V,upsertDatabaseObject:O,deleteDatabaseObject:M}=W(String(J.projectId||"")),p=c([]),s=c(null),x=c(""),g=c(!1),o=c(""),l=c(""),h=c(!1),d=E({name:"",description:""}),S=Z(()=>{if(!x.value)return p.value;const a=x.value.toLowerCase();return p.value.filter(e=>e.name.toLowerCase().includes(a)||(e.description||"").toLowerCase().includes(a))});async function b(){try{await V(),p.value=(D.value||[]).sort((a,e)=>e.updatedAt-a.updatedAt)}catch(a){console.error("åŠ è½½å¯¹è±¡åˆ—è¡¨å¤±è´¥:",a)}}async function A(a){try{const e=JSON.parse(JSON.stringify(a));await O(e)}catch(e){throw console.error("ä¿å­˜å¯¹è±¡å¤±è´¥:",e),e}}async function B(a){try{await M(a)}catch(e){console.error("åˆ é™¤å¯¹è±¡å¤±è´¥:",e)}}function y(a){return a?/^[A-Za-z_][A-Za-z0-9_]*$/.test(a):!1}function w(a){s.value={...a};try{o.value=a.content?JSON.stringify(a.content,null,2):"",l.value=""}catch{o.value="",l.value="å†…å®¹åºåˆ—åŒ–å¤±è´¥"}}async function L(){if(!d.name||!y(d.name)){_("è¯·å¡«å†™åˆæ³•çš„å¯¹è±¡åç§°ï¼ˆå­—æ¯/ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä»…å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰","warning");return}const a={id:"",name:d.name.trim(),description:d.description.trim(),content:{},createdAt:Date.now(),updatedAt:Date.now()},{id:e}=await O(a);a.id=e,await b(),Object.assign(d,{name:"",description:""}),g.value=!1,w(a)}async function z(){if(!s.value)return;if(!y(s.value.name)){_("å¯¹è±¡åç§°éæ³•ï¼Œè¯·ä¿®æ”¹åå†ä¿å­˜","error");return}if(o.value&&o.value.trim())try{const r=JSON.parse(o.value);s.value.content=r,l.value=""}catch(r){l.value="JSONæ ¼å¼é”™è¯¯: "+r.message;return}else s.value.content={};s.value.updatedAt=Date.now();const a=JSON.parse(JSON.stringify(s.value)),e=p.value.findIndex(r=>r.id===a.id);e>=0?p.value.splice(e,1,a):p.value.unshift(a),w(a),await A(a),await b(),h.value=!0,setTimeout(()=>h.value=!1,1800)}async function I(a){var e;confirm("ç¡®è®¤åˆ é™¤æ­¤æ•°æ®å¯¹è±¡å—ï¼Ÿ")&&(await B(a),await b(),((e=s.value)==null?void 0:e.id)===a&&(s.value=null,o.value="",l.value=""))}function U(){if(o.value)try{const a=JSON.parse(o.value);o.value=JSON.stringify(a,null,2),l.value=""}catch(a){l.value="JSONæ ¼å¼é”™è¯¯: "+a.message}}function $(){if(!o.value){l.value="";return}try{JSON.parse(o.value),l.value="",_("JSONæ ¼å¼æ­£ç¡®ï¼","success")}catch(a){l.value="JSONæ ¼å¼é”™è¯¯: "+a.message}}return F(s,a=>{if(a)try{o.value=a.content?JSON.stringify(a.content,null,2):""}catch{}}),Q(()=>{b()}),(a,e)=>(n(),i("div",X,[e[25]||(e[25]=q('<div class="absolute inset-0 opacity-10" data-v-a372caf6><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-a372caf6></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-a372caf6></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-a372caf6></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-a372caf6></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-a372caf6></div>',2)),t("div",Y,[t("div",ee,[t("div",te,[t("div",ae,[e[9]||(e[9]=t("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[t("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),C(" æ•°æ®å¯¹è±¡åˆ—è¡¨ ")],-1)),t("div",re,[t("button",{onClick:e[0]||(e[0]=r=>g.value=!0),class:"px-3 py-1 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25 text-sm"}," + æ–°å¢ ")])])]),t("div",se,[t("div",oe,[v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>x.value=r),placeholder:"æœç´¢å¯¹è±¡...",class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200 text-sm"},null,512),[[f,x.value]])]),S.value.length===0?(n(),i("div",le,[...e[10]||(e[10]=[t("div",{class:"text-4xl mb-2"},"ğŸ—‚ï¸",-1),t("p",null,"æš‚æ— æ•°æ®å¯¹è±¡",-1),t("p",{class:"text-xs mt-1"},'ç‚¹å‡»å³ä¸Šè§’"æ–°å¢"æŒ‰é’®æ·»åŠ å¯¹è±¡',-1)])])):u("",!0),(n(!0),i(H,null,P(S.value,r=>{var j;return n(),i("div",{key:r.id,onClick:T=>w(r),class:k(["p-3 rounded-lg cursor-pointer transition-all duration-200 border",((j=s.value)==null?void 0:j.id)===r.id?"bg-cyan-600/30 border-cyan-400/50 shadow-lg shadow-cyan-500/20":"bg-gray-800/30 border-gray-600/30 hover:bg-gray-700/40 hover:border-gray-500/50"])},[t("div",ie,[t("div",de,[t("div",ue,[e[11]||(e[11]=t("span",{class:"px-2 py-0.5 rounded text-xs font-medium bg-cyan-600/80 text-cyan-100"},"Object",-1)),t("span",ce,m(r.name),1)]),r.description?(n(),i("div",pe,m(r.description),1)):u("",!0)]),t("button",{onClick:G(T=>I(r.id),["stop"]),class:"ml-2 p-1 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded transition-colors duration-200"},[...e[12]||(e[12]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ve)])],10,ne)}),128))])]),t("div",fe,[t("div",ge,[t("h2",xe,[e[13]||(e[13]=t("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"},null,-1)),C(" "+m(s.value?"å¯¹è±¡è¯¦æƒ…ç¼–è¾‘":"é€‰æ‹©ä¸€ä¸ªæ•°æ®å¯¹è±¡"),1)]),s.value?(n(),i("div",be,[t("button",{onClick:z,class:"px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"}," ä¿å­˜ ")])):u("",!0)]),t("div",ye,[s.value?u("",!0):(n(),i("div",me,[...e[14]||(e[14]=[t("div",{class:"text-center"},[t("div",{class:"text-6xl mb-4"},"ğŸ“¦"),t("p",{class:"text-lg"},"è¯·ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ªæ•°æ®å¯¹è±¡è¿›è¡Œç¼–è¾‘"),t("p",{class:"text-sm mt-2"},'æˆ–è€…ç‚¹å‡»"æ–°å¢"æŒ‰é’®åˆ›å»ºæ–°çš„å¯¹è±¡')],-1)])])),s.value?(n(),i("div",he,[t("div",we,[e[17]||(e[17]=t("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-2"},"åŸºæœ¬ä¿¡æ¯",-1)),t("div",ke,[t("div",_e,[e[15]||(e[15]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡åç§°",-1)),v(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.value.name=r),type:"text",placeholder:"å¦‚: powerSourceData",class:"w-full px-3 py-2 bg-gray-800/50 border border-purple-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[f,s.value.name]]),t("div",{class:k(["text-xs",y(s.value.name)?"text-gray-500":"text-red-400"])}," åç§°éœ€ä¸ºåˆæ³•æ ‡è¯†ç¬¦ï¼ˆç”¨äº Vue2 data é”®ï¼‰ ",2)]),t("div",Oe,[e[16]||(e[16]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡æè¿°",-1)),v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>s.value.description=r),type:"text",placeholder:"å¯¹è±¡ç”¨é€”æè¿°ï¼ˆå¯é€‰ï¼‰",class:"w-full px-3 py-2 bg-gray-800/50 border border-purple-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[f,s.value.description]])])])]),t("div",Se,[e[19]||(e[19]=t("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-2"},"å¯¹è±¡å†…å®¹ (JSON)",-1)),t("div",je,[e[18]||(e[18]=t("label",{class:"block text-xs text-gray-400"},"JSON å†…å®¹",-1)),v(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=r=>o.value=r),rows:"12",placeholder:'{"code": 200, "data": [], "message": "success"}',class:"w-full px-3 py-2 bg-gray-800/50 border border-purple-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 font-mono text-sm"},null,512),[[f,o.value]]),t("div",{class:"flex gap-2"},[t("button",{onClick:U,class:"px-3 py-1 bg-blue-600/30 hover:bg-blue-600/50 text-blue-300 rounded text-xs transition-colors duration-200"},"æ ¼å¼åŒ–JSON"),t("button",{onClick:$,class:"px-3 py-1 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200"},"éªŒè¯JSON")]),l.value?(n(),i("div",Ce,m(l.value),1)):u("",!0)])])])):u("",!0)])])]),g.value?(n(),i("div",Ne,[t("div",Je,[t("div",De,[e[21]||(e[21]=t("h3",{class:"text-lg font-bold text-cyan-300"},"æ–°å¢æ•°æ®å¯¹è±¡",-1)),t("button",{onClick:e[5]||(e[5]=r=>g.value=!1),class:"text-gray-400 hover:text-white"},[...e[20]||(e[20]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Ve,[t("div",Me,[e[22]||(e[22]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡åç§°",-1)),v(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>d.name=r),type:"text",placeholder:"å¦‚: powerSourceData",class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[f,d.name]]),t("div",{class:k(["text-xs",y(d.name)?"text-gray-500":"text-red-400"])},"åç§°éœ€ä¸ºåˆæ³•æ ‡è¯†ç¬¦",2)]),t("div",Ae,[e[23]||(e[23]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡æè¿°",-1)),v(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>d.description=r),type:"text",placeholder:"å¯¹è±¡ç”¨é€”æè¿°ï¼ˆå¯é€‰ï¼‰",class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[f,d.description]])])]),t("div",Be,[t("button",{onClick:L,class:"flex-1 px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},"æ·»åŠ "),t("button",{onClick:e[8]||(e[8]=r=>g.value=!1),class:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-medium transition-all duration-200"},"å–æ¶ˆ")])])])):u("",!0),h.value?(n(),i("div",Le,[...e[24]||(e[24]=[t("div",{class:"px-3 py-2 bg-emerald-600/90 text-white rounded-lg shadow-lg flex items-center gap-2"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),t("span",{class:"text-sm"},"ä¿å­˜æˆåŠŸ")],-1)])])):u("",!0)]))}}),Pe=K(ze,[["__scopeId","data-v-a372caf6"]]);export{Pe as default};
