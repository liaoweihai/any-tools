import{i as Po}from"./rolldown-runtime-CKFmjIRy.js";import{C as Et,E as S,H as hn,I as G,L as wn,O as st,P as Ze,R as q,S as kn,_ as kt,c as Je,ct as Xe,d as P,f as C,g as Be,h as Go,i as On,l as r,lt as Ue,m as Ft,n as Sn,o as rt,r as Nn,st as he,t as Cn,u as Wo,w as Dt}from"./codemirror-B25QCqWr.js";import{d as Mn,f as R,h as $n,n as An,o as In,r as jn,s as zn,u as Fn}from"./vendor-vue-fZ-TTK_Z.js";import{t as Ro}from"./index-R3-RO9Tt.js";import{t as Ie}from"./componentStorage-C30w18UR.js";import"./echarts-CeA8Xwre.js";import{t as Ln}from"./DraggableBox-D_w9MXsh.js";function Lt(te){return te.replace(/[&<>"']/g,v=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[v]||v)}function Dn(te){var Y,L;const v=te.style||{},M=[];if(M.push("position:absolute"),M.push(`left:${Math.round(te.left||0)}px`),M.push(`top:${Math.round(te.top||0)}px`),te.autoSize||(te.width&&M.push(`width:${Math.round(te.width)}px`),te.height&&M.push(`height:${Math.round(te.height)}px`)),v.opacity!==void 0&&M.push(`opacity:${v.opacity}`),v.border&&M.push(`border:${v.border}`),v.borderRadius&&M.push(`border-radius:${v.borderRadius}`),v.backgroundColor&&M.push(`background-color:${v.backgroundColor}`),v.backgroundGradient&&((Y=v.backgroundGradient.colors)!=null&&Y.length)){const W=v.backgroundGradient.angle||0,ve=v.backgroundGradient.colors[0]||"#000000",Ne=v.backgroundGradient.colors[1]||"#000000";M.push(`background-image:linear-gradient(${W}deg, ${ve}, ${Ne})`),M.push("background-size:cover"),M.push("background-repeat:no-repeat")}if(te.type==="text"){v.fontFamily&&M.push(`font-family:${v.fontFamily}`),v.fontSize!==void 0&&M.push(`font-size:${v.fontSize}px`),v.color&&M.push(`color:${v.color}`),v.fontWeight&&M.push(`font-weight:${v.fontWeight}`),v.letterSpacing!==void 0&&v.letterSpacing!==null&&M.push(`letter-spacing:${v.letterSpacing}px`),v.lineHeight!==void 0&&M.push(`line-height:${v.lineHeight}`),v.fontStyle&&M.push(`font-style:${v.fontStyle}`),v.textAlign&&M.push(`text-align:${v.textAlign}`),v.textDecoration&&M.push(`text-decoration:${v.textDecoration}`);const W=v.textOrientation;if(W==="vertical"?(M.push("writing-mode:vertical-rl"),M.push("text-orientation:upright")):W==="horizontal"&&M.push("writing-mode:horizontal-tb"),v.textGradient&&((L=v.textGradient.colors)!=null&&L.length)){const ve=v.textGradient.angle||0,Ne=v.textGradient.colors[0]||"#000000",Ce=v.textGradient.colors[1]||"#000000";M.push(`background-image:linear-gradient(${ve}deg, ${Ne}, ${Ce})`),M.push("-webkit-background-clip:text"),M.push("background-clip:text"),M.push("color:transparent")}}return te.type==="image"&&v.objectFit&&M.push(`object-fit:${v.objectFit}`),M.join(";")}function Ho(te){return String(te).split(";").map(v=>v.trim()).filter(Boolean).map(v=>v.includes("!important")?v:`${v} !important`).join("; ")}function En(te){return String(te).replace(/\{([^}]*)\}/g,(v,M)=>`{ ${Ho(M)} }`)}function Vn(te){const v=[],M=Y=>{Y.forEach(L=>{if(L.type==="group"&&Array.isArray(L.children))M(L.children);else{const W=(L.className||"").trim(),ve=L.customClassCss?String(L.customClassCss).trim():"";if(!W||!ve)return;/\{[^}]*\}/.test(ve)?v.push(En(ve)):v.push(`.${W} { ${Ho(ve)} }`)}})};return M(te),v.join(`
`)}function Tn(te,v,M,Y,L){const W=te.replace(/[^A-Za-z0-9_]/g,"_");let ve=0;const Ne=[],Ce=[],g=v.backgroundUrl||"",ge=v.backgroundColor||"transparent",ue=v.globalFontFamily||"",ie=v.globalFontSize||14,_e=v.globalColor||"#000000",lt=M.some(y=>y.type==="chart");function B(y,fe){var V,Re,De,Ke,it,ut,dt,we,pt,ct,vt,Ve,t,gt,yt;const re=Dn(y),ae=y.zIndex||1,Le=y.className&&y.className.trim()?` class="${y.className.trim()}"`:"";if(y.type==="group"&&Array.isArray(y.children)){const xe=y.children.map((ke,Ae)=>B(ke,Ae)).join(`
        `);return`<div${Le} style="${re};z-index:${ae}">
        ${xe}
      </div>`}if(y.type==="text"){const xe=(()=>{var ze;const Me=((ze=y.style)==null?void 0:ze.textAlign)||"left";return Me==="center"?"text-flex-center":Me==="right"?"text-flex-right":"text-flex-left"})(),ke=[(V=y.className)==null?void 0:V.trim(),xe].filter(Boolean).join(" "),Ae=ke?` class="${ke}"`:"",be=y.style||{},He=y.elementId&&y.elementId.trim()?y.elementId.trim():`text_${fe}`,Qe=!!(be.textWave&&be.textWave.enabled),et=!!be.skewFlowEnabled;if(Qe||et){const Me=y.dynamic&&y.dynamic.enabled&&y.dynamic.objectName&&y.dynamic.propertyPath?{type:"dynamic",obj:y.dynamic.objectName,path:y.dynamic.propertyPath}:{type:"static",text:y.text||""};Ne.push(`'${He.replace(/'/g,"\\'")}' : ${JSON.stringify(Me)}`);const ze={textWaveEnabled:Qe,amplitude:(De=(Re=be.textWave)==null?void 0:Re.amplitude)!=null?De:0,frequency:(it=(Ke=be.textWave)==null?void 0:Ke.frequency)!=null?it:0,phase:(dt=(ut=be.textWave)==null?void 0:ut.phase)!=null?dt:0,skewFlowEnabled:et,skewAngle:(we=be.skewAngle)!=null?we:0,textOrientation:be.textOrientation||"horizontal",fontSize:(pt=be.fontSize)!=null?pt:ie,letterSpacing:(ct=be.letterSpacing)!=null?ct:0};return Ce.push(`'${He.replace(/'/g,"\\'")}' : ${JSON.stringify(ze)}`),`<div${Ae} style="${re};z-index:${ae}">
          <span v-for="(p,pi) in getTextPieces('${He.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
        </div>`}if(y.dynamic&&y.dynamic.enabled&&y.dynamic.objectName&&y.dynamic.propertyPath){const Me=`${y.dynamic.objectName}.${y.dynamic.propertyPath}`;return`<div${Ae} style="${re};z-index:${ae}">{{ ${Me} }}</div>`}else{const Me=Lt(y.text||"");return`<div${Ae} style="${re};z-index:${ae}">${Me}</div>`}}if(y.type==="image"){if(Y!=null&&Y.imageFileNames&&Y.imageFileNames[ve]){const Ae=Y.imageFileNames[ve++],be=y.elementId&&y.elementId.trim()?` id="${y.elementId.trim()}"`:"";return`<img${Le}${be} src="./imgs/${Ae}" style="${re};z-index:${ae}" alt="" />`}const xe=y.elementId&&y.elementId.trim()?y.elementId.trim():`img_${fe}`,ke=y.elementId&&y.elementId.trim()?` id="${y.elementId.trim()}"`:"";return`<img${Le}${ke} :src="images['${xe}']" style="${re};z-index:${ae}" alt="" />`}if(y.type==="chart"){const xe=Lt(y.text||"chart"),ke=y.elementId&&y.elementId.trim()?y.elementId.trim():`chart_${fe}`;return`<div${Le} id="${ke}" style="${re};z-index:${ae}">${xe}</div>`}if(y.type==="line"){const xe=y.style||{},ke=xe.lineColor||"#ffffff",Ae=(vt=xe.lineThickness)!=null?vt:2,be=xe.lineOrientation||"horizontal",He=xe.lineStyle==="dashed",Qe=(Ve=xe.lineDashLength)!=null?Ve:6,et=(t=xe.lineDashGap)!=null?t:4,Me=Math.max(1,Math.round((gt=y.width)!=null?gt:be==="horizontal"?200:2)),ze=Math.max(1,Math.round((yt=y.height)!=null?yt:be==="horizontal"?2:200)),ft=Math.round(ze/2),tt=Math.round(Me/2),xt=He?` stroke-dasharray="${Qe} ${et}"`:"";return be==="horizontal"?`<svg${Le} viewBox="0 0 ${Me} ${ze}" preserveAspectRatio="none" style="${re};z-index:${ae}"><line x1="0" y1="${ft}" x2="${Me}" y2="${ft}" stroke="${ke}" stroke-width="${Ae}"${xt} fill="none" /></svg>`:`<svg${Le} viewBox="0 0 ${Me} ${ze}" preserveAspectRatio="none" style="${re};z-index:${ae}"><line x1="${tt}" y1="0" x2="${tt}" y2="${ze}" stroke="${ke}" stroke-width="${Ae}"${xt} fill="none" /></svg>`}const Pe=Lt(y.text||"element");return`<div${Le} style="${re};z-index:${ae}">${Pe}</div>`}const le=M.map((y,fe)=>B(y,fe)).join(`
      `),We=Vn(M);function je(y,fe){y.forEach(re=>{re.type==="group"&&Array.isArray(re.children)?(fe(re),je(re.children,fe)):fe(re)})}const Ge=new Set;je(M,y=>{y.type==="text"&&y.dynamic&&y.dynamic.enabled&&y.dynamic.objectName&&Ge.add(String(y.dynamic.objectName))});const _=Array.from(Ge),ye=!L||_.length===0?"":_.map(y=>{try{const fe=L[y],re=JSON.stringify(fe!=null?fe:{});return`      ${y}: ${re},`}catch{return`      ${y}: {},`}}).join(`
`),ce=(()=>{const y=[];let fe=0;return je(M,re=>{if(re.type==="chart"){const ae=re.elementId&&re.elementId.trim()?re.elementId.trim():`chart_${fe}`;fe++;const Le=re.chartOption||{};try{y.push(`'${ae.replace(/'/g,"\\'")}' : ${JSON.stringify(Le)}`)}catch{y.push(`'${ae.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${y.join(", ")} }`})();return`
<template>
  <div class="container" :style="containerStyle">
    ${le}
  </div>
</template>

<script>
${lt?`import * as echarts from 'echarts';
`:""}
export default {
  name: '${W}',
  data() {
    return {
      config: {
        width: ${Math.round(v.width)},
        height: ${Math.round(v.height)},
        backgroundColor: '${ge.replace(/'/g,"\\'")}',
        globalFontFamily: '${ue.replace(/'/g,"\\'")}',
        globalFontSize: ${Math.round(ie)},
        globalColor: '${_e}',
      },
      backgroundUrl: ${Y!=null&&Y.backgroundFileName?`(() => { try { return require('./imgs/${Y.backgroundFileName.replace(/'/g,"\\'")}'); } catch(e) { return './imgs/${Y.backgroundFileName.replace(/'/g,"\\'")}'; } })()`:`'${g.replace(/'/g,"\\'")}'`},
      ${Y!=null&&Y.imageFileNames?`// 使用本地资源路径，动态映射不再需要
      images: {},`:`// 图片 src 动态映射，初始写入 base64（若存在），blob 留空待替换
      images: {},`}
      // 图表配置导出，键为元素ID或序号
      chartOptions: ${ce},
      ${ye?`// 数据库对象（按页面引用注入到 data）
${ye}`:""}
      ${Ne.length?`// 文本数据源映射（支持静态/动态）
      textSources: { ${Ne.join(", ")} },`:""}
      ${Ce.length?`// 文本效果参数映射（波形与倾斜跟随）
      textEffects: { ${Ce.join(", ")} },`:""}
    };
  },
  computed: {
    containerStyle() {
      const base = {
        position: 'relative',
        width: this.config.width + 'px',
        height: this.config.height + 'px',
        fontFamily: this.config.globalFontFamily,
        fontSize: this.config.globalFontSize + 'px',
        color: this.config.globalColor,
        backgroundColor: this.config.backgroundColor || 'transparent',
      };
      if (this.backgroundUrl) {
        return Object.assign({}, base, {
          backgroundImage: 'url(' + this.backgroundUrl + ')',
          backgroundSize: 'cover',
          backgroundRepeat: 'no-repeat',
        });
      }
      return base;
    }
  },
  methods: {
    getByPath(obj, path) {
      try {
        const segs = String(path).split('.');
        return segs.reduce((acc, k) => (acc ? acc[k] : undefined), obj);
      } catch(e) {
        return undefined;
      }
    },
    getTextValue(id) {
      const srcMap = this.textSources || {};
      const src = srcMap[id];
      if (!src) return '';
      if (src.type === 'static') return String(src.text || '');
      const root = this[src.obj] || {};
      const v = this.getByPath(root, src.path);
      return v != null ? String(v) : '';
    },
    getTextPieces(id) {
      const text = this.getTextValue(id);
      const effMap = this.textEffects || {};
      const eff = effMap[id] || {};
      const orientation = eff.textOrientation || 'horizontal';
      const fontSize = Number(eff.fontSize || (this.config && this.config.globalFontSize) || 14);
      const letterSpacing = Number(eff.letterSpacing || 0);
      const step = fontSize * 0.6 + letterSpacing;

      const amp = eff.textWaveEnabled ? Number(eff.amplitude || 0) : 0;
      const freq = eff.textWaveEnabled ? Number(eff.frequency || 0) : 0;
      const phase = eff.textWaveEnabled ? Number(eff.phase || 0) : 0;

      const skewAngle = eff.skewFlowEnabled ? Number(eff.skewAngle || 0) : 0;
      const tan = Math.tan(skewAngle * Math.PI / 180);

      const pieces = [];
      for (let i = 0; i < text.length; i++) {
        const ch = text[i];
        const wave = amp ? amp * Math.sin(i * freq + phase) : 0;
        let dx = 0, dy = 0;
        if (orientation === 'horizontal') {
          dy += wave;
          dy += tan * step * i;
        } else {
          dx += wave;
          dx += tan * step * i;
        }
        const style = 'display:inline-block;white-space:pre;transform: translate(' + Math.round(dx) + 'px, ' + Math.round(dy) + 'px);';
        pieces.push({ char: ch, style });
      }
      return pieces;
    }
  },
  mounted() {
    // 使用 npm 依赖的 echarts 初始化图表实例
    Object.keys(this.chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) {
        const inst = echarts.init(el);
        inst.setOption(this.chartOptions[id], true);
      }
    });
  }
};
<\/script>

${Y!=null&&Y.fontFaces&&Y.fontFaces.length>0?`
<style>
${Y.fontFaces.map(y=>`@font-face { font-family: '${y.family.replace(/'/g,"\\'")}'; src: url('./fonts/${y.file}'); font-weight: normal; font-style: normal; }`).join(`
`)}
</style>
`:""}
<style scoped>
.container { box-sizing: border-box; }
/* 文本对齐公共样式，减少重复的内联 CSS */
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${We}
</style>
`}var Bn=Po(An()),Un=Po(jn()),Jn=["placeholder"],Gn={key:0,class:"absolute z-10 bg-gray-900 border border-gray-700 rounded w-full mt-1 max-h-40 overflow-auto shadow custom-scrollbar"},Pn=["onMousedown"],Wn={key:0,class:"px-2 py-2 text-xs text-gray-400"},Rn=kt({__name:"SearchableSelect",props:{modelValue:{},options:{},placeholder:{},numeric:{type:Boolean}},emits:["update:modelValue"],setup(te,{emit:v}){const M=te,Y=v,L=q(!1),W=q(""),ve=q(null),Ne=q("");let Ce=null;const g=q(!1);Ze(()=>M.modelValue,_=>{_==null?W.value="":W.value=String(_)},{immediate:!0});const ge=Je(()=>M.options.map(_=>String(_))),ue=Je(()=>{const _=Ne.value.trim().toLowerCase();return _?ge.value.filter(ye=>ye.toLowerCase().includes(_)):ge.value});function ie(_){W.value=_;const ye=M.numeric?Number(_):_;Y("update:modelValue",ye),L.value=!1}function _e(){const _=W.value.trim();if(!_){Y("update:modelValue",(M.numeric,null)),L.value=!1;return}const ye=M.numeric?Number(_):_;Y("update:modelValue",ye),L.value=!1}function lt(){g.value=!1,L.value=!0,We(W.value)}function B(){}function le(_){_.key==="Enter"&&_e()}function We(_){Ce&&window.clearTimeout(Ce),Ce=window.setTimeout(()=>{Ne.value=_},180)}function je(){g.value=!0,L.value=!0,We(W.value)}function Ge(_){ve.value&&(ve.value.contains(_.target)||(L.value=!1))}return Dt(()=>{window.addEventListener("click",Ge),Ne.value=W.value}),Et(()=>{window.removeEventListener("click",Ge),Ce&&window.clearTimeout(Ce)}),(_,ye)=>(S(),C("div",{class:"relative",ref_key:"root",ref:ve},[G(r("input",{class:"border border-gray-700 bg-gray-900 text-gray-100 rounded w-full px-2 py-1",placeholder:te.placeholder||"搜索选择或直接输入","onUpdate:modelValue":ye[0]||(ye[0]=ce=>W.value=ce),onInput:je,onFocus:lt,onBlur:B,onKeydown:le},null,40,Jn),[[R,W.value]]),L.value?(S(),C("div",Gn,[(S(!0),C(rt,null,st(ue.value,ce=>(S(),C("div",{key:ce,class:"px-2 py-1 hover:bg-gray-700 cursor-pointer text-sm text-gray-100",onMousedown:$n(y=>ie(ce),["prevent"])},Ue(ce),41,Pn))),128)),ue.value.length===0?(S(),C("div",Wn,"无匹配项，回车使用当前输入")):P("",!0)])):P("",!0)],512))}}),Ye=Rn,Hn={class:"relative w-full"},qn=kt({__name:"CssEditor",props:{modelValue:{},height:{},debounceMs:{}},emits:["update:modelValue"],setup(te,{emit:v}){const M=te,Y=v,L=q(M.modelValue||"");let W=null;const ve=typeof M.debounceMs=="number"?Math.max(0,M.debounceMs):250;Ze(()=>M.modelValue,ue=>{W&&(clearTimeout(W),W=null);const ie=ue||"";ie!==L.value&&(L.value=ie)}),Ze(L,ue=>{W&&clearTimeout(W),W=window.setTimeout(()=>{Y("update:modelValue",ue),W=null},ve)}),Et(()=>{W&&(clearTimeout(W),W=null)});function Ne(){const ue=L.value||"";if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText(ue).catch(()=>{try{const ie=document.createElement("textarea");ie.value=ue,document.body.appendChild(ie),ie.select(),document.execCommand("copy"),document.body.removeChild(ie)}catch{}});else try{const ie=document.createElement("textarea");ie.value=ue,document.body.appendChild(ie),ie.select(),document.execCommand("copy"),document.body.removeChild(ie)}catch{}}function Ce(){W&&(clearTimeout(W),W=null),L.value="",Y("update:modelValue","")}const g=[On,Sn(),Cn],ge=Je(()=>{var ue;return(ue=M.height)!=null?ue:"180px"});return(ue,ie)=>(S(),C("div",Hn,[r("div",{class:"absolute right-2 top-2 z-10 flex gap-2"},[r("button",{type:"button",class:"px-2 py-1 text-xs bg-gray-700/70 hover:bg-gray-700 text-gray-100 rounded",onClick:Ne},"复制"),r("button",{type:"button",class:"px-2 py-1 text-xs bg-red-600/70 hover:bg-red-600 text-white rounded",onClick:Ce},"清空")]),Be(hn(Nn),{modelValue:L.value,"onUpdate:modelValue":ie[0]||(ie[0]=_e=>L.value=_e),extensions:g,style:Xe({height:ge.value,width:"100%"}),class:"w-full rounded border border-purple-500/30 bg-gray-800/50"},null,8,["modelValue","style"])]))}}),Yn=Ro(qn,[["__scopeId","data-v-c1c6cbbe"]]),Xn={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},Zn={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},_n={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},Kn={class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Qn={class:"space-y-2"},es={class:"space-y-2"},ts={class:"grid grid-cols-2 gap-2"},rs={class:"space-y-2"},ls={class:"flex gap-2"},as={class:"space-y-2"},os={class:"flex gap-2"},ns=["value"],ss={class:"space-y-3"},is={class:"space-y-2"},us={class:"space-y-2"},ds={class:"space-y-2"},ps={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},cs={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},vs={class:"flex gap-2"},gs={class:"flex items-center gap-2"},ys={class:"text-sm text-gray-400 min-w-[60px] text-center"},fs={key:0,class:"absolute inset-0 pointer-events-none z-50"},xs={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20 flex flex-col"},bs={key:0,class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},ms={class:"space-y-3"},hs={class:"grid grid-cols-2 gap-2"},ws={class:"col-span-2"},ks={class:"space-y-3"},Os={class:"space-y-2"},Ss={class:"flex items-center justify-between"},Ns={key:0},Cs={class:"flex gap-2"},Ms={key:1},$s={key:2},As={key:0,class:"space-y-3"},Is={class:"flex items-center gap-2"},js={key:0,class:"space-y-2"},zs=["value"],Fs={class:"grid grid-cols-2 gap-2"},Ls=["value"],Ds=["value"],Es={key:0,class:"grid grid-cols-2 gap-2"},Vs=["value"],Ts=["value"],Bs={key:1,class:"grid grid-cols-2 gap-2"},Us={key:2,class:"grid grid-cols-3 gap-2 items-end"},Js={key:1,class:"space-y-3 pt-2 border-t border-purple-500/30"},Gs={class:"grid grid-cols-2 gap-2"},Ps=["value"],Ws=["value"],Rs={class:"space-y-2"},Hs={class:"grid grid-cols-3 gap-2"},qs=["value"],Ys=["value"],Xs=["value"],Zs={class:"grid grid-cols-3 gap-2"},_s=["value"],Ks=["value"],Qs=["value"],ei={class:"grid grid-cols-4 gap-2"},ti=["value"],ri=["value"],li=["value"],ai=["value"],oi={class:"space-y-2"},ni={class:"grid grid-cols-3 gap-2"},si=["value"],ii=["value"],ui=["value"],di={class:"grid grid-cols-2 gap-2"},pi=["value"],ci=["value"],vi={class:"space-y-2"},gi={class:"grid grid-cols-2 gap-2"},yi={class:"space-y-1"},fi=["value"],xi=["value"],bi={class:"space-y-1"},mi=["value"],hi=["value"],wi={key:0,class:"space-y-2"},ki={class:"grid grid-cols-3 gap-2"},Oi=["value"],Si=["value"],Ni={key:1,class:"space-y-2"},Ci={class:"grid grid-cols-3 gap-2"},Mi=["value"],$i=["value"],Ai=["value"],Ii={key:2},ji={class:"flex items-center justify-between mt-2"},zi={key:0,class:"text-xs text-red-400"},Fi={key:1,class:"space-y-3"},Li={class:"space-y-2"},Di={class:"flex gap-1"},Ei=["value"],Vi=["value"],Ti={class:"grid grid-cols-2 gap-2"},Bi={class:"grid grid-cols-2 gap-1"},Ui=["value"],Ji={class:"grid grid-cols-2 gap-2"},Gi=["value"],Pi={key:0},Wi=["value"],Ri={key:0,class:"grid grid-cols-2 gap-2"},Hi=["value"],qi={key:2,class:"space-y-3"},Yi={class:"space-y-2"},Xi={class:"space-y-2 mt-2"},Zi={class:"flex items-center gap-2"},_i=["checked"],Ki={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Qi={class:"text-xs text-gray-400"},eu={class:"space-y-2"},tu={class:"grid grid-cols-2 gap-1"},ru={class:"grid grid-cols-2 gap-2"},lu={class:"grid grid-cols-2 gap-2"},au={class:"grid grid-cols-2 gap-2"},ou=["value"],nu=["value"],su={class:"space-y-2"},iu={class:"flex gap-1"},uu=["value","disabled"],du=["value","disabled"],pu={key:0,class:"text-xs text-yellow-400 mt-1"},cu={class:"space-y-2"},vu={class:"flex gap-1"},gu=["value"],yu=["value"],fu={class:"space-y-2"},xu={class:"grid grid-cols-3 gap-1"},bu={class:"space-y-2"},mu={class:"grid grid-cols-2 gap-1"},hu={class:"space-y-2"},wu={class:"flex items-center gap-2"},ku={class:"flex items-center gap-2 mt-1"},Ou={class:"space-y-2"},Su={class:"flex items-center justify-between"},Nu={class:"flex gap-1"},Cu={key:0,class:"grid grid-cols-3 gap-2 items-center"},Mu={class:"col-span-1"},$u={class:"col-span-1"},Au={class:"col-span-1"},Iu={class:"space-y-2"},ju={class:"grid grid-cols-3 gap-1"},zu={class:"space-y-2"},Fu={class:"flex items-center justify-between"},Lu={class:"flex gap-1"},Du={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Eu={class:"grid grid-cols-2 gap-2"},Vu={class:"flex gap-1"},Tu={class:"flex gap-1"},Bu={class:"block text-xs text-gray-400 mb-1"},Uu={class:"space-y-2"},Ju={class:"flex items-center justify-between"},Gu={class:"flex gap-1"},Pu={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Wu={class:"grid grid-cols-2 gap-2"},Ru={class:"flex gap-1"},Hu={class:"flex gap-1"},qu={class:"block text-xs text-gray-400 mb-1"},Yu={key:3,class:"space-y-3"},Xu={class:"space-y-2"},Zu={key:0,class:"space-y-2"},_u={class:"max-h-32 overflow-y-auto custom-scrollbar bg-gray-800/30 rounded p-2"},Ku={class:"grid grid-cols-4 gap-2"},Qu=["onClick"],e0=["src","alt"],t0={key:0,class:"text-xs text-gray-500 text-center py-2"},r0={class:"grid grid-cols-3 gap-2"},l0={class:"space-y-2"},a0={key:1,class:"p-4 text-center text-gray-400 flex-1 flex flex-col justify-center"},o0={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},n0={class:"relative w-[800px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-fuchsia-500/40 rounded-xl shadow-2xl"},s0={class:"p-4 space-y-3"},i0={class:"flex items-center gap-2"},u0={key:0,class:"text-center text-sm text-gray-400 py-6"},d0={key:1},p0={key:0,class:"text-center text-sm text-gray-400 py-6"},c0={key:1,class:"grid grid-cols-3 gap-3"},v0={class:"aspect-video bg-gray-700/50 flex items-center justify-center"},g0=["src"],y0={key:1,class:"text-gray-400 text-xs"},f0={class:"p-3 space-y-1"},x0={class:"flex items-center justify-between"},b0=["title"],m0={class:"text-xs text-gray-500"},h0=["title"],w0={class:"flex flex-wrap gap-1 mt-1"},k0={class:"pt-2"},O0=["onClick"],S0=50,N0=kt({__name:"LowCodeBuilder",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(te){const v=te,M=In(),Y=zn(),L=Je(()=>{var l;return(l=v.projectId)!=null?l:M.params.id?String(M.params.id):void 0}),W=q(null);async function ve(){if(L.value)try{const l=(await Ce()).transaction(["projects"],"readonly").objectStore("projects").get(L.value);l.onsuccess=()=>{W.value=l.result}}catch(l){console.error("加载项目信息失败:",l)}}function Ne(){if(!L.value)return;const l=v.isComponent?{path:`/project/${L.value}/preview`,query:{type:"component"}}:{path:`/project/${L.value}/preview`},e=Y.resolve(l).href;window.open(e,"_blank")}async function Ce(){return new Promise((l,e)=>{const o="lowcode-projects",n="projects",s=indexedDB.open(o);s.onerror=()=>e(s.error),s.onupgradeneeded=()=>{const i=s.result;i.objectStoreNames.contains(n)||i.createObjectStore(n,{keyPath:"id"})},s.onsuccess=()=>{const i=s.result;if(i.objectStoreNames.contains(n))l(i);else{const x=i.version+1;i.close();const f=indexedDB.open(o,x);f.onerror=()=>e(f.error),f.onupgradeneeded=()=>{const b=f.result;b.objectStoreNames.contains(n)||b.createObjectStore(n,{keyPath:"id"})},f.onsuccess=()=>l(f.result)}}})}const g=wn({width:1024,height:576,backgroundUrl:"",backgroundColor:"#000000",globalFontFamily:"Arial, Helvetica, sans-serif",globalFontSize:14,globalColor:"#FFFFFF"}),ge=q("GeneratedComponent"),ue=q(["Arial, Helvetica, sans-serif","PingFang SC","Microsoft YaHei","Roboto","Inter"]),ie=q([8,9,10,11,12,14,16,18,20,24,28,32,36,48,64]),_e=q(["100","200","300","400","500","600","700","800","900"]),lt=q(["normal","italic","oblique"]),B=q([]),le=q(null),We=q([]),je=q({}),Ge=q(null),_=q([]),ye=q(!1);function ce(){try{const l=JSON.parse(JSON.stringify(B.value));_.value.push(l),_.value.length>S0&&_.value.shift()}catch(l){console.warn("pushHistory 序列化失败：",l)}}function y(){_.value.length!==0&&(B.value=_.value.pop(),le.value=null,re.value=!1)}function fe(l){var i,x,f,b,j,c,A,E,I,$,K,J,ne,oe,z;function e(N){var X;if(!N)return!1;const D=(X=N.tagName)==null?void 0:X.toLowerCase();return N.isContentEditable||!!N.closest('[contenteditable="true"]')||D==="input"||D==="textarea"||D==="select"}const o=document.activeElement;if(e(o)||e(l.target))return;const n=l.metaKey||l.ctrlKey,s=l.key.toLowerCase();if(n&&s==="c"){if(t.value){try{Ge.value=JSON.parse(JSON.stringify(t.value))}catch{}l.preventDefault()}}else if(n&&s==="v"){if(Ge.value){const N=Ge.value,D=Pt(N),{parentGroup:X}=Ve(N.id);if(X){const Oe=Number((x=(i=X.left)!=null?i:X.x)!=null?x:0),m=Number((b=(f=X.top)!=null?f:X.y)!=null?b:0),k=Number((j=X.width)!=null?j:0),h=Number((c=X.height)!=null?c:0),u=Oe+k,O=m+h,Q=Number((A=N.width)!=null?A:0),w=Number((E=N.height)!=null?E:0);let F=Q,U=w;if(!F||!U)if(N.type==="text"){const Se=Number((I=N.fontSize)!=null?I:16),pe=String((K=($=N.text)!=null?$:N.content)!=null?K:"").trim();F=Math.max(Q||50,Math.round((pe.length||2)*Se*.6)),U=Math.max(w||20,Math.round(Se*1.5))}else N.type==="image"?(F=Q||200,U=w||150):N.type==="chart"?(F=Q||240,U=w||160):N.type==="line"?(F=Q||200,U=w||2):(F=Q||100,U=w||60);const T=10,ee=Oe+k/2,H=m+h/2;let Z=!1,se=u+T,de=Math.round(H-U/2);if(!Z&&se+F<=g.width&&(D.left=Math.max(0,Math.min(se,Math.max(0,g.width-F))),D.top=Math.max(0,Math.min(de,Math.max(0,g.height-U))),Z=!0),se=Oe-F-T,de=Math.round(H-U/2),!Z&&se>=0&&(D.left=Math.max(0,Math.min(se,Math.max(0,g.width-F))),D.top=Math.max(0,Math.min(de,Math.max(0,g.height-U))),Z=!0),se=Math.round(ee-F/2),de=O+T,!Z&&de+U<=g.height&&(D.left=Math.max(0,Math.min(se,Math.max(0,g.width-F))),D.top=Math.max(0,Math.min(de,Math.max(0,g.height-U))),Z=!0),se=Math.round(ee-F/2),de=m-U-T,!Z&&de>=0&&(D.left=Math.max(0,Math.min(se,Math.max(0,g.width-F))),D.top=Math.max(0,Math.min(de,Math.max(0,g.height-U))),Z=!0),!Z){const Se=Number((ne=(J=N.left)!=null?J:N.x)!=null?ne:0),pe=Number((z=(oe=N.top)!=null?oe:N.y)!=null?z:0),$e=Oe+Se+T,me=m+pe+T;D.left=Math.max(0,Math.min(Math.round($e),Math.max(0,g.width-F))),D.top=Math.max(0,Math.min(Math.round(me),Math.max(0,g.height-U)))}D.x=D.left,D.y=D.top}ce(),B.value.push(D),le.value=D.id,l.preventDefault()}}else if(s==="delete"||s==="backspace"){if(le.value){ce();const{el:N,parentGroup:D}=Ve(le.value);N&&D&&Array.isArray(D.children)?D.children=D.children.filter(X=>X.id!==N.id):(B.value=B.value.filter(X=>X.id!==le.value),N&&N.type==="group"&&He(N.id)),le.value=null,l.preventDefault()}}else n&&s==="z"&&(y(),l.preventDefault())}const re=q(!1),ae=q({left:0,top:0,right:0,bottom:0,centerX:0,centerY:0});function Le(l){je.value[l.id]=l}const Pe=q("visual"),V=q(""),Re=q("");function De(l){return l==="pie"?{backgroundColor:"transparent",tooltip:{trigger:"item"},legend:{top:"5%",left:"center",textStyle:{color:"#fff"},show:!0},series:[{name:"分类占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#111",borderWidth:2},label:{show:!0,color:"#fff"},labelLine:{show:!0},data:[{value:1048,name:"A"},{value:735,name:"B"},{value:580,name:"C"},{value:484,name:"D"},{value:300,name:"E"}]}]}:l==="mix"?{backgroundColor:"transparent",color:["#00bcd4","#ff9800"],tooltip:{trigger:"axis"},legend:{textStyle:{color:"#fff"},show:!0},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"销量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}},{name:"均价",type:"line",smooth:!0,data:[30,40,45,50,49,60,70],lineStyle:{width:2}}]}:l==="bar"?{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"数量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}}]}:{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"趋势",type:"line",smooth:!0,data:[150,230,224,218,135,147,260],lineStyle:{width:2}}]}}function Ke(l){var K,J;const e=`${l}-${Date.now()}`,o=ot.value,n=Te.value||1,s=(K=o==null?void 0:o.clientWidth)!=null?K:0,i=(J=o==null?void 0:o.clientHeight)!=null?J:0,x=o?(o.scrollLeft+s/2)/n:20,f=o?(o.scrollTop+i/2)/n:20,b=l==="chart"?240:l==="image"||l==="line"?200:void 0,j=l==="chart"?160:l==="image"?150:l==="line"?2:void 0,c=Math.round(x-(b?b/2:10)),A=Math.round(f-(j?j/2:10)),E=Math.max(0,Math.min(c,Math.max(0,g.width-(b!=null?b:0)))),I=Math.max(0,Math.min(A,Math.max(0,g.height-(j!=null?j:0)))),$={id:e,type:l,left:E,top:I,autoSize:l==="text",width:b,height:j,text:l==="text"?"文字":l==="image"||l==="line"?"":"图表",className:"",zIndex:1,style:{}};l==="text"?Object.assign($,{content:"文字",fontSize:16,fontWeight:"400",fontFamily:"Arial, Helvetica, sans-serif",color:"#ffffff",letterSpacing:"0px",lineHeight:"1.5",fontStyle:"normal",useGradient:!1,gradientStart:"#00A3FF",gradientEnd:"#ffffff",gradientDirection:"to right",x:E,y:I}):l==="image"&&(Object.assign($,{src:"",borderRadius:0,x:E,y:I}),$.style={...$.style||{},objectFit:"contain"}),l==="chart"&&Object.assign($,{elementId:`chart-${Date.now()}`,chartType:"line",chartOption:De("line")}),l==="line"&&($.autoSize=!1,$.style={...$.style||{},lineColor:"#ffffff",lineThickness:2,lineOrientation:"horizontal",lineStyle:"solid",lineDashLength:6,lineDashGap:4}),ce(),B.value.push($),le.value=e}function it(l){const{el:e}=Ve(l.id);e&&(ye.value||(ce(),ye.value=!0),e.left=l.left,e.top=l.top,e.x=l.left,e.y=l.top)}function ut(l){const{el:e}=Ve(l.id);e&&(ye.value||(ce(),ye.value=!0),e.width=l.width,e.height=l.height,l.left!==void 0&&(e.left=l.left,e.x=l.left),l.top!==void 0&&(e.top=l.top,e.y=l.top))}function dt(l){le.value=l}const we=q({centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1}),pt=Je(()=>B.value.map(l=>{var s,i;const e=je.value[l.id];if(e)return{id:l.id,left:e.left,top:e.top,right:e.right,bottom:e.bottom,centerX:e.centerX,centerY:e.centerY,w:e.width,h:e.height,type:l.type};const o=(s=l.width)!=null?s:0,n=(i=l.height)!=null?i:0;return{id:l.id,left:l.left,top:l.top,right:l.left+o,bottom:l.top+n,centerX:l.left+o/2,centerY:l.top+n/2,w:o,h:n,type:l.type}}));function ct(l){ye.value||(ce(),ye.value=!0),ae.value={left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.centerX,centerY:l.centerY},we.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1};const e=.5,o=le.value,n=pt.value;for(const s of n)!o||s.id===o||(Math.abs(l.centerX-s.centerX)<=e&&s.w>0&&(we.value.centerV=!0,ae.value.centerX=s.centerX),Math.abs(l.centerY-s.centerY)<=e&&s.h>0&&(we.value.centerH=!0,ae.value.centerY=s.centerY),Math.abs(l.left-s.left)<=e&&(we.value.left=!0,ae.value.left=s.left),Math.abs(l.right-s.right)<=e&&s.w>0&&(we.value.right=!0,ae.value.right=s.right),Math.abs(l.top-s.top)<=e&&(we.value.top=!0,ae.value.top=s.top),Math.abs(l.bottom-s.bottom)<=e&&s.h>0&&(we.value.bottom=!0,ae.value.bottom=s.bottom));re.value=Object.values(we.value).some(Boolean)}function vt(){re.value=!1,ye.value=!1}function Ve(l){if(!l)return{el:null,parentGroup:null};const e=(o,n)=>{for(const s of o){if(s.id===l)return{el:s,parentGroup:n};if(s.type==="group"&&Array.isArray(s.children)){const i=e(s.children,s);if(i)return i}}return null};return e(B.value,null)||{el:null,parentGroup:null}}const t=Je(()=>le.value?Ve(le.value).el:null);async function gt(){return new Promise((l,e)=>{const o=indexedDB.open("lowcode-db",1);o.onupgradeneeded=()=>{const n=o.result;if(!n.objectStoreNames.contains("objects")){const s=n.createObjectStore("objects",{keyPath:"id"});try{s.createIndex("projectId","projectId",{unique:!1}),s.createIndex("name","name",{unique:!1})}catch{}}},o.onsuccess=()=>l(o.result),o.onerror=()=>e(o.error)})}async function yt(){try{const l=(await gt()).transaction(["objects"],"readonly").objectStore("objects").getAll();l.onsuccess=()=>{We.value=(l.result||[]).filter(e=>!e.projectId||e.projectId===(v.projectId||void 0))},l.onerror=()=>{console.warn("loadDatabaseObjects error",l.error)}}catch(l){console.warn("openDatabaseDB error",l)}}const xe=Je(()=>{const l={};for(const e of We.value)e&&e.name&&(l[e.name]=e.content);return l}),ke=q({}),Ae=Je(()=>{const l={...xe.value};for(const e in ke.value)Object.assign(l,ke.value[e]);return l});function be(l,e){const o={};for(const n of e)n&&n.name&&(o[n.name]=n.content);ke.value[l]=o}function He(l){ke.value[l]&&delete ke.value[l];const e=`component-fonts-${l}`,o=document.getElementById(e);o&&o.parentNode&&o.parentNode.removeChild(o)}function Qe(l,e){var c,A,E;const o=(c=e==null?void 0:e.maxDepth)!=null?c:5,n=(A=e==null?void 0:e.maxEntries)!=null?A:200,s=(E=e==null?void 0:e.includeIntermediate)!=null?E:!1,i=[],x=new WeakSet;function f(I){return Object.prototype.toString.call(I)==="[object Object]"}function b(I){i.length<n&&i.push(I)}function j(I,$,K){if(!(K>o)){if(I==null){b($);return}if(typeof I!="object"){b($);return}if(!x.has(I))if(x.add(I),s&&$&&b($),Array.isArray(I))for(let J=0;J<I.length&&i.length<n;J++){const ne=$?`${$}[${J}]`:`[${J}]`;j(I[J],ne,K+1)}else if(f(I))for(const J of Object.keys(I)){const ne=/^[A-Za-z_][A-Za-z0-9_]*$/.test(J)?J:`['${J.replace(/'/g,"\\'")}]`,oe=$?`${$}.${ne}`:ne;if(j(I[J],oe,K+1),i.length>=n)break}else b($)}}return j(l,"",0),i.filter(Boolean)}const et=Je(()=>{var o,n;const l=(n=(o=t.value)==null?void 0:o.dynamic)==null?void 0:n.objectName;if(!l)return[];const e=xe.value[l];try{return Qe(e,{maxDepth:6,maxEntries:400})}catch{return[]}});function Me(l,e){try{if(!l||!e)return"";const o=e.replace(/\[(\d+)\]/g,".$1").replace(/\['([^']+)'\]/g,".$1").replace(/\["([^\"]+)"\]/g,".$1").split(".").filter(Boolean);let n=l;for(const s of o){if(n==null)return"";n=n[s]}return typeof n=="object"?JSON.stringify(n):n!=null?n:""}catch{return""}}function ze(l){var n;if(!l||!((n=l.dynamic)!=null&&n.enabled)||!l.dynamic.objectName||!l.dynamic.propertyPath)return"";const e=l.dynamic,o=xe.value[e.objectName];return String(Me(o,e.propertyPath))}function ft(l){return l?/^#([0-9a-fA-F]{6})$/.test(l.trim()):!1}function tt(l,e="#000000"){return ft(l)?l:e}function xt(){if(!le.value)return;ce();const{el:l,parentGroup:e}=Ve(le.value);l&&e&&Array.isArray(e.children)?e.children=e.children.filter(o=>o.id!==l.id):(B.value=B.value.filter(o=>o.id!==le.value),l&&l.type==="group"&&He(l.id)),le.value=null}function Vt(l){(!l.className||!l.className.trim())&&(l.className=`cls-${String(l.id).slice(0,8)}`)}function Tt(l){try{Vt(l);const e=String(l.className||"").trim();String(l.customClassCss||"").trim()||(l.customClassCss=`.${e} {
  
}`)}catch{}}function qo(l){const e=String(l||"").trim();return e?e.split(";").map(o=>{const n=o.trim();return n?/!important\s*$/.test(n)?n+";":n+" !important;":""}).filter(Boolean).join(`
`):""}function Yo(l){return String(l||"").replace(/\{([^}]*)\}/g,(e,o)=>`{
`+String(o||"").split(";").map(n=>{const s=n.trim();return s?s.startsWith("@")||!/:/.test(s)||/!important\s*$/.test(s)?s+";":s+" !important;":""}).filter(Boolean).join(`
`)+`
}`)}function Xo(l){try{if(!l.enableClassStyle)return;Vt(l);const e=String(l.customClassCss||"").trim();if(!e)return;const o=`custom-class-${l.id}`;let n=document.getElementById(o);if(n||(n=document.createElement("style"),n.id=o,document.head.appendChild(n)),/{[^}]*}/.test(e)){n.textContent=Yo(e);return}const s=qo(e);n.textContent=`.${String(l.className).trim()} {
${s}
}`}catch(e){console.warn("注入自定义类样式失败：",e)}}function Bt(l){try{const e=`custom-class-${l}`,o=document.getElementById(e);o&&o.remove()}catch{}}function Ut(l,e){for(const o of l)e(o),o.type==="group"&&Array.isArray(o.children)&&Ut(o.children,e)}let Ot=null;function at(){Ot&&clearTimeout(Ot),Ot=setTimeout(()=>{try{Ut(B.value,l=>{l.enableClassStyle&&l.customClassCss&&l.className?Xo(l):Bt(l.id)})}catch(l){console.warn("刷新自定义类样式失败：",l)}},50)}async function Zo(){var l,e,o,n,s,i,x,f,b,j;try{const c=t.value;if(!c){alert("请先选中要保存的元素或分组");return}const A=ge.value||(c.type==="group"?"分组组件":"元素组件"),E=prompt("请输入组件名称",A);if(E===null)return;const I=(E||A).trim()||"未命名组件";let $=[];if(c.type==="group"&&Array.isArray(c.children)){const m=Number((e=(l=c.left)!=null?l:c.x)!=null?e:0),k=Number((n=(o=c.top)!=null?o:c.y)!=null?n:0);$=c.children.map(h=>{var T,ee,H,Z,se,de;const u=JSON.parse(JSON.stringify(h)),O=Number((ee=(T=u.left)!=null?T:u.x)!=null?ee:0),Q=Number((Z=(H=u.top)!=null?H:u.y)!=null?Z:0);u.left=m+O,u.top=k+Q,u.x=u.left,u.y=u.top;const w=je.value[h.id],F=Number(u.width||0),U=Number(u.height||0);if(!(F>0)){const Se=(()=>{var pe,$e,me,Fe,Ee;if(u.type==="text"){const qe=Number((pe=u.fontSize)!=null?pe:16),wt=String(($e=u.text)!=null?$e:"").trim();return Math.max(50,Math.round((wt.length||2)*qe*.6))}if(u.type==="image")return 100;if(u.type==="chart")return 240;if(u.type==="line"){const qe=Number((Fe=(me=u.style)==null?void 0:me.lineThickness)!=null?Fe:2);return(((Ee=u.style)==null?void 0:Ee.lineOrientation)||"horizontal")==="vertical"?qe:100}return 50})();u.width=Math.max(1,Math.round((se=w==null?void 0:w.width)!=null?se:Se))}if(!(U>0)){const Se=(()=>{var pe,$e,me,Fe;if(u.type==="text"){const Ee=Number((pe=u.fontSize)!=null?pe:16);return Math.max(20,Math.round(Ee*1.5))}if(u.type==="image")return 100;if(u.type==="chart")return 160;if(u.type==="line"){const Ee=Number((me=($e=u.style)==null?void 0:$e.lineThickness)!=null?me:2);return(((Fe=u.style)==null?void 0:Fe.lineOrientation)||"horizontal")==="vertical"?100:Ee}return 20})();u.height=Math.max(1,Math.round((de=w==null?void 0:w.height)!=null?de:Se))}return u.id=`${u.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,u})}else{const m=JSON.parse(JSON.stringify(c)),k=Number((i=(s=m.left)!=null?s:m.x)!=null?i:0),h=Number((f=(x=m.top)!=null?x:m.y)!=null?f:0);m.left=k,m.top=h,m.x=m.left,m.y=m.top;const u=je.value[c.id],O=Number(m.width||0),Q=Number(m.height||0);if(!(O>0)){const w=(()=>{var F,U,T,ee,H;if(m.type==="text"){const Z=Number((F=m.fontSize)!=null?F:16),se=String((U=m.text)!=null?U:"").trim();return Math.max(50,Math.round((se.length||2)*Z*.6))}if(m.type==="image")return 100;if(m.type==="chart")return 240;if(m.type==="line"){const Z=Number((ee=(T=m.style)==null?void 0:T.lineThickness)!=null?ee:2);return(((H=m.style)==null?void 0:H.lineOrientation)||"horizontal")==="vertical"?Z:100}return 50})();m.width=Math.max(1,Math.round((b=u==null?void 0:u.width)!=null?b:w))}if(!(Q>0)){const w=(()=>{var F,U,T,ee;if(m.type==="text"){const H=Number((F=m.fontSize)!=null?F:16);return Math.max(20,Math.round(H*1.5))}if(m.type==="image")return 100;if(m.type==="chart")return 160;if(m.type==="line"){const H=Number((T=(U=m.style)==null?void 0:U.lineThickness)!=null?T:2);return(((ee=m.style)==null?void 0:ee.lineOrientation)||"horizontal")==="vertical"?100:H}return 20})();m.height=Math.max(1,Math.round((j=u==null?void 0:u.height)!=null?j:w))}m.id=`${m.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,$=[m]}const K=Math.min(...$.map(m=>{var k,h;return Number((h=(k=m.left)!=null?k:m.x)!=null?h:0)})),J=Math.min(...$.map(m=>{var k,h;return Number((h=(k=m.top)!=null?k:m.y)!=null?h:0)})),ne=Math.max(...$.map(m=>{var k,h,u;return Number((h=(k=m.left)!=null?k:m.x)!=null?h:0)+Number((u=m.width)!=null?u:0)})),oe=Math.max(...$.map(m=>{var k,h,u;return Number((h=(k=m.top)!=null?k:m.y)!=null?h:0)+Number((u=m.height)!=null?u:0)})),z=Math.max(1,Math.round(ne-K)),N=Math.max(1,Math.round(oe-J));$=$.map(m=>{var O,Q,w,F;const k=JSON.parse(JSON.stringify(m)),h=Number((Q=(O=k.left)!=null?O:k.x)!=null?Q:0)-K,u=Number((F=(w=k.top)!=null?w:k.y)!=null?F:0)-J;return k.left=Math.max(0,Math.round(h)),k.top=Math.max(0,Math.round(u)),k.x=k.left,k.y=k.top,k});const D={width:z,height:N,backgroundUrl:"",backgroundColor:"transparent",globalFontFamily:g.globalFontFamily,globalFontSize:g.globalFontSize,globalColor:g.globalColor},X=`${Date.now()}${Math.random().toString(36).slice(2,9)}`,Oe={id:X,name:I,description:"",tags:[],elements:$,config:D,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await Ie.init(),await Ie.saveComponent(JSON.parse(JSON.stringify(Oe))),await It(`component-${X}`,{config:D,elements:$,exportName:I}),alert("组件已保存到组件库")}catch(c){console.warn("保存组件失败：",c),alert("保存组件失败，请稍后重试")}}function _o(){const l=t.value;!l||l.type!=="text"||(ce(),l.autoSize=!0)}async function Ko(){var c,A;const l=t.value;if(!l||l.type!=="text")return;await kn();const e=l.id,o=je.value[e],n=ze(l),s=String(l.text||"").trim(),i=n&&String(n).trim().length>0||s.length>0,x=100,f=20,b=i&&(c=o==null?void 0:o.width)!=null?c:x,j=i&&(A=o==null?void 0:o.height)!=null?A:f;ce(),l.width=Math.round(Math.max(1,b)),l.height=Math.round(Math.max(1,j)),l.autoSize=!1}function Qo(l){var o;const e=(o=l.target.files)==null?void 0:o[0];if(e&&t.value){const n=new FileReader;n.onload=()=>{t.value&&(t.value.src=String(n.result),t.value.iconId=void 0)},n.readAsDataURL(e)}}const en=q(null);function tn(l){var n;const e=(n=l.target.files)==null?void 0:n[0];if(!e)return;const o=new FileReader;o.onload=()=>{const s=String(o.result);g.backgroundUrl=s;const i=new Image;i.onload=()=>{en.value={width:i.naturalWidth,height:i.naturalHeight},g.width=i.naturalWidth,g.height=i.naturalHeight},i.src=s},o.readAsDataURL(e)}function Jt(l){var e;return l&&((e=l.split(",")[0])!=null?e:"").trim().replace(/^['"]|['"]$/g,"")||null}function St(l){return{"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","font/ttf":"ttf","font/otf":"otf","font/woff":"woff","font/woff2":"woff2","application/font-ttf":"ttf","application/font-otf":"otf","application/font-woff":"woff","application/font-woff2":"woff2","application/octet-stream":"bin"}[l]||"bin"}async function rn(){const l=prompt("请输入导出组件名称",ge.value||"GeneratedComponent");if(l===null)return;const e=l.trim()||"GeneratedComponent";ge.value=e;const o=[],n=z=>{for(const N of z)N.type==="group"&&Array.isArray(N.children)?n(N.children):N.type==="image"&&N.src&&o.push(N)};n(B.value);const s=[];let i=0;for(const z of o)try{const N=await(await fetch(String(z.src))).blob(),D=St(N.type),X=`${e}_img_${i}.${D}`;s.push({fileName:X,blob:N}),i++}catch(N){console.warn("导出图片失败：",N)}let x=null,f=null;if(g.backgroundUrl)try{const z=await(await fetch(String(g.backgroundUrl))).blob(),N=St(z.type);x=`${e}_bg.${N}`,f=z}catch(z){console.warn("导出背景图片失败：",z)}const b=new Set,j=Jt(g.globalFontFamily);j&&b.add(j);const c=z=>{var N;for(const D of z)if(D.type==="group"&&Array.isArray(D.children))c(D.children);else if(D.type==="text"){const X=Jt((N=D.style)==null?void 0:N.fontFamily);X&&b.add(X)}};c(B.value);const A=[],E=[];if(b.size>0)try{const z="lowcode-fonts",N="fonts",D=await new Promise((k,h)=>{const u=indexedDB.open(z);u.onsuccess=()=>{const O=u.result;if(O.objectStoreNames.contains(N))k(O);else{const Q=O.version+1;O.close();const w=indexedDB.open(z,Q);w.onupgradeneeded=()=>{const F=w.result;F.objectStoreNames.contains(N)||F.createObjectStore(N,{keyPath:"id"})},w.onsuccess=()=>k(w.result),w.onerror=()=>h(w.error)}},u.onerror=()=>h(u.error)}),X=await new Promise((k,h)=>{const u=D.transaction(N,"readonly").objectStore(N).getAll();u.onsuccess=()=>k(u.result),u.onerror=()=>h(u.error)}),Oe=L.value,m=Oe?X.filter(k=>k.projectId===Oe):X.filter(k=>!k.projectId);for(const k of m)if(b.has(k.name)){const h=new Blob([k.buffer],{type:k.mime}),u=St(k.mime),O=k.name.replace(/[^A-Za-z0-9_\-]/g,"_"),Q=`${e}_${O}.${u}`;A.push({family:k.name,file:Q}),E.push({file:Q,blob:h})}}catch(z){console.warn("读取字体库失败：",z)}const I=Tn(e,g,B.value,{imageFileNames:s.map(z=>z.fileName),backgroundFileName:f&&x?x:null,fontFaces:A},Ae.value),$=new Bn.default,K=$.folder(e);K.file("index.vue",I);const J=K.folder("imgs");for(const z of s)J.file(z.fileName,z.blob);f&&x&&J.file(x,f);const ne=K.folder("fonts");for(const z of E)ne.file(z.file,z.blob);const oe=await $.generateAsync({type:"blob"});(0,Un.saveAs)(oe,`${e}.zip`)}function ln(){confirm("确认清空当前画布与元素吗？")&&(B.value=[],le.value=null)}const Te=q(1),ot=q(null);function an(){Te.value=Math.min(2,+(Te.value+.1).toFixed(2))}function on(){Te.value=Math.max(.2,+(Te.value-.1).toFixed(2))}function Gt(){const l=ot.value;if(!l)return;const e=l.clientWidth-16,o=l.clientHeight-16,n=e/g.width,s=o/g.height;Te.value=+Math.max(.2,Math.min(2,Math.min(n,s))).toFixed(2)}Dt(async()=>{Gt(),await yt()});function nn(l){l.style=l.style||{},l.style.textGradient=l.style.textGradient||{colors:["#00A3FF","#ffffff"],angle:0}}function sn(l){l.style=l.style||{},l.style.backgroundGradient=l.style.backgroundGradient||{colors:["#00A3FF","#ffffff"],angle:90}}const bt=q([]);async function un(l){const e=t.value;if(!e||e.type!=="image")return;const o=await ht(l.id);if(!o)return;e.src=o,e.iconId=l.id;const n=new Image;n.onload=()=>{const s=t.value;s&&s.id===e.id&&(s.width=n.naturalWidth,s.height=n.naturalHeight)},n.src=o}function dn(){const l=t.value;if(!l||l.type!=="image"||!l.src)return;const e=new Image;e.onload=()=>{t.value&&(t.value.width=e.naturalWidth,t.value.height=e.naturalHeight)},e.src=l.src}function pn(){}function Pt(l){const e=JSON.parse(JSON.stringify(l));return e.id=`${l.type}-${Date.now()}`,e.left=(l.left||0)+10,e.top=(l.top||0)+10,e.x=e.left,e.y=e.top,e.zIndex=(l.zIndex||1)+1,e}function cn(){var n,s,i,x,f,b,j,c,A,E,I,$,K,J,ne;if(!t.value)return;const l=t.value,e=Pt(l),{parentGroup:o}=Ve(l.id);if(o){const oe=Number((s=(n=o.left)!=null?n:o.x)!=null?s:0),z=Number((x=(i=o.top)!=null?i:o.y)!=null?x:0),N=Number((f=o.width)!=null?f:0),D=Number((b=o.height)!=null?b:0),X=oe+N,Oe=z+D,m=Number((j=l.width)!=null?j:0),k=Number((c=l.height)!=null?c:0);let h=m,u=k;if(!h||!u)if(l.type==="text"){const ee=Number((A=l.fontSize)!=null?A:16),H=String((I=(E=l.text)!=null?E:l.content)!=null?I:"").trim();h=Math.max(m||50,Math.round((H.length||2)*ee*.6)),u=Math.max(k||20,Math.round(ee*1.5))}else l.type==="image"?(h=m||200,u=k||150):l.type==="chart"?(h=m||240,u=k||160):l.type==="line"?(h=m||200,u=k||2):(h=m||100,u=k||60);const O=10,Q=oe+N/2,w=z+D/2;let F=!1,U=X+O,T=Math.round(w-u/2);if(!F&&U+h<=g.width&&(e.left=Math.max(0,Math.min(U,Math.max(0,g.width-h))),e.top=Math.max(0,Math.min(T,Math.max(0,g.height-u))),F=!0),U=oe-h-O,T=Math.round(w-u/2),!F&&U>=0&&(e.left=Math.max(0,Math.min(U,Math.max(0,g.width-h))),e.top=Math.max(0,Math.min(T,Math.max(0,g.height-u))),F=!0),U=Math.round(Q-h/2),T=Oe+O,!F&&T+u<=g.height&&(e.left=Math.max(0,Math.min(U,Math.max(0,g.width-h))),e.top=Math.max(0,Math.min(T,Math.max(0,g.height-u))),F=!0),U=Math.round(Q-h/2),T=z-u-O,!F&&T>=0&&(e.left=Math.max(0,Math.min(U,Math.max(0,g.width-h))),e.top=Math.max(0,Math.min(T,Math.max(0,g.height-u))),F=!0),!F){const ee=Number((K=($=l.left)!=null?$:l.x)!=null?K:0),H=Number((ne=(J=l.top)!=null?J:l.y)!=null?ne:0),Z=oe+ee+O,se=z+H+O;e.left=Math.max(0,Math.min(Math.round(Z),Math.max(0,g.width-h))),e.top=Math.max(0,Math.min(Math.round(se),Math.max(0,g.height-u)))}e.x=e.left,e.y=e.top}ce(),B.value.push(e),le.value=e.id}const mt=q(!1),Nt=q([]),Ct=q(""),Mt=q(!1),Wt=Je(()=>{const l=Ct.value.trim().toLowerCase();return l?Nt.value.filter(e=>e.name.toLowerCase().includes(l)||(e.description||"").toLowerCase().includes(l)||Array.isArray(e.tags)&&e.tags.some(o=>o.toLowerCase().includes(l))):Nt.value});async function Rt(){try{Mt.value=!0,await Ie.init(),Nt.value=(await Ie.getAllComponents()||[]).sort((l,e)=>(e.updatedAt||0)-(l.updatedAt||0))}catch(l){console.warn("加载组件缓存失败：",l)}finally{Mt.value=!1}}async function vn(){await Rt(),mt.value=!0}function Ht(){mt.value=!1}function gn(l){const e=[],o=[],n=[],s=[];function i(c){var I,$,K,J,ne;const A=Number(c.width||0),E=Number(c.height||0);if(A>0&&E>0)return{w:A,h:E};if(c.type==="text"){const oe=Number((I=c.fontSize)!=null?I:16),z=String(($=c.text)!=null?$:"").trim(),N=Math.max(50,Math.round((z.length||2)*oe*.6)),D=Math.max(20,Math.round(oe*1.5));return{w:A||N,h:E||D}}if(c.type==="image")return{w:A||100,h:E||100};if(c.type==="chart")return{w:A||240,h:E||160};if(c.type==="line"){const oe=Number((J=(K=c.style)==null?void 0:K.lineThickness)!=null?J:2);return(((ne=c.style)==null?void 0:ne.lineOrientation)||"horizontal")==="vertical"?{w:A||oe,h:E||100}:{w:A||100,h:E||oe}}return{w:A||50,h:E||20}}for(const c of l){const A=Number(c.left||c.x||0),E=Number(c.top||c.y||0),{w:I,h:$}=i(c);e.push(A),o.push(E),n.push(A+(I||0)),s.push(E+($||0))}const x=e.length?Math.min(...e):0,f=o.length?Math.min(...o):0,b=n.length?Math.max(...n):x,j=s.length?Math.max(...s):f;return{minX:x,minY:f,maxX:b,maxY:j,width:Math.max(0,b-x),height:Math.max(0,j-f)}}async function yn(l){var e,o,n,s,i,x,f,b,j,c;try{const A=await Yt(`component-${l.id}`),E=JSON.parse(JSON.stringify((A==null?void 0:A.elements)||l.elements||[]));if(!E||E.length===0){console.warn("该组件没有可插入的元素");return}const I=ot.value,$=Te.value||1,K=(e=I==null?void 0:I.clientWidth)!=null?e:0,J=(o=I==null?void 0:I.clientHeight)!=null?o:0,ne=I?(I.scrollLeft+K/2)/$:20,oe=I?(I.scrollTop+J/2)/$:20,z=gn(E),N=z.minX+z.width/2,D=z.minY+z.height/2,X=Math.round(ne-N),Oe=Math.round(oe-D),m=B.value.reduce((h,u)=>Math.max(h,Number(u.zIndex||0)),0);let k=null;if(E.length===1){const h=E[0];if(!h){console.warn("单元素组件插入失败：源元素不存在");return}const u=h,O=JSON.parse(JSON.stringify(u));O.id=`${u.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;const Q=Number((s=(n=O.left)!=null?n:O.x)!=null?s:0),w=Number((x=(i=O.top)!=null?i:O.y)!=null?x:0);O.left=Math.round(Q+X),O.top=Math.round(w+Oe),O.x=O.left,O.y=O.top;const{w:F,h:U}=(function(){var H,Z,se,de,Se;const T=Number(O.width||0),ee=Number(O.height||0);if(T>0&&ee>0)return{w:T,h:ee};if(O.type==="text"){const pe=Number((H=O.fontSize)!=null?H:16),$e=String((Z=O.text)!=null?Z:"").trim(),me=Math.max(50,Math.round(($e.length||2)*pe*.6)),Fe=Math.max(20,Math.round(pe*1.5));return{w:T||me,h:ee||Fe}}if(O.type==="image")return{w:T||100,h:ee||100};if(O.type==="chart")return{w:T||240,h:ee||160};if(O.type==="line"){const pe=Number((de=(se=O.style)==null?void 0:se.lineThickness)!=null?de:2);return(((Se=O.style)==null?void 0:Se.lineOrientation)||"horizontal")==="vertical"?{w:T||pe,h:ee||100}:{w:T||100,h:ee||pe}}return{w:T||50,h:ee||20}})();if(O.width=F,O.height=U,O.type==="image"&&!(O.src||"").startsWith("data:")&&O.iconId)try{ht(O.iconId).then(T=>{T&&(O.src=T)}).catch(()=>{})}catch{}O.zIndex=Math.max(1,m+1),ce(),B.value=B.value.concat(O),le.value=O.id,k=O.id}else{const h=`group-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,u=[];for(const Q of E){const w=JSON.parse(JSON.stringify(Q));w.id=`${Q.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;const F=Number((b=(f=w.left)!=null?f:w.x)!=null?b:0),U=Number((c=(j=w.top)!=null?j:w.y)!=null?c:0);w.left=Math.round(F-z.minX),w.top=Math.round(U-z.minY),w.x=w.left,w.y=w.top;const{w:T,h:ee}=(function(){var se,de,Se,pe,$e;const H=Number(w.width||0),Z=Number(w.height||0);if(H>0&&Z>0)return{w:H,h:Z};if(w.type==="text"){const me=Number((se=w.fontSize)!=null?se:16),Fe=String((de=w.text)!=null?de:"").trim(),Ee=Math.max(50,Math.round((Fe.length||2)*me*.6)),qe=Math.max(20,Math.round(me*1.5));return{w:H||Ee,h:Z||qe}}if(w.type==="image")return{w:H||100,h:Z||100};if(w.type==="chart")return{w:H||240,h:Z||160};if(w.type==="line"){const me=Number((pe=(Se=w.style)==null?void 0:Se.lineThickness)!=null?pe:2);return((($e=w.style)==null?void 0:$e.lineOrientation)||"horizontal")==="vertical"?{w:H||me,h:Z||100}:{w:H||100,h:Z||me}}return{w:H||50,h:Z||20}})();if(w.width=T,w.height=ee,w.type==="image"&&!(w.src||"").startsWith("data:")&&w.iconId)try{ht(w.iconId).then(H=>{H&&(w.src=H)}).catch(()=>{})}catch{}u.push(w)}const O={id:h,type:"group",left:Math.round(z.minX+X),top:Math.round(z.minY+Oe),width:Math.max(1,Math.round(z.width)),height:Math.max(1,Math.round(z.height)),zIndex:Math.max(1,m+1),className:l.name?`component-${l.name.replace(/[^A-Za-z0-9_-]/g,"-")}`:void 0,children:u,componentId:l.id,editable:!0,style:{backgroundColor:"transparent"}};ce(),B.value=B.value.concat(O),le.value=O.id,k=h}try{if(k){const h=await Ie.getFontsByComponentId(l.id);if(Array.isArray(h)&&h.length>0){let u=document.getElementById(`component-fonts-${k}`);u||(u=document.createElement("style"),u.id=`component-fonts-${k}`,document.head.appendChild(u));const O=[];for(const Q of h){const w=String(Q.name||"").replace(/[^A-Za-z0-9_\-]/g,"_"),F=Q.bufferBase64;F&&O.push(`@font-face { font-family: '${w}'; src: url('${F}'); font-weight: normal; font-style: normal; font-display: swap; }`)}u.textContent=O.join(`
`)}}}catch(h){console.warn("注入组件字体失败：",h)}try{if(k){const h=await Ie.getDatabaseObjectsByComponentId(l.id);Array.isArray(h)&&h.length>0&&be(k,h.map(u=>({name:u.name,content:u.content})))}}catch(h){console.warn("注入组件数据库对象失败：",h)}await Ie.incrementUsageCount(l.id),mt.value=!1}catch(A){console.warn("插入组件失败：",A)}}const $t=()=>L.value?`lowcode-builder-state-${L.value}`:"lowcode-builder-state-v1",At=()=>L.value?v.isComponent?`component-${L.value}`:`project-${L.value}`:"default";async function qt(){return new Promise((l,e)=>{const o="lowcode-builder",n="states",s=indexedDB.open(o);s.onerror=()=>e(s.error),s.onupgradeneeded=()=>{const i=s.result;i.objectStoreNames.contains(n)||i.createObjectStore(n,{keyPath:"id"})},s.onsuccess=()=>{const i=s.result;if(i.objectStoreNames.contains(n))l(i);else{const x=i.version+1;i.close();const f=indexedDB.open(o,x);f.onerror=()=>e(f.error),f.onupgradeneeded=()=>{const b=f.result;b.objectStoreNames.contains(n)||b.createObjectStore(n,{keyPath:"id"})},f.onsuccess=()=>l(f.result)}}})}async function It(l,e){try{const o=JSON.parse(JSON.stringify(e)),n=await qt();await new Promise((s,i)=>{const x=n.transaction("states","readwrite").objectStore("states").put({id:l,...o,updatedAt:Date.now()});x.onsuccess=()=>s(),x.onerror=()=>i(x.error)})}catch(o){console.warn("保存到 IndexedDB 失败：",o);try{const n=$t(),s=JSON.stringify(e);localStorage.setItem(n,s)}catch(n){console.warn("localStorage 备份也失败：",n)}}}async function Yt(l){try{const e=await qt(),o=await new Promise((n,s)=>{const i=e.transaction("states","readonly").objectStore("states").get(l);i.onsuccess=()=>n(i.result||null),i.onerror=()=>s(i.error)});return o?{config:o.config,elements:o.elements,exportName:o.exportName}:null}catch(e){return console.warn("从 IndexedDB 恢复失败：",e),null}}let jt=null;function zt(){jt&&clearTimeout(jt),jt=setTimeout(()=>{const l={config:g,elements:B.value,exportName:ge.value};try{const e=async()=>{if(await It(At(),l),v.isComponent&&L.value)try{const o=String(L.value),n=await Ie.getComponent(o),s={id:o,name:ge.value||(n==null?void 0:n.name)||"未命名组件",description:(n==null?void 0:n.description)||"",tags:(n==null?void 0:n.tags)||[],elements:B.value,config:g,usageCount:(n==null?void 0:n.usageCount)||0,createdAt:(n==null?void 0:n.createdAt)||Date.now(),updatedAt:Date.now()};await Ie.saveComponent(JSON.parse(JSON.stringify(s))),Kt()}catch(o){console.warn("同步保存组件记录失败：",o)}};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{e()}):e()}catch(e){console.warn("保存失败：",e)}},400)}Ze(g,zt,{deep:!0}),Ze(B,zt,{deep:!0}),Ze(ge,zt),Ze(B,()=>{at()},{deep:!0}),Ze(le,()=>{var e;const l=B.value.find(o=>o.id===le.value);l&&l.type==="chart"&&(Pe.value="visual",Re.value="",V.value=JSON.stringify((e=l.chartOption)!=null?e:De(l.chartType||"line"),null,2))});function fn(){Re.value="";try{const l=JSON.parse(V.value);t.value&&t.value.type==="chart"&&(t.value.chartOption=l)}catch(l){Re.value=`JSON 解析失败：${(l==null?void 0:l.message)||String(l)}`}}function Xt(l,e){if(!t.value||t.value.type!=="chart"||!t.value.chartOption)return;const o=t.value.chartOption,n=o.series||[],s={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:l},{offset:1,color:e}],global:!1};n.forEach(i=>{i.type==="bar"&&(i.itemStyle=i.itemStyle||{},i.itemStyle.color=s)}),V.value=JSON.stringify(o,null,2)}async function xn(){try{const l="lowcode-icons",e="icons",o=await new Promise((i,x)=>{const f=indexedDB.open(l);f.onsuccess=()=>{const b=f.result;if(b.objectStoreNames.contains(e))i(b);else{const j=b.version+1;b.close();const c=indexedDB.open(l,j);c.onupgradeneeded=()=>{const A=c.result;A.objectStoreNames.contains(e)||A.createObjectStore(e,{keyPath:"id"})},c.onsuccess=()=>i(c.result),c.onerror=()=>x(c.error)}},f.onerror=()=>x(f.error)}),n=await new Promise((i,x)=>{const f=o.transaction(e,"readonly").objectStore(e).getAll();f.onsuccess=()=>i(f.result),f.onerror=()=>x(f.error)}),s=L.value;bt.value=(s?n.filter(i=>i.projectId===s):n.filter(i=>!i.projectId)).map(i=>{const x=new Blob([i.buffer],{type:i.mime}),f=URL.createObjectURL(x);return{id:i.id,url:f,name:i.name}})}catch(l){console.warn("图标库初始化失败：",l)}}async function ht(l){try{const e="lowcode-icons",o="icons",n=await new Promise((x,f)=>{const b=indexedDB.open(e);b.onsuccess=()=>{const j=b.result;if(j.objectStoreNames.contains(o))x(j);else{const c=j.version+1;j.close();const A=indexedDB.open(e,c);A.onupgradeneeded=()=>{const E=A.result;E.objectStoreNames.contains(o)||E.createObjectStore(o,{keyPath:"id"})},A.onsuccess=()=>x(A.result),A.onerror=()=>f(A.error)}},b.onerror=()=>f(b.error)}),s=await new Promise((x,f)=>{const b=n.transaction(o,"readonly").objectStore(o).get(l);b.onsuccess=()=>x(b.result),b.onerror=()=>f(b.error)});if(!s||!s.buffer)return null;const i=new Blob([s.buffer],{type:s.mime||"application/octet-stream"});return await new Promise((x,f)=>{const b=new FileReader;b.onload=()=>x(String(b.result)),b.onerror=()=>f(b.error),b.readAsDataURL(i)})}catch(e){return console.warn("读取图标数据失败：",e),null}}async function Zt(){const l=B.value.filter(e=>e.type==="image");for(const e of l){if((e.src||"").startsWith("data:")||!e.iconId)continue;const o=await ht(e.iconId);o&&(e.src=o)}}async function bn(){try{const l="lowcode-fonts",e="fonts",o=await new Promise((s,i)=>{const x=indexedDB.open(l);x.onsuccess=()=>{const f=x.result;if(f.objectStoreNames.contains(e))s(f);else{const b=f.version+1;f.close();const j=indexedDB.open(l,b);j.onupgradeneeded=()=>{const c=j.result;c.objectStoreNames.contains(e)||c.createObjectStore(e,{keyPath:"id"})},j.onsuccess=()=>s(j.result),j.onerror=()=>i(j.error)}},x.onerror=()=>i(x.error)}),n=await new Promise((s,i)=>{const x=o.transaction(e,"readonly").objectStore(e).getAll();x.onsuccess=()=>s(x.result),x.onerror=()=>i(x.error)});if(n.length>0){let s=document.querySelector("style[data-font-lib]");s||(s=document.createElement("style"),s.setAttribute("data-font-lib",""),document.head.appendChild(s));const i=[],x=[],f=L.value,b=f?n.filter(c=>c.projectId===f):n.filter(c=>!c.projectId);for(const c of b){const A=new Blob([c.buffer],{type:c.mime}),E=URL.createObjectURL(A),I=c.name;x.push(I),i.push(`@font-face { font-family: '${I}'; src: url('${E}'); font-weight: normal; font-style: normal; }`)}s.textContent=i.join(`
`);const j=new Set([...ue.value,...x]);ue.value=Array.from(j)}}catch(l){console.warn("字体库初始化失败：",l)}}Dt(async()=>{await ve(),await bn(),await xn();try{if(v.isComponent&&L.value){const l=String(L.value);if(!await Ie.getComponent(l)){const e={id:l,name:ge.value||"未命名组件",description:"",tags:[],elements:[],config:g,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await Ie.saveComponent(JSON.parse(JSON.stringify(e)))}}}catch(l){console.warn("预创建组件记录失败：",l)}try{const l=await Yt(At());if(l){l.config&&Object.assign(g,l.config),Array.isArray(l.elements)&&(B.value=l.elements),typeof l.exportName=="string"&&l.exportName&&(ge.value=l.exportName),await Zt();try{B.value=B.value.map(e=>{if(e.type==="chart"&&e.style&&typeof e.style.border=="string"&&e.style.border.includes("dashed")){const o={...e,style:{...e.style}};return delete o.style.border,o}return e})}catch{}}else{const e=localStorage.getItem($t());if(e){const o=JSON.parse(e);o&&o.config&&Object.assign(g,o.config),Array.isArray(o==null?void 0:o.elements)&&(B.value=o.elements),typeof(o==null?void 0:o.exportName)=="string"&&o.exportName&&(ge.value=o.exportName),await Zt();try{B.value=B.value.map(n=>{if(n.type==="chart"&&n.style&&typeof n.style.border=="string"&&n.style.border.includes("dashed")){const s={...n,style:{...n.style}};return delete s.style.border,s}return n})}catch{}await It(At(),{config:g,elements:B.value,exportName:ge.value});try{localStorage.removeItem($t())}catch{}}}}catch(l){console.warn("恢复失败：",l)}at(),window.addEventListener("keydown",fe)}),Et(()=>{window.removeEventListener("keydown",fe),Kt()});let _t=0;async function mn(l,e){var o,n,s;try{const i=g.width||l.clientWidth||800,x=g.height||l.clientHeight||600,f=(o=e==null?void 0:e.maxWidth)!=null?o:420,b=(n=e==null?void 0:e.scale)!=null?n:Math.min(1,f/i),j=(s=e==null?void 0:e.quality)!=null?s:.85,c=l.cloneNode(!0);c.style.transform="none",c.style.transformOrigin="top left",c.style.width=`${i}px`,c.style.height=`${x}px`;const A=new XMLSerializer().serializeToString(c),E=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${Math.round(i*b)}" height="${Math.round(x*b)}">
  <foreignObject width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml" style="transform: scale(${b}); transform-origin: top left;">${A}</div>
  </foreignObject>
</svg>`,I="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(E),$=new Image;return await new Promise(K=>{$.onload=()=>{try{const J=document.createElement("canvas");J.width=$.width,J.height=$.height;const ne=J.getContext("2d");if(!ne)return K(null);ne.drawImage($,0,0);const oe=J.toDataURL("image/jpeg",j);K(oe)}catch{K(null)}},$.onerror=()=>K(null),$.src=I})}catch{return null}}async function Kt(){try{const l=Date.now();if(l-_t<5e3||(_t=l,!v.isComponent||!L.value))return;const e=ot.value;if(!e)return;const o=e.firstElementChild;if(!o)return;const n=await mn(o,{maxWidth:420,quality:.8});if(!n)return;const s=String(L.value),i=await Ie.getComponent(s);if(!i)return;const x={...i,previewDataUrl:n,updatedAt:Date.now()};await Ie.saveComponent(JSON.parse(JSON.stringify(x)))}catch(l){console.warn("生成缩略图失败：",l)}}return(l,e)=>{var o,n,s,i,x,f,b,j,c,A,E,I,$,K,J,ne,oe,z,N,D,X,Oe,m,k,h,u,O,Q,w,F,U,T,ee,H,Z,se,de,Se,pe,$e,me,Fe,Ee,qe,wt,Qt,er,tr,rr,lr,ar,or,nr,sr,ir,ur,dr,pr,cr,vr,gr,yr,fr,xr,br,mr,hr,wr,kr,Or,Sr,Nr,Cr,Mr,$r,Ar,Ir,jr,zr,Fr,Lr,Dr,Er,Vr,Tr,Br,Ur,Jr,Gr,Pr,Wr,Rr,Hr,qr,Yr,Xr,Zr,_r,Kr,Qr,el,tl,rl,ll,al,ol,nl,sl,il,ul,dl,pl,cl,vl,gl,yl,fl,xl,bl,ml,hl,wl,kl,Ol,Sl,Nl,Cl,Ml,$l,Al,Il,jl,zl,Fl,Ll,Dl,El,Vl,Tl,Bl,Ul,Jl,Gl,Pl,Wl,Rl,Hl,ql,Yl,Xl,Zl,_l,Kl,Ql,ea,ta,ra,la,aa,oa,na,sa,ia,ua,da,pa,ca,va,ga,ya,fa,xa,ba,ma,ha,wa,ka,Oa,Sa,Na,Ca,Ma,$a,Aa,Ia,ja,za,Fa,La,Da,Ea,Va,Ta,Ba,Ua,Ja,Ga,Pa,Wa,Ra,Ha,qa,Ya,Xa,Za,_a,Ka,Qa,eo,to,ro,lo,ao,oo,no,so,io,uo,po,co,vo,go,yo,fo,xo,bo,mo,ho,wo,ko,Oo,So,No,Co,Mo,$o,Ao,Io,jo,zo,Fo,Lo,Do,Eo,Vo,To,Bo,Uo,Jo;return S(),C(rt,null,[r("div",Xn,[e[245]||(e[245]=Ft('<div class="absolute inset-0 opacity-10" data-v-5ca0ef08><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-5ca0ef08></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-5ca0ef08></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-5ca0ef08></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-5ca0ef08></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-5ca0ef08></div>',2)),r("div",Zn,[r("div",_n,[e[130]||(e[130]=r("div",{class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),Go(" 画布设置 ")])],-1)),r("div",Kn,[r("div",Qn,[e[122]||(e[122]=r("label",{class:"block text-sm font-medium text-cyan-300"},"组件名称",-1)),G(r("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>ge.value=a),class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"GeneratedComponent"},null,512),[[R,ge.value]])]),r("div",es,[e[123]||(e[123]=r("label",{class:"block text-sm font-medium text-cyan-300"},"画布尺寸",-1)),r("div",ts,[G(r("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>g.width=a),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"宽度"},null,512),[[R,g.width,void 0,{number:!0}]]),G(r("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>g.height=a),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"高度"},null,512),[[R,g.height,void 0,{number:!0}]])])]),r("div",rs,[e[124]||(e[124]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景图片",-1)),r("div",ls,[r("input",{type:"file",onChange:tn,accept:"image/*",class:"flex-1 text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-cyan-600 file:text-white hover:file:bg-cyan-500 file:cursor-pointer"},null,32)])]),r("div",as,[e[125]||(e[125]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景颜色",-1)),r("div",os,[r("input",{value:tt(g.backgroundColor),type:"color",onInput:e[3]||(e[3]=a=>{g.backgroundColor=a.target.value}),class:"w-16 h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,40,ns),G(r("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>g.backgroundColor=a),type:"text",class:"flex-1 px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"#000000 或 rgba(...)"},null,512),[[R,g.backgroundColor]])])]),r("div",ss,[e[129]||(e[129]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"全局字体设置",-1)),r("div",is,[e[126]||(e[126]=r("label",{class:"block text-xs text-gray-400"},"字体族",-1)),Be(Ye,{options:ue.value,modelValue:g.globalFontFamily,"onUpdate:modelValue":e[5]||(e[5]=a=>g.globalFontFamily=a),placeholder:"选择字体"},null,8,["options","modelValue"])]),r("div",us,[e[127]||(e[127]=r("label",{class:"block text-xs text-gray-400"},"字号 (px)",-1)),G(r("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>g.globalFontSize=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-cyan-500/30 rounded text-gray-100 text-sm focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[R,g.globalFontSize,void 0,{number:!0}]])]),r("div",ds,[e[128]||(e[128]=r("label",{class:"block text-xs text-gray-400"},"颜色",-1)),G(r("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>g.globalColor=a),type:"color",class:"w-full h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,512),[[R,g.globalColor]])])]),r("div",{class:"space-y-2 pt-4 border-t border-cyan-500/30"},[r("button",{onClick:Ne,class:"w-full px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"}," 预览（新窗口） "),r("button",{onClick:rn,class:"w-full px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"}," 导出 Vue2 组件 "),r("button",{onClick:ln,class:"w-full px-4 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"}," 清空画布 ")])])]),r("div",ps,[r("div",cs,[r("div",vs,[r("button",{onClick:e[8]||(e[8]=a=>Ke("text")),class:"px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"}," + 文本 "),r("button",{onClick:e[9]||(e[9]=a=>Ke("image")),class:"px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-green-500/25"}," + 图片 "),r("button",{onClick:e[10]||(e[10]=a=>Ke("chart")),class:"px-4 py-2 bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-500 hover:to-red-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-orange-500/25"}," + 图表 "),r("button",{onClick:e[11]||(e[11]=a=>Ke("line")),class:"px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"}," + 线条 "),r("button",{onClick:vn,class:"px-4 py-2 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-pink-500/25"}," 插入组件 ")]),r("div",gs,[r("button",{onClick:on,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...e[131]||(e[131]=[r("span",{class:"text-gray-300"},"-",-1)])]),r("span",ys,Ue(Math.round(Te.value*100))+"%",1),r("button",{onClick:an,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...e[132]||(e[132]=[r("span",{class:"text-gray-300"},"+",-1)])]),r("button",{onClick:Gt,class:"px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg text-xs text-gray-300 transition-colors duration-200"}," 适应 ")])]),r("div",{ref_key:"canvasScrollRef",ref:ot,class:"flex-1 overflow-auto bg-gray-800/30 p-4 min-h-0 custom-scrollbar"},[r("div",{class:"relative border border-gray-600/50 bg-gray-100 shadow-2xl mx-auto",style:Xe({width:`${g.width}px`,height:`${g.height}px`,backgroundColor:g.backgroundColor||"transparent",backgroundImage:g.backgroundUrl?`url(${g.backgroundUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`scale(${Te.value})`,transformOrigin:"top left"})},[re.value?(S(),C("div",fs,[we.value.left?(S(),C("div",{key:0,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:Xe([{"border-width":"0.5px"},{left:`${ae.value.left}px`}])},null,4)):P("",!0),we.value.right?(S(),C("div",{key:1,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:Xe([{"border-width":"0.5px"},{left:`${ae.value.right}px`}])},null,4)):P("",!0),we.value.top?(S(),C("div",{key:2,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:Xe([{"border-width":"0.5px"},{top:`${ae.value.top}px`}])},null,4)):P("",!0),we.value.bottom?(S(),C("div",{key:3,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:Xe([{"border-width":"0.5px"},{top:`${ae.value.bottom}px`}])},null,4)):P("",!0),we.value.centerV?(S(),C("div",{key:4,class:"absolute top-0 bottom-0 border-l border-dashed border-blue-400/60",style:Xe([{"border-width":"0.5px"},{left:`${ae.value.centerX}px`}])},null,4)):P("",!0),we.value.centerH?(S(),C("div",{key:5,class:"absolute left-0 right-0 border-t border-dashed border-blue-400/60",style:Xe([{"border-width":"0.5px"},{top:`${ae.value.centerY}px`}])},null,4)):P("",!0)])):P("",!0),(S(!0),C(rt,null,st(B.value,a=>(S(),Wo(Ln,{key:a.id,element:a,selected:a.id===le.value,"selected-id":le.value,config:g,zoom:Te.value,dbMap:Ae.value,"metrics-map":je.value,onSelect:dt,"onUpdate:position":it,"onUpdate:size":ut,onShowGuidelines:ct,onHideGuidelines:vt,onReportMetrics:Le},null,8,["element","selected","selected-id","config","zoom","dbMap","metrics-map"]))),128))],4)],512)]),r("div",xs,[e[244]||(e[244]=r("div",{class:"p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-purple-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),Go(" 元素设置 ")])],-1)),t.value?(S(),C("div",bs,[r("div",ms,[e[138]||(e[138]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"位置和尺寸",-1)),r("div",hs,[r("div",null,[e[133]||(e[133]=r("label",{class:"block text-xs text-gray-400 mb-1"},"X",-1)),G(r("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>t.value.left=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.left,void 0,{number:!0}]])]),r("div",null,[e[134]||(e[134]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y",-1)),G(r("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>t.value.top=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.top,void 0,{number:!0}]])]),r("div",null,[e[135]||(e[135]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度",-1)),G(r("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>t.value.width=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.width,void 0,{number:!0}]])]),r("div",null,[e[136]||(e[136]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度",-1)),G(r("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>t.value.height=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.height,void 0,{number:!0}]])]),r("div",ws,[e[137]||(e[137]=r("label",{class:"block text-xs text-gray-400 mb-1"},"层级（z-index）",-1)),G(r("input",{"onUpdate:modelValue":e[16]||(e[16]=a=>t.value.zIndex=a),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.zIndex,void 0,{number:!0}]])])])]),r("div",ks,[e[144]||(e[144]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"元素属性",-1)),r("div",Os,[r("div",Ss,[e[139]||(e[139]=r("label",{class:"text-xs text-gray-400"},"启用 Class 样式",-1)),G(r("input",{type:"checkbox","onUpdate:modelValue":e[17]||(e[17]=a=>t.value.enableClassStyle=a),onChange:e[18]||(e[18]=a=>{t.value&&a.target.checked?(Tt(t.value),at()):t.value&&!a.target.checked&&Bt(t.value.id)}),class:"rounded border-purple-500/30 text-purple-400 focus:ring-purple-400"},null,544),[[Fn,t.value.enableClassStyle]])]),(o=t.value)!=null&&o.enableClassStyle?(S(),C("div",Ns,[e[140]||(e[140]=r("label",{class:"block text-xs text-gray-400 mb-1"},"CSS Class",-1)),r("div",Cs,[G(r("input",{"onUpdate:modelValue":e[19]||(e[19]=a=>t.value.className=a),type:"text",placeholder:"自动生成唯一类名，可修改",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.className]]),r("button",{type:"button",onClick:e[20]||(e[20]=()=>{t.value&&(t.value.className=`cls-${String(t.value.id).slice(0,8)}`,Tt(t.value),at())}),class:"px-2 py-1 text-xs bg-purple-600/60 hover:bg-purple-600 rounded text-white"},"生成默认")])])):P("",!0),(n=t.value)!=null&&n.enableClassStyle?(S(),C("div",Ms,[e[141]||(e[141]=r("label",{class:"block text-xs text-gray-400 mb-1"},"自定义样式（CSS 声明）",-1)),Be(Yn,{modelValue:String((s=t.value.customClassCss)!=null?s:""),"onUpdate:modelValue":e[21]||(e[21]=a=>{t.value.customClassCss=a,at()}),height:"180px"},null,8,["modelValue"]),e[142]||(e[142]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"提示：已为当前类名生成 .className { } 模板；也可直接填写声明，系统会自动包裹并追加 !important。",-1))])):P("",!0),t.value&&t.value.type==="chart"?(S(),C("div",$s,[e[143]||(e[143]=r("label",{class:"block text-xs text-gray-400 mb-1"},"元素ID",-1)),G(r("input",{"onUpdate:modelValue":e[22]||(e[22]=a=>t.value.elementId=a),type:"text",placeholder:"输入元素ID",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.elementId]])])):P("",!0)])]),t.value&&t.value.type==="chart"?(S(),C("div",As,[e[192]||(e[192]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"图表配置",-1)),r("div",Is,[r("button",{onClick:e[23]||(e[23]=a=>Pe.value="visual"),class:he(["px-3 py-1 rounded text-sm",Pe.value==="visual"?"bg-purple-600/60":"bg-gray-700"])},"可视化",2),r("button",{onClick:e[24]||(e[24]=a=>Pe.value="json"),class:he(["px-3 py-1 rounded text-sm",Pe.value==="json"?"bg-purple-600/60":"bg-gray-700"])},"JSON",2)]),Pe.value==="visual"?(S(),C("div",js,[r("div",null,[e[145]||(e[145]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图表类型",-1)),Be(Ye,{options:["line","bar","pie","mix"],modelValue:t.value.chartType||"line","onUpdate:modelValue":e[25]||(e[25]=a=>{t.value&&(t.value.chartType=a,t.value.chartOption=De(a),V.value=JSON.stringify(t.value.chartOption,null,2))})},null,8,["modelValue"])]),r("div",null,[e[146]||(e[146]=r("label",{class:"block text-xs text-gray-400 mb-1"},"标题",-1)),r("input",{value:((f=(x=(i=t.value)==null?void 0:i.chartOption)==null?void 0:x.title)==null?void 0:f.text)||"",onInput:e[26]||(e[26]=a=>{const d=a.target.value;t.value&&(t.value.chartOption||(t.value.chartOption=De(t.value.chartType||"line")),t.value.chartOption.title=t.value.chartOption.title||{},t.value.chartOption.title.text=d,V.value=JSON.stringify(t.value.chartOption,null,2))}),type:"text",placeholder:"输入图表标题",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,zs)]),r("div",Fs,[r("div",null,[e[147]||(e[147]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色列表（逗号分隔）",-1)),r("input",{value:((c=(j=(b=t.value)==null?void 0:b.chartOption)==null?void 0:j.color)==null?void 0:c.join(","))||"",onInput:e[27]||(e[27]=a=>{const d=a.target.value.split(",").map(p=>p.trim()).filter(Boolean);t.value&&(t.value.chartOption||(t.value.chartOption=De(t.value.chartType||"line")),t.value.chartOption.color=d,V.value=JSON.stringify(t.value.chartOption,null,2))}),type:"text",placeholder:"#42b883,#ff9800",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ls)]),r("div",null,[e[149]||(e[149]=r("label",{class:"block text-xs text-gray-400 mb-1"},"显示图例",-1)),r("select",{value:($=(I=(E=(A=t.value)==null?void 0:A.chartOption)==null?void 0:E.legend)==null?void 0:I.show)==null||$?"1":"0",onChange:e[28]||(e[28]=a=>{const d=a.target.value==="1";t.value&&(t.value.chartOption||(t.value.chartOption=De(t.value.chartType||"line")),t.value.chartOption.legend=t.value.chartOption.legend||{},t.value.chartOption.legend.show=d,V.value=JSON.stringify(t.value.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...e[148]||(e[148]=[r("option",{value:"1"},"显示",-1),r("option",{value:"0"},"隐藏",-1)])],40,Ds)])]),t.value&&t.value.chartType!=="pie"?(S(),C("div",Es,[r("div",null,[e[150]||(e[150]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最小值",-1)),r("input",{value:Array.isArray((J=(K=t.value)==null?void 0:K.chartOption)==null?void 0:J.yAxis)?(D=(N=(z=(oe=(ne=t.value)==null?void 0:ne.chartOption)==null?void 0:oe.yAxis)==null?void 0:z[0])==null?void 0:N.min)!=null?D:"":(k=(m=(Oe=(X=t.value)==null?void 0:X.chartOption)==null?void 0:Oe.yAxis)==null?void 0:m.min)!=null?k:"",onInput:e[29]||(e[29]=a=>{const d=a.target.value;if(!t.value)return;t.value.chartOption||(t.value.chartOption=De(t.value.chartType||"line"));const p=t.value.chartOption.yAxis,nt=d===""?null:Number(d);Array.isArray(p)?(p[0]=p[0]||{},p[0].min=nt):(t.value.chartOption.yAxis=p||{},t.value.chartOption.yAxis.min=nt),V.value=JSON.stringify(t.value.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Vs)]),r("div",null,[e[151]||(e[151]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最大值",-1)),r("input",{value:Array.isArray((u=(h=t.value)==null?void 0:h.chartOption)==null?void 0:u.yAxis)?(U=(F=(w=(Q=(O=t.value)==null?void 0:O.chartOption)==null?void 0:Q.yAxis)==null?void 0:w[0])==null?void 0:F.max)!=null?U:"":(Z=(H=(ee=(T=t.value)==null?void 0:T.chartOption)==null?void 0:ee.yAxis)==null?void 0:H.max)!=null?Z:"",onInput:e[30]||(e[30]=a=>{const d=a.target.value;if(!t.value)return;t.value.chartOption||(t.value.chartOption=De(t.value.chartType||"line"));const p=t.value.chartOption.yAxis,nt=d===""?null:Number(d);Array.isArray(p)?(p[0]=p[0]||{},p[0].max=nt):(t.value.chartOption.yAxis=p||{},t.value.chartOption.yAxis.max=nt),V.value=JSON.stringify(t.value.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ts)])])):P("",!0),t.value&&(t.value.chartType==="line"||t.value.chartType==="mix")?(S(),C("div",Bs,[r("div",null,[e[153]||(e[153]=r("label",{class:"block text-xs text-gray-400 mb-1"},"折线平滑",-1)),r("select",{value:"1",onChange:e[31]||(e[31]=a=>{const d=a.target.value==="1";t.value&&t.value.chartOption&&((t.value.chartOption.series||[]).forEach(p=>{p.type==="line"&&(p.smooth=d)}),V.value=JSON.stringify(t.value.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...e[152]||(e[152]=[r("option",{value:"1"},"平滑",-1),r("option",{value:"0"},"不平滑",-1)])],32)]),r("div",null,[e[154]||(e[154]=r("label",{class:"block text-xs text-gray-400 mb-1"},"线宽",-1)),r("input",{value:2,onInput:e[32]||(e[32]=a=>{const d=Number(a.target.value)||2;t.value&&t.value.chartOption&&((t.value.chartOption.series||[]).forEach(p=>{p.type==="line"&&(p.lineStyle=p.lineStyle||{},p.lineStyle.width=d)}),V.value=JSON.stringify(t.value.chartOption,null,2))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):P("",!0),t.value&&(t.value.chartType==="bar"||t.value.chartType==="mix")?(S(),C("div",Us,[r("div",null,[e[155]||(e[155]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变起始色",-1)),r("input",{type:"color",value:"#42b883",onInput:e[33]||(e[33]=a=>{const d=a.target.value;Xt(d,"#0ea5e9")}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[e[156]||(e[156]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变结束色",-1)),r("input",{type:"color",value:"#0ea5e9",onInput:e[34]||(e[34]=a=>{const d=a.target.value;Xt("#42b883",d)}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[e[157]||(e[157]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),r("input",{value:4,onInput:e[35]||(e[35]=a=>{const d=Number(a.target.value)||0;t.value&&t.value.chartOption&&((t.value.chartOption.series||[]).forEach(p=>{p.type==="bar"&&(p.itemStyle=p.itemStyle||{},p.itemStyle.borderRadius=[d,d,0,0])}),V.value=JSON.stringify(t.value.chartOption,null,2))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):P("",!0)])):P("",!0),Pe.value==="visual"?(S(),C("div",Js,[e[190]||(e[190]=r("h4",{class:"text-xs font-medium text-purple-300"},"高级配置",-1)),r("div",Gs,[r("div",null,[e[158]||(e[158]=r("label",{class:"block text-xs text-gray-400 mb-1"},"显示标题",-1)),r("select",{value:(pe=(Se=(de=(se=t.value)==null?void 0:se.chartOption)==null?void 0:de.title)==null?void 0:Se.show)==null||pe?"1":"0",onChange:e[36]||(e[36]=a=>{const d=a.target.value==="1";t.value&&(t.value.chartOption=t.value.chartOption||{},t.value.chartOption.title=t.value.chartOption.title||{},t.value.chartOption.title.show=d,V.value=JSON.stringify(t.value.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ps)]),r("div",null,[e[159]||(e[159]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图例显示",-1)),r("select",{value:(Ee=(Fe=(me=($e=t.value)==null?void 0:$e.chartOption)==null?void 0:me.legend)==null?void 0:Fe.show)==null||Ee?"1":"0",onChange:e[37]||(e[37]=a=>{const d=a.target.value==="1";t.value&&(t.value.chartOption=t.value.chartOption||{},t.value.chartOption.legend=t.value.chartOption.legend||{},t.value.chartOption.legend.show=d,V.value=JSON.stringify(t.value.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ws)])]),r("div",Rs,[e[166]||(e[166]=r("label",{class:"block text-xs text-gray-400 mb-1"},"提示框样式",-1)),r("div",Hs,[r("div",null,[e[160]||(e[160]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"背景色",-1)),r("input",{type:"text",value:((Qt=(wt=(qe=t.value)==null?void 0:qe.chartOption)==null?void 0:wt.tooltip)==null?void 0:Qt.backgroundColor)||"",onInput:e[38]||(e[38]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.tooltip=t.value.chartOption.tooltip||{},t.value.chartOption.tooltip.backgroundColor=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,qs)]),r("div",null,[e[161]||(e[161]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"边框色",-1)),r("input",{type:"text",value:((rr=(tr=(er=t.value)==null?void 0:er.chartOption)==null?void 0:tr.tooltip)==null?void 0:rr.borderColor)||"",onInput:e[39]||(e[39]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.tooltip=t.value.chartOption.tooltip||{},t.value.chartOption.tooltip.borderColor=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ys)]),r("div",null,[e[162]||(e[162]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"边框粗细",-1)),r("input",{type:"number",value:(nr=(or=(ar=(lr=t.value)==null?void 0:lr.chartOption)==null?void 0:ar.tooltip)==null?void 0:or.borderWidth)!=null?nr:0,onInput:e[40]||(e[40]=a=>{if(!t.value)return;const d=Number(a.target.value)||0;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.tooltip=t.value.chartOption.tooltip||{},t.value.chartOption.tooltip.borderWidth=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Xs)])]),r("div",Zs,[r("div",null,[e[163]||(e[163]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"文字大小",-1)),r("input",{type:"number",value:(pr=(dr=(ur=(ir=(sr=t.value)==null?void 0:sr.chartOption)==null?void 0:ir.tooltip)==null?void 0:ur.textStyle)==null?void 0:dr.fontSize)!=null?pr:"",onInput:e[41]||(e[41]=a=>{if(!t.value)return;const d=Number(a.target.value)||0;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.tooltip=t.value.chartOption.tooltip||{},t.value.chartOption.tooltip.textStyle=t.value.chartOption.tooltip.textStyle||{},t.value.chartOption.tooltip.textStyle.fontSize=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,_s)]),r("div",null,[e[164]||(e[164]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"阴影色",-1)),r("input",{type:"text",value:((fr=(yr=(gr=(vr=(cr=t.value)==null?void 0:cr.chartOption)==null?void 0:vr.tooltip)==null?void 0:gr.axisPointer)==null?void 0:yr.shadowStyle)==null?void 0:fr.color)||"",onInput:e[42]||(e[42]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.tooltip=t.value.chartOption.tooltip||{},t.value.chartOption.tooltip.axisPointer=t.value.chartOption.tooltip.axisPointer||{},t.value.chartOption.tooltip.axisPointer.shadowStyle=t.value.chartOption.tooltip.axisPointer.shadowStyle||{},t.value.chartOption.tooltip.axisPointer.shadowStyle.color=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ks)]),r("div",null,[e[165]||(e[165]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"额外CSS",-1)),r("input",{type:"text",value:((mr=(br=(xr=t.value)==null?void 0:xr.chartOption)==null?void 0:br.tooltip)==null?void 0:mr.extraCssText)||"",onInput:e[43]||(e[43]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.tooltip=t.value.chartOption.tooltip||{},t.value.chartOption.tooltip.extraCssText=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Qs)])])]),r("div",ei,[r("div",null,[e[167]||(e[167]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"grid.top",-1)),r("input",{type:"text",value:((kr=(wr=(hr=t.value)==null?void 0:hr.chartOption)==null?void 0:wr.grid)==null?void 0:kr.top)||"",onInput:e[44]||(e[44]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.grid=t.value.chartOption.grid||{},t.value.chartOption.grid.top=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ti)]),r("div",null,[e[168]||(e[168]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"grid.right",-1)),r("input",{type:"text",value:((Nr=(Sr=(Or=t.value)==null?void 0:Or.chartOption)==null?void 0:Sr.grid)==null?void 0:Nr.right)||"",onInput:e[45]||(e[45]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.grid=t.value.chartOption.grid||{},t.value.chartOption.grid.right=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ri)]),r("div",null,[e[169]||(e[169]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"grid.bottom",-1)),r("input",{type:"text",value:(($r=(Mr=(Cr=t.value)==null?void 0:Cr.chartOption)==null?void 0:Mr.grid)==null?void 0:$r.bottom)||"",onInput:e[46]||(e[46]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.grid=t.value.chartOption.grid||{},t.value.chartOption.grid.bottom=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,li)]),r("div",null,[e[170]||(e[170]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"grid.left",-1)),r("input",{type:"text",value:((jr=(Ir=(Ar=t.value)==null?void 0:Ar.chartOption)==null?void 0:Ir.grid)==null?void 0:jr.left)||"",onInput:e[47]||(e[47]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.grid=t.value.chartOption.grid||{},t.value.chartOption.grid.left=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ai)])]),r("div",oi,[e[176]||(e[176]=r("label",{class:"block text-xs text-gray-400 mb-1"},"X轴样式",-1)),r("div",ni,[r("div",null,[e[171]||(e[171]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"标签大小",-1)),r("input",{type:"number",value:(Er=(Dr=(Lr=(Fr=(zr=t.value)==null?void 0:zr.chartOption)==null?void 0:Fr.xAxis)==null?void 0:Lr.axisLabel)==null?void 0:Dr.fontSize)!=null?Er:"",onInput:e[48]||(e[48]=a=>{if(!t.value)return;const d=Number(a.target.value)||0;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.xAxis=t.value.chartOption.xAxis||{},t.value.chartOption.xAxis.axisLabel=t.value.chartOption.xAxis.axisLabel||{},t.value.chartOption.xAxis.axisLabel.fontSize=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,si)]),r("div",null,[e[172]||(e[172]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"标签颜色",-1)),r("input",{type:"text",value:((Ur=(Br=(Tr=(Vr=t.value)==null?void 0:Vr.chartOption)==null?void 0:Tr.xAxis)==null?void 0:Br.axisLabel)==null?void 0:Ur.color)||"",onInput:e[49]||(e[49]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.xAxis=t.value.chartOption.xAxis||{},t.value.chartOption.xAxis.axisLabel=t.value.chartOption.xAxis.axisLabel||{},t.value.chartOption.xAxis.axisLabel.color=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ii)]),r("div",null,[e[173]||(e[173]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"标签间距",-1)),r("input",{type:"number",value:(Rr=(Wr=(Pr=(Gr=(Jr=t.value)==null?void 0:Jr.chartOption)==null?void 0:Gr.xAxis)==null?void 0:Pr.axisLabel)==null?void 0:Wr.margin)!=null?Rr:0,onInput:e[50]||(e[50]=a=>{if(!t.value)return;const d=Number(a.target.value)||0;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.xAxis=t.value.chartOption.xAxis||{},t.value.chartOption.xAxis.axisLabel=t.value.chartOption.xAxis.axisLabel||{},t.value.chartOption.xAxis.axisLabel.margin=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ui)])]),r("div",di,[r("div",null,[e[174]||(e[174]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"轴线颜色",-1)),r("input",{type:"text",value:((Zr=(Xr=(Yr=(qr=(Hr=t.value)==null?void 0:Hr.chartOption)==null?void 0:qr.xAxis)==null?void 0:Yr.axisLine)==null?void 0:Xr.lineStyle)==null?void 0:Zr.color)||"",onInput:e[51]||(e[51]=a=>{if(!t.value)return;const d=a.target.value;t.value.chartOption=t.value.chartOption||{},t.value.chartOption.xAxis=t.value.chartOption.xAxis||{},t.value.chartOption.xAxis.axisLine=t.value.chartOption.xAxis.axisLine||{},t.value.chartOption.xAxis.axisLine.lineStyle=t.value.chartOption.xAxis.axisLine.lineStyle||{},t.value.chartOption.xAxis.axisLine.lineStyle.color=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,pi)]),r("div",null,[e[175]||(e[175]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"显示刻度",-1)),r("select",{value:(tl=(el=(Qr=(Kr=(_r=t.value)==null?void 0:_r.chartOption)==null?void 0:Kr.xAxis)==null?void 0:Qr.axisTick)==null?void 0:el.show)!=null&&tl?"1":"0",onChange:e[52]||(e[52]=a=>{if(!t.value)return;const d=a.target.value==="1";t.value.chartOption=t.value.chartOption||{},t.value.chartOption.xAxis=t.value.chartOption.xAxis||{},t.value.chartOption.xAxis.axisTick=t.value.chartOption.xAxis.axisTick||{},t.value.chartOption.xAxis.axisTick.show=d,V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ci)])])]),r("div",vi,[e[181]||(e[181]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴样式（左/右）",-1)),r("div",gi,[r("div",yi,[e[177]||(e[177]=r("div",{class:"text-[11px] text-gray-400"},"左轴标签大小",-1)),r("input",{type:"number",value:Array.isArray((ll=(rl=t.value)==null?void 0:rl.chartOption)==null?void 0:ll.yAxis)?(ul=(il=(sl=(nl=(ol=(al=t.value)==null?void 0:al.chartOption)==null?void 0:ol.yAxis)==null?void 0:nl[0])==null?void 0:sl.axisLabel)==null?void 0:il.fontSize)!=null?ul:"":(gl=(vl=(cl=(pl=(dl=t.value)==null?void 0:dl.chartOption)==null?void 0:pl.yAxis)==null?void 0:cl.axisLabel)==null?void 0:vl.fontSize)!=null?gl:"",onInput:e[53]||(e[53]=a=>{if(!t.value)return;const d=Number(a.target.value)||0,p=t.value.chartOption.yAxis=t.value.chartOption.yAxis||{};Array.isArray(p)?(p[0]=p[0]||{},p[0].axisLabel=p[0].axisLabel||{},p[0].axisLabel.fontSize=d):(t.value.chartOption.yAxis.axisLabel=t.value.chartOption.yAxis.axisLabel||{},t.value.chartOption.yAxis.axisLabel.fontSize=d),V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,fi),e[178]||(e[178]=r("div",{class:"text-[11px] text-gray-400"},"左轴线颜色",-1)),r("input",{type:"text",value:Array.isArray((fl=(yl=t.value)==null?void 0:yl.chartOption)==null?void 0:fl.yAxis)?((kl=(wl=(hl=(ml=(bl=(xl=t.value)==null?void 0:xl.chartOption)==null?void 0:bl.yAxis)==null?void 0:ml[0])==null?void 0:hl.axisLine)==null?void 0:wl.lineStyle)==null?void 0:kl.color)||"":((Ml=(Cl=(Nl=(Sl=(Ol=t.value)==null?void 0:Ol.chartOption)==null?void 0:Sl.yAxis)==null?void 0:Nl.axisLine)==null?void 0:Cl.lineStyle)==null?void 0:Ml.color)||"",onInput:e[54]||(e[54]=a=>{if(!t.value)return;const d=a.target.value,p=t.value.chartOption.yAxis=t.value.chartOption.yAxis||{};Array.isArray(p)?(p[0]=p[0]||{},p[0].axisLine=p[0].axisLine||{},p[0].axisLine.lineStyle=p[0].axisLine.lineStyle||{},p[0].axisLine.lineStyle.color=d):(t.value.chartOption.yAxis.axisLine=t.value.chartOption.yAxis.axisLine||{},t.value.chartOption.yAxis.axisLine.lineStyle=t.value.chartOption.yAxis.axisLine.lineStyle||{},t.value.chartOption.yAxis.axisLine.lineStyle.color=d),V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,xi)]),r("div",bi,[e[179]||(e[179]=r("div",{class:"text-[11px] text-gray-400"},"右轴标签大小",-1)),r("input",{type:"number",value:Array.isArray((Al=($l=t.value)==null?void 0:$l.chartOption)==null?void 0:Al.yAxis)&&(Dl=(Ll=(Fl=(zl=(jl=(Il=t.value)==null?void 0:Il.chartOption)==null?void 0:jl.yAxis)==null?void 0:zl[1])==null?void 0:Fl.axisLabel)==null?void 0:Ll.fontSize)!=null?Dl:"",onInput:e[55]||(e[55]=a=>{if(!t.value)return;const d=Number(a.target.value)||0,p=t.value.chartOption.yAxis;Array.isArray(p)&&(p[1]=p[1]||{},p[1].axisLabel=p[1].axisLabel||{},p[1].axisLabel.fontSize=d,V.value=JSON.stringify(t.value.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,mi),e[180]||(e[180]=r("div",{class:"text-[11px] text-gray-400"},"右轴线颜色",-1)),r("input",{type:"text",value:Array.isArray((Vl=(El=t.value)==null?void 0:El.chartOption)==null?void 0:Vl.yAxis)&&((Pl=(Gl=(Jl=(Ul=(Bl=(Tl=t.value)==null?void 0:Tl.chartOption)==null?void 0:Bl.yAxis)==null?void 0:Ul[1])==null?void 0:Jl.axisLine)==null?void 0:Gl.lineStyle)==null?void 0:Pl.color)||"",onInput:e[56]||(e[56]=a=>{if(!t.value)return;const d=a.target.value,p=t.value.chartOption.yAxis;Array.isArray(p)&&(p[1]=p[1]||{},p[1].axisLine=p[1].axisLine||{},p[1].axisLine.lineStyle=p[1].axisLine.lineStyle||{},p[1].axisLine.lineStyle.color=d,V.value=JSON.stringify(t.value.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,hi)])])]),t.value&&(t.value.chartType==="bar"||t.value.chartType==="mix")?(S(),C("div",wi,[e[184]||(e[184]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状系列",-1)),r("div",ki,[r("div",null,[e[182]||(e[182]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"宽度",-1)),r("input",{type:"number",value:(ql=(Hl=(((Rl=(Wl=t.value)==null?void 0:Wl.chartOption)==null?void 0:Rl.series)||[]).find(a=>a.type==="bar"))==null?void 0:Hl.barWidth)!=null?ql:"",onInput:e[57]||(e[57]=a=>{if(!t.value)return;const d=a.target.value;(t.value.chartOption.series||[]).forEach(p=>{p.type==="bar"&&(p.barWidth=d)}),V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Oi)]),r("div",null,[e[183]||(e[183]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"显示数值",-1)),r("select",{value:(Kl=(_l=(Zl=(((Xl=(Yl=t.value)==null?void 0:Yl.chartOption)==null?void 0:Xl.series)||[]).find(a=>a.type==="bar"))==null?void 0:Zl.label)==null?void 0:_l.show)!=null&&Kl?"1":"0",onChange:e[58]||(e[58]=a=>{if(!t.value)return;const d=a.target.value==="1";(t.value.chartOption.series||[]).forEach(p=>{p.type==="bar"&&(p.label=p.label||{},p.label.show=d)}),V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Si)])])])):P("",!0),t.value&&(t.value.chartType==="line"||t.value.chartType==="mix")?(S(),C("div",Ni,[e[189]||(e[189]=r("label",{class:"block text-xs text-gray-400 mb-1"},"折线系列",-1)),r("div",Ci,[r("div",null,[e[185]||(e[185]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"线颜色",-1)),r("input",{type:"text",value:((ra=(ta=(((ea=(Ql=t.value)==null?void 0:Ql.chartOption)==null?void 0:ea.series)||[]).find(a=>a.type==="line"))==null?void 0:ta.lineStyle)==null?void 0:ra.color)||"",onInput:e[59]||(e[59]=a=>{if(!t.value)return;const d=a.target.value;(t.value.chartOption.series||[]).forEach(p=>{p.type==="line"&&(p.lineStyle=p.lineStyle||{},p.lineStyle.color=d)}),V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Mi)]),r("div",null,[e[187]||(e[187]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"符号",-1)),r("select",{value:((oa=(((aa=(la=t.value)==null?void 0:la.chartOption)==null?void 0:aa.series)||[]).find(a=>a.type==="line"))==null?void 0:oa.symbol)||"none",onChange:e[60]||(e[60]=a=>{if(!t.value)return;const d=a.target.value;(t.value.chartOption.series||[]).forEach(p=>{p.type==="line"&&(p.symbol=d)}),V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},[...e[186]||(e[186]=[r("option",{value:"none"},"none",-1),r("option",{value:"circle"},"circle",-1),r("option",{value:"rect"},"rect",-1)])],40,$i)]),r("div",null,[e[188]||(e[188]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"强调颜色",-1)),r("input",{type:"text",value:((da=(ua=(ia=(((sa=(na=t.value)==null?void 0:na.chartOption)==null?void 0:sa.series)||[]).find(a=>a.type==="line"))==null?void 0:ia.emphasis)==null?void 0:ua.lineStyle)==null?void 0:da.color)||"",onInput:e[61]||(e[61]=a=>{if(!t.value)return;const d=a.target.value;(t.value.chartOption.series||[]).forEach(p=>{p.type==="line"&&(p.emphasis=p.emphasis||{},p.emphasis.lineStyle=p.emphasis.lineStyle||{},p.emphasis.lineStyle.color=d)}),V.value=JSON.stringify(t.value.chartOption,null,2)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ai)])])])):P("",!0)])):(S(),C("div",Ii,[e[191]||(e[191]=r("label",{class:"block text-xs text-gray-400 mb-1"},"ECharts Option JSON",-1)),G(r("textarea",{"onUpdate:modelValue":e[62]||(e[62]=a=>V.value=a),rows:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs font-mono"},null,512),[[R,V.value]]),r("div",ji,[r("button",{onClick:e[63]||(e[63]=a=>fn()),class:"px-3 py-1 bg-emerald-600 rounded text-sm"},"应用配置"),Re.value?(S(),C("div",zi,Ue(Re.value),1)):P("",!0)])]))])):P("",!0),t.value&&t.value.type==="line"?(S(),C("div",Fi,[e[200]||(e[200]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"线条设置",-1)),r("div",Li,[e[193]||(e[193]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",Di,[r("input",{value:tt(((ca=(pa=t.value)==null?void 0:pa.style)==null?void 0:ca.lineColor)||""),onInput:e[64]||(e[64]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineColor=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Ei),r("input",{value:(ya=(ga=(va=t.value)==null?void 0:va.style)==null?void 0:ga.lineColor)!=null?ya:"#ffffff",onInput:e[65]||(e[65]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineColor=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,40,Vi)])]),r("div",Ti,[r("div",null,[e[194]||(e[194]=r("label",{class:"block text-xs text-gray-400 mb-1"},"方向",-1)),r("div",Bi,[r("button",{onClick:e[66]||(e[66]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineOrientation="horizontal")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((xa=(fa=t.value)==null?void 0:fa.style)==null?void 0:xa.lineOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:e[67]||(e[67]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineOrientation="vertical")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ma=(ba=t.value)==null?void 0:ba.style)==null?void 0:ma.lineOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)])]),r("div",null,[e[195]||(e[195]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细(px)",-1)),r("input",{value:(ka=(wa=(ha=t.value)==null?void 0:ha.style)==null?void 0:wa.lineThickness)!=null?ka:2,onInput:e[68]||(e[68]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineThickness=Number(a.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ui)])]),r("div",Ji,[r("div",null,[e[197]||(e[197]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),r("select",{value:((Sa=(Oa=t.value)==null?void 0:Oa.style)==null?void 0:Sa.lineStyle)||"solid",onChange:e[69]||(e[69]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineStyle=a.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...e[196]||(e[196]=[r("option",{value:"solid"},"实线",-1),r("option",{value:"dashed"},"虚线",-1)])],40,Gi)]),((Ca=(Na=t.value)==null?void 0:Na.style)==null?void 0:Ca.lineStyle)==="dashed"?(S(),C("div",Pi,[e[198]||(e[198]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线长度(px)",-1)),r("input",{value:(Aa=($a=(Ma=t.value)==null?void 0:Ma.style)==null?void 0:$a.lineDashLength)!=null?Aa:6,onInput:e[70]||(e[70]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineDashLength=Number(a.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Wi)])):P("",!0)]),((ja=(Ia=t.value)==null?void 0:Ia.style)==null?void 0:ja.lineStyle)==="dashed"?(S(),C("div",Ri,[r("div",null,[e[199]||(e[199]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线间距(px)",-1)),r("input",{value:(La=(Fa=(za=t.value)==null?void 0:za.style)==null?void 0:Fa.lineDashGap)!=null?La:4,onInput:e[71]||(e[71]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineDashGap=Number(a.target.value))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Hi)])])):P("",!0)])):P("",!0),t.value&&t.value.type==="text"?(S(),C("div",qi,[e[233]||(e[233]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"文本设置",-1)),r("div",Yi,[e[205]||(e[205]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),G(r("textarea",{"onUpdate:modelValue":e[72]||(e[72]=a=>t.value.text=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[R,t.value.text]]),r("div",Xi,[e[204]||(e[204]=r("label",{class:"block text-xs text-gray-400 mb-1"},"动态值",-1)),r("div",Zi,[r("input",{type:"checkbox",checked:!!((Ea=(Da=t.value)==null?void 0:Da.dynamic)!=null&&Ea.enabled),onChange:e[73]||(e[73]=a=>{t.value&&(t.value.dynamic=t.value.dynamic||{enabled:!1,objectName:"",propertyPath:""},t.value.dynamic.enabled=a.target.checked)}),class:"rounded accent-purple-600"},null,40,_i),e[201]||(e[201]=r("span",{class:"text-xs text-gray-400"},"启用后从数据库对象绑定",-1))]),(Ta=(Va=t.value)==null?void 0:Va.dynamic)!=null&&Ta.enabled?(S(),C("div",Ki,[r("div",null,[e[202]||(e[202]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择对象",-1)),Be(Ye,{options:We.value.map(a=>a.name),modelValue:((Ua=(Ba=t.value)==null?void 0:Ba.dynamic)==null?void 0:Ua.objectName)||"","onUpdate:modelValue":e[74]||(e[74]=a=>{t.value&&(t.value.dynamic=t.value.dynamic||{enabled:!0,objectName:"",propertyPath:""},t.value.dynamic.objectName=String(a||""))})},null,8,["options","modelValue"])]),r("div",null,[e[203]||(e[203]=r("label",{class:"block text-xs text-gray-400 mb-1"},"属性路径",-1)),Be(Ye,{options:et.value,modelValue:((Ga=(Ja=t.value)==null?void 0:Ja.dynamic)==null?void 0:Ga.propertyPath)||"","onUpdate:modelValue":e[75]||(e[75]=a=>{t.value&&(t.value.dynamic=t.value.dynamic||{enabled:!0,objectName:"",propertyPath:""},t.value.dynamic.propertyPath=String(a||""))})},null,8,["options","modelValue"])]),r("div",Qi," 预览值: "+Ue(ze(t.value)),1)])):P("",!0)])]),r("div",eu,[e[206]||(e[206]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",tu,[r("button",{onClick:_o,class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",t.value.autoSize!==!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 自适应 ",2),r("button",{onClick:Ko,class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",t.value.autoSize===!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 固定尺寸 ",2)])]),r("div",ru,[r("div",null,[e[207]||(e[207]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),Be(Ye,{options:ie.value,modelValue:((Pa=t.value.style)==null?void 0:Pa.fontSize)||14,"onUpdate:modelValue":e[76]||(e[76]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.fontSize=a)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[e[208]||(e[208]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),Be(Ye,{options:ue.value,modelValue:((Wa=t.value.style)==null?void 0:Wa.fontFamily)||g.globalFontFamily,"onUpdate:modelValue":e[77]||(e[77]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.fontFamily=a)})},null,8,["options","modelValue"])])]),r("div",lu,[r("div",null,[e[209]||(e[209]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),Be(Ye,{options:_e.value,modelValue:((Ra=t.value.style)==null?void 0:Ra.fontWeight)||"400","onUpdate:modelValue":e[78]||(e[78]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.fontWeight=a)})},null,8,["options","modelValue"])]),r("div",null,[e[210]||(e[210]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),Be(Ye,{options:lt.value,modelValue:((Ha=t.value.style)==null?void 0:Ha.fontStyle)||"normal","onUpdate:modelValue":e[79]||(e[79]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.fontStyle=a)})},null,8,["options","modelValue"])])]),r("div",au,[r("div",null,[e[211]||(e[211]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:((qa=t.value.style)==null?void 0:qa.letterSpacing)||0,onInput:e[80]||(e[80]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.letterSpacing=Number(a.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,ou)]),r("div",null,[e[212]||(e[212]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:((Ya=t.value.style)==null?void 0:Ya.lineHeight)||1.5,onInput:e[81]||(e[81]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.lineHeight=Number(a.target.value))}),type:"number",step:"0.1",min:"0.5",max:"3",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,nu)])]),r("div",su,[e[213]||(e[213]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",iu,[r("input",{value:(Za=(Xa=t.value)==null?void 0:Xa.style)!=null&&Za.textGradient?"#000000":((Ka=(_a=t.value)==null?void 0:_a.style)==null?void 0:Ka.color)||g.globalColor,onInput:e[82]||(e[82]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.color=a.target.value)}),type:"color",disabled:!!((eo=(Qa=t.value)==null?void 0:Qa.style)!=null&&eo.textGradient),class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"},null,40,uu),r("input",{value:(ro=(to=t.value)==null?void 0:to.style)!=null&&ro.textGradient?"transparent":(oo=(ao=(lo=t.value)==null?void 0:lo.style)==null?void 0:ao.color)!=null?oo:g.globalColor,onInput:e[83]||(e[83]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.color=a.target.value)}),type:"text",disabled:!!((so=(no=t.value)==null?void 0:no.style)!=null&&so.textGradient),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"#000000"},null,40,du)]),(uo=(io=t.value)==null?void 0:io.style)!=null&&uo.textGradient?(S(),C("div",pu," 文字渐变启用时，文字颜色自动设为透明 ")):P("",!0)]),r("div",cu,[e[214]||(e[214]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色",-1)),r("div",vu,[r("input",{value:tt(((co=(po=t.value)==null?void 0:po.style)==null?void 0:co.backgroundColor)||""),onInput:e[84]||(e[84]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.backgroundColor=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,gu),r("input",{value:(yo=(go=(vo=t.value)==null?void 0:vo.style)==null?void 0:go.backgroundColor)!=null?yo:"transparent",onInput:e[85]||(e[85]=a=>{t.value&&(t.value.style=t.value.style||{},t.value.style.backgroundColor=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"transparent"},null,40,yu)])]),r("div",fu,[e[215]||(e[215]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本对齐",-1)),r("div",xu,[r("button",{onClick:e[86]||(e[86]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textAlign="left")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((fo=t.value.style)==null?void 0:fo.textAlign)||"left")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 左对齐 ",2),r("button",{onClick:e[87]||(e[87]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textAlign="center")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((xo=t.value.style)==null?void 0:xo.textAlign)||"left")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 居中 ",2),r("button",{onClick:e[88]||(e[88]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textAlign="right")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((bo=t.value.style)==null?void 0:bo.textAlign)||"left")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 右对齐 ",2)])]),r("div",bu,[e[216]||(e[216]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本方向",-1)),r("div",mu,[r("button",{onClick:e[89]||(e[89]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textOrientation="horizontal")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ho=(mo=t.value)==null?void 0:mo.style)==null?void 0:ho.textOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 横向 ",2),r("button",{onClick:e[90]||(e[90]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textOrientation="vertical")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ko=(wo=t.value)==null?void 0:wo.style)==null?void 0:ko.textOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 纵向 ",2)]),e[217]||(e[217]=r("p",{class:"text-[11px] text-gray-400"},"纵向使用 CSS writing-mode 展示，适合竖排文本。",-1))]),r("div",hu,[e[219]||(e[219]=r("label",{class:"block text-xs text-gray-400 mb-1"},"布局倾斜",-1)),r("div",wu,[G(r("input",{"onUpdate:modelValue":e[91]||(e[91]=a=>t.value.style.skewAngle=a),type:"range",min:"-45",max:"45",class:"flex-1"},null,512),[[R,t.value.style.skewAngle,void 0,{number:!0}]]),G(r("input",{"onUpdate:modelValue":e[92]||(e[92]=a=>t.value.style.skewAngle=a),type:"number",min:"-45",max:"45",class:"w-16 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.style.skewAngle,void 0,{number:!0}]])]),r("div",ku,[e[218]||(e[218]=r("label",{class:"text-xs text-gray-400"},"布局倾斜跟随",-1)),r("button",{onClick:e[93]||(e[93]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.skewFlowEnabled=!0)}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(So=(Oo=t.value)==null?void 0:Oo.style)!=null&&So.skewFlowEnabled?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 开 ",2),r("button",{onClick:e[94]||(e[94]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.skewFlowEnabled=!1)}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(Co=(No=t.value)==null?void 0:No.style)!=null&&Co.skewFlowEnabled?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-purple-600 text-white"])}," 关 ",2)]),e[220]||(e[220]=r("p",{class:"text-[11px] text-gray-400"},"调整整体容器的 X 轴倾斜角度（-45° ~ 45°）。启用“跟随”后，文本布局按父视图倾斜线性排布，字符保持正立，可与波形叠加。",-1))]),r("div",Ou,[r("div",Su,[e[221]||(e[221]=r("label",{class:"text-xs text-gray-400"},"文本波形",-1)),r("div",Nu,[(Ao=($o=(Mo=t.value)==null?void 0:Mo.style)==null?void 0:$o.textWave)!=null&&Ao.enabled?(S(),C("button",{key:1,onClick:e[96]||(e[96]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textWave={enabled:!1})}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):(S(),C("button",{key:0,onClick:e[95]||(e[95]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textWave={enabled:!0,amplitude:8,frequency:.5,phase:0})}),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用"))])]),(zo=(jo=(Io=t.value)==null?void 0:Io.style)==null?void 0:jo.textWave)!=null&&zo.enabled?(S(),C("div",Cu,[r("div",Mu,[e[222]||(e[222]=r("label",{class:"block text-xs text-gray-400 mb-1"},"幅度(px)",-1)),G(r("input",{"onUpdate:modelValue":e[97]||(e[97]=a=>t.value.style.textWave.amplitude=a),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.style.textWave.amplitude,void 0,{number:!0}]])]),r("div",$u,[e[223]||(e[223]=r("label",{class:"block text-xs text-gray-400 mb-1"},"频率(rad/字)",-1)),G(r("input",{"onUpdate:modelValue":e[98]||(e[98]=a=>t.value.style.textWave.frequency=a),type:"number",step:"0.1",min:"0.1",max:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.style.textWave.frequency,void 0,{number:!0}]])]),r("div",Au,[e[224]||(e[224]=r("label",{class:"block text-xs text-gray-400 mb-1"},"相位(rad)",-1)),G(r("input",{"onUpdate:modelValue":e[99]||(e[99]=a=>t.value.style.textWave.phase=a),type:"number",step:"0.1",min:"-100",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.style.textWave.phase,void 0,{number:!0}]])])])):P("",!0),e[225]||(e[225]=r("p",{class:"text-[11px] text-gray-400"},"每个字符沿 Y 轴按正弦位移，字符保持正立。",-1))]),r("div",Iu,[e[226]||(e[226]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本装饰",-1)),r("div",ju,[r("button",{onClick:e[100]||(e[100]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textDecoration=t.value.style.textDecoration==="underline"?"none":"underline")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Fo=t.value.style)==null?void 0:Fo.textDecoration)||"none")==="underline"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 下划线 ",2),r("button",{onClick:e[101]||(e[101]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textDecoration=t.value.style.textDecoration==="line-through"?"none":"line-through")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Lo=t.value.style)==null?void 0:Lo.textDecoration)||"none")==="line-through"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 删除线 ",2),r("button",{onClick:e[102]||(e[102]=()=>{t.value&&(t.value.style=t.value.style||{},t.value.style.textDecoration="none")}),class:he(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Do=t.value.style)==null?void 0:Do.textDecoration)||"none")==="none"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])}," 无 ",2)])]),r("div",zu,[r("div",Fu,[e[227]||(e[227]=r("label",{class:"text-xs text-gray-400"},"文本渐变",-1)),r("div",Lu,[(Eo=t.value.style)!=null&&Eo.textGradient?P("",!0):(S(),C("button",{key:0,onClick:e[103]||(e[103]=a=>nn(t.value)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"}," 启用 ")),(Vo=t.value.style)!=null&&Vo.textGradient?(S(),C("button",{key:1,onClick:e[104]||(e[104]=()=>{t.value&&t.value.style&&(t.value.style.textGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"}," 关闭 ")):P("",!0)])]),(To=t.value.style)!=null&&To.textGradient?(S(),C("div",Du,[r("div",Eu,[r("div",null,[e[228]||(e[228]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Vu,[G(r("input",{"onUpdate:modelValue":e[105]||(e[105]=a=>t.value.style.textGradient.colors[0]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[R,t.value.style.textGradient.colors[0]]]),G(r("input",{"onUpdate:modelValue":e[106]||(e[106]=a=>t.value.style.textGradient.colors[0]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#DFDD5A"},null,512),[[R,t.value.style.textGradient.colors[0]]])])]),r("div",null,[e[229]||(e[229]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Tu,[G(r("input",{"onUpdate:modelValue":e[107]||(e[107]=a=>t.value.style.textGradient.colors[1]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[R,t.value.style.textGradient.colors[1]]]),G(r("input",{"onUpdate:modelValue":e[108]||(e[108]=a=>t.value.style.textGradient.colors[1]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,512),[[R,t.value.style.textGradient.colors[1]]])])])]),r("div",null,[r("label",Bu,"角度: "+Ue(t.value.style.textGradient.angle||0)+"°",1),G(r("input",{"onUpdate:modelValue":e[109]||(e[109]=a=>t.value.style.textGradient.angle=a),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[R,t.value.style.textGradient.angle,void 0,{number:!0}]])])])):P("",!0)]),r("div",Uu,[r("div",Ju,[e[230]||(e[230]=r("label",{class:"text-xs text-gray-400"},"背景渐变",-1)),r("div",Gu,[(Bo=t.value.style)!=null&&Bo.backgroundGradient?P("",!0):(S(),C("button",{key:0,onClick:e[110]||(e[110]=a=>sn(t.value)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"}," 启用 ")),(Uo=t.value.style)!=null&&Uo.backgroundGradient?(S(),C("button",{key:1,onClick:e[111]||(e[111]=()=>{t.value&&t.value.style&&(t.value.style.backgroundGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"}," 关闭 ")):P("",!0)])]),(Jo=t.value.style)!=null&&Jo.backgroundGradient?(S(),C("div",Pu,[r("div",Wu,[r("div",null,[e[231]||(e[231]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Ru,[G(r("input",{"onUpdate:modelValue":e[112]||(e[112]=a=>t.value.style.backgroundGradient.colors[0]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[R,t.value.style.backgroundGradient.colors[0]]]),G(r("input",{"onUpdate:modelValue":e[113]||(e[113]=a=>t.value.style.backgroundGradient.colors[0]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#00A3FF"},null,512),[[R,t.value.style.backgroundGradient.colors[0]]])])]),r("div",null,[e[232]||(e[232]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Hu,[G(r("input",{"onUpdate:modelValue":e[114]||(e[114]=a=>t.value.style.backgroundGradient.colors[1]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[R,t.value.style.backgroundGradient.colors[1]]]),G(r("input",{"onUpdate:modelValue":e[115]||(e[115]=a=>t.value.style.backgroundGradient.colors[1]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,512),[[R,t.value.style.backgroundGradient.colors[1]]])])])]),r("div",null,[r("label",qu,"角度: "+Ue(t.value.style.backgroundGradient.angle||0)+"°",1),G(r("input",{"onUpdate:modelValue":e[116]||(e[116]=a=>t.value.style.backgroundGradient.angle=a),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[R,t.value.style.backgroundGradient.angle,void 0,{number:!0}]])])])):P("",!0)])])):P("",!0),t.value&&t.value.type==="image"?(S(),C("div",Yu,[e[242]||(e[242]=Ft('<h3 class="text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1" data-v-5ca0ef08>图片设置</h3><div class="space-y-2" data-v-5ca0ef08><label class="block text-xs text-gray-400 mb-1" data-v-5ca0ef08>图片来源</label><div class="grid grid-cols-2 gap-2" data-v-5ca0ef08><button class="px-3 py-2 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200" data-v-5ca0ef08> 上传文件 </button><button class="px-3 py-2 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200" data-v-5ca0ef08> 选择图标 </button></div></div>',2)),r("div",Xu,[e[234]||(e[234]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图片文件",-1)),r("input",{type:"file",onChange:Qo,accept:"image/*",class:"w-full text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-purple-600 file:text-white hover:file:bg-purple-500 file:cursor-pointer"},null,32)]),bt.value.length>0?(S(),C("div",Zu,[e[235]||(e[235]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择图标",-1)),r("div",_u,[r("div",Ku,[(S(!0),C(rt,null,st(bt.value,a=>(S(),C("div",{key:a.id,onClick:d=>un(a),class:"aspect-square bg-gray-700/50 rounded cursor-pointer hover:bg-gray-600/50 transition-colors duration-200 flex items-center justify-center p-1 border border-transparent hover:border-green-400/50"},[r("img",{src:a.url,alt:a.name,class:"max-w-full max-h-full object-contain",loading:"lazy"},null,8,e0)],8,Qu))),128))])]),bt.value.length===0?(S(),C("div",t0," 暂无图标，请先在图标库管理中上传图标 ")):P("",!0)])):P("",!0),r("div",{class:"space-y-2"},[e[236]||(e[236]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",{class:"grid grid-cols-2 gap-2"},[r("button",{onClick:dn,class:he(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-blue-600/30 hover:bg-blue-600/50 text-blue-300"])},"自适应（原始尺寸）"),r("button",{onClick:pn,class:he(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-purple-600/30 hover:bg-purple-600/50 text-purple-300"])},"固定大小")])]),r("div",r0,[r("div",null,[e[237]||(e[237]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度(px)",-1)),G(r("input",{"onUpdate:modelValue":e[117]||(e[117]=a=>t.value.width=a),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.width,void 0,{number:!0}]])]),r("div",null,[e[238]||(e[238]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度(px)",-1)),G(r("input",{"onUpdate:modelValue":e[118]||(e[118]=a=>t.value.height=a),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.height,void 0,{number:!0}]])]),r("div",null,[e[240]||(e[240]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对象适配",-1)),G(r("select",{"onUpdate:modelValue":e[119]||(e[119]=a=>t.value.style.objectFit=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...e[239]||(e[239]=[Ft('<option value="contain" data-v-5ca0ef08>contain（完整显示）</option><option value="cover" data-v-5ca0ef08>cover（填充裁剪）</option><option value="fill" data-v-5ca0ef08>fill（拉伸填充）</option><option value="scale-down" data-v-5ca0ef08>scale-down（缩小适配）</option><option value="none" data-v-5ca0ef08>none（不适配）</option>',5)])],512),[[Mn,t.value.style.objectFit]])])]),r("div",l0,[e[241]||(e[241]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),G(r("input",{"onUpdate:modelValue":e[120]||(e[120]=a=>t.value.style.borderRadius=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[R,t.value.style.borderRadius,void 0,{number:!0}]])])])):P("",!0),r("div",{class:"pt-4 border-t border-purple-500/30 space-y-2"},[r("button",{onClick:Zo,class:"w-full px-3 py-2 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"}," 保存为组件 "),r("button",{onClick:cn,class:"w-full px-3 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-blue-500/25"}," 复制元素 "),r("button",{onClick:xt,class:"w-full px-3 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"}," 删除元素 ")])])):(S(),C("div",a0,[...e[243]||(e[243]=[r("div",{class:"w-16 h-16 mx-auto mb-4 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center"},[r("span",{class:"text-2xl"},"📝")],-1),r("p",{class:"text-sm"},"选择一个元素来编辑其属性",-1)])]))])])]),mt.value?(S(),C("div",o0,[r("div",{class:"absolute inset-0 bg-black/60",onClick:Ht}),r("div",n0,[r("div",{class:"flex items-center justify-between p-4 border-b border-fuchsia-500/30 bg-gradient-to-r from-fuchsia-600/20 to-pink-600/20"},[e[246]||(e[246]=r("h3",{class:"text-lg font-bold text-pink-300"},"插入组件",-1)),r("button",{onClick:Ht,class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",s0,[r("div",i0,[G(r("input",{"onUpdate:modelValue":e[121]||(e[121]=a=>Ct.value=a),type:"text",placeholder:"搜索名称、描述或标签",class:"flex-1 px-3 py-2 bg-gray-800/60 border border-fuchsia-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-fuchsia-400 focus:ring-1 focus:ring-fuchsia-400 focus:outline-none transition-all duration-200"},null,512),[[R,Ct.value]]),r("button",{onClick:Rt,class:"px-3 py-2 bg-pink-600/70 hover:bg-pink-600 text-white rounded"},"刷新")]),Mt.value?(S(),C("div",u0,"正在加载组件...")):(S(),C("div",d0,[Wt.value.length===0?(S(),C("div",p0,"暂无匹配的组件")):(S(),C("div",c0,[(S(!0),C(rt,null,st(Wt.value,a=>(S(),C("div",{key:a.id,class:"bg-gray-800/60 border border-pink-500/20 rounded-lg overflow-hidden"},[r("div",v0,[a.previewDataUrl?(S(),C("img",{key:0,src:a.previewDataUrl,alt:"预览",class:"max-w-full max-h-full object-contain"},null,8,g0)):(S(),C("div",y0,"无预览"))]),r("div",f0,[r("div",x0,[r("div",{class:"text-sm text-gray-100 font-medium truncate",title:a.name},Ue(a.name),9,b0),r("div",m0,Ue(a.usageCount||0)+" 次",1)]),r("div",{class:"text-xs text-gray-400 truncate",title:a.description||""},Ue(a.description||"—"),9,h0),r("div",w0,[(S(!0),C(rt,null,st(a.tags||[],d=>(S(),C("span",{key:d,class:"px-1.5 py-0.5 text-[10px] rounded bg-pink-600/30 text-pink-200"},Ue(d),1))),128))]),r("div",k0,[r("button",{onClick:d=>yn(a),class:"w-full px-3 py-1.5 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded text-sm transition"}," 插入到画布 ",8,O0)])])]))),128))]))]))])])])):P("",!0)],64)}}}),C0=Ro(N0,[["__scopeId","data-v-5ca0ef08"]]),M0=kt({__name:"index",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(te){const v=te;return(M,Y)=>(S(),Wo(C0,{"project-id":v.projectId,"current-project":v.currentProject,"is-component":v.isComponent},null,8,["project-id","current-project","is-component"]))}}),D0=M0;export{D0 as default};
