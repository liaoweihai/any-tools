import{E as V,I as d,P as m,R as r,_ as ll,d as E,f as P,l as o,lt as A,st as C,w as tl}from"./codemirror-B25QCqWr.js";import{f as p}from"./vendor-vue-C93_ecI2.js";import{t as el}from"./index-Cl0CrogP.js";var al={class:"drawing-tool"},ol={class:"toolbar"},ul={class:"tool-group"},sl={class:"tools"},il={class:"tool-group"},vl={class:"style-item"},nl={class:"style-item"},rl={class:"style-item"},dl={class:"value"},pl={key:0,class:"tool-group"},xl={class:"style-item"},cl={class:"value"},fl={class:"style-item"},yl={key:1,class:"tool-group"},hl={class:"style-item"},gl={class:"style-item"},kl={class:"tool-group"},wl={class:"actions"},bl=["disabled"],Cl={class:"canvas-container"},Ml=ll({__name:"TechRoadmap",setup(Sl){const n=r(),a=r(),y=r([]),s=r(null),R=r(!1),S=r(!1),U=r({x:0,y:0}),h=r({x:0,y:0}),i=r("select"),x=r("#3B82F6"),c=r("#000000"),g=r(2),b=r(16),k=r("#000000"),I=()=>{if(!a.value||!n.value)return;const t=20;a.value.strokeStyle="#E5E7EB",a.value.lineWidth=.5;for(let l=0;l<=n.value.width;l+=t)a.value.beginPath(),a.value.moveTo(l,0),a.value.lineTo(l,n.value.height),a.value.stroke();for(let l=0;l<=n.value.height;l+=t)a.value.beginPath(),a.value.moveTo(0,l),a.value.lineTo(n.value.width,l),a.value.stroke()},L=t=>{var l;if(a.value){switch(a.value.fillStyle=t.fillColor,a.value.strokeStyle=t.strokeColor,a.value.lineWidth=t.strokeWidth,t.type){case"rectangle":a.value.fillRect(t.x,t.y,t.width,t.height),a.value.strokeRect(t.x,t.y,t.width,t.height);break;case"circle":const u=Math.min(t.width,t.height)/2;a.value.beginPath(),a.value.arc(t.x+t.width/2,t.y+t.height/2,u,0,2*Math.PI),a.value.fill(),a.value.stroke();break;case"line":a.value.beginPath(),a.value.moveTo(t.x,t.y),a.value.lineTo(t.endX,t.endY),a.value.stroke();break;case"arrow":a.value.beginPath(),a.value.moveTo(t.x,t.y),a.value.lineTo(t.endX,t.endY),a.value.stroke();const e=Math.atan2(t.endY-t.y,t.endX-t.x),v=15,f=Math.PI/6;a.value.fillStyle=t.strokeColor,a.value.beginPath(),a.value.moveTo(t.endX,t.endY),a.value.lineTo(t.endX-v*Math.cos(e-f),t.endY-v*Math.sin(e-f)),a.value.lineTo(t.endX-v*Math.cos(e+f),t.endY-v*Math.sin(e+f)),a.value.closePath(),a.value.fill();break;case"text":a.value.fillStyle=t.textColor,a.value.font=`${t.fontSize}px Arial`,a.value.textAlign="left",a.value.textBaseline="top",a.value.fillText(t.text||"ÊñáÂ≠ó",t.x,t.y);break}if(((l=s.value)==null?void 0:l.id)===t.id){if(a.value.strokeStyle="#3B82F6",a.value.lineWidth=2,a.value.setLineDash([5,5]),t.type==="line"||t.type==="arrow"){const u=Math.min(t.x,t.endX),e=Math.min(t.y,t.endY),v=Math.max(t.x,t.endX),f=Math.max(t.y,t.endY);a.value.strokeRect(u-5,e-5,v-u+10,f-e+10)}else if(t.type==="text"){const u=a.value.measureText(t.text||"ÊñáÂ≠ó").width;a.value.strokeRect(t.x-2,t.y-2,u+4,t.fontSize+4)}else a.value.strokeRect(t.x-2,t.y-2,t.width+4,t.height+4);a.value.setLineDash([])}}},w=()=>{!a.value||!n.value||(a.value.clearRect(0,0,n.value.width,n.value.height),I(),y.value.forEach(L))},T=t=>{const l=n.value.getBoundingClientRect();return{x:t.clientX-l.left,y:t.clientY-l.top}},W=(t,l)=>{for(let u=y.value.length-1;u>=0;u--){const e=y.value[u];if(e){if(e.type==="line"||e.type==="arrow"){if(F(t,l,e.x,e.y,e.endX,e.endY)<10)return e}else if(e.type==="text"){if(!a.value)continue;a.value.font=`${e.fontSize}px Arial`;const v=a.value.measureText(e.text||"ÊñáÂ≠ó").width;if(t>=e.x&&t<=e.x+v&&l>=e.y&&l<=e.y+e.fontSize)return e}else if(t>=e.x&&t<=e.x+e.width&&l>=e.y&&l<=e.y+e.height)return e}}return null},F=(t,l,u,e,v,f)=>{const K=t-u,Q=l-e,D=v-u,z=f-e,Z=K*D+Q*z,B=D*D+z*z;let M=-1;B!==0&&(M=Z/B);let X,Y;M<0?(X=u,Y=e):M>1?(X=v,Y=f):(X=u+M*D,Y=e+M*z);const _=t-X,$=l-Y;return Math.sqrt(_*_+$*$)},q=t=>{const l=T(t);if(i.value==="select"){const u=W(l.x,l.y);u?(s.value=u,R.value=!0,U.value={x:l.x-u.x,y:l.y-u.y}):s.value=null}else if(i.value==="text"){const u={id:Date.now().toString(),type:"text",x:l.x,y:l.y,text:"ÊñáÂ≠ó",fillColor:x.value,strokeColor:c.value,strokeWidth:g.value,fontSize:b.value,textColor:k.value};y.value.push(u),s.value=u}else i.value==="line"||i.value==="arrow"?(S.value=!0,h.value={x:l.x,y:l.y}):(S.value=!0,h.value={x:l.x,y:l.y});w()},N=t=>{const l=T(t);R.value&&s.value&&(s.value.x=l.x-U.value.x,s.value.y=l.y-U.value.y,w())},G=t=>{const l=T(t);if(S.value){const u=Math.abs(l.x-h.value.x),e=Math.abs(l.y-h.value.y);if(u>5||e>5){const v={id:Date.now().toString(),type:i.value,x:Math.min(h.value.x,l.x),y:Math.min(h.value.y,l.y),fillColor:x.value,strokeColor:c.value,strokeWidth:g.value};i.value==="line"||i.value==="arrow"?(v.x=h.value.x,v.y=h.value.y,v.endX=l.x,v.endY=l.y):(v.width=u,v.height=e),y.value.push(v),s.value=v}}R.value=!1,S.value=!1,w()},O=t=>{const l=T(t),u=W(l.x,l.y);if(u&&u.type==="text"){const e=prompt("ËæìÂÖ•ÊñáÂ≠ó:",u.text);e!==null&&(u.text=e,w())}},j=()=>{s.value&&(y.value=y.value.filter(t=>t.id!==s.value.id),s.value=null,w())},H=()=>{y.value=[],s.value=null,w()},J=()=>{if(!n.value)return;const t=document.createElement("a");t.download=`drawing-${Date.now()}.png`,t.href=n.value.toDataURL(),t.click()};return m(s,t=>{t&&(x.value=t.fillColor,c.value=t.strokeColor,g.value=t.strokeWidth,t.fontSize&&(b.value=t.fontSize),t.textColor&&(k.value=t.textColor))},{deep:!0}),m([x,c,g,b,k],()=>{s.value&&(s.value.fillColor=x.value,s.value.strokeColor=c.value,s.value.strokeWidth=g.value,s.value.type==="text"&&(s.value.fontSize=b.value,s.value.textColor=k.value),w())}),tl(()=>{n.value&&(a.value=n.value.getContext("2d")||void 0,w())}),(t,l)=>{var u;return V(),P("div",al,[o("div",ol,[o("div",ul,[l[16]||(l[16]=o("h3",null,"Â∑•ÂÖ∑",-1)),o("div",sl,[o("button",{class:C({active:i.value==="select"}),onClick:l[0]||(l[0]=e=>i.value="select"),title:"ÈÄâÊã©"},"üîç",2),o("button",{class:C({active:i.value==="rectangle"}),onClick:l[1]||(l[1]=e=>i.value="rectangle"),title:"Áü©ÂΩ¢"},"‚¨ú",2),o("button",{class:C({active:i.value==="circle"}),onClick:l[2]||(l[2]=e=>i.value="circle"),title:"ÂúÜÂΩ¢"},"‚≠ï",2),o("button",{class:C({active:i.value==="line"}),onClick:l[3]||(l[3]=e=>i.value="line"),title:"Áõ¥Á∫ø"},"üìè",2),o("button",{class:C({active:i.value==="arrow"}),onClick:l[4]||(l[4]=e=>i.value="arrow"),title:"ÁÆ≠Â§¥"},"‚û°Ô∏è",2),o("button",{class:C({active:i.value==="text"}),onClick:l[5]||(l[5]=e=>i.value="text"),title:"ÊñáÂ≠ó"},"üìù",2)])]),o("div",il,[l[20]||(l[20]=o("h3",null,"Ê†∑Âºè",-1)),o("div",vl,[l[17]||(l[17]=o("label",null,"Â°´ÂÖÖ:",-1)),d(o("input",{type:"color","onUpdate:modelValue":l[6]||(l[6]=e=>x.value=e),class:"color-input"},null,512),[[p,x.value]]),d(o("input",{type:"text","onUpdate:modelValue":l[7]||(l[7]=e=>x.value=e),class:"color-text",placeholder:"#3B82F6"},null,512),[[p,x.value]])]),o("div",nl,[l[18]||(l[18]=o("label",null,"ËæπÊ°Ü:",-1)),d(o("input",{type:"color","onUpdate:modelValue":l[8]||(l[8]=e=>c.value=e),class:"color-input"},null,512),[[p,c.value]]),d(o("input",{type:"text","onUpdate:modelValue":l[9]||(l[9]=e=>c.value=e),class:"color-text",placeholder:"#000000"},null,512),[[p,c.value]])]),o("div",rl,[l[19]||(l[19]=o("label",null,"ËæπÊ°ÜÂÆΩÂ∫¶:",-1)),d(o("input",{type:"range","onUpdate:modelValue":l[10]||(l[10]=e=>g.value=e),min:"1",max:"10",class:"range-input"},null,512),[[p,g.value]]),o("span",dl,A(g.value)+"px",1)])]),i.value==="text"||((u=s.value)==null?void 0:u.type)==="text"?(V(),P("div",pl,[l[23]||(l[23]=o("h3",null,"ÊñáÂ≠ó",-1)),o("div",xl,[l[21]||(l[21]=o("label",null,"Â≠ó‰ΩìÂ§ßÂ∞è:",-1)),d(o("input",{type:"range","onUpdate:modelValue":l[11]||(l[11]=e=>b.value=e),min:"12",max:"72",class:"range-input"},null,512),[[p,b.value]]),o("span",cl,A(b.value)+"px",1)]),o("div",fl,[l[22]||(l[22]=o("label",null,"Â≠ó‰ΩìÈ¢úËâ≤:",-1)),d(o("input",{type:"color","onUpdate:modelValue":l[12]||(l[12]=e=>k.value=e),class:"color-input"},null,512),[[p,k.value]]),d(o("input",{type:"text","onUpdate:modelValue":l[13]||(l[13]=e=>k.value=e),class:"color-text",placeholder:"#000000"},null,512),[[p,k.value]])])])):E("",!0),s.value&&s.value.type!=="text"?(V(),P("div",yl,[l[26]||(l[26]=o("h3",null,"Â§ßÂ∞è",-1)),o("div",hl,[l[24]||(l[24]=o("label",null,"ÂÆΩÂ∫¶:",-1)),d(o("input",{type:"number","onUpdate:modelValue":l[14]||(l[14]=e=>s.value.width=e),min:"10",max:"500",class:"size-input"},null,512),[[p,s.value.width]])]),o("div",gl,[l[25]||(l[25]=o("label",null,"È´òÂ∫¶:",-1)),d(o("input",{type:"number","onUpdate:modelValue":l[15]||(l[15]=e=>s.value.height=e),min:"10",max:"500",class:"size-input"},null,512),[[p,s.value.height]])])])):E("",!0),o("div",kl,[l[27]||(l[27]=o("h3",null,"Êìç‰Ωú",-1)),o("div",wl,[o("button",{onClick:j,disabled:!s.value},"Âà†Èô§ÈÄâ‰∏≠",8,bl),o("button",{onClick:H},"Ê∏ÖÁ©∫ÁîªÂ∏É"),o("button",{onClick:J},"‰∏ãËΩΩÂõæÁâá")])])]),o("div",Cl,[o("canvas",{ref_key:"canvas",ref:n,width:"1200",height:"800",onMousedown:q,onMousemove:N,onMouseup:G,onDblclick:O},null,544)])])}}}),Xl=el(Ml,[["__scopeId","data-v-2cdf69dd"]]);export{Xl as default};
