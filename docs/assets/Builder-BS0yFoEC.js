import{i as qn}from"./rolldown-runtime-CKFmjIRy.js";import{C as nr,E as z,H as Xn,I as fe,L as Gn,O as Rt,P as bt,R as ge,S as tr,_ as St,b as kt,c as Ve,ct as ut,d as te,f as O,g as at,h as xl,i as to,l,lt as rt,m as Zl,n as lo,o as It,r as ro,st as Ae,t as no,u as er,w as rr}from"./codemirror-B25QCqWr.js";import{d as Ln,f as we,h as Yn,m as _l,n as oo,o as so,p as ao,r as io,s as uo,u as Ql}from"./vendor-vue-C93_ecI2.js";import{t as or}from"./index-FzRHQyb9.js";import{t as et}from"./componentStorage-DB4dbTb9.js";import"./echarts-xBohgwka.js";import{t as co}from"./DraggableBox-CRAQnTNF.js";function ml(x){return x.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function po(x){var g,w;const n=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||0)}px`),e.push(`top:${Math.round(x.top||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(x.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((g=n.backgroundGradient.colors)!=null&&g.length)){const C=n.backgroundGradient.angle||0,W=n.backgroundGradient.colors[0]||"#000000",oe=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${C}deg, ${W}, ${oe})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"){n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textIndent&&e.push(`text-indent:${n.textIndent}`);const C=n.textOrientation;if(C==="vertical"?(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")):C==="horizontal"&&e.push("writing-mode:horizontal-tb"),n.textGradient&&((w=n.textGradient.colors)!=null&&w.length)){const W=n.textGradient.angle||0,oe=n.textGradient.colors[0]||"#000000",he=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${W}deg, ${oe}, ${he})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}}return x.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),e.join(";")}function go(x){const n=x.style||{},e=[];return n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.color&&e.push(`fill:${n.color}`),e.join(";")}function fo(x){var c,D,R,ee;const n=Math.max(1,Math.round(x.width||1)),e=Math.max(1,Math.round(x.height||1)),g=n/2,w=e/2,C=((c=x.style)==null?void 0:c.arcText)||{},W=Math.max(1,Number((D=C.radius)!=null?D:Math.min(n,e)/2-4)),oe=Number((R=C.startAngle)!=null?R:0),he=Math.max(0,Number((ee=C.sweepAngle)!=null?ee:180)),k=C.clockwise!==!1,ce=oe*Math.PI/180,P=(oe+he)*Math.PI/180,Q=g+W*Math.cos(ce),se=w+W*Math.sin(ce),_=g+W*Math.cos(P),E=w+W*Math.sin(P);return`M ${Q} ${se} A ${W} ${W} 0 ${he>180?1:0} ${k?1:0} ${_} ${E}`}function yo(x){var e;const n=((e=x.style)==null?void 0:e.textAlign)||"center";return n==="left"?"0%":n==="right"?"100%":"50%"}function mo(x){var e;const n=((e=x.style)==null?void 0:e.textAlign)||"center";return n==="left"?"start":n==="right"?"end":"middle"}function _n(x){return String(x).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function bo(x){return String(x).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${_n(e)} }`)}function xo(x){const n=[],e=g=>{g.forEach(w=>{if((w.type==="group"||w.type==="container")&&Array.isArray(w.children))e(w.children);else{const C=(w.className||"").trim(),W=w.customClassCss?String(w.customClassCss).trim():"";if(!C||!W)return;/\{[^}]*\}/.test(W)?n.push(bo(W)):n.push(`.${C} { ${_n(W)} }`)}})};return e(x),n.join(`
`)}function Un(x,n,e,g,w){const C=x.replace(/[^A-Za-z0-9_]/g,"_");let W=0;const oe=[],he=[],k=n.backgroundUrl||"",ce=n.backgroundColor||"transparent",P=n.globalFontFamily||"",Q=n.globalFontSize||14,se=n.globalColor||"#000000",_=e.some(d=>d.type==="chart"),E=g!=null&&g.backgroundFileName&&g.backgroundFileName.trim()?`./imgs/${g.backgroundFileName.replace(/'/g,"\\'")}`:k?k.replace(/'/g,"\\'"):"";function c(d){const ie=String(d||"").trim();if(!ie)return"";let y=ie.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(y[0]||"")||(y="_"+y),y}function D(d){if(!d.hidden)return"";const ie=c(d.hiddenLabel);return ie?` ${g&&g.hideDirective==="show"?"v-show":"v-if"}="${ie}"`:""}function R(d,ie){var Ce,tt,_e,Xe,ht,wt,At,Ft,zt,xt,jt,Fe,xe,gt,ft;const y=po(d),t=d.zIndex||1,Z=d.className&&d.className.trim()?` class="${d.className.trim()}"`:"",$e=d.eventBinding,ze=$e&&$e.enabled&&$e.handlerName?` @click="${String($e.handlerName)}($event)"`:"";if(d.type==="group"&&Array.isArray(d.children)){const Ue=d.children.map((He,Je)=>R(He,Je)).join(`
        `);return`<div${Z}${D(d)} style="${y};z-index:${t}">
        ${Ue}
      </div>`}if(d.type==="text"){const Ue=(()=>{var nt;const Pe=((nt=d.style)==null?void 0:nt.textAlign)||"left";return Pe==="center"?"text-flex-center":Pe==="right"?"text-flex-right":"text-flex-left"})(),He=[(Ce=d.className)==null?void 0:Ce.trim(),Ue].filter(Boolean).join(" "),Je=He?` class="${He}"`:"",Ee=d.style||{},je=d.elementId&&d.elementId.trim()?d.elementId.trim():`text_${ie}`,Ke=!!(Ee.textWave&&Ee.textWave.enabled),yt=!!Ee.skewFlowEnabled;if(Ke||yt){const Pe=d.dynamic&&d.dynamic.enabled&&d.dynamic.objectName&&d.dynamic.propertyPath?{type:"dynamic",obj:d.dynamic.objectName,path:d.dynamic.propertyPath}:{type:"static",text:d.text||""};oe.push(`'${je.replace(/'/g,"\\'")}' : ${JSON.stringify(Pe)}`);const nt={textWaveEnabled:Ke,amplitude:(_e=(tt=Ee.textWave)==null?void 0:tt.amplitude)!=null?_e:0,frequency:(ht=(Xe=Ee.textWave)==null?void 0:Xe.frequency)!=null?ht:0,phase:(At=(wt=Ee.textWave)==null?void 0:wt.phase)!=null?At:0,skewFlowEnabled:yt,skewAngle:(Ft=Ee.skewAngle)!=null?Ft:0,textOrientation:Ee.textOrientation||"horizontal",fontSize:(zt=Ee.fontSize)!=null?zt:Q,letterSpacing:(xt=Ee.letterSpacing)!=null?xt:0};return he.push(`'${je.replace(/'/g,"\\'")}' : ${JSON.stringify(nt)}`),`<div${Je}${D(d)}${ze} style="${y};z-index:${t}">
        <span v-for="(p,pi) in getTextPieces('${je.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
      </div>`}if(d.dynamic&&d.dynamic.enabled&&d.dynamic.objectName&&d.dynamic.propertyPath){const Pe=`${d.dynamic.objectName}.${d.dynamic.propertyPath}`;return`<div${Je}${D(d)}${ze} style="${y};z-index:${t}">{{ ${Pe} }}</div>`}else{const Pe=ml(d.text||"");return`<div${Je}${D(d)}${ze} style="${y};z-index:${t}">${Pe}</div>`}}if(d.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[d.id]){const Je=g.imageFileMap[d.id],Ee=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"";return`<img${Z}${Ee}${D(d)}${ze} src="./imgs/${Je}" style="${y};z-index:${t}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[W]){const Je=g.imageFileNames[W++],Ee=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"";return`<img${Z}${Ee}${D(d)}${ze} src="./imgs/${Je}" style="${y};z-index:${t}" alt="" />`}const Ue=d.elementId&&d.elementId.trim()?d.elementId.trim():`img_${ie}`,He=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"";return`<img${Z}${He}${D(d)}${ze} :src="images['${Ue}']" style="${y};z-index:${t}" alt="" />`}if(d.type==="chart"){const Ue=ml(d.text||"chart"),He=d.elementId&&d.elementId.trim()?d.elementId.trim():`chart_${ie}`;return`<div${Z}${D(d)}${ze} id="${He}" style="${y};z-index:${t}">${Ue}</div>`}if(d.type==="container"){const Ue=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"",He=d.comment?`<!-- ${d.comment.replace(/-->/g,"")} -->
      `:"";if(Array.isArray(d.children)){const Ee=d.children.map((je,Ke)=>R(je,Ke)).join(`
        `);return`${He}<div${Z}${D(d)}${ze}${Ue} style="${y};z-index:${t}">
        ${Ee}
      </div>`}const Je=ml(d.text||"");return`${He}<div${Z}${D(d)}${ze}${Ue} style="${y};z-index:${t}">${Je}</div>`}if(d.type==="line"){const Ue=d.style||{},He=Ue.lineColor||"#ffffff",Je=(jt=Ue.lineThickness)!=null?jt:2,Ee=Ue.lineOrientation||"horizontal",je=Ue.lineStyle==="dashed",Ke=(Fe=Ue.lineDashLength)!=null?Fe:6,yt=(xe=Ue.lineDashGap)!=null?xe:4,Pe=Math.max(1,Math.round((gt=d.width)!=null?gt:Ee==="horizontal"?200:2)),nt=Math.max(1,Math.round((ft=d.height)!=null?ft:Ee==="horizontal"?2:200)),Ye=Math.round(nt/2),Mt=Math.round(Pe/2),Ot=je?` stroke-dasharray="${Ke} ${yt}"`:"";return Ee==="horizontal"?`<svg${Z}${D(d)}${ze} viewBox="0 0 ${Pe} ${nt}" preserveAspectRatio="none" style="${y};z-index:${t}"><line x1="0" y1="${Ye}" x2="${Pe}" y2="${Ye}" stroke="${He}" stroke-width="${Je}"${Ot} fill="none" /></svg>`:`<svg${Z}${D(d)}${ze} viewBox="0 0 ${Pe} ${nt}" preserveAspectRatio="none" style="${y};z-index:${t}"><line x1="${Mt}" y1="0" x2="${Mt}" y2="${nt}" stroke="${He}" stroke-width="${Je}"${Ot} fill="none" /></svg>`}if(d.type==="arc-text"){const Ue=Math.max(1,Math.round(d.width||1)),He=Math.max(1,Math.round(d.height||1)),Je=`arc_${d.id.replace(/"/g,"").replace(/'/g,"\\'")}`,Ee=go(d),je=yo(d),Ke=mo(d),yt=d.dynamic&&d.dynamic.enabled&&d.dynamic.objectName&&d.dynamic.propertyPath?`{{ ${`${d.dynamic.objectName}.${d.dynamic.propertyPath}`} }}`:ml(d.text||"");return`<svg${Z}${D(d)}${ze} viewBox="0 0 ${Ue} ${He}" preserveAspectRatio="none" style="${y};z-index:${t}">
        <defs>
          <path id="${Je}" d="${fo(d)}" fill="none" />
        </defs>
        <text style="${Ee}">
          <textPath :href="'#${Je}'" startOffset="${je}" text-anchor="${Ke}">${yt}</textPath>
        </text>
      </svg>`}const Re=ml(d.text||"element");return`<div${Z}${D(d)}${ze} style="${y};z-index:${t}">${Re}</div>`}const ee=e.map((d,ie)=>R(d,ie)).join(`
      `),J=xo(e);function q(d,ie){d.forEach(y=>{(y.type==="group"||y.type==="container")&&Array.isArray(y.children)?(ie(y),q(y.children,ie)):ie(y)})}const Ie=new Set;q(e,d=>{(d.type==="text"||d.type==="arc-text")&&d.dynamic&&d.dynamic.enabled&&d.dynamic.objectName&&Ie.add(String(d.dynamic.objectName))});const L=Array.from(Ie),T=!w||L.length===0?"":L.map(d=>{try{const ie=w[d],y=JSON.stringify(ie!=null?ie:{});return`      ${d}: ${y},`}catch{return`      ${d}: {},`}}).join(`
`),K=(()=>{const d=[];let ie=0;return q(e,y=>{if(y.type==="chart"){const t=y.elementId&&y.elementId.trim()?y.elementId.trim():`chart_${ie}`;ie++;const Z=y.chartOption||{};try{d.push(`'${t.replace(/'/g,"\\'")}' : ${JSON.stringify(Z)}`)}catch{d.push(`'${t.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${d.join(", ")} }`})(),We=(()=>{const d=new Set;return q(e,ie=>{const y=String(ie.hiddenLabel||"").trim(),t=c(y),Z=!!ie.hidden;t&&Z&&d.add(t)}),Array.from(d).map(ie=>`      ${ie}: false,`).join(`
`)})(),qe=(()=>{const d=new Map;function ie(t){t.forEach(Z=>{const $e=Z.eventBinding;$e&&$e.enabled&&$e.handlerName&&d.set(String($e.handlerName),String($e.code||"")),Array.isArray(Z.children)&&ie(Z.children)})}ie(e);const y=Array.from(d.entries());return y.length?y.map(([t,Z])=>`${t}(e) {
${Z}
}`).join(`,
`):""})();return`
<template>
  <div class="container" :style="containerStyle">
    ${E?`<img class="bg-img" src='${E}' alt="" />`:""}
    ${ee}
  </div>
</template>

<script>
${_?`import * as echarts from 'echarts';
`:""}
export default {
  name: '${C}',
  data() {
    return {
      config: {
        width: ${Math.round(n.width)},
        height: ${Math.round(n.height)},
        backgroundColor: '${ce.replace(/'/g,"\\'")}',
        globalFontFamily: '${P.replace(/'/g,"\\'")}',
        globalFontSize: ${Math.round(Q)},
        globalColor: '${se}',
      },
      ${g!=null&&g.imageFileNames?`// 使用本地资源路径，动态映射不再需要
      images: {},`:`// 图片 src 动态映射，初始写入 base64（若存在），blob 留空待替换
      images: {},`}
      // 图表配置导出，键为元素ID或序号
      chartOptions: ${K},
      ${T?`// 数据库对象（按页面引用注入到 data）
${T}`:""}
      ${oe.length?`// 文本数据源映射（支持静态/动态）
      textSources: { ${oe.join(", ")} },`:""}
      ${he.length?`// 文本效果参数映射（波形与倾斜跟随）
      textEffects: { ${he.join(", ")} },`:""}
      ${We}
    };
  },
  computed: {
    containerStyle() {
      const base = {
        position: 'relative',
        width: this.config.width + 'px',
        height: this.config.height + 'px',
        fontFamily: this.config.globalFontFamily,
        fontSize: this.config.globalFontSize + 'px',
        color: this.config.globalColor,
        backgroundColor: this.config.backgroundColor || 'transparent',
      };
      return base;
    }
  },
  methods: {
    getByPath(obj, path) {
      try {
        const segs = String(path).split('.');
        return segs.reduce((acc, k) => (acc ? acc[k] : undefined), obj);
      } catch(e) {
        return undefined;
      }
    },
    getTextValue(id) {
      const srcMap = this.textSources || {};
      const src = srcMap[id];
      if (!src) return '';
      if (src.type === 'static') return String(src.text || '');
      const root = this[src.obj] || {};
      const v = this.getByPath(root, src.path);
      return v != null ? String(v) : '';
    },
    getTextPieces(id) {
      const text = this.getTextValue(id);
      const effMap = this.textEffects || {};
      const eff = effMap[id] || {};
      const orientation = eff.textOrientation || 'horizontal';
      const fontSize = Number(eff.fontSize || (this.config && this.config.globalFontSize) || 14);
      const letterSpacing = Number(eff.letterSpacing || 0);
      const step = fontSize * 0.6 + letterSpacing;

      const amp = eff.textWaveEnabled ? Number(eff.amplitude || 0) : 0;
      const freq = eff.textWaveEnabled ? Number(eff.frequency || 0) : 0;
      const phase = eff.textWaveEnabled ? Number(eff.phase || 0) : 0;

      const skewAngle = eff.skewFlowEnabled ? Number(eff.skewAngle || 0) : 0;
      const tan = Math.tan(skewAngle * Math.PI / 180);

      const pieces = [];
      for (let i = 0; i < text.length; i++) {
        const ch = text[i];
        const wave = amp ? amp * Math.sin(i * freq + phase) : 0;
        let dx = 0, dy = 0;
        if (orientation === 'horizontal') {
          dy += wave;
          dy += tan * step * i;
        } else {
          dx += wave;
          dx += tan * step * i;
        }
        const style = 'display:inline-block;white-space:pre;transform: translate(' + Math.round(dx) + 'px, ' + Math.round(dy) + 'px);';
        pieces.push({ char: ch, style });
      }
      return pieces;
    }${qe?`,
${qe}`:""}
  },
  mounted() {
    // 使用 npm 依赖的 echarts 初始化图表实例
    Object.keys(this.chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) {
        const inst = echarts.init(el);
        inst.setOption(this.chartOptions[id], true);
      }
    });
  }
};
<\/script>

${g!=null&&g.fontFaces&&g.fontFaces.length>0?`
<style>
${g.fontFaces.map(d=>`@font-face { font-family: '${d.family.replace(/'/g,"\\'")}'; src: url('./fonts/${d.file}'); font-weight: normal; font-style: normal; }`).join(`
`)}
</style>
`:""}
<style scoped>
.container { box-sizing: border-box; }
.bg-img { position:absolute; left:0; top:0; width:100%; height:100%; object-fit:cover; z-index:0; pointer-events:none; }
/* 文本对齐公共样式，减少重复的内联 CSS */
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${J}
</style>
`}function lr(x){return x.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function vo(x){var w,C;const n=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||0)}px`),e.push(`top:${Math.round(x.top||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(x.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((w=n.backgroundGradient.colors)!=null&&w.length)){const W=n.backgroundGradient.angle||0,oe=n.backgroundGradient.colors[0]||"#000000",he=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${W}deg, ${oe}, ${he})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&((C=n.textGradient.colors)!=null&&C.length))){const W=n.textGradient.angle||0,oe=n.textGradient.colors[0]||"#000000",he=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${W}deg, ${oe}, ${he})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}x.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const g=x.eventBinding;return g&&g.enabled&&g.cursor&&e.push(`cursor:${g.cursor}`),e.join(";")}function Kn(x){return String(x).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function ho(x){return String(x).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Kn(e)} }`)}function wo(x){const n=[],e=g=>{g.forEach(w=>{if((w.type==="group"||w.type==="container")&&Array.isArray(w.children))e(w.children);else{const C=(w.className||"").trim(),W=w.customClassCss?String(w.customClassCss).trim():"";if(!C||!W)return;/\{[^}]*\}/.test(W)?n.push(ho(W)):n.push(`.${C} { ${Kn(W)} }`)}})};return e(x),n.join(`
`)}function Zn(x){const n=String(x||"").trim();if(!n)return"";let e=n.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(e[0]||"")||(e="_"+e),e}function $o(x,n){if(!x.hidden)return"";const e=Zn(x.hiddenLabel);return e?` ${n!=null&&n.useShow?"v-show":"v-if"}="${e}"`:""}function Vn(x,n,e,g){let w=0;const C=e.some(c=>c.type==="chart");function W(c,D){var K,We,qe,d,ie;const R=vo(c),ee=c.zIndex||1,J=c.className&&c.className.trim()?` class="${c.className.trim()}"`:"",q=$o(c,{useShow:(g==null?void 0:g.hideDirective)==="show"}),Ie=c.eventBinding,L=Ie&&Ie.enabled&&Ie.handlerName?` @click="${String(Ie.handlerName)}($event)"`:"",T=c.elementId&&c.elementId.trim()?` id="${c.elementId.trim()}"`:"";if((c.type==="group"||c.type==="container")&&Array.isArray(c.children)){const y=c.children.map((t,Z)=>W(t,Z)).join(`
        `);return`<div${J}${q}${L}${T} style="${R};z-index:${ee}">
        ${y}
      </div>`}if(c.type==="text"){const y=lr(c.text||"");return`<div${J}${q}${L} style="${R};z-index:${ee}">${y}</div>`}if(c.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[c.id]){const y=g.imageFileMap[c.id],t=c.elementId&&c.elementId.trim()?` id="${c.elementId.trim()}"`:"";return`<img${J}${t}${q}${L} :src="assetUrl('./imgs/${y}')" style="${R};z-index:${ee}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[w]){const y=g.imageFileNames[w++],t=c.elementId&&c.elementId.trim()?` id="${c.elementId.trim()}"`:"";return`<img${J}${t}${q}${L} :src="assetUrl('./imgs/${y}')" style="${R};z-index:${ee}" alt="" />`}return`<div${J}${q}${L} style="${R};z-index:${ee}"></div>`}if(c.type==="line"){const y=c.style||{},t=y.lineColor||"#ffffff",Z=(K=y.lineThickness)!=null?K:2,$e=y.lineOrientation||"horizontal",ze=y.lineStyle==="dashed",Re=(We=y.lineDashLength)!=null?We:6,Ce=(qe=y.lineDashGap)!=null?qe:4,tt=Math.max(1,Math.round((d=c.width)!=null?d:$e==="horizontal"?200:2)),_e=Math.max(1,Math.round((ie=c.height)!=null?ie:$e==="horizontal"?2:200)),Xe=Math.round(_e/2),ht=Math.round(tt/2),wt=ze?` stroke-dasharray="${Re} ${Ce}"`:"";return $e==="horizontal"?`<svg${J}${q}${L} viewBox="0 0 ${tt} ${_e}" preserveAspectRatio="none" style="${R};z-index:${ee}"><line x1="0" y1="${Xe}" x2="${tt}" y2="${Xe}" stroke="${t}" stroke-width="${Z}"${wt} fill="none" /></svg>`:`<svg${J}${q}${L} viewBox="0 0 ${tt} ${_e}" preserveAspectRatio="none" style="${R};z-index:${ee}"><line x1="${ht}" y1="0" x2="${ht}" y2="${_e}" stroke="${t}" stroke-width="${Z}"${wt} fill="none" /></svg>`}if(c.type==="chart"){const y=c.elementId&&c.elementId.trim()?c.elementId.trim():`chart_${D}`,t=lr(c.text||"chart");return`<div${J}${q}${L} id="${y}" style="${R};z-index:${ee}">${t}</div>`}return`<div${J}${q}${L} style="${R};z-index:${ee}">${lr(c.text||"")}</div>`}const oe=e.map((c,D)=>W(c,D)).join(`
      `),he=wo(e),k=n.backgroundUrl||"",ce=n.backgroundColor||"transparent",P=n.globalFontFamily||"",Q=n.globalFontSize||14,se=n.globalColor||"#000000",_=(()=>{const c=[];let D=0;return e.forEach(R=>{if(R.type==="chart"){const ee=R.elementId&&R.elementId.trim()?R.elementId.trim():`chart_${D}`;D++;const J=R.chartOption||{};try{c.push(`'${ee.replace(/'/g,"\\'")}' : ${JSON.stringify(J)}`)}catch{c.push(`'${ee.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${c.join(", ")} }`})(),E=(()=>{const c=new Set;return e.forEach(D=>{const R=String(D.hiddenLabel||"").trim(),ee=Zn(R),J=!!D.hidden;ee&&J&&c.add(ee)}),Array.from(c).map(D=>`const ${D} = ref(false)`).join(`
`)})();return`
<template>
  <div class="container" :style="containerStyle">
    ${oe}
  </div>
</template>

<script setup lang="ts">
import { onMounted, ref, computed } from 'vue'
${C?`import * as echarts from 'echarts'
`:""}
function assetUrl(p: string): string { try { return new URL(p, import.meta.url).href } catch { return p } }
const config = {
  width: ${Math.round(n.width)},
  height: ${Math.round(n.height)},
  backgroundColor: '${ce.replace(/'/g,"\\'")}',
  globalFontFamily: '${P.replace(/'/g,"\\'")}',
  globalFontSize: ${Math.round(Q)},
  globalColor: '${se}',
}
const backgroundUrl: string = ${g!=null&&g.backgroundFileName?`assetUrl('./imgs/${String(g.backgroundFileName).replace(/'/g,"\\'")}')`:`'${k.replace(/'/g,"\\'")}'`}
const images: Record<string, string> = {}
${C?`const chartOptions: Record<string, any> = ${_}`:""}
${E?`${E}
`:""}
const containerStyle = computed(() => {
  const base: Record<string, string> = {
    position: 'relative',
    width: config.width + 'px',
    height: config.height + 'px',
    fontFamily: config.globalFontFamily,
    fontSize: config.globalFontSize + 'px',
    color: config.globalColor,
    backgroundColor: (config.backgroundColor || 'transparent') as string,
  }
  if (backgroundUrl) {
    return Object.assign({}, base, {
      backgroundImage: 'url(' + backgroundUrl + ')',
      backgroundSize: 'cover',
      backgroundRepeat: 'no-repeat',
    }) as Record<string, string>
  }
  return base
})
// 事件处理函数
${(()=>{const c=new Map,D=R=>{R.forEach(ee=>{const J=ee.eventBinding;J&&J.enabled&&J.handlerName&&c.set(String(J.handlerName),String(J.code||"")),Array.isArray(ee.children)&&D(ee.children)})};return D(e),Array.from(c.entries()).map(([R,ee])=>`function ${R}(e: MouseEvent){
${ee}
}`).join(`
`)})()}
${C?`onMounted(() => {
  Object.keys(chartOptions || {}).forEach((id) => {
    const el = document.getElementById(id)
    if (el && (echarts as any)) { const inst = (echarts as any).init(el); inst.setOption((chartOptions as any)[id], true) }
  })
})`:""}
<\/script>

<style scoped>
.container { box-sizing: border-box; }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${he}
</style>
`}function bl(x){return String(x).replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Eo(x){const n=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||x.x||0)}px`),e.push(`top:${Math.round(x.top||x.y||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(x.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&n.backgroundGradient.colors&&n.backgroundGradient.colors.length){const w=n.backgroundGradient.angle||0,C=n.backgroundGradient.colors[0]||"#000000",W=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${w}deg, ${C}, ${W})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&n.textGradient.colors&&n.textGradient.colors.length)){const w=n.textGradient.angle||0,C=n.textGradient.colors[0]||"#000000",W=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${w}deg, ${C}, ${W})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}x.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const g=x.eventBinding;return g&&g.enabled&&g.cursor&&e.push(`cursor:${g.cursor}`),x.hidden&&e.push("display:none"),e.join(";")}function Qn(x){return String(x).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function ko(x){return String(x).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Qn(e)} }`)}function So(x){const n=[],e=g=>{g.forEach(w=>{if((w.type==="group"||w.type==="container")&&Array.isArray(w.children))e(w.children);else{const C=(w.className||"").trim(),W=w.customClassCss?String(w.customClassCss).trim():"";if(!C||!W)return;/\{[^}]*\}/.test(W)?n.push(ko(W)):n.push(`.${C} { ${Qn(W)} }`)}})};return e(x),n.join(`
`)}function Rn(x,n,e,g){function w(c){for(const D of c)if((D.type==="group"||D.type==="container")&&Array.isArray(D.children)){if(w(D.children))return!0}else if(D.type==="chart")return!0;return!1}const C=w(e),W=n.backgroundUrl||"",oe=g!=null&&g.backgroundFileName?`background-image:url('./imgs/${g.backgroundFileName}');background-size:cover;background-repeat:no-repeat;`:W?`background-image:url('${W}');background-size:cover;background-repeat:no-repeat;`:"";let he=0;const k={};(function(D){let R=0;const ee=J=>{J.forEach(q=>{if((q.type==="group"||q.type==="container")&&Array.isArray(q.children))ee(q.children);else if(q.type==="chart"){const Ie=q.elementId&&String(q.elementId).trim()?String(q.elementId).trim():`chart_${R++}`;k[q.id]=Ie}})};ee(D)})(e);function ce(c){var L,T,K,We,qe;const D=Eo(c),R=c.zIndex||1,ee=c.className&&c.className.trim()?` class="${c.className.trim()}"`:"",J=c.eventBinding,q=J&&J.enabled&&J.handlerName?` onclick="${String(J.handlerName)}(event)"`:"",Ie=c.elementId&&c.elementId.trim()?` id="${c.elementId.trim()}"`:"";if((c.type==="group"||c.type==="container")&&Array.isArray(c.children)&&c.children.length>0){const d=c.children.map(ie=>ce(ie)).join(`
        `);return`<div${ee}${q}${Ie} style="${D};z-index:${R}">
        ${d}
      </div>`}if(c.type==="text"){const d=(c.style||{}).textAlign||"left",ie=d==="center"?"text-flex-center":d==="right"?"text-flex-right":"text-flex-left",y=[(c.className||"").trim(),ie].filter(Boolean).join(" ");return`<div${y?` class="${y}"`:""}${q} style="${D};z-index:${R}">${bl(c.text||"")}</div>`}if(c.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[c.id]){const d=g.imageFileMap[c.id];return`<img${ee}${q} src="./imgs/${d}" style="${D};z-index:${R}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[he]){const d=g.imageFileNames[he++];return`<img${ee}${q} src="./imgs/${d}" style="${D};z-index:${R}" alt="" />`}return`<div${ee}${q} style="${D};z-index:${R}"></div>`}if(c.type==="line"){const d=c.style||{},ie=d.lineColor||"#ffffff",y=(L=d.lineThickness)!=null?L:2,t=d.lineOrientation||"horizontal",Z=d.lineStyle==="dashed",$e=(T=d.lineDashLength)!=null?T:6,ze=(K=d.lineDashGap)!=null?K:4,Re=Math.max(1,Math.round((We=c.width)!=null?We:t==="horizontal"?200:2)),Ce=Math.max(1,Math.round((qe=c.height)!=null?qe:t==="horizontal"?2:200)),tt=Math.round(Ce/2),_e=Math.round(Re/2),Xe=Z?` stroke-dasharray="${$e} ${ze}"`:"";return t==="horizontal"?`<svg${ee}${q} viewBox="0 0 ${Re} ${Ce}" preserveAspectRatio="none" style="${D};z-index:${R}"><line x1="0" y1="${tt}" x2="${Re}" y2="${tt}" stroke="${ie}" stroke-width="${y}"${Xe} fill="none" /></svg>`:`<svg${ee}${q} viewBox="0 0 ${Re} ${Ce}" preserveAspectRatio="none" style="${D};z-index:${R}"><line x1="${_e}" y1="0" x2="${_e}" y2="${Ce}" stroke="${ie}" stroke-width="${y}"${Xe} fill="none" /></svg>`}if(c.type==="chart"){const d=k[c.id]||String(c.elementId||"");return`<div${ee}${q} id="${d}" style="${D};z-index:${R}">${bl(c.text||"chart")}</div>`}return c.type==="container"?`<div${ee}${q} style="${D};z-index:${R}">${bl(c.text||"")}</div>`:`<div${ee}${q} style="${D};z-index:${R}">${bl(c.text||"")}</div>`}const P=e.map(c=>ce(c)).join(`
      `),Q=So(e),se=g!=null&&g.fontFaces&&g.fontFaces.length>0?g.fontFaces.map(c=>`@font-face { font-family: '${String(c.family).replace(/'/g,"\\'")}'; src: url('./fonts/${String(c.file)}'); font-weight: normal; font-style: normal; }`).join(`
`):"";function _(c,D){c.forEach(R=>{if((R.type==="group"||R.type==="container")&&Array.isArray(R.children))_(R.children,D);else if(R.type==="chart"){const ee=k[R.id]||String(R.elementId||"");try{D.push(`chartOptions['${ee.replace(/'/g,"\\'")}'] = ${JSON.stringify(R.chartOption||{})};`)}catch{D.push(`chartOptions['${ee.replace(/'/g,"\\'")}'] = {};`)}}})}const E=C?`
    (function(){
      var chartOptions = {};
      ${(()=>{const c=[];return _(e,c),c.join(`
      `)})()}
      Object.keys(chartOptions).forEach(function(id){
        var el = document.getElementById(id);
        if (el && window.echarts) { var inst = window.echarts.init(el); inst.setOption(chartOptions[id], true); }
      });
    })();
  `:"";return`<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>${bl(x)}</title>
<style>
.container { position:relative; width:${Math.round(n.width)}px; height:${Math.round(n.height)}px; font-family:${String(n.globalFontFamily||"").replace(/'/g,"\\'")}; font-size:${Math.round(n.globalFontSize)}px; color:${String(n.globalColor)}; background-color:${String(n.backgroundColor||"transparent")}; ${oe} }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${se}
${Q}
</style>
${C?'<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"><\/script>':""}
</head>
<body>
<div class="container">
  ${P}
</div>
<script>
${(()=>{const c=new Map,D=R=>{R.forEach(ee=>{const J=ee.eventBinding;J&&J.enabled&&J.handlerName&&c.set(String(J.handlerName),String(J.code||"")),Array.isArray(ee.children)&&D(ee.children)})};return D(e),Array.from(c.entries()).map(([R,ee])=>`function ${R}(event){
${ee}
}`).join(`
`)})()}
${E}
<\/script>
</body>
</html>`}function Kl(x){return x.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Pn(x){var g,w;const n=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||0)}px`),e.push(`top:${Math.round(x.top||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(x.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((g=n.backgroundGradient.colors)!=null&&g.length)){const C=n.backgroundGradient.angle||0,W=n.backgroundGradient.colors[0]||"#000000",oe=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${C}deg, ${W}, ${oe})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&((w=n.textGradient.colors)!=null&&w.length))){const C=n.textGradient.angle||0,W=n.textGradient.colors[0]||"#000000",oe=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${C}deg, ${W}, ${oe})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}return x.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),x.hidden&&e.push("display:none"),e.join(";")}function eo(x){return String(x).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function Mo(x){return String(x).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${eo(e)} }`)}function Co(x){const n=[],e=g=>{g.forEach(w=>{if((w.type==="group"||w.type==="container")&&Array.isArray(w.children))e(w.children);else{const C=(w.className||"").trim(),W=w.customClassCss?String(w.customClassCss).trim():"";if(!C||!W)return;/\{[^}]*\}/.test(W)?n.push(Mo(W)):n.push(`.${C} { ${eo(W)} }`)}})};return e(x),n.join(`
`)}function Wn(x,n,e,g){const w=e.some(P=>P.type==="chart");let C=0;const W=e.map((P,Q)=>{var c,D,R,ee,J;const se=Pn(P),_=P.zIndex||1,E=P.className&&P.className.trim()?` class="${P.className.trim()}"`:"";if((P.type==="group"||P.type==="container")&&Array.isArray(P.children)){const q=P.children.map(L=>{const T=Pn(L),K=L.zIndex||1,We=L.className&&L.className.trim()?` class="${L.className.trim()}"`:"",qe=L.elementId&&L.elementId.trim()?` id="${L.elementId.trim()}"`:"";if(L.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[L.id]){const d=g.imageFileMap[L.id];return`<img${We}${qe} src="/imgs/${d}" style="${T};z-index:${K}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[C]){const d=g.imageFileNames[C++];return`<img${We}${qe} src="/imgs/${d}" style="${T};z-index:${K}" alt="" />`}}return`<div${We}${qe} style="${T};z-index:${K}">${Kl(L.text||"")}</div>`}).join(`
        `),Ie=P.elementId&&P.elementId.trim()?` id="${P.elementId.trim()}"`:"";return`<div${E}${Ie} style="${se};z-index:${_}">${q}</div>`}if(P.type==="text")return`<div${E} style="${se};z-index:${_}">${Kl(P.text||"")}</div>`;if(P.type==="image"){if(g!=null&&g.imageFileMap&&g.imageFileMap[P.id]){const q=g.imageFileMap[P.id];return`<img${E} src="/imgs/${q}" style="${se};z-index:${_}" alt="" />`}if(g!=null&&g.imageFileNames&&g.imageFileNames[C]){const q=g.imageFileNames[C++];return`<img${E} src="/imgs/${q}" style="${se};z-index:${_}" alt="" />`}return`<div${E} style="${se};z-index:${_}"></div>`}if(P.type==="line"){const q=P.style||{},Ie=q.lineColor||"#ffffff",L=(c=q.lineThickness)!=null?c:2,T=q.lineOrientation||"horizontal",K=q.lineStyle==="dashed",We=(D=q.lineDashLength)!=null?D:6,qe=(R=q.lineDashGap)!=null?R:4,d=Math.max(1,Math.round((ee=P.width)!=null?ee:T==="horizontal"?200:2)),ie=Math.max(1,Math.round((J=P.height)!=null?J:T==="horizontal"?2:200)),y=Math.round(ie/2),t=Math.round(d/2),Z=K?` stroke-dasharray="${We} ${qe}"`:"";return T==="horizontal"?`<svg${E} viewBox="0 0 ${d} ${ie}" preserveAspectRatio="none" style="${se};z-index:${_}"><line x1="0" y1="${y}" x2="${d}" y2="${y}" stroke="${Ie}" stroke-width="${L}"${Z} fill="none" /></svg>`:`<svg${E} viewBox="0 0 ${d} ${ie}" preserveAspectRatio="none" style="${se};z-index:${_}"><line x1="${t}" y1="0" x2="${t}" y2="${ie}" stroke="${Ie}" stroke-width="${L}"${Z} fill="none" /></svg>`}if(P.type==="chart"){const q=P.elementId&&P.elementId.trim()?P.elementId.trim():`chart_${Q}`;return`<div${E} id="${q}" style="${se};z-index:${_}">${Kl(P.text||"chart")}</div>`}return`<div${E} style="${se};z-index:${_}">${Kl(P.text||"")}</div>`}).join(`
      `),oe=Co(e),he=g!=null&&g.fontFaces&&g.fontFaces.length>0?g.fontFaces.map(P=>`@font-face { font-family: '${P.family.replace(/'/g,"\\'")}'; src: url('/fonts/${P.file}'); font-weight: normal; font-style: normal; }`).join(`
`):"",k=(()=>{const P=[];return e.forEach((Q,se)=>{if(Q.type==="chart"){const _=Q.elementId&&Q.elementId.trim()?Q.elementId.trim():`chart_${se}`,E=Q.chartOption||{};try{P.push(`'${_.replace(/'/g,"\\'")}' : ${JSON.stringify(E)}`)}catch{P.push(`'${_.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${P.join(", ")} }`})(),ce=g!=null&&g.backgroundFileName?`'/imgs/${String(g.backgroundFileName).replace(/'/g,"\\'")}'`:`'${(n.backgroundUrl||"").replace(/'/g,"\\'")}'`;return`import React, { useEffect } from 'react';
${w?`import * as echarts from 'echarts';
`:""}
export default function ${x.replace(/[^A-Za-z0-9_]/g,"_")}() {
  const config = { width: ${Math.round(n.width)}, height: ${Math.round(n.height)}, backgroundColor: '${(n.backgroundColor||"transparent").replace(/'/g,"\\'")}', globalFontFamily: '${(n.globalFontFamily||"").replace(/'/g,"\\'")}', globalFontSize: ${Math.round(n.globalFontSize)}, globalColor: '${n.globalColor}' };
  const backgroundUrl = ${ce};
  ${w?`const chartOptions = ${k};
  useEffect(() => {
    Object.keys(chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) { const inst = echarts.init(el); inst.setOption(chartOptions[id], true); }
    });
  }, []);
`:""}  const containerStyle = { position:'relative', width: config.width + 'px', height: config.height + 'px', fontFamily: config.globalFontFamily, fontSize: config.globalFontSize + 'px', color: config.globalColor, backgroundColor: config.backgroundColor, ...(backgroundUrl ? { backgroundImage: 'url(' + backgroundUrl + ')', backgroundSize: 'cover', backgroundRepeat: 'no-repeat' } : {}) };
  return (
    <div className="container" style={containerStyle}>
      <style>{\`.text-flex-left{display:flex;align-items:center;justify-content:flex-start}.text-flex-center{display:flex;align-items:center;justify-content:center}.text-flex-right{display:flex;align-items:center;justify-content:flex-end${he?"\\n"+he:""}${oe?"\\n"+oe:""}\`}</style>
      <div dangerouslySetInnerHTML={{ __html: \`${W.replace(/`/g,"\\`")}\` }} />
    </div>
  );
}
`}var Hn=qn(oo()),No=["placeholder"],Io={key:0,class:"absolute z-10 bg-gray-900 border border-gray-700 rounded w-full mt-1 max-h-40 overflow-auto shadow custom-scrollbar"},Ao=["onMousedown"],Fo={key:0,class:"px-2 py-2 text-xs text-gray-400"},zo=St({__name:"SearchableSelect",props:{modelValue:{},options:{},placeholder:{},numeric:{type:Boolean}},emits:["update:modelValue"],setup(x,{emit:n}){const e=x,g=n,w=ge(!1),C=ge(""),W=ge(null),oe=ge("");let he=null;const k=ge(!1);bt(()=>e.modelValue,J=>{J==null?C.value="":C.value=String(J)},{immediate:!0});const ce=Ve(()=>e.options.map(J=>String(J))),P=Ve(()=>{const J=oe.value.trim().toLowerCase();return J?ce.value.filter(q=>q.toLowerCase().includes(J)):ce.value});function Q(J){C.value=J;const q=e.numeric?Number(J):J;g("update:modelValue",q),w.value=!1}function se(){const J=C.value.trim();if(!J){g("update:modelValue",(e.numeric,null)),w.value=!1;return}const q=e.numeric?Number(J):J;g("update:modelValue",q),w.value=!1}function _(){k.value=!1,w.value=!0,D(C.value)}function E(){}function c(J){J.key==="Enter"&&se()}function D(J){he&&window.clearTimeout(he),he=window.setTimeout(()=>{oe.value=J},180)}function R(){k.value=!0,w.value=!0,D(C.value)}function ee(J){W.value&&(W.value.contains(J.target)||(w.value=!1))}return rr(()=>{window.addEventListener("click",ee),oe.value=C.value}),nr(()=>{window.removeEventListener("click",ee),he&&window.clearTimeout(he)}),(J,q)=>(z(),O("div",{class:"relative",ref_key:"root",ref:W},[fe(l("input",{class:"border border-gray-700 bg-gray-900 text-gray-100 rounded w-full px-2 py-1",placeholder:x.placeholder||"搜索选择或直接输入","onUpdate:modelValue":q[0]||(q[0]=Ie=>C.value=Ie),onInput:R,onFocus:_,onBlur:E,onKeydown:c},null,40,No),[[we,C.value]]),w.value?(z(),O("div",Io,[(z(!0),O(It,null,Rt(P.value,Ie=>(z(),O("div",{key:Ie,class:"px-2 py-1 hover:bg-gray-700 cursor-pointer text-sm text-gray-100",onMousedown:Yn(L=>Q(Ie),["prevent"])},rt(Ie),41,Ao))),128)),P.value.length===0?(z(),O("div",Fo,"无匹配项，回车使用当前输入")):te("",!0)])):te("",!0)],512))}}),mt=zo,jo={class:"space-y-3"},Oo={class:"flex items-center justify-between"},Bo={class:"inline-flex items-center cursor-pointer"},Do={class:"flex items-center justify-between"},To={class:"inline-flex items-center cursor-pointer"},Go=St({__name:"CanvasSettingsPanel",props:{spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean}},emits:["update:spacingEnabled","update:alignmentEnabled"],setup(x,{emit:n}){const e=x,g=n,w=Ve({get:()=>e.spacingEnabled,set:W=>g("update:spacingEnabled",W)}),C=Ve({get:()=>e.alignmentEnabled,set:W=>g("update:alignmentEnabled",W)});return(W,oe)=>(z(),O("div",jo,[oe[6]||(oe[6]=l("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"辅助间距",-1)),l("div",Oo,[oe[3]||(oe[3]=l("label",{class:"text-xs text-gray-400"},"显示间距标注",-1)),l("label",Bo,[fe(l("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":oe[0]||(oe[0]=he=>w.value=he)},null,512),[[Ql,w.value]]),oe[2]||(oe[2]=l("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[l("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),l("span",{class:Ae(["ml-3 text-xs",w.value?"text-cyan-300":"text-gray-300"])},rt(w.value?"已开启":"已关闭"),3)])]),l("div",Do,[oe[5]||(oe[5]=l("label",{class:"text-xs text-gray-400"},"显示对齐参考线",-1)),l("label",To,[fe(l("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":oe[1]||(oe[1]=he=>C.value=he)},null,512),[[Ql,C.value]]),oe[4]||(oe[4]=l("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[l("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),l("span",{class:Ae(["ml-3 text-xs",C.value?"text-cyan-300":"text-gray-300"])},rt(C.value?"已开启":"已关闭"),3)])])]))}}),Lo=Go,Uo={class:"space-y-3"},Vo={key:0,class:"text-sm text-gray-400"},Ro={key:1,class:"space-y-2"},Po=St({__name:"LayersList",props:{elements:{},selectedId:{}},emits:["select","reorderTop"],setup(x,{emit:n}){const e=x,g=n,w=Ve(()=>e.elements),C=ge({});function W(_){C.value[_]=!C.value[_]}function oe(_){const E=_.children;return Array.isArray(E)&&E.length>0}function he(_){const E=_.children;return Array.isArray(E)?E:[]}const k=ge(null),ce=ge(null);function P(_){const E=(_.elementId||"").trim(),c=(_.className||"").trim(),D=(_.text||"").trim();return E||c||D||_.id}function Q(_){const E=String(_.type||"").toLowerCase();return E==="text"?{label:"文本",cls:"bg-blue-600/30 text-blue-200"}:E==="arc-text"?{label:"环绕",cls:"bg-cyan-600/30 text-cyan-200"}:E==="image"?{label:"图片",cls:"bg-emerald-600/30 text-emerald-200"}:E==="chart"?{label:"图表",cls:"bg-orange-600/30 text-orange-200"}:E==="line"?{label:"线条",cls:"bg-slate-600/30 text-slate-200"}:E==="container"?{label:"容器",cls:"bg-cyan-600/30 text-cyan-200"}:E==="group"?{label:"分组",cls:"bg-purple-600/30 text-purple-200"}:{label:"元素",cls:"bg-gray-600/30 text-gray-200"}}const se=St({name:"LayerNode",props:{node:{type:Object,required:!0},selectedId:{type:String,default:null},depth:{type:Number,default:0},index:{type:Number,default:-1}},emits:["select","reorderTop"],setup(_,{emit:E}){return()=>{const c=_.node,D=_.depth===0,R=c.id===_.selectedId,ee=Q(c),J=kt("div",{class:"flex items-center gap-2"},[D&&_.index>=0?kt("span",{class:"px-1.5 py-0.5 text-[10px] rounded bg-cyan-600/30 text-cyan-200"},String(_.index+1)):null,oe(c)?kt("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:L=>{L.stopPropagation(),W(c.id)},title:C.value[c.id]?"收起":"展开"},C.value[c.id]?"▼":"▶"):null,kt("span",{class:`px-1.5 py-0.5 text-[10px] rounded ${ee.cls}`},ee.label),kt("span",{class:"text-left text-sm text-gray-100 truncate whitespace-nowrap max-w-[180px]",title:P(c)},P(c))]),q=kt("div",{class:["bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2 cursor-grab hover:bg-gray-700/60 transition-colors",R?"ring-2 ring-cyan-400/40 bg-gray-700/70":"",D&&ce.value===_.index?"border-purple-400":"",_.depth>0?"ml-3":""].filter(Boolean).join(" "),onClick:()=>E("select",c.id),draggable:D?!0:void 0,onDragstart:L=>{D&&(k.value=_.index,L.target.classList.add("cursor-grabbing"))},onDragover:L=>{D&&(L.preventDefault(),ce.value=_.index)},onDragenter:()=>{D&&(ce.value=_.index)},onDrop:L=>{if(!D)return;L.preventDefault();const T=k.value,K=_.index;k.value=null,ce.value=null,typeof T=="number"&&typeof K=="number"&&T!==K&&E("reorderTop",{from:T,to:K})},onDragend:L=>{k.value=null,ce.value=null,L.target.classList.remove("cursor-grabbing")}},[J,null]),Ie=C.value[c.id]&&oe(c)?kt("div",{class:"mt-2 space-y-2 pl-3"},[...he(c)].map(L=>kt(se,{node:L,selectedId:_.selectedId,depth:_.depth+1,index:-1,onSelect:T=>E("select",T)}))):null;return kt("div",{},[q,Ie])}}});return(_,E)=>(z(),O("div",Uo,[E[2]||(E[2]=l("div",{class:"text-xs text-gray-400"},"所有元素按层叠从上到下显示，支持展开分组/容器",-1)),w.value.length===0?(z(),O("div",Vo,"暂无元素")):(z(),O("div",Ro,[(z(!0),O(It,null,Rt(w.value,(c,D)=>(z(),er(Xn(se),{key:c.id,node:c,selectedId:x.selectedId,depth:0,index:D,onSelect:E[0]||(E[0]=R=>g("select",R)),onReorderTop:E[1]||(E[1]=R=>g("reorderTop",R))},null,8,["node","selectedId","index"]))),128))]))]))}}),Wo=Po,Ho={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},Jo={class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},qo={class:"flex items-center gap-2"},Xo={key:0,class:"space-y-2"},Yo={key:1,class:"space-y-2"},_o={class:"grid grid-cols-2 gap-2"},Ko={key:2,class:"space-y-2"},Zo={class:"flex gap-2"},Qo={key:3,class:"space-y-2"},es={class:"flex gap-2"},ts=["value"],ls={key:4,class:"space-y-3"},rs={class:"space-y-2"},ns={class:"space-y-2"},os={class:"space-y-2"},ss={key:6,class:"space-y-2 pt-4 border-t border-cyan-500/30"},as={class:"relative"},is={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},ds={class:"relative w-[520px] max-w-[90vw] p-4 bg-gray-900/95 backdrop-blur-md border border-emerald-500/40 rounded-xl shadow-2xl"},us={class:"flex items-center justify-between mb-3"},cs={class:"grid grid-cols-2 gap-2"},ps={key:7,class:"space-y-3"},gs=St({__name:"CanvasSidebar",props:{exportName:{},config:{},fontLibrary:{},spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean},elements:{},selectedId:{}},emits:["update:exportName","update:configWidth","update:configHeight","update:backgroundColor","update:globalFontFamily","update:globalFontSize","update:globalColor","update:spacingEnabled","update:alignmentEnabled","backgroundFileChange","openPreview","downloadByFormat","downloadAllFormats","resetCanvas","selectElement","moveElementUp","moveElementDown","moveElementTop","moveElementBottom","reorderTopElements"],setup(x,{emit:n}){const e=x,g=n,w=Ve({get:()=>e.exportName,set:L=>g("update:exportName",L)}),C=Ve({get:()=>e.config.width,set:L=>g("update:configWidth",L)}),W=Ve({get:()=>e.config.height,set:L=>g("update:configHeight",L)}),oe=Ve({get:()=>e.config.backgroundColor||"",set:L=>g("update:backgroundColor",L)}),he=Ve({get:()=>e.config.globalFontFamily||"",set:L=>g("update:globalFontFamily",L)}),k=Ve({get:()=>e.config.globalFontSize||14,set:L=>g("update:globalFontSize",L)}),ce=Ve({get:()=>e.config.globalColor||"#ffffff",set:L=>g("update:globalColor",L)}),P=Ve({get:()=>e.spacingEnabled,set:L=>g("update:spacingEnabled",L)}),Q=Ve({get:()=>e.alignmentEnabled,set:L=>g("update:alignmentEnabled",L)});function se(L){try{return String(L||"#000000")}catch{return"#000000"}}const _=Ve({get:()=>E.value,set:L=>E.value=L}),E=ge(!1),c=ge("settings");function D(L){g("backgroundFileChange",L)}function R(){g("openPreview")}function ee(){E.value=!E.value}function J(L){g("downloadByFormat",L),E.value=!1}function q(){g("downloadAllFormats"),E.value=!1}function Ie(){g("resetCanvas")}return(L,T)=>(z(),O("div",Ho,[T[31]||(T[31]=l("div",{class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},[l("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[l("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),xl(" 画布设置 ")])],-1)),l("div",Jo,[l("div",qo,[l("button",{class:Ae(["px-3 py-1 text-xs rounded bg-gradient-to-r from-cyan-600 to-blue-600 text-white",c.value==="settings"?"":"opacity-50"]),onClick:T[0]||(T[0]=K=>c.value="settings")},"设置",2),l("button",{class:Ae(["px-3 py-1 text-xs rounded bg-gradient-to-r from-purple-600 to-pink-600 text-white",c.value==="layers"?"":"opacity-50"]),onClick:T[1]||(T[1]=K=>c.value="layers")},"容器层级",2)]),c.value==="settings"?(z(),O("div",Xo,[T[21]||(T[21]=l("label",{class:"block text-sm font-medium text-cyan-300"},"组件名称",-1)),fe(l("input",{"onUpdate:modelValue":T[2]||(T[2]=K=>w.value=K),class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"GeneratedComponent"},null,512),[[we,w.value]])])):te("",!0),c.value==="settings"?(z(),O("div",Yo,[T[22]||(T[22]=l("label",{class:"block text-sm font-medium text-cyan-300"},"画布尺寸",-1)),l("div",_o,[fe(l("input",{"onUpdate:modelValue":T[3]||(T[3]=K=>C.value=K),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"宽度"},null,512),[[we,C.value,void 0,{number:!0}]]),fe(l("input",{"onUpdate:modelValue":T[4]||(T[4]=K=>W.value=K),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"高度"},null,512),[[we,W.value,void 0,{number:!0}]])])])):te("",!0),c.value==="settings"?(z(),O("div",Ko,[T[23]||(T[23]=l("label",{class:"block text-sm font-medium text-cyan-300"},"背景图片",-1)),l("div",Zo,[l("input",{type:"file",onChange:D,accept:"image/*",class:"flex-1 text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-cyan-600 file:text-white hover:file:bg-cyan-500 file:cursor-pointer"},null,32)])])):te("",!0),c.value==="settings"?(z(),O("div",Qo,[T[24]||(T[24]=l("label",{class:"block text-sm font-medium text-cyan-300"},"背景颜色",-1)),l("div",es,[l("input",{value:se(oe.value),type:"color",onInput:T[5]||(T[5]=K=>g("update:backgroundColor",K.target.value)),class:"w-16 h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,40,ts),fe(l("input",{"onUpdate:modelValue":T[6]||(T[6]=K=>oe.value=K),type:"text",class:"flex-1 px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"#000000 或 rgba(...)"},null,512),[[we,oe.value]])])])):te("",!0),c.value==="settings"?(z(),O("div",ls,[T[28]||(T[28]=l("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"全局字体设置",-1)),l("div",rs,[T[25]||(T[25]=l("label",{class:"block text-xs text-gray-400"},"字体族",-1)),at(mt,{options:x.fontLibrary,modelValue:he.value,"onUpdate:modelValue":T[7]||(T[7]=K=>he.value=K),placeholder:"选择字体"},null,8,["options","modelValue"])]),l("div",ns,[T[26]||(T[26]=l("label",{class:"block text-xs text-gray-400"},"字号 (px)",-1)),fe(l("input",{"onUpdate:modelValue":T[8]||(T[8]=K=>k.value=K),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-cyan-500/30 rounded text-gray-100 text-sm focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[we,k.value,void 0,{number:!0}]])]),l("div",os,[T[27]||(T[27]=l("label",{class:"block text-xs text-gray-400"},"颜色",-1)),fe(l("input",{"onUpdate:modelValue":T[9]||(T[9]=K=>ce.value=K),type:"color",class:"w-full h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,512),[[we,ce.value]])])])):te("",!0),c.value==="settings"?(z(),er(Lo,{key:5,spacingEnabled:P.value,alignmentEnabled:Q.value,"onUpdate:spacingEnabled":T[10]||(T[10]=K=>P.value=K),"onUpdate:alignmentEnabled":T[11]||(T[11]=K=>Q.value=K)},null,8,["spacingEnabled","alignmentEnabled"])):te("",!0),c.value==="settings"?(z(),O("div",ss,[l("button",{onClick:R,class:"w-full px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"},"预览（新窗口）"),l("div",as,[l("button",{onClick:ee,class:"w-full px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},"导出"),_.value?(z(),O("div",is,[l("div",{class:"absolute inset-0 bg-black/60",onClick:T[12]||(T[12]=K=>_.value=!1)}),l("div",ds,[l("div",us,[T[29]||(T[29]=l("h3",{class:"text-sm font-medium text-emerald-300"},"选择导出格式",-1)),l("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:T[13]||(T[13]=K=>_.value=!1)},"关闭")]),l("div",cs,[l("button",{onClick:T[14]||(T[14]=K=>J("vue2")),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded"},"Vue2 组件"),l("button",{onClick:T[15]||(T[15]=K=>J("vue3")),class:"px-3 py-2 text-xs bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-500 hover:to-cyan-500 text-white rounded"},"Vue3 组件"),l("button",{onClick:T[16]||(T[16]=K=>J("react")),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"React 组件"),l("button",{onClick:T[17]||(T[17]=K=>J("html")),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded"},"纯 HTML 页面"),l("button",{onClick:T[18]||(T[18]=K=>q()),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded col-span-2"},"一键导出（全部）")])])])):te("",!0)]),l("button",{onClick:Ie,class:"w-full px-4 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"清空画布")])):te("",!0),c.value==="layers"?(z(),O("div",ps,[T[30]||(T[30]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器层级",-1)),at(Wo,{elements:e.elements||[],selectedId:e.selectedId||null,onSelect:T[19]||(T[19]=K=>g("selectElement",K)),onReorderTop:T[20]||(T[20]=K=>g("reorderTopElements",K))},null,8,["elements","selectedId"])])):te("",!0)])]))}}),fs=gs,Jn=qn(io()),ys={class:"relative w-full"},ms=St({__name:"CssEditor",props:{modelValue:{},height:{},debounceMs:{}},emits:["update:modelValue"],setup(x,{emit:n}){const e=x,g=n,w=ge(e.modelValue||"");let C=null;const W=typeof e.debounceMs=="number"?Math.max(0,e.debounceMs):250;bt(()=>e.modelValue,P=>{C&&(clearTimeout(C),C=null);const Q=P||"";Q!==w.value&&(w.value=Q)}),bt(w,P=>{C&&clearTimeout(C),C=window.setTimeout(()=>{g("update:modelValue",P),C=null},W)}),nr(()=>{C&&(clearTimeout(C),C=null)});function oe(){const P=w.value||"";if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText(P).catch(()=>{try{const Q=document.createElement("textarea");Q.value=P,document.body.appendChild(Q),Q.select(),document.execCommand("copy"),document.body.removeChild(Q)}catch{}});else try{const Q=document.createElement("textarea");Q.value=P,document.body.appendChild(Q),Q.select(),document.execCommand("copy"),document.body.removeChild(Q)}catch{}}function he(){C&&(clearTimeout(C),C=null),w.value="",g("update:modelValue","")}const k=[to,lo(),no],ce=Ve(()=>{var P;return(P=e.height)!=null?P:"180px"});return(P,Q)=>(z(),O("div",ys,[l("div",{class:"absolute right-2 top-2 z-10 flex gap-2"},[l("button",{type:"button",class:"px-2 py-1 text-xs bg-gray-700/70 hover:bg-gray-700 text-gray-100 rounded",onClick:oe},"复制"),l("button",{type:"button",class:"px-2 py-1 text-xs bg-red-600/70 hover:bg-red-600 text-white rounded",onClick:he},"清空")]),at(Xn(ro),{modelValue:w.value,"onUpdate:modelValue":Q[0]||(Q[0]=se=>w.value=se),extensions:k,style:ut({height:ce.value,width:"100%"}),class:"w-full rounded border border-purple-500/30 bg-gray-800/50"},null,8,["modelValue","style"])]))}}),bs=or(ms,[["__scopeId","data-v-c1c6cbbe"]]);function xs(x,n,e,g,w,C){x&&(x.style=x.style||{},x.style.boxShadow=`${n}px ${e}px ${g}px ${w}px ${C}`)}function vs(x){x.style=x.style||{},x.style.textGradient=x.style.textGradient||{colors:["#00A3FF","#ffffff"],angle:0}}function hs(x){x.style=x.style||{},x.style.backgroundGradient=x.style.backgroundGradient||{colors:["#00A3FF","#ffffff"],angle:90}}function ws(x,n){var ce,P,Q;const e=(ce=n==null?void 0:n.maxDepth)!=null?ce:6,g=(P=n==null?void 0:n.maxEntries)!=null?P:400,w=(Q=n==null?void 0:n.includeIntermediate)!=null?Q:!1,C=[],W=new WeakSet;function oe(se){return Object.prototype.toString.call(se)==="[object Object]"}function he(se){C.length<g&&C.push(se)}function k(se,_,E){if(!(E>e)&&se!=null){if(typeof se!="object"){he(_);return}if(!W.has(se)){if(W.add(se),Array.isArray(se)){he(_);const c=Math.min(se.length,20);for(let D=0;D<c;D++)k(se[D],`${_}[${D}]`,E+1);return}if(oe(se)){w&&he(_);const c=Object.keys(se).slice(0,50);for(const D of c)k(se[D],_?`${_}.${D}`:D,E+1);return}he(_)}}}return k(x,"",0),C.filter(Boolean)}function $s(x,n){try{if(!x||!n)return"";const e=n.replace(/\[(\d+)\]/g,".$1").replace(/\['([^']+)'\]/g,".$1").replace(/\["([^\"]+)"\]/g,".$1").split(".").filter(Boolean);let g=x;for(const w of e){if(g==null)return"";g=g[w]}return typeof g=="object"?JSON.stringify(g):g!=null?g:""}catch{return""}}function Es(x,n){var w;if(!n||!((w=n.dynamic)!=null&&w.enabled)||!n.dynamic.objectName||!n.dynamic.propertyPath)return"";const e=n.dynamic,g=x[e.objectName];return String($s(g,e.propertyPath))}var ks={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20 flex flex-col"},Ss={key:0,class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Ms={class:"space-y-3"},Cs={class:"grid grid-cols-2 gap-2"},Ns={class:"col-span-2"},Is={key:0,class:"space-y-3"},As={class:"space-y-2"},Fs={class:"grid grid-cols-2 gap-2"},zs={class:"grid grid-cols-2 gap-2"},js={class:"grid grid-cols-2 gap-2"},Os=["value"],Bs=["value"],Ds={class:"space-y-2"},Ts={class:"flex gap-1"},Gs=["value"],Ls=["value"],Us={class:"space-y-2"},Vs={class:"grid grid-cols-3 gap-1"},Rs={class:"space-y-2"},Ps={class:"grid grid-cols-2 gap-2"},Ws=["value"],Hs=["value"],Js=["value"],qs=["value"],Xs={class:"grid grid-cols-4 gap-1"},Ys={class:"space-y-3"},_s={class:"flex items-center justify-between"},Ks={class:"inline-flex items-center cursor-pointer"},Zs={key:0,class:"grid grid-cols-2 gap-2"},Qs={key:1},ea={class:"space-y-3"},ta={class:"space-y-2"},la={class:"flex items-center justify-between"},ra={key:0},na={class:"flex gap-2"},oa={key:1},sa={key:2},aa={key:3,class:"space-y-2 pt-2 border-t border-purple-500/20"},ia={class:"flex items-center justify-between"},da={class:"inline-flex items-center cursor-pointer"},ua=["checked"],ca={key:0,class:"space-y-1"},pa=["value"],ga={key:1,class:"space-y-3"},fa={class:"flex items-center gap-2"},ya=["value"],ma=["value"],ba={class:"space-y-2"},xa={class:"flex items-center justify-between"},va={class:"flex items-center gap-1 text-xs text-gray-300"},ha=["checked"],wa={key:0,class:"grid grid-cols-3 gap-2 items-end"},$a={class:"flex items-center gap-2"},Ea=["value"],ka=["value"],Sa={class:"flex items-center gap-2"},Ma=["value"],Ca=["value"],Na={class:"space-y-1"},Ia=["value"],Aa=["value"],Fa={class:"space-y-2"},za={class:"flex items-center justify-between"},ja={class:"flex items-center gap-1 text-xs text-gray-300"},Oa=["checked"],Ba={key:0,class:"space-y-1"},Da={class:"flex items-center gap-2"},Ta={key:0,class:"space-y-1"},Ga=["value"],La=["value"],Ua={key:1,class:"space-y-1"},Va=["value"],Ra={class:"flex items-center gap-1"},Pa=["value"],Wa={class:"space-y-2"},Ha={class:"flex items-center justify-between"},Ja={class:"flex items-center gap-1 text-xs text-gray-300"},qa=["checked"],Xa={key:0,class:"space-y-2"},Ya=["value"],_a={class:"space-y-1"},Ka={class:"flex items-center gap-2"},Za=["value"],Qa=["value"],ei={class:"space-y-1"},ti={class:"flex items-center gap-2"},li=["value"],ri=["value"],ni={class:"space-y-1"},oi={class:"flex items-center gap-2"},si=["value"],ai=["value"],ii={class:"space-y-1"},di={class:"flex items-center gap-2"},ui=["value"],ci=["value"],pi={class:"space-y-1"},gi={key:0,class:"flex items-center gap-2"},fi=["value"],yi=["value"],mi={key:2,class:"space-y-3"},bi={class:"flex items-center gap-2"},xi={key:0,class:"space-y-2"},vi=["value"],hi={class:"grid grid-cols-2 gap-2"},wi=["value"],$i=["value"],Ei={key:0,class:"grid grid-cols-2 gap-2"},ki=["value"],Si=["value"],Mi={key:1,class:"grid grid-cols-2 gap-2"},Ci={key:2,class:"grid grid-cols-3 gap-2 items-end"},Ni={key:1},Ii={class:"flex items-center justify-between mt-2"},Ai={key:0,class:"text-xs text-red-400"},Fi={key:3,class:"space-y-3"},zi={class:"space-y-2"},ji={class:"flex gap-1"},Oi=["value"],Bi=["value"],Di={class:"grid grid-cols-2 gap-2"},Ti={class:"grid grid-cols-2 gap-1"},Gi=["value"],Li={class:"grid grid-cols-2 gap-2"},Ui=["value"],Vi={key:0},Ri=["value"],Pi={key:0,class:"grid grid-cols-2 gap-2"},Wi=["value"],Hi={key:4,class:"space-y-3"},Ji={class:"space-y-2"},qi={class:"space-y-2 mt-2"},Xi={class:"flex items-center gap-2"},Yi=["checked"],_i={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Ki={class:"text-xs text-gray-400"},Zi={class:"space-y-2"},Qi={class:"grid grid-cols-2 gap-1"},ed={class:"grid grid-cols-2 gap-2"},td={class:"grid grid-cols-2 gap-2"},ld={class:"grid grid-cols-2 gap-2"},rd=["value"],nd=["value"],od={class:"space-y-2"},sd=["value"],ad={class:"space-y-2"},id={class:"flex gap-1"},dd=["value","disabled"],ud=["value","disabled"],cd={key:0,class:"text-xs text-yellow-400 mt-1"},pd={class:"space-y-2"},gd={class:"flex gap-1"},fd=["value"],yd=["value"],md={class:"space-y-2"},bd={class:"grid grid-cols-3 gap-1"},xd={class:"space-y-2"},vd={class:"grid grid-cols-2 gap-1"},hd={class:"space-y-2"},wd={class:"flex items-center gap-2"},$d={class:"flex items-center gap-2 mt-1"},Ed={class:"space-y-2"},kd={class:"flex items-center justify-between"},Sd={class:"flex gap-1"},Md={key:0,class:"grid grid-cols-3 gap-2 items-center"},Cd={class:"col-span-1"},Nd={class:"col-span-1"},Id={class:"col-span-1"},Ad={class:"space-y-2"},Fd={class:"grid grid-cols-3 gap-1"},zd={class:"space-y-2"},jd={class:"flex items-center justify-between"},Od={class:"flex gap-1"},Bd={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Dd={class:"grid grid-cols-2 gap-2"},Td={class:"flex gap-1"},Gd={class:"flex gap-1"},Ld={class:"block text-xs text-gray-400 mb-1"},Ud={class:"space-y-2"},Vd={class:"flex items-center justify-between"},Rd={class:"flex gap-1"},Pd={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Wd={class:"grid grid-cols-2 gap-2"},Hd={class:"flex gap-1"},Jd={class:"flex gap-1"},qd={class:"block text-xs text-gray-400 mb-1"},Xd={key:5,class:"space-y-3"},Yd={class:"space-y-2"},_d={key:0,class:"space-y-2"},Kd={class:"max-h-32 overflow-y-auto custom-scrollbar bg-gray-800/30 rounded p-2"},Zd={class:"grid grid-cols-4 gap-2"},Qd=["onClick"],eu=["src","alt"],tu={key:0,class:"text-xs text-gray-500 text-center py-2"},lu={class:"grid grid-cols-3 gap-2"},ru={class:"space-y-2"},nu={class:"pt-4 border-t border-purple-500/30 space-y-2"},ou={key:1,class:"p-4 text-center text-gray-400 flex-1 flex flex-col justify-center"},su={},au=St({...su,__name:"ElementSettingsPanel",props:{selectedEl:{},config:{},fontLibrary:{},fontSizeLibrary:{},fontWeightOptions:{},fontStyleOptions:{},databaseObjects:{},dbMap:{},iconLibrary:{},defaultChartOption:{type:Function},safeHex:{type:Function},initCustomClassSkeleton:{type:Function},refreshAllCustomClassCss:{type:Function},removeCustomClassCssForElement:{type:Function},getIconDataUrlById:{type:Function}},emits:["duplicateSelected","removeSelected","saveSelectedAsComponent"],setup(x,{emit:n}){const e=x,g=n,w=ge("visual"),C=ge(""),W=ge("");bt(()=>{var y;return(y=e.selectedEl)==null?void 0:y.id},()=>{var t;const y=e.selectedEl;y&&y.type==="chart"&&(w.value="visual",W.value="",C.value=JSON.stringify((t=y.chartOption)!=null?t:e.defaultChartOption(y.chartType||"line"),null,2))});const oe=Ve(()=>{var Z,$e;const y=($e=(Z=e.selectedEl)==null?void 0:Z.dynamic)==null?void 0:$e.objectName;if(!y)return[];const t=e.dbMap[y];try{return ws(t,{maxDepth:6,maxEntries:400})}catch{return[]}});function he(y){return Es(e.dbMap,y)}function k(y){return typeof y=="string"&&y.trim().endsWith("%")?"%":"px"}function ce(y){if(y==null)return 0;if(typeof y=="number")return y;const t=String(y).trim();if(t.endsWith("%")){const $e=Number(t.replace("%",""));return Number.isFinite($e)?$e:0}const Z=Number(t.replace("px",""));return Number.isFinite(Z)?Z:0}function P(y,t){const Z=e.selectedEl;Z&&(Z.style=Z.style||{},Z.style.borderRadius=`${y}${t}`)}function Q(y){const t={x:0,y:8,blur:24,spread:0,color:"#000000"};if(!y||!y.trim())return t;const Z=y.split(/\s+/).filter(Boolean);if(Z.length<3)return t;const $e=Z.slice(0,4).map(Xe=>Number(String(Xe).replace("px",""))),ze=Z.slice(4).join(" ")||t.color,[Re=NaN,Ce=NaN,tt=NaN,_e=NaN]=$e;return{x:Number.isFinite(Re)?Re:t.x,y:Number.isFinite(Ce)?Ce:t.y,blur:Number.isFinite(tt)?tt:t.blur,spread:Number.isFinite(_e)?_e:t.spread,color:ze}}function se(y,t,Z,$e,ze){xs(e.selectedEl,y,t,Z,$e,ze)}function _(y){vs(y)}function E(y){hs(y)}function c(){W.value="";try{const y=JSON.parse(C.value);e.selectedEl&&e.selectedEl.type==="chart"&&(e.selectedEl.chartOption=y)}catch(y){W.value=`JSON 解析失败：${(y==null?void 0:y.message)||String(y)}`}}function D(y,t){if(!e.selectedEl||e.selectedEl.type!=="chart"||!e.selectedEl.chartOption)return;const Z=e.selectedEl.chartOption,$e=Z.series||[],ze={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:y},{offset:1,color:t}],global:!1};$e.forEach(Re=>{Re.type==="bar"&&(Re.itemStyle=Re.itemStyle||{},Re.itemStyle.color=ze)}),C.value=JSON.stringify(Z,null,2)}function R(){const y=e.selectedEl;return!y||y.type!=="chart"?null:(y.chartOption||(y.chartOption=e.defaultChartOption(y.chartType||"line")),y.chartOption)}function ee(y){const t=R();t&&(t.title=t.title||{},t.title.text=y,C.value=JSON.stringify(t,null,2))}function J(y){const t=R();t&&(t.color=y.split(",").map(Z=>Z.trim()).filter(Boolean),C.value=JSON.stringify(t,null,2))}function q(y){const t=R();t&&(t.legend=t.legend||{},t.legend.show=y==="1",C.value=JSON.stringify(t,null,2))}function Ie(y){var Z;const t=(Z=y.target.files)==null?void 0:Z[0];if(t&&e.selectedEl){const $e=new FileReader;$e.onload=()=>{e.selectedEl&&(e.selectedEl.src=String($e.result),e.selectedEl.iconId=void 0)},$e.readAsDataURL(t)}}async function L(y){const t=e.selectedEl;if(!t||t.type!=="image")return;const Z=await e.getIconDataUrlById(y.id);if(!Z)return;t.src=Z,t.iconId=y.id;const $e=new Image;$e.onload=()=>{e.selectedEl&&e.selectedEl.id===t.id&&(e.selectedEl.width=$e.naturalWidth,e.selectedEl.height=$e.naturalHeight)},$e.src=Z}function T(){const y=e.selectedEl;if(!y||y.type!=="image"||!y.src)return;const t=new Image;t.onload=()=>{e.selectedEl&&(e.selectedEl.width=t.naturalWidth,e.selectedEl.height=t.naturalHeight)},t.src=y.src}function K(){}const We=Ve({get(){const y=e.selectedEl;return!!(y&&y.eventBinding&&y.eventBinding.enabled)},set(y){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!1,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.enabled=y,(t.eventBinding.handlerName==null||String(t.eventBinding.handlerName).trim()==="")&&(t.eventBinding.handlerName="handleClick"),(t.eventBinding.cursor==null||String(t.eventBinding.cursor).trim()==="")&&(t.eventBinding.cursor="pointer"),t.eventBinding.code==null&&(t.eventBinding.code=""))}}),qe=Ve({get(){var y,t;return(t=(y=e.selectedEl)==null?void 0:y.eventBinding)==null?void 0:t.cursor},set(y){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.cursor=y)}}),d=Ve({get(){var y,t;return(t=(y=e.selectedEl)==null?void 0:y.eventBinding)==null?void 0:t.handlerName},set(y){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.handlerName=y)}}),ie=Ve({get(){var y,t;return(t=(y=e.selectedEl)==null?void 0:y.eventBinding)==null?void 0:t.code},set(y){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.code=y)}});return(y,t)=>{var Z,$e,ze,Re,Ce,tt,_e,Xe,ht,wt,At,Ft,zt,xt,jt,Fe,xe,gt,ft,Ue,He,Je,Ee,je,Ke,yt,Pe,nt,Ye,Mt,Ot,vl,Bt,Dt,$t,hl,wl,$l,Ct,Tt,El,Qt,kl,Sl,el,Ml,Cl,Nl,Il,tl,ll,Pt,Wt,Al,Fl,zl,Gt,vt,rl,Lt,nl,jl,Ol,Bl,Ze,Nt,Dl,Tl,ol,sl,al,Gl,Ut,Ht,Jt,qt,il,dl,Ll,ul,ct,it,Ul,Vl,Rl,Pl,Wl,Hl,cl,Xt,Yt,pl,_t,Kt,Jl,Vt,gl,ql,fl,Xl,yl,r,o,a,p,m,f,A,F,N,S,i,u,B,H,de,pe,ae,me,ye,le,re,X,ne,Me,b,h,U,I,G,Y,v,V,$,ue,Se,be,ke,Ne,Oe,ot,lt,dt,Qe,pt,st,Et,Zt,Yl,sr,ar,ir,dr,ur,cr,pr,gr,fr,yr,mr,br,xr,vr,hr,wr,$r,Er,kr,Sr,Mr,Cr,Nr,Ir,Ar,Fr,zr,jr,Or,Br,Dr,Tr,Gr,Lr,Ur,Vr,Rr,Pr,Wr,Hr,Jr,qr,Xr,Yr,_r,Kr,Zr,Qr,en,tn,ln,rn,nn,on,sn,an,dn,un,cn,pn,gn,fn,yn,mn,bn,xn,vn,hn,wn,$n,En,kn,Sn,Mn,Cn,Nn,In,An,Fn,zn,jn,On,Bn,Dn,Tn;return z(),O("div",ks,[t[272]||(t[272]=l("div",{class:"p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},[l("h2",{class:"text-lg font-bold text-purple-300 flex items-center gap-2"},[l("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),xl(" 元素设置 ")])],-1)),e.selectedEl?(z(),O("div",Ss,[l("div",Ms,[t[149]||(t[149]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"位置和尺寸",-1)),l("div",Cs,[l("div",null,[t[144]||(t[144]=l("label",{class:"block text-xs text-gray-400 mb-1"},"X",-1)),fe(l("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>e.selectedEl.left=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.left,void 0,{number:!0}]])]),l("div",null,[t[145]||(t[145]=l("label",{class:"block text-xs text-gray-400 mb-1"},"Y",-1)),fe(l("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.selectedEl.top=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.top,void 0,{number:!0}]])]),l("div",null,[t[146]||(t[146]=l("label",{class:"block text-xs text-gray-400 mb-1"},"宽度",-1)),fe(l("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.selectedEl.width=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.width,void 0,{number:!0}]])]),l("div",null,[t[147]||(t[147]=l("label",{class:"block text-xs text-gray-400 mb-1"},"高度",-1)),fe(l("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>e.selectedEl.height=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.height,void 0,{number:!0}]])]),l("div",Ns,[t[148]||(t[148]=l("label",{class:"block text-xs text-gray-400 mb-1"},"层级（z-index）",-1)),fe(l("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.selectedEl.zIndex=s),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.zIndex,void 0,{number:!0}]])])])]),e.selectedEl&&e.selectedEl.type==="arc-text"?(z(),O("div",Is,[t[165]||(t[165]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"环绕文字设置",-1)),l("div",As,[t[150]||(t[150]=l("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),fe(l("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>e.selectedEl.text=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[we,e.selectedEl.text]])]),l("div",Fs,[l("div",null,[t[151]||(t[151]=l("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),at(mt,{options:e.fontSizeLibrary,modelValue:((Z=e.selectedEl.style)==null?void 0:Z.fontSize)||e.config.globalFontSize,"onUpdate:modelValue":t[6]||(t[6]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=s)}),numeric:!0},null,8,["options","modelValue"])]),l("div",null,[t[152]||(t[152]=l("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),at(mt,{options:e.fontLibrary,modelValue:(($e=e.selectedEl.style)==null?void 0:$e.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[7]||(t[7]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=s)})},null,8,["options","modelValue"])])]),l("div",zs,[l("div",null,[t[153]||(t[153]=l("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),at(mt,{options:e.fontWeightOptions,modelValue:((ze=e.selectedEl.style)==null?void 0:ze.fontWeight)||"400","onUpdate:modelValue":t[8]||(t[8]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=s)})},null,8,["options","modelValue"])]),l("div",null,[t[154]||(t[154]=l("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),at(mt,{options:e.fontStyleOptions,modelValue:((Re=e.selectedEl.style)==null?void 0:Re.fontStyle)||"normal","onUpdate:modelValue":t[9]||(t[9]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=s)})},null,8,["options","modelValue"])])]),l("div",js,[l("div",null,[t[155]||(t[155]=l("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),l("input",{value:(tt=(Ce=e.selectedEl.style)==null?void 0:Ce.letterSpacing)!=null?tt:0,onInput:t[10]||(t[10]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(s.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Os)]),l("div",null,[t[156]||(t[156]=l("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),l("input",{value:(Xe=(_e=e.selectedEl.style)==null?void 0:_e.lineHeight)!=null?Xe:1.5,onInput:t[11]||(t[11]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(s.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Bs)])]),l("div",Ds,[t[157]||(t[157]=l("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),l("div",Ts,[l("input",{value:((wt=(ht=e.selectedEl)==null?void 0:ht.style)==null?void 0:wt.color)||e.config.globalColor,onInput:t[12]||(t[12]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Gs),l("input",{value:(zt=(Ft=(At=e.selectedEl)==null?void 0:At.style)==null?void 0:Ft.color)!=null?zt:e.config.globalColor,onInput:t[13]||(t[13]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,40,Ls)])]),l("div",Us,[t[158]||(t[158]=l("label",{class:"block text-xs text-gray-400 mb-1"},"对齐方式",-1)),l("div",Vs,[l("button",{onClick:t[14]||(t[14]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((xt=e.selectedEl.style)==null?void 0:xt.textAlign)||"center")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左",2),l("button",{onClick:t[15]||(t[15]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((jt=e.selectedEl.style)==null?void 0:jt.textAlign)||"center")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"中",2),l("button",{onClick:t[16]||(t[16]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Fe=e.selectedEl.style)==null?void 0:Fe.textAlign)||"center")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右",2)])]),l("div",Rs,[t[164]||(t[164]=l("label",{class:"block text-xs text-gray-400 mb-1"},"圆弧参数",-1)),l("div",Ps,[l("div",null,[t[159]||(t[159]=l("label",{class:"block text-xs text-gray-400 mb-1"},"半径(px)",-1)),l("input",{value:(Ue=(ft=(gt=(xe=e.selectedEl)==null?void 0:xe.style)==null?void 0:gt.arcText)==null?void 0:ft.radius)!=null?Ue:Math.min(e.selectedEl.width||0,e.selectedEl.height||0)/2,onInput:t[17]||(t[17]=s=>{if(e.selectedEl){const j=Number(s.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.radius=j}}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ws)]),l("div",null,[t[160]||(t[160]=l("label",{class:"block text-xs text-gray-400 mb-1"},"起始角(°)",-1)),l("input",{value:(je=(Ee=(Je=(He=e.selectedEl)==null?void 0:He.style)==null?void 0:Je.arcText)==null?void 0:Ee.startAngle)!=null?je:0,onInput:t[18]||(t[18]=s=>{if(e.selectedEl){const j=Number(s.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=j}}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Hs)]),l("div",null,[t[161]||(t[161]=l("label",{class:"block text-xs text-gray-400 mb-1"},"扫过角(°)",-1)),l("input",{value:(nt=(Pe=(yt=(Ke=e.selectedEl)==null?void 0:Ke.style)==null?void 0:yt.arcText)==null?void 0:Pe.sweepAngle)!=null?nt:180,onInput:t[19]||(t[19]=s=>{if(e.selectedEl){const j=Number(s.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.sweepAngle=j}}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Js)]),l("div",null,[t[163]||(t[163]=l("label",{class:"block text-xs text-gray-400 mb-1"},"顺时针",-1)),l("select",{value:(vl=(Ot=(Mt=(Ye=e.selectedEl)==null?void 0:Ye.style)==null?void 0:Mt.arcText)==null?void 0:Ot.clockwise)==null||vl?"1":"0",onChange:t[20]||(t[20]=s=>{if(e.selectedEl){const j=s.target.value==="1";e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.clockwise=j}}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[162]||(t[162]=[l("option",{value:"1"},"是",-1),l("option",{value:"0"},"否",-1)])],40,qs)])]),l("div",Xs,[l("button",{onClick:t[21]||(t[21]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=180,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"上"),l("button",{onClick:t[22]||(t[22]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=0,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下"),l("button",{onClick:t[23]||(t[23]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=90,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左"),l("button",{onClick:t[24]||(t[24]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=270,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右")])])])):te("",!0),l("div",Ys,[t[172]||(t[172]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"事件绑定",-1)),l("div",_s,[t[167]||(t[167]=l("label",{class:"text-xs text-gray-400"},"开启事件绑定",-1)),l("label",Ks,[fe(l("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":t[25]||(t[25]=s=>We.value=s)},null,512),[[Ql,We.value]]),t[166]||(t[166]=l("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[l("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),l("span",{class:Ae(["ml-3 text-xs",We.value?"text-cyan-300":"text-gray-300"])},rt(We.value?"已开启":"已关闭"),3)])]),We.value?(z(),O("div",Zs,[l("div",null,[t[169]||(t[169]=l("label",{class:"block text-xs text-gray-400 mb-1"},"Cursor",-1)),fe(l("select",{"onUpdate:modelValue":t[26]||(t[26]=s=>qe.value=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[168]||(t[168]=[Zl('<option value="pointer" data-v-4b22c81b>pointer</option><option value="default" data-v-4b22c81b>default</option><option value="move" data-v-4b22c81b>move</option><option value="crosshair" data-v-4b22c81b>crosshair</option><option value="grab" data-v-4b22c81b>grab</option>',5)])],512),[[Ln,qe.value]])]),l("div",null,[t[170]||(t[170]=l("label",{class:"block text-xs text-gray-400 mb-1"},"函数名",-1)),fe(l("input",{"onUpdate:modelValue":t[27]||(t[27]=s=>d.value=s),type:"text",placeholder:"handleClick",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[we,d.value]])])])):te("",!0),We.value?(z(),O("div",Qs,[t[171]||(t[171]=l("label",{class:"block text-xs text-gray-400 mb-1"},"事件代码",-1)),fe(l("textarea",{"onUpdate:modelValue":t[28]||(t[28]=s=>ie.value=s),rows:"6",placeholder:"function body...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[we,ie.value]])])):te("",!0)]),l("div",ea,[t[182]||(t[182]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"元素属性",-1)),l("div",ta,[l("div",la,[t[173]||(t[173]=l("label",{class:"text-xs text-gray-400"},"启用 Class 样式",-1)),fe(l("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=s=>e.selectedEl.enableClassStyle=s),onChange:t[30]||(t[30]=s=>{e.selectedEl&&s.target.checked?(e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss()):e.selectedEl&&!s.target.checked&&e.removeCustomClassCssForElement(e.selectedEl.id)}),class:"rounded border-purple-500/30 text-purple-400 focus:ring-purple-400"},null,544),[[Ql,e.selectedEl.enableClassStyle]])]),(Bt=e.selectedEl)!=null&&Bt.enableClassStyle?(z(),O("div",ra,[t[174]||(t[174]=l("label",{class:"block text-xs text-gray-400 mb-1"},"CSS Class",-1)),l("div",na,[fe(l("input",{"onUpdate:modelValue":t[31]||(t[31]=s=>e.selectedEl.className=s),type:"text",placeholder:"自动生成唯一类名，可修改",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.className]]),l("button",{type:"button",onClick:t[32]||(t[32]=()=>{e.selectedEl&&(e.selectedEl.className=`cls-${String(e.selectedEl.id).slice(0,8)}`,e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss())}),class:"px-2 py-1 text-xs bg-purple-600/60 hover:bg-purple-600 rounded text-white"},"生成默认")])])):te("",!0),(Dt=e.selectedEl)!=null&&Dt.enableClassStyle?(z(),O("div",oa,[t[175]||(t[175]=l("label",{class:"block text-xs text-gray-400 mb-1"},"自定义样式（CSS 声明）",-1)),at(bs,{modelValue:String(($t=e.selectedEl.customClassCss)!=null?$t:""),"onUpdate:modelValue":t[33]||(t[33]=s=>{e.selectedEl.customClassCss=s,e.refreshAllCustomClassCss()}),height:"180px"},null,8,["modelValue"]),t[176]||(t[176]=l("p",{class:"text-[11px] text-gray-500 mt-1"},"提示：已为当前类名生成 .className { } 模板；也可直接填写声明，系统会自动包裹并追加 !important。",-1))])):te("",!0),e.selectedEl&&(e.selectedEl.type==="chart"||e.selectedEl.type==="container")?(z(),O("div",sa,[t[177]||(t[177]=l("label",{class:"block text-xs text-gray-400 mb-1"},"元素ID",-1)),fe(l("input",{"onUpdate:modelValue":t[34]||(t[34]=s=>e.selectedEl.elementId=s),type:"text",placeholder:"输入元素ID",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.elementId]])])):te("",!0),e.selectedEl?(z(),O("div",aa,[t[181]||(t[181]=l("h3",{class:"text-sm font-medium text-purple-300"},"显示与隐藏",-1)),l("div",ia,[t[179]||(t[179]=l("label",{class:"text-xs text-gray-400"},"隐藏该元素",-1)),l("label",da,[l("input",{type:"checkbox",class:"sr-only peer",checked:!!e.selectedEl.hidden,onChange:t[35]||(t[35]=s=>{const j=s.target.checked;e.selectedEl&&(e.selectedEl.hidden=j,j&&!e.selectedEl.hiddenLabel&&(e.selectedEl.hiddenLabel=`hidden-${String(e.selectedEl.id).slice(0,8)}`))})},null,40,ua),t[178]||(t[178]=l("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-purple-600 peer-checked:to-pink-600"},[l("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),l("span",{class:Ae(["ml-3 text-xs",e.selectedEl.hidden?"text-purple-300":"text-gray-300"])},rt(e.selectedEl.hidden?"已隐藏":"显示中"),3)])]),e.selectedEl.hidden?(z(),O("div",ca,[t[180]||(t[180]=l("label",{class:"block text-xs text-gray-400"},"隐藏标识",-1)),l("input",{type:"text",value:e.selectedEl.hiddenLabel||"",onInput:t[36]||(t[36]=s=>{e.selectedEl&&(e.selectedEl.hiddenLabel=s.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1",placeholder:"hidden-xxxx"},null,40,pa)])):te("",!0)])):te("",!0)])]),e.selectedEl&&e.selectedEl.type==="container"?(z(),O("div",ga,[t[204]||(t[204]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器样式",-1)),l("div",null,[t[183]||(t[183]=l("label",{class:"block text-xs text-gray-400 mb-1"},"背景色（HEX）",-1)),l("div",fa,[l("input",{type:"color",value:((wl=(hl=e.selectedEl)==null?void 0:hl.style)==null?void 0:wl.backgroundColor)||"#000000",onInput:t[37]||(t[37]=s=>{const j=s.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=j)}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,ya),l("input",{type:"text",value:((Ct=($l=e.selectedEl)==null?void 0:$l.style)==null?void 0:Ct.backgroundColor)||"",placeholder:"#1e293b 或 transparent",onInput:t[38]||(t[38]=s=>{const j=s.target.value.trim();e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=j)}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,ma)]),t[184]||(t[184]=l("p",{class:"text-[11px] text-gray-500 mt-1"},"支持 #RGB/#RRGGBB 或 CSS 颜色名；启用渐变时该颜色被覆盖。",-1))]),l("div",null,[t[185]||(t[185]=l("label",{class:"block text-xs text-gray-400 mb-1"},"容器注释（导出可见）",-1)),fe(l("textarea",{"onUpdate:modelValue":t[39]||(t[39]=s=>e.selectedEl.comment=s),rows:"2",placeholder:"输入注释，方便代码维护...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.comment]])]),l("div",ba,[l("div",xa,[t[187]||(t[187]=l("label",{class:"block text-xs text-gray-400 mb-1"},"渐变背景",-1)),l("label",va,[l("input",{type:"checkbox",checked:!!((El=(Tt=e.selectedEl)==null?void 0:Tt.style)!=null&&El.backgroundGradient),onChange:t[40]||(t[40]=s=>{const j=s.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},j?e.selectedEl.style.backgroundGradient||(e.selectedEl.style.backgroundGradient={colors:["#42b883","#0ea5e9"],angle:90}):delete e.selectedEl.style.backgroundGradient)})},null,40,ha),t[186]||(t[186]=xl(" 启用 ",-1))])]),(kl=(Qt=e.selectedEl)==null?void 0:Qt.style)!=null&&kl.backgroundGradient?(z(),O("div",wa,[l("div",null,[t[188]||(t[188]=l("label",{class:"block text-[11px] text-gray-400 mb-1"},"起始色（HEX）",-1)),l("div",$a,[l("input",{type:"color",value:((Cl=(Ml=(el=(Sl=e.selectedEl)==null?void 0:Sl.style)==null?void 0:el.backgroundGradient)==null?void 0:Ml.colors)==null?void 0:Cl[0])||"#42b883",onInput:t[41]||(t[41]=s=>{var ve;const j=s.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(ve=M.colors)!=null&&ve.length?M.colors:["","#"],M.colors[0]=j,e.selectedEl.style.backgroundGradient=M}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,Ea),l("input",{type:"text",value:((ll=(tl=(Il=(Nl=e.selectedEl)==null?void 0:Nl.style)==null?void 0:Il.backgroundGradient)==null?void 0:tl.colors)==null?void 0:ll[0])||"",placeholder:"#42b883",onInput:t[42]||(t[42]=s=>{var ve;const j=s.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(ve=M.colors)!=null&&ve.length?M.colors:["","#"],M.colors[0]=j,e.selectedEl.style.backgroundGradient=M}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ka)])]),l("div",null,[t[189]||(t[189]=l("label",{class:"block text-[11px] text-gray-400 mb-1"},"结束色（HEX）",-1)),l("div",Sa,[l("input",{type:"color",value:((Fl=(Al=(Wt=(Pt=e.selectedEl)==null?void 0:Pt.style)==null?void 0:Wt.backgroundGradient)==null?void 0:Al.colors)==null?void 0:Fl[1])||"#0ea5e9",onInput:t[43]||(t[43]=s=>{var ve;const j=s.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(ve=M.colors)!=null&&ve.length?M.colors:["","#"],M.colors[1]=j,e.selectedEl.style.backgroundGradient=M}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,Ma),l("input",{type:"text",value:((rl=(vt=(Gt=(zl=e.selectedEl)==null?void 0:zl.style)==null?void 0:Gt.backgroundGradient)==null?void 0:vt.colors)==null?void 0:rl[1])||"",placeholder:"#0ea5e9",onInput:t[44]||(t[44]=s=>{var ve;const j=s.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(ve=M.colors)!=null&&ve.length?M.colors:["","#"],M.colors[1]=j,e.selectedEl.style.backgroundGradient=M}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ca)])]),l("div",Na,[t[190]||(t[190]=l("label",{class:"block text-[11px] text-gray-400"},"角度（0-360）",-1)),l("input",{type:"range",min:"0",max:"360",step:"1",value:(Ol=(jl=(nl=(Lt=e.selectedEl)==null?void 0:Lt.style)==null?void 0:nl.backgroundGradient)==null?void 0:jl.angle)!=null?Ol:90,onInput:t[45]||(t[45]=s=>{const j=Number(s.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.angle=j,e.selectedEl.style.backgroundGradient=M}),class:"w-full"},null,40,Ia),l("input",{type:"number",value:(Dl=(Nt=(Ze=(Bl=e.selectedEl)==null?void 0:Bl.style)==null?void 0:Ze.backgroundGradient)==null?void 0:Nt.angle)!=null?Dl:90,onInput:t[46]||(t[46]=s=>{const j=Number(s.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.angle=j,e.selectedEl.style.backgroundGradient=M}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Aa)])])):te("",!0),t[191]||(t[191]=l("p",{class:"text-[11px] text-gray-500"},"提示：仅在启用后显示渐变设置；未启用时使用背景色。",-1))]),l("div",Fa,[l("div",za,[t[193]||(t[193]=l("label",{class:"block text-xs text-gray-400"},"圆角",-1)),l("label",ja,[l("input",{type:"checkbox",checked:!!((ol=(Tl=e.selectedEl)==null?void 0:Tl.style)!=null&&ol.borderRadius)&&ce((al=(sl=e.selectedEl)==null?void 0:sl.style)==null?void 0:al.borderRadius)>0,onChange:t[47]||(t[47]=s=>{const j=s.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},j?e.selectedEl.style.borderRadius||(e.selectedEl.style.borderRadius="8px"):e.selectedEl.style.borderRadius="0")})},null,40,Oa),t[192]||(t[192]=xl(" 启用 ",-1))])]),(Ut=(Gl=e.selectedEl)==null?void 0:Gl.style)!=null&&Ut.borderRadius&&ce((Jt=(Ht=e.selectedEl)==null?void 0:Ht.style)==null?void 0:Jt.borderRadius)>=0?(z(),O("div",Ba,[l("div",Da,[t[194]||(t[194]=l("span",{class:"text-[11px] text-gray-400"},"单位",-1)),l("button",{type:"button",class:Ae(["px-2 py-0.5 rounded text-[11px]",k((il=(qt=e.selectedEl)==null?void 0:qt.style)==null?void 0:il.borderRadius)==="px"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[48]||(t[48]=()=>{var j,M;const s=ce((M=(j=e.selectedEl)==null?void 0:j.style)==null?void 0:M.borderRadius);P(s,"px")})},"px",2),l("button",{type:"button",class:Ae(["px-2 py-0.5 rounded text-[11px]",k((Ll=(dl=e.selectedEl)==null?void 0:dl.style)==null?void 0:Ll.borderRadius)==="%"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[49]||(t[49]=()=>{var j,M;const s=ce((M=(j=e.selectedEl)==null?void 0:j.style)==null?void 0:M.borderRadius);P(s,"%")})},"%",2)]),k((ct=(ul=e.selectedEl)==null?void 0:ul.style)==null?void 0:ct.borderRadius)==="px"?(z(),O("div",Ta,[l("input",{type:"range",min:"0",max:"64",step:"1",value:ce((Ul=(it=e.selectedEl)==null?void 0:it.style)==null?void 0:Ul.borderRadius),onInput:t[50]||(t[50]=s=>{const j=Number(s.target.value)||0;P(j,"px")}),class:"w-full"},null,40,Ga),l("input",{type:"number",value:ce((Rl=(Vl=e.selectedEl)==null?void 0:Vl.style)==null?void 0:Rl.borderRadius),onInput:t[51]||(t[51]=s=>{const j=Number(s.target.value)||0;P(j,"px")}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,La)])):(z(),O("div",Ua,[l("input",{type:"range",min:"0",max:"100",step:"1",value:ce((Wl=(Pl=e.selectedEl)==null?void 0:Pl.style)==null?void 0:Wl.borderRadius),onInput:t[52]||(t[52]=s=>{const j=Number(s.target.value)||0;P(j,"%")}),class:"w-full"},null,40,Va),l("div",Ra,[l("input",{type:"number",value:ce((cl=(Hl=e.selectedEl)==null?void 0:Hl.style)==null?void 0:cl.borderRadius),onInput:t[53]||(t[53]=s=>{const j=Number(s.target.value)||0;P(j,"%")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Pa),t[195]||(t[195]=l("span",{class:"text-xs text-gray-400"},"%",-1))])]))])):te("",!0)]),l("div",Wa,[l("div",Ha,[t[197]||(t[197]=l("label",{class:"block text-xs text-gray-400"},"阴影（box-shadow）",-1)),l("label",Ja,[l("input",{type:"checkbox",checked:!!((Yt=(Xt=e.selectedEl)==null?void 0:Xt.style)!=null&&Yt.boxShadow),onChange:t[54]||(t[54]=s=>{const j=s.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},j?e.selectedEl.style.boxShadow||(e.selectedEl.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)"):delete e.selectedEl.style.boxShadow)})},null,40,qa),t[196]||(t[196]=xl(" 启用 ",-1))])]),(_t=(pl=e.selectedEl)==null?void 0:pl.style)!=null&&_t.boxShadow?(z(),O("div",Xa,[l("input",{type:"text",value:((Jl=(Kt=e.selectedEl)==null?void 0:Kt.style)==null?void 0:Jl.boxShadow)||"",placeholder:"例如: 0 8px 24px rgba(0,0,0,0.25)",onInput:t[55]||(t[55]=s=>{const j=s.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.boxShadow=j)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ya),l("div",_a,[t[198]||(t[198]=l("label",{class:"block text-[11px] text-gray-400"},"X 偏移",-1)),l("div",Ka,[l("input",{type:"range",min:"-64",max:"64",step:"1",value:Q((gl=(Vt=e.selectedEl)==null?void 0:Vt.style)==null?void 0:gl.boxShadow).x,onInput:t[56]||(t[56]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se(j!=null?j:0,(De=M.y)!=null?De:0,(Te=M.blur)!=null?Te:0,(Ge=M.spread)!=null?Ge:0,(Le=M.color)!=null?Le:"#000000")}),class:"flex-1"},null,40,Za),l("input",{type:"number",value:Q((fl=(ql=e.selectedEl)==null?void 0:ql.style)==null?void 0:fl.boxShadow).x,onInput:t[57]||(t[57]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se(j!=null?j:0,(De=M.y)!=null?De:0,(Te=M.blur)!=null?Te:0,(Ge=M.spread)!=null?Ge:0,(Le=M.color)!=null?Le:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Qa)])]),l("div",ei,[t[199]||(t[199]=l("label",{class:"block text-[11px] text-gray-400"},"Y 偏移",-1)),l("div",ti,[l("input",{type:"range",min:"-64",max:"64",step:"1",value:Q((yl=(Xl=e.selectedEl)==null?void 0:Xl.style)==null?void 0:yl.boxShadow).y,onInput:t[58]||(t[58]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,j!=null?j:0,(Te=M.blur)!=null?Te:0,(Ge=M.spread)!=null?Ge:0,(Le=M.color)!=null?Le:"#000000")}),class:"flex-1"},null,40,li),l("input",{type:"number",value:Q((o=(r=e.selectedEl)==null?void 0:r.style)==null?void 0:o.boxShadow).y,onInput:t[59]||(t[59]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,j!=null?j:0,(Te=M.blur)!=null?Te:0,(Ge=M.spread)!=null?Ge:0,(Le=M.color)!=null?Le:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ri)])]),l("div",ni,[t[200]||(t[200]=l("label",{class:"block text-[11px] text-gray-400"},"模糊",-1)),l("div",oi,[l("input",{type:"range",min:"0",max:"128",step:"1",value:Q((p=(a=e.selectedEl)==null?void 0:a.style)==null?void 0:p.boxShadow).blur,onInput:t[60]||(t[60]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,(Te=M.y)!=null?Te:0,j!=null?j:0,(Ge=M.spread)!=null?Ge:0,(Le=M.color)!=null?Le:"#000000")}),class:"flex-1"},null,40,si),l("input",{type:"number",value:Q((f=(m=e.selectedEl)==null?void 0:m.style)==null?void 0:f.boxShadow).blur,onInput:t[61]||(t[61]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,(Te=M.y)!=null?Te:0,j!=null?j:0,(Ge=M.spread)!=null?Ge:0,(Le=M.color)!=null?Le:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ai)])]),l("div",ii,[t[201]||(t[201]=l("label",{class:"block text-[11px] text-gray-400"},"扩散",-1)),l("div",di,[l("input",{type:"range",min:"-64",max:"64",step:"1",value:Q((F=(A=e.selectedEl)==null?void 0:A.style)==null?void 0:F.boxShadow).spread,onInput:t[62]||(t[62]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,(Te=M.y)!=null?Te:0,(Ge=M.blur)!=null?Ge:0,j!=null?j:0,(Le=M.color)!=null?Le:"#000000")}),class:"flex-1"},null,40,ui),l("input",{type:"number",value:Q((S=(N=e.selectedEl)==null?void 0:N.style)==null?void 0:S.boxShadow).spread,onInput:t[63]||(t[63]=s=>{var ve,Be,De,Te,Ge,Le;const j=Number(s.target.value)||0,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,(Te=M.y)!=null?Te:0,(Ge=M.blur)!=null?Ge:0,j!=null?j:0,(Le=M.color)!=null?Le:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ci)])])])):te("",!0),l("div",pi,[t[202]||(t[202]=l("label",{class:"block text-[11px] text-gray-400"},"阴影颜色",-1)),(u=(i=e.selectedEl)==null?void 0:i.style)!=null&&u.boxShadow?(z(),O("div",gi,[l("input",{type:"color",value:Q((H=(B=e.selectedEl)==null?void 0:B.style)==null?void 0:H.boxShadow).color||"#000000",onInput:t[64]||(t[64]=s=>{var ve,Be,De,Te,Ge,Le;const j=s.target.value,M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,(Te=M.y)!=null?Te:0,(Ge=M.blur)!=null?Ge:0,(Le=M.spread)!=null?Le:0,j||"#000000")}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,fi),l("input",{type:"text",value:Q((pe=(de=e.selectedEl)==null?void 0:de.style)==null?void 0:pe.boxShadow).color||"",placeholder:"#000000 或 rgba(...)",onInput:t[65]||(t[65]=s=>{var ve,Be,De,Te,Ge,Le;const j=s.target.value.trim(),M=Q((Be=(ve=e.selectedEl)==null?void 0:ve.style)==null?void 0:Be.boxShadow);se((De=M.x)!=null?De:0,(Te=M.y)!=null?Te:0,(Ge=M.blur)!=null?Ge:0,(Le=M.spread)!=null?Le:0,j||"#000000")}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,yi)])):te("",!0)]),t[203]||(t[203]=l("p",{class:"text-[11px] text-gray-500"},"支持滑动或数字输入；颜色可选色块与 HEX 文本。",-1))])])):te("",!0),e.selectedEl&&e.selectedEl.type==="chart"?(z(),O("div",mi,[t[219]||(t[219]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"图表配置",-1)),l("div",bi,[l("button",{onClick:t[66]||(t[66]=s=>w.value="visual"),class:Ae(["px-3 py-1 rounded text-sm",w.value==="visual"?"bg-purple-600/60":"bg-gray-700"])},"可视化",2),l("button",{onClick:t[67]||(t[67]=s=>w.value="json"),class:Ae(["px-3 py-1 rounded text-sm",w.value==="json"?"bg-purple-600/60":"bg-gray-700"])},"JSON",2)]),w.value==="visual"?(z(),O("div",xi,[l("div",null,[t[205]||(t[205]=l("label",{class:"block text-xs text-gray-400 mb-1"},"图表类型",-1)),at(mt,{options:["line","bar","pie","mix"],modelValue:e.selectedEl.chartType||"line","onUpdate:modelValue":t[68]||(t[68]=s=>{e.selectedEl&&(e.selectedEl.chartType=s,e.selectedEl.chartOption=e.defaultChartOption(s),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))})},null,8,["modelValue"])]),l("div",null,[t[206]||(t[206]=l("label",{class:"block text-xs text-gray-400 mb-1"},"标题",-1)),l("input",{value:((ye=(me=(ae=e.selectedEl)==null?void 0:ae.chartOption)==null?void 0:me.title)==null?void 0:ye.text)||"",onInput:t[69]||(t[69]=s=>ee(s.target.value)),type:"text",placeholder:"输入图表标题",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,vi)]),l("div",hi,[l("div",null,[t[207]||(t[207]=l("label",{class:"block text-xs text-gray-400 mb-1"},"颜色列表（逗号分隔）",-1)),l("input",{value:((X=(re=(le=e.selectedEl)==null?void 0:le.chartOption)==null?void 0:re.color)==null?void 0:X.join(","))||"",onInput:t[70]||(t[70]=s=>J(s.target.value)),type:"text",placeholder:"#42b883,#ff9800",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,wi)]),l("div",null,[t[209]||(t[209]=l("label",{class:"block text-xs text-gray-400 mb-1"},"显示图例",-1)),l("select",{value:(h=(b=(Me=(ne=e.selectedEl)==null?void 0:ne.chartOption)==null?void 0:Me.legend)==null?void 0:b.show)==null||h?"1":"0",onChange:t[71]||(t[71]=s=>q(s.target.value)),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[208]||(t[208]=[l("option",{value:"1"},"显示",-1),l("option",{value:"0"},"隐藏",-1)])],40,$i)])]),e.selectedEl&&e.selectedEl.chartType!=="pie"?(z(),O("div",Ei,[l("div",null,[t[210]||(t[210]=l("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最小值",-1)),l("input",{value:Array.isArray((I=(U=e.selectedEl)==null?void 0:U.chartOption)==null?void 0:I.yAxis)?($=(V=(v=(Y=(G=e.selectedEl)==null?void 0:G.chartOption)==null?void 0:Y.yAxis)==null?void 0:v[0])==null?void 0:V.min)!=null?$:"":(ke=(be=(Se=(ue=e.selectedEl)==null?void 0:ue.chartOption)==null?void 0:Se.yAxis)==null?void 0:be.min)!=null?ke:"",onInput:t[72]||(t[72]=s=>{const j=s.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const M=e.selectedEl.chartOption.yAxis,ve=j===""?null:Number(j);Array.isArray(M)?(M[0]=M[0]||{},M[0].min=ve):(e.selectedEl.chartOption.yAxis=M||{},e.selectedEl.chartOption.yAxis.min=ve),C.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,ki)]),l("div",null,[t[211]||(t[211]=l("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最大值",-1)),l("input",{value:Array.isArray((Oe=(Ne=e.selectedEl)==null?void 0:Ne.chartOption)==null?void 0:Oe.yAxis)?(pt=(Qe=(dt=(lt=(ot=e.selectedEl)==null?void 0:ot.chartOption)==null?void 0:lt.yAxis)==null?void 0:dt[0])==null?void 0:Qe.max)!=null?pt:"":(Yl=(Zt=(Et=(st=e.selectedEl)==null?void 0:st.chartOption)==null?void 0:Et.yAxis)==null?void 0:Zt.max)!=null?Yl:"",onInput:t[73]||(t[73]=s=>{const j=s.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const M=e.selectedEl.chartOption.yAxis,ve=j===""?null:Number(j);Array.isArray(M)?(M[0]=M[0]||{},M[0].max=ve):(e.selectedEl.chartOption.yAxis=M||{},e.selectedEl.chartOption.yAxis.max=ve),C.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Si)])])):te("",!0),e.selectedEl&&(e.selectedEl.chartType==="line"||e.selectedEl.chartType==="mix")?(z(),O("div",Mi,[l("div",null,[t[213]||(t[213]=l("label",{class:"block text-xs text-gray-400 mb-1"},"折线平滑",-1)),l("select",{value:"1",onChange:t[74]||(t[74]=s=>{const j=s.target.value==="1";e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(M=>{M.type==="line"&&(M.smooth=j)}),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[212]||(t[212]=[l("option",{value:"1"},"平滑",-1),l("option",{value:"0"},"不平滑",-1)])],32)]),l("div",null,[t[214]||(t[214]=l("label",{class:"block text-xs text-gray-400 mb-1"},"线宽",-1)),l("input",{value:2,onInput:t[75]||(t[75]=s=>{const j=Number(s.target.value)||2;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(M=>{M.type==="line"&&(M.lineStyle=M.lineStyle||{},M.lineStyle.width=j)}),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):te("",!0),e.selectedEl&&(e.selectedEl.chartType==="bar"||e.selectedEl.chartType==="mix")?(z(),O("div",Ci,[l("div",null,[t[215]||(t[215]=l("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变起始色",-1)),l("input",{type:"color",value:"#42b883",onInput:t[76]||(t[76]=s=>{const j=s.target.value;D(j,"#0ea5e9")}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),l("div",null,[t[216]||(t[216]=l("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变结束色",-1)),l("input",{type:"color",value:"#0ea5e9",onInput:t[77]||(t[77]=s=>{const j=s.target.value;D("#42b883",j)}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),l("div",null,[t[217]||(t[217]=l("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),l("input",{value:4,onInput:t[78]||(t[78]=s=>{const j=Number(s.target.value)||0;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(M=>{M.type==="bar"&&(M.itemStyle=M.itemStyle||{},M.itemStyle.borderRadius=[j,j,0,0])}),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):te("",!0)])):(z(),O("div",Ni,[t[218]||(t[218]=l("label",{class:"block text-xs text-gray-400 mb-1"},"ECharts Option JSON",-1)),fe(l("textarea",{"onUpdate:modelValue":t[79]||(t[79]=s=>C.value=s),rows:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs font-mono"},null,512),[[we,C.value]]),l("div",Ii,[l("button",{onClick:t[80]||(t[80]=s=>c()),class:"px-3 py-1 bg-emerald-600 rounded text-sm"},"应用配置"),W.value?(z(),O("div",Ai,rt(W.value),1)):te("",!0)])]))])):te("",!0),e.selectedEl&&e.selectedEl.type==="line"?(z(),O("div",Fi,[t[227]||(t[227]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"线条设置",-1)),l("div",zi,[t[220]||(t[220]=l("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),l("div",ji,[l("input",{value:e.safeHex(((ar=(sr=e.selectedEl)==null?void 0:sr.style)==null?void 0:ar.lineColor)||""),onInput:t[81]||(t[81]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=s.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Oi),l("input",{value:(ur=(dr=(ir=e.selectedEl)==null?void 0:ir.style)==null?void 0:dr.lineColor)!=null?ur:"#ffffff",onInput:t[82]||(t[82]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=s.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,40,Bi)])]),l("div",Di,[l("div",null,[t[221]||(t[221]=l("label",{class:"block text-xs text-gray-400 mb-1"},"方向",-1)),l("div",Ti,[l("button",{onClick:t[83]||(t[83]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="horizontal")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((pr=(cr=e.selectedEl)==null?void 0:cr.style)==null?void 0:pr.lineOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),l("button",{onClick:t[84]||(t[84]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="vertical")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((fr=(gr=e.selectedEl)==null?void 0:gr.style)==null?void 0:fr.lineOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)])]),l("div",null,[t[222]||(t[222]=l("label",{class:"block text-xs text-gray-400 mb-1"},"粗细(px)",-1)),l("input",{value:(br=(mr=(yr=e.selectedEl)==null?void 0:yr.style)==null?void 0:mr.lineThickness)!=null?br:2,onInput:t[85]||(t[85]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineThickness=Number(s.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Gi)])]),l("div",Li,[l("div",null,[t[224]||(t[224]=l("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),l("select",{value:((vr=(xr=e.selectedEl)==null?void 0:xr.style)==null?void 0:vr.lineStyle)||"solid",onChange:t[86]||(t[86]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineStyle=s.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[223]||(t[223]=[l("option",{value:"solid"},"实线",-1),l("option",{value:"dashed"},"虚线",-1)])],40,Ui)]),((wr=(hr=e.selectedEl)==null?void 0:hr.style)==null?void 0:wr.lineStyle)==="dashed"?(z(),O("div",Vi,[t[225]||(t[225]=l("label",{class:"block text-xs text-gray-400 mb-1"},"虚线长度(px)",-1)),l("input",{value:(kr=(Er=($r=e.selectedEl)==null?void 0:$r.style)==null?void 0:Er.lineDashLength)!=null?kr:6,onInput:t[87]||(t[87]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashLength=Number(s.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ri)])):te("",!0)]),((Mr=(Sr=e.selectedEl)==null?void 0:Sr.style)==null?void 0:Mr.lineStyle)==="dashed"?(z(),O("div",Pi,[l("div",null,[t[226]||(t[226]=l("label",{class:"block text-xs text-gray-400 mb-1"},"虚线间距(px)",-1)),l("input",{value:(Ir=(Nr=(Cr=e.selectedEl)==null?void 0:Cr.style)==null?void 0:Nr.lineDashGap)!=null?Ir:4,onInput:t[88]||(t[88]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashGap=Number(s.target.value))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Wi)])])):te("",!0)])):te("",!0),e.selectedEl&&e.selectedEl.type==="text"?(z(),O("div",Hi,[t[261]||(t[261]=l("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"文本设置",-1)),l("div",Ji,[t[232]||(t[232]=l("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),fe(l("textarea",{"onUpdate:modelValue":t[89]||(t[89]=s=>e.selectedEl.text=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[we,e.selectedEl.text]]),l("div",qi,[t[231]||(t[231]=l("label",{class:"block text-xs text-gray-400 mb-1"},"动态值",-1)),l("div",Xi,[l("input",{type:"checkbox",checked:!!((Fr=(Ar=e.selectedEl)==null?void 0:Ar.dynamic)!=null&&Fr.enabled),onChange:t[90]||(t[90]=s=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!1,objectName:"",propertyPath:""},e.selectedEl.dynamic.enabled=s.target.checked)}),class:"rounded accent-purple-600"},null,40,Yi),t[228]||(t[228]=l("span",{class:"text-xs text-gray-400"},"启用后从数据库对象绑定",-1))]),(jr=(zr=e.selectedEl)==null?void 0:zr.dynamic)!=null&&jr.enabled?(z(),O("div",_i,[l("div",null,[t[229]||(t[229]=l("label",{class:"block text-xs text-gray-400 mb-1"},"选择对象",-1)),at(mt,{options:e.databaseObjects.map(s=>s.name),modelValue:((Br=(Or=e.selectedEl)==null?void 0:Or.dynamic)==null?void 0:Br.objectName)||"","onUpdate:modelValue":t[91]||(t[91]=s=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.objectName=String(s||""))})},null,8,["options","modelValue"])]),l("div",null,[t[230]||(t[230]=l("label",{class:"block text-xs text-gray-400 mb-1"},"属性路径",-1)),at(mt,{options:oe.value,modelValue:((Tr=(Dr=e.selectedEl)==null?void 0:Dr.dynamic)==null?void 0:Tr.propertyPath)||"","onUpdate:modelValue":t[92]||(t[92]=s=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.propertyPath=String(s||""))})},null,8,["options","modelValue"])]),l("div",Ki,"预览值: "+rt(he(e.selectedEl)),1)])):te("",!0)])]),l("div",Zi,[t[233]||(t[233]=l("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),l("div",Qi,[l("button",{onClick:t[93]||(t[93]=()=>{const s=e.selectedEl;!s||s.type!=="text"||(s.autoSize=!0)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize!==!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"自适应",2),l("button",{onClick:t[94]||(t[94]=()=>{const s=e.selectedEl;!s||s.type!=="text"||(s.autoSize=!1)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize===!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"固定尺寸",2)])]),l("div",ed,[l("div",null,[t[234]||(t[234]=l("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),at(mt,{options:e.fontSizeLibrary,modelValue:((Gr=e.selectedEl.style)==null?void 0:Gr.fontSize)||14,"onUpdate:modelValue":t[95]||(t[95]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=s)}),numeric:!0},null,8,["options","modelValue"])]),l("div",null,[t[235]||(t[235]=l("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),at(mt,{options:e.fontLibrary,modelValue:((Lr=e.selectedEl.style)==null?void 0:Lr.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[96]||(t[96]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=s)})},null,8,["options","modelValue"])])]),l("div",td,[l("div",null,[t[236]||(t[236]=l("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),at(mt,{options:e.fontWeightOptions,modelValue:((Ur=e.selectedEl.style)==null?void 0:Ur.fontWeight)||"400","onUpdate:modelValue":t[97]||(t[97]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=s)})},null,8,["options","modelValue"])]),l("div",null,[t[237]||(t[237]=l("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),at(mt,{options:e.fontStyleOptions,modelValue:((Vr=e.selectedEl.style)==null?void 0:Vr.fontStyle)||"normal","onUpdate:modelValue":t[98]||(t[98]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=s)})},null,8,["options","modelValue"])])]),l("div",ld,[l("div",null,[t[238]||(t[238]=l("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),l("input",{value:((Rr=e.selectedEl.style)==null?void 0:Rr.letterSpacing)||0,onInput:t[99]||(t[99]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(s.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,rd)]),l("div",null,[t[239]||(t[239]=l("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),l("input",{value:((Pr=e.selectedEl.style)==null?void 0:Pr.lineHeight)||1.5,onInput:t[100]||(t[100]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(s.target.value))}),type:"number",step:"0.1",min:"0.5",max:"3",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,nd)])]),l("div",od,[t[240]||(t[240]=l("label",{class:"block text-xs text-gray-400 mb-1"},"缩进",-1)),l("input",{value:((Wr=e.selectedEl.style)==null?void 0:Wr.textIndent)||"",onInput:t[101]||(t[101]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textIndent=s.target.value)}),type:"text",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"例如: 2em 或 24px"},null,40,sd)]),l("div",ad,[t[241]||(t[241]=l("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),l("div",id,[l("input",{value:(Jr=(Hr=e.selectedEl)==null?void 0:Hr.style)!=null&&Jr.textGradient?"#000000":((Xr=(qr=e.selectedEl)==null?void 0:qr.style)==null?void 0:Xr.color)||e.config.globalColor,onInput:t[102]||(t[102]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"color",disabled:!!((_r=(Yr=e.selectedEl)==null?void 0:Yr.style)!=null&&_r.textGradient),class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"},null,40,dd),l("input",{value:(Zr=(Kr=e.selectedEl)==null?void 0:Kr.style)!=null&&Zr.textGradient?"transparent":(tn=(en=(Qr=e.selectedEl)==null?void 0:Qr.style)==null?void 0:en.color)!=null?tn:e.config.globalColor,onInput:t[103]||(t[103]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"text",disabled:!!((rn=(ln=e.selectedEl)==null?void 0:ln.style)!=null&&rn.textGradient),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"#000000"},null,40,ud)]),(on=(nn=e.selectedEl)==null?void 0:nn.style)!=null&&on.textGradient?(z(),O("div",cd,"文字渐变启用时，文字颜色自动设为透明")):te("",!0)]),l("div",pd,[t[242]||(t[242]=l("label",{class:"block text-xs text-gray-400 mb-1"},"背景色",-1)),l("div",gd,[l("input",{value:e.safeHex(((an=(sn=e.selectedEl)==null?void 0:sn.style)==null?void 0:an.backgroundColor)||""),onInput:t[104]||(t[104]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=s.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,fd),l("input",{value:(cn=(un=(dn=e.selectedEl)==null?void 0:dn.style)==null?void 0:un.backgroundColor)!=null?cn:"transparent",onInput:t[105]||(t[105]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=s.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"transparent"},null,40,yd)])]),l("div",md,[t[243]||(t[243]=l("label",{class:"block text-xs text-gray-400 mb-1"},"文本对齐",-1)),l("div",bd,[l("button",{onClick:t[106]||(t[106]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((pn=e.selectedEl.style)==null?void 0:pn.textAlign)||"left")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左对齐",2),l("button",{onClick:t[107]||(t[107]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((gn=e.selectedEl.style)==null?void 0:gn.textAlign)||"left")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"居中",2),l("button",{onClick:t[108]||(t[108]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((fn=e.selectedEl.style)==null?void 0:fn.textAlign)||"left")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右对齐",2)])]),l("div",xd,[t[244]||(t[244]=l("label",{class:"block text-xs text-gray-400 mb-1"},"文本方向",-1)),l("div",vd,[l("button",{onClick:t[109]||(t[109]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="horizontal")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((mn=(yn=e.selectedEl)==null?void 0:yn.style)==null?void 0:mn.textOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),l("button",{onClick:t[110]||(t[110]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="vertical")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((xn=(bn=e.selectedEl)==null?void 0:bn.style)==null?void 0:xn.textOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)]),t[245]||(t[245]=l("p",{class:"text-[11px] text-gray-400"},"纵向使用 CSS writing-mode 展示，适合竖排文本。",-1))]),l("div",hd,[t[247]||(t[247]=l("label",{class:"block text-xs text-gray-400 mb-1"},"布局倾斜",-1)),l("div",wd,[fe(l("input",{"onUpdate:modelValue":t[111]||(t[111]=s=>e.selectedEl.style.skewAngle=s),type:"range",min:"-45",max:"45",class:"flex-1"},null,512),[[we,e.selectedEl.style.skewAngle,void 0,{number:!0}]]),fe(l("input",{"onUpdate:modelValue":t[112]||(t[112]=s=>e.selectedEl.style.skewAngle=s),type:"number",min:"-45",max:"45",class:"w-16 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.style.skewAngle,void 0,{number:!0}]])]),l("div",$d,[t[246]||(t[246]=l("label",{class:"text-xs text-gray-400"},"布局倾斜跟随",-1)),l("button",{onClick:t[113]||(t[113]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!0)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(hn=(vn=e.selectedEl)==null?void 0:vn.style)!=null&&hn.skewFlowEnabled?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"开",2),l("button",{onClick:t[114]||(t[114]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!1)}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",($n=(wn=e.selectedEl)==null?void 0:wn.style)!=null&&$n.skewFlowEnabled?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-purple-600 text-white"])},"关",2)]),t[248]||(t[248]=l("p",{class:"text-[11px] text-gray-400"},"调整整体容器的 X 轴倾斜角度（-45° ~ 45°）。启用“跟随”后，文本布局按父视图倾斜线性排布，字符保持正立，可与波形叠加。",-1))]),l("div",Ed,[l("div",kd,[t[249]||(t[249]=l("label",{class:"text-xs text-gray-400"},"文本波形",-1)),l("div",Sd,[(Sn=(kn=(En=e.selectedEl)==null?void 0:En.style)==null?void 0:kn.textWave)!=null&&Sn.enabled?(z(),O("button",{key:1,onClick:t[116]||(t[116]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!1})}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):(z(),O("button",{key:0,onClick:t[115]||(t[115]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!0,amplitude:8,frequency:.5,phase:0})}),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用"))])]),(Nn=(Cn=(Mn=e.selectedEl)==null?void 0:Mn.style)==null?void 0:Cn.textWave)!=null&&Nn.enabled?(z(),O("div",Md,[l("div",Cd,[t[250]||(t[250]=l("label",{class:"block text-xs text-gray-400 mb-1"},"幅度(px)",-1)),fe(l("input",{"onUpdate:modelValue":t[117]||(t[117]=s=>e.selectedEl.style.textWave.amplitude=s),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.style.textWave.amplitude,void 0,{number:!0}]])]),l("div",Nd,[t[251]||(t[251]=l("label",{class:"block text-xs text-gray-400 mb-1"},"频率(rad/字)",-1)),fe(l("input",{"onUpdate:modelValue":t[118]||(t[118]=s=>e.selectedEl.style.textWave.frequency=s),type:"number",step:"0.1",min:"0.1",max:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.style.textWave.frequency,void 0,{number:!0}]])]),l("div",Id,[t[252]||(t[252]=l("label",{class:"block text-xs text-gray-400 mb-1"},"相位(rad)",-1)),fe(l("input",{"onUpdate:modelValue":t[119]||(t[119]=s=>e.selectedEl.style.textWave.phase=s),type:"number",step:"0.1",min:"-100",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.style.textWave.phase,void 0,{number:!0}]])])])):te("",!0),t[253]||(t[253]=l("p",{class:"text-[11px] text-gray-400"},"每个字符沿 Y 轴按正弦位移，字符保持正立。",-1))]),l("div",Ad,[t[254]||(t[254]=l("label",{class:"block text-xs text-gray-400 mb-1"},"文本装饰",-1)),l("div",Fd,[l("button",{onClick:t[120]||(t[120]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="underline"?"none":"underline")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((In=e.selectedEl.style)==null?void 0:In.textDecoration)||"none")==="underline"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下划线",2),l("button",{onClick:t[121]||(t[121]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="line-through"?"none":"line-through")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((An=e.selectedEl.style)==null?void 0:An.textDecoration)||"none")==="line-through"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"删除线",2),l("button",{onClick:t[122]||(t[122]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration="none")}),class:Ae(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Fn=e.selectedEl.style)==null?void 0:Fn.textDecoration)||"none")==="none"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"无",2)])]),l("div",zd,[l("div",jd,[t[255]||(t[255]=l("label",{class:"text-xs text-gray-400"},"文本渐变",-1)),l("div",Od,[(zn=e.selectedEl.style)!=null&&zn.textGradient?te("",!0):(z(),O("button",{key:0,onClick:t[123]||(t[123]=s=>_(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(jn=e.selectedEl.style)!=null&&jn.textGradient?(z(),O("button",{key:1,onClick:t[124]||(t[124]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.textGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):te("",!0)])]),(On=e.selectedEl.style)!=null&&On.textGradient?(z(),O("div",Bd,[l("div",Dd,[l("div",null,[t[256]||(t[256]=l("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),l("div",Td,[fe(l("input",{"onUpdate:modelValue":t[125]||(t[125]=s=>e.selectedEl.style.textGradient.colors[0]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[we,e.selectedEl.style.textGradient.colors[0]]]),fe(l("input",{"onUpdate:modelValue":t[126]||(t[126]=s=>e.selectedEl.style.textGradient.colors[0]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#DFDD5A"},null,512),[[we,e.selectedEl.style.textGradient.colors[0]]])])]),l("div",null,[t[257]||(t[257]=l("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),l("div",Gd,[fe(l("input",{"onUpdate:modelValue":t[127]||(t[127]=s=>e.selectedEl.style.textGradient.colors[1]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[we,e.selectedEl.style.textGradient.colors[1]]]),fe(l("input",{"onUpdate:modelValue":t[128]||(t[128]=s=>e.selectedEl.style.textGradient.colors[1]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,512),[[we,e.selectedEl.style.textGradient.colors[1]]])])])]),l("div",null,[l("label",Ld,"角度: "+rt(e.selectedEl.style.textGradient.angle||0)+"°",1),fe(l("input",{"onUpdate:modelValue":t[129]||(t[129]=s=>e.selectedEl.style.textGradient.angle=s),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[we,e.selectedEl.style.textGradient.angle,void 0,{number:!0}]])])])):te("",!0)]),l("div",Ud,[l("div",Vd,[t[258]||(t[258]=l("label",{class:"text-xs text-gray-400"},"背景渐变",-1)),l("div",Rd,[(Bn=e.selectedEl.style)!=null&&Bn.backgroundGradient?te("",!0):(z(),O("button",{key:0,onClick:t[130]||(t[130]=s=>E(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(Dn=e.selectedEl.style)!=null&&Dn.backgroundGradient?(z(),O("button",{key:1,onClick:t[131]||(t[131]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.backgroundGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):te("",!0)])]),(Tn=e.selectedEl.style)!=null&&Tn.backgroundGradient?(z(),O("div",Pd,[l("div",Wd,[l("div",null,[t[259]||(t[259]=l("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),l("div",Hd,[fe(l("input",{"onUpdate:modelValue":t[132]||(t[132]=s=>e.selectedEl.style.backgroundGradient.colors[0]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[we,e.selectedEl.style.backgroundGradient.colors[0]]]),fe(l("input",{"onUpdate:modelValue":t[133]||(t[133]=s=>e.selectedEl.style.backgroundGradient.colors[0]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#00A3FF"},null,512),[[we,e.selectedEl.style.backgroundGradient.colors[0]]])])]),l("div",null,[t[260]||(t[260]=l("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),l("div",Jd,[fe(l("input",{"onUpdate:modelValue":t[134]||(t[134]=s=>e.selectedEl.style.backgroundGradient.colors[1]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[we,e.selectedEl.style.backgroundGradient.colors[1]]]),fe(l("input",{"onUpdate:modelValue":t[135]||(t[135]=s=>e.selectedEl.style.backgroundGradient.colors[1]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,512),[[we,e.selectedEl.style.backgroundGradient.colors[1]]])])])]),l("div",null,[l("label",qd,"角度: "+rt(e.selectedEl.style.backgroundGradient.angle||0)+"°",1),fe(l("input",{"onUpdate:modelValue":t[136]||(t[136]=s=>e.selectedEl.style.backgroundGradient.angle=s),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[we,e.selectedEl.style.backgroundGradient.angle,void 0,{number:!0}]])])])):te("",!0)])])):te("",!0),e.selectedEl&&e.selectedEl.type==="image"?(z(),O("div",Xd,[t[270]||(t[270]=Zl('<h3 class="text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1" data-v-4b22c81b>图片设置</h3><div class="space-y-2" data-v-4b22c81b><label class="block text-xs text-gray-400 mb-1" data-v-4b22c81b>图片来源</label><div class="grid grid-cols-2 gap-2" data-v-4b22c81b><button class="px-3 py-2 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200" data-v-4b22c81b>上传文件</button><button class="px-3 py-2 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200" data-v-4b22c81b>选择图标</button></div></div>',2)),l("div",Yd,[t[262]||(t[262]=l("label",{class:"block text-xs text-gray-400 mb-1"},"图片文件",-1)),l("input",{type:"file",onChange:Ie,accept:"image/*",class:"w-full text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-purple-600 file:text-white hover:file:bg-purple-500 file:cursor-pointer"},null,32)]),e.iconLibrary.length>0?(z(),O("div",_d,[t[263]||(t[263]=l("label",{class:"block text-xs text-gray-400 mb-1"},"选择图标",-1)),l("div",Kd,[l("div",Zd,[(z(!0),O(It,null,Rt(e.iconLibrary,s=>(z(),O("div",{key:s.id,onClick:j=>L(s),class:"aspect-square bg-gray-700/50 rounded cursor-pointer hover:bg-gray-600/50 transition-colors duration-200 flex items-center justify-center p-1 border border-transparent hover:border-green-400/50"},[l("img",{src:s.url,alt:s.name,class:"max-w-full max-h-full object-contain",loading:"lazy"},null,8,eu)],8,Qd))),128))])]),e.iconLibrary.length===0?(z(),O("div",tu,"暂无图标，请先在图标库管理中上传图标")):te("",!0)])):te("",!0),l("div",{class:"space-y-2"},[t[264]||(t[264]=l("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),l("div",{class:"grid grid-cols-2 gap-2"},[l("button",{onClick:T,class:Ae(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-blue-600/30 hover:bg-blue-600/50 text-blue-300"])},"自适应（原始尺寸）"),l("button",{onClick:K,class:Ae(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-purple-600/30 hover:bg-purple-600/50 text-purple-300"])},"固定大小")])]),l("div",lu,[l("div",null,[t[265]||(t[265]=l("label",{class:"block text-xs text-gray-400 mb-1"},"宽度(px)",-1)),fe(l("input",{"onUpdate:modelValue":t[137]||(t[137]=s=>e.selectedEl.width=s),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.width,void 0,{number:!0}]])]),l("div",null,[t[266]||(t[266]=l("label",{class:"block text-xs text-gray-400 mb-1"},"高度(px)",-1)),fe(l("input",{"onUpdate:modelValue":t[138]||(t[138]=s=>e.selectedEl.height=s),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.height,void 0,{number:!0}]])]),l("div",null,[t[268]||(t[268]=l("label",{class:"block text-xs text-gray-400 mb-1"},"对象适配",-1)),fe(l("select",{"onUpdate:modelValue":t[139]||(t[139]=s=>e.selectedEl.style.objectFit=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[267]||(t[267]=[Zl('<option value="contain" data-v-4b22c81b>contain（完整显示）</option><option value="cover" data-v-4b22c81b>cover（填充裁剪）</option><option value="fill" data-v-4b22c81b>fill（拉伸填充）</option><option value="scale-down" data-v-4b22c81b>scale-down（缩小适配）</option><option value="none" data-v-4b22c81b>none（不适配）</option>',5)])],512),[[Ln,e.selectedEl.style.objectFit]])])]),l("div",ru,[t[269]||(t[269]=l("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),fe(l("input",{"onUpdate:modelValue":t[140]||(t[140]=s=>e.selectedEl.style.borderRadius=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[we,e.selectedEl.style.borderRadius,void 0,{number:!0}]])])])):te("",!0),l("div",nu,[l("button",{onClick:t[141]||(t[141]=s=>g("saveSelectedAsComponent")),class:"w-full px-3 py-2 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"},"保存为组件"),l("button",{onClick:t[142]||(t[142]=s=>g("duplicateSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-blue-500/25"},"复制元素"),l("button",{onClick:t[143]||(t[143]=s=>g("removeSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"删除元素")])])):te("",!0),e.selectedEl?te("",!0):(z(),O("div",ou,[...t[271]||(t[271]=[l("div",{class:"w-16 h-16 mx-auto mb-4 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center"},[l("span",{class:"text-2xl"},"📝")],-1),l("p",{class:"text-sm"},"选择一个元素来编辑其属性",-1)])]))])}}}),iu=or(au,[["__scopeId","data-v-4b22c81b"]]),du={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},uu={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},cu={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},pu={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},gu={class:"flex gap-2"},fu={class:"relative"},yu={class:"grid grid-cols-2 gap-2"},mu={class:"flex items-center gap-2"},bu={class:"text-sm text-gray-400 min-w-[60px] text-center"},xu={key:0,class:"absolute inset-0 pointer-events-none z-50"},vu={key:1,class:"absolute inset-0 z-[9999] select-none pointer-events-none"},hu={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},wu={class:"relative w-[800px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-fuchsia-500/40 rounded-xl shadow-2xl"},$u={class:"p-4 space-y-3"},Eu={class:"flex items-center gap-2"},ku={key:0,class:"text-center text-sm text-gray-400 py-6"},Su={key:1},Mu={key:0,class:"text-center text-sm text-gray-400 py-6"},Cu={key:1,class:"grid grid-cols-3 gap-3"},Nu={class:"aspect-video bg-gray-700/50 flex items-center justify-center"},Iu=["src"],Au={key:1,class:"text-gray-400 text-xs"},Fu={class:"p-3 space-y-1"},zu={class:"flex items-center justify-between"},ju=["title"],Ou={class:"text-xs text-gray-500"},Bu={class:"flex flex-wrap gap-1 mt-1"},Du={class:"pt-2"},Tu=["onClick"],Gu={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},Lu={class:"relative w-[600px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl"},Uu={class:"flex items-center justify-between p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20"},Vu={class:"p-4 space-y-3 max-h-[50vh] overflow-y-auto"},Ru={key:0,class:"text-center text-sm text-gray-400 py-6"},Pu={key:1,class:"space-y-2"},Wu=["title"],Hu=["onClick"],Ju=50,qu=St({__name:"LowCodeBuilder",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(x){const n=x,e=so(),g=uo(),w=Ve(()=>{var r;return(r=n.projectId)!=null?r:e.params.id?String(e.params.id):void 0}),C=ge(null);async function W(){if(w.value)try{const r=(await he()).transaction(["projects"],"readonly").objectStore("projects").get(w.value);r.onsuccess=()=>{C.value=r.result}}catch(r){console.error("加载项目信息失败:",r)}}function oe(){if(!w.value)return;const r=n.isComponent?{path:`/project/${w.value}/preview`,query:{type:"component"}}:{path:`/project/${w.value}/preview`},o=g.resolve(r).href;window.open(o,"_blank")}async function he(){return new Promise((r,o)=>{const a="lowcode-projects",p="projects",m=indexedDB.open(a);m.onerror=()=>o(m.error),m.onupgradeneeded=()=>{const f=m.result;f.objectStoreNames.contains(p)||f.createObjectStore(p,{keyPath:"id"})},m.onsuccess=()=>{const f=m.result;if(f.objectStoreNames.contains(p))r(f);else{const A=f.version+1;f.close();const F=indexedDB.open(a,A);F.onerror=()=>o(F.error),F.onupgradeneeded=()=>{const N=F.result;N.objectStoreNames.contains(p)||N.createObjectStore(p,{keyPath:"id"})},F.onsuccess=()=>r(F.result)}}})}const k=Gn({width:1024,height:576,backgroundUrl:"",backgroundColor:"#000000",globalFontFamily:"Arial, Helvetica, sans-serif",globalFontSize:14,globalColor:"#FFFFFF"}),ce=ge("GeneratedComponent"),P=ge(["Arial, Helvetica, sans-serif","PingFang SC","Microsoft YaHei","Roboto","Inter"]),Q=ge([8,9,10,11,12,14,16,18,20,24,28,32,36,48,64]),se=ge(["100","200","300","400","500","600","700","800","900"]),_=ge(["normal","italic","oblique"]),E=ge([]),c=ge(null),D=ge([]),R=ge({}),ee=ge(null),J=ge([]),q=ge(!1),Ie=ge(!1),L=ge({id:null,steps:[],cursor:0,stage:0,active:!1}),T=ge(!1);function K(){try{const r=JSON.parse(JSON.stringify(E.value));J.value.push(r),J.value.length>Ju&&J.value.shift()}catch(r){console.warn("pushHistory 序列化失败：",r)}}function We(){J.value.length!==0&&(E.value=J.value.pop(),c.value=null,Re.value=!1)}function qe(r){var f,A,F,N,S,i,u,B,H,de,pe,ae,me,ye,le;function o(re){var ne;if(!re)return!1;const X=(ne=re.tagName)==null?void 0:ne.toLowerCase();return re.isContentEditable||!!re.closest('[contenteditable="true"]')||X==="input"||X==="textarea"||X==="select"}const a=document.activeElement;if(o(a)||o(r.target))return;const p=r.metaKey||r.ctrlKey,m=r.key.toLowerCase();if(m==="arrowleft"||m==="arrowright"||m==="arrowup"||m==="arrowdown"){if(!c.value)return;const{el:re}=Ye(c.value);if(!re)return;Ie.value||(K(),Ie.value=!0,L.value={id:c.value,steps:[],cursor:0,stage:0,active:!0},T.value=!0),d.shift=r.shiftKey,m==="arrowleft"&&(d.left=!0),m==="arrowright"&&(d.right=!0),m==="arrowup"&&(d.up=!0),m==="arrowdown"&&(d.down=!0);const X=r.shiftKey?10:1;Z(m==="arrowleft"?-X:m==="arrowright"?X:0,m==="arrowup"?-X:m==="arrowdown"?X:0),t!=null&&(clearTimeout(t),t=null),t=window.setTimeout(()=>{$e()},220),r.preventDefault();return}if(p&&m==="c"){if($t.value){try{ee.value=JSON.parse(JSON.stringify($t.value))}catch{}r.preventDefault()}}else if(p&&m==="v"){if(ee.value){const re=ee.value,X=al(re),{parentGroup:ne}=Ye(re.id);if(ne){const Me=Number((A=(f=ne.left)!=null?f:ne.x)!=null?A:0),b=Number((N=(F=ne.top)!=null?F:ne.y)!=null?N:0),h=Number((S=ne.width)!=null?S:0),U=Number((i=ne.height)!=null?i:0),I=Me+h,G=b+U,Y=Number((u=re.width)!=null?u:0),v=Number((B=re.height)!=null?B:0);let V=Y,$=v;if(!V||!$)if(re.type==="text"){const ot=Number((H=re.fontSize)!=null?H:16),lt=String((pe=(de=re.text)!=null?de:re.content)!=null?pe:"").trim();V=Math.max(Y||50,Math.round((lt.length||2)*ot*.6)),$=Math.max(v||20,Math.round(ot*1.5))}else re.type==="image"?(V=Y||200,$=v||150):re.type==="chart"?(V=Y||240,$=v||160):re.type==="line"?(V=Y||200,$=v||2):(V=Y||100,$=v||60);const ue=10,Se=Me+h/2,be=b+U/2;let ke=!1,Ne=I+ue,Oe=Math.round(be-$/2);if(!ke&&Ne+V<=k.width&&(X.left=Math.max(0,Math.min(Ne,Math.max(0,k.width-V))),X.top=Math.max(0,Math.min(Oe,Math.max(0,k.height-$))),ke=!0),Ne=Me-V-ue,Oe=Math.round(be-$/2),!ke&&Ne>=0&&(X.left=Math.max(0,Math.min(Ne,Math.max(0,k.width-V))),X.top=Math.max(0,Math.min(Oe,Math.max(0,k.height-$))),ke=!0),Ne=Math.round(Se-V/2),Oe=G+ue,!ke&&Oe+$<=k.height&&(X.left=Math.max(0,Math.min(Ne,Math.max(0,k.width-V))),X.top=Math.max(0,Math.min(Oe,Math.max(0,k.height-$))),ke=!0),Ne=Math.round(Se-V/2),Oe=b-$-ue,!ke&&Oe>=0&&(X.left=Math.max(0,Math.min(Ne,Math.max(0,k.width-V))),X.top=Math.max(0,Math.min(Oe,Math.max(0,k.height-$))),ke=!0),!ke){const ot=Number((me=(ae=re.left)!=null?ae:re.x)!=null?me:0),lt=Number((le=(ye=re.top)!=null?ye:re.y)!=null?le:0),dt=Me+ot+ue,Qe=b+lt+ue;X.left=Math.max(0,Math.min(Math.round(dt),Math.max(0,k.width-V))),X.top=Math.max(0,Math.min(Math.round(Qe),Math.max(0,k.height-$)))}X.x=X.left,X.y=X.top}K(),E.value.push(X),c.value=X.id,r.preventDefault()}}else if(m==="delete"||m==="backspace"){if(c.value){K();const{el:re,parentGroup:X}=Ye(c.value);re&&X&&Array.isArray(X.children)?X.children=X.children.filter(ne=>ne.id!==re.id):(E.value=E.value.filter(ne=>ne.id!==c.value),re&&re.type==="group"&&Qt(re.id)),c.value=null,r.preventDefault()}}else p&&m==="z"&&((()=>{var Me,b;const X=L.value,ne=[20,15,10];if(T.value&&X.id&&X.cursor>0){const{el:h}=Ye(X.id);if(h){const U=Math.min(Math.max(X.stage,0),ne.length-1),I=ne[U],G=Math.min(I,X.cursor);let Y=0,v=0;for(let V=X.cursor-G;V<X.cursor;V++){const $=X.steps[V];Y+=$.dx,v+=$.dy}h.left=Math.round(((Me=h.left)!=null?Me:0)-Y),h.top=Math.round(((b=h.top)!=null?b:0)-v),h.x=h.left,h.y=h.top,X.cursor-=G,X.stage=Math.min(X.stage+1,ne.length-1),c.value=h.id,xt();return}}We(),T.value=!1,L.value.active=!1})(),r.preventDefault())}const d=Gn({left:!1,right:!1,up:!1,down:!1,shift:!1});let ie=null,y=0,t=null;function Z(r,o){var me,ye,le,re,X,ne,Me,b;const a=c.value;if(!a)return;const{el:p,parentGroup:m}=Ye(a);if(!p)return;Ie.value&&L.value.active&&L.value.id===a&&(L.value.steps.push({dx:r,dy:o}),L.value.cursor=L.value.steps.length,T.value=!0);const f=(le=(ye=p.width)!=null?ye:(me=R.value[a])==null?void 0:me.width)!=null?le:0,A=(ne=(X=p.height)!=null?X:(re=R.value[a])==null?void 0:re.height)!=null?ne:0;let F=k.width,N=k.height;m&&m.width&&m.height&&(F=Number(m.width)||F,N=Number(m.height)||N);let S=((Me=p.left)!=null?Me:0)+r,i=((b=p.top)!=null?b:0)+o;S=Math.round(S),i=Math.round(i),S=Math.max(0,Math.min(S,F-(f||0))),i=Math.max(0,Math.min(i,N-(A||0))),p.left=S,p.top=i,p.x=p.left,p.y=p.top;const u=p.left,B=p.top,H=u+(f||0),de=B+(A||0),pe=u+(f||0)/2,ae=B+(A||0)/2;yt({left:u,top:B,right:H,bottom:de,centerX:pe,centerY:ae})}function $e(){if(ie!=null)return;y=Date.now();const r=()=>{if(!d.left&&!d.right&&!d.up&&!d.down){ie!=null&&cancelAnimationFrame(ie),ie=null,nt();return}const o=Date.now()-y,a=o>1500?8:o>800?4:o>300?2:1,p=(d.shift?10:1)*a,m=(d.left?-p:0)+(d.right?p:0),f=(d.up?-p:0)+(d.down?p:0);Z(m,f),ie=requestAnimationFrame(r)};ie=requestAnimationFrame(r)}function ze(r){const o=r.key.toLowerCase();o==="shift"&&(d.shift=!1),o==="arrowleft"&&(d.left=!1),o==="arrowright"&&(d.right=!1),o==="arrowup"&&(d.up=!1),o==="arrowdown"&&(d.down=!1),t!=null&&(clearTimeout(t),t=null),!d.left&&!d.right&&!d.up&&!d.down&&ie==null&&(Ie.value=!1,L.value.active=!1),!d.left&&!d.right&&!d.up&&!d.down&&nt()}const Re=ge(!1),Ce=ge({left:0,top:0,right:0,bottom:0,centerX:0,centerY:0});function tt(r){R.value[r.id]=r}function _e(r){return r==="pie"?{backgroundColor:"transparent",tooltip:{trigger:"item"},legend:{top:"5%",left:"center",textStyle:{color:"#fff"},show:!0},series:[{name:"分类占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#111",borderWidth:2},label:{show:!0,color:"#fff"},labelLine:{show:!0},data:[{value:1048,name:"A"},{value:735,name:"B"},{value:580,name:"C"},{value:484,name:"D"},{value:300,name:"E"}]}]}:r==="mix"?{backgroundColor:"transparent",color:["#00bcd4","#ff9800"],tooltip:{trigger:"axis"},legend:{textStyle:{color:"#fff"},show:!0},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"销量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}},{name:"均价",type:"line",smooth:!0,data:[30,40,45,50,49,60,70],lineStyle:{width:2}}]}:r==="bar"?{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"数量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}}]}:{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"趋势",type:"line",smooth:!0,data:[150,230,224,218,135,147,260],lineStyle:{width:2}}]}}function Xe(r){var re,X;const o=`${r}-${Date.now()}`,a=Nt.value,p=Ze.value||1,m=(re=a==null?void 0:a.clientWidth)!=null?re:0,f=(X=a==null?void 0:a.clientHeight)!=null?X:0,A=a?(a.scrollLeft+m/2)/p:20,F=a?(a.scrollTop+f/2)/p:20,N=r==="chart"?240:r==="image"||r==="line"?200:r==="container"?240:void 0,S=r==="chart"?160:r==="image"?150:r==="line"?2:r==="container"?160:void 0,i=Math.round(A-(N?N/2:10)),u=Math.round(F-(S?S/2:10)),B=Math.max(0,Math.min(i,Math.max(0,k.width-(N!=null?N:0)))),H=Math.max(0,Math.min(u,Math.max(0,k.height-(S!=null?S:0)))),de=(ne,Me,b,h)=>{const U=Math.max(0,Math.min(ne,Math.max(0,k.width-(b!=null?b:0)))),I=Math.max(0,Math.min(Me,Math.max(0,k.height-(h!=null?h:0))));return{cl:U,ct:I}},pe=E.value.map(ne=>{var I,G,Y,v,V,$;const Me=(I=ne.width)!=null?I:0,b=(G=ne.height)!=null?G:0,h=Number((v=(Y=ne.left)!=null?Y:ne.x)!=null?v:0),U=Number(($=(V=ne.top)!=null?V:ne.y)!=null?$:0);return{l:h,t:U,r:h+Me,b:U+b}}),ae=(ne,Me,b,h)=>{const U=ne+(b!=null?b:0),I=Me+(h!=null?h:0);for(const G of pe)if(!(b===void 0||h===void 0)&&!(U<=G.l||I<=G.t||ne>=G.r||Me>=G.b))return!0;return!1},me=24;let ye={cl:B,ct:H};if(N&&S&&ae(ye.cl,ye.ct,N,S)){let ne=!1;for(let Me=1;Me<=20&&!ne;Me++)for(const b of[[Me,0],[0,Me],[-Me,0],[0,-Me]]){const[h,U]=b,I=i+h*me,G=u+U*me,Y=de(I,G,N,S);if(!ae(Y.cl,Y.ct,N,S)){ye=Y,ne=!0;break}}}const le={id:o,type:r,left:ye.cl,top:ye.ct,autoSize:r==="text",width:N,height:S,text:r==="text"?"文字":r==="image"||r==="line"?"":"图表",className:"",zIndex:1,style:{}};if(r==="text"?Object.assign(le,{content:"文字",fontSize:16,fontWeight:"400",fontFamily:"Arial, Helvetica, sans-serif",color:"#ffffff",letterSpacing:"0px",lineHeight:"1.5",fontStyle:"normal",useGradient:!1,gradientStart:"#00A3FF",gradientEnd:"#ffffff",gradientDirection:"to right",x:ye.cl,y:ye.ct}):r==="image"&&(Object.assign(le,{src:"",borderRadius:0,x:ye.cl,y:ye.ct}),le.style={...le.style||{},objectFit:"contain"}),r==="chart"&&Object.assign(le,{elementId:`chart-${Date.now()}`,chartType:"line",chartOption:_e("line")}),r==="line"&&(le.autoSize=!1,le.style={...le.style||{},lineColor:"#ffffff",lineThickness:2,lineOrientation:"horizontal",lineStyle:"solid",lineDashLength:6,lineDashGap:4}),r==="arc-text"){le.autoSize=!1,le.text="环绕文字";const ne=60;le.width=le.width||ne*2+20,le.height=le.height||ne*2+20,le.style={...le.style||{},fontFamily:k.globalFontFamily,fontSize:Math.max(12,k.globalFontSize),color:k.globalColor,textAlign:"center",arcText:{radius:ne,startAngle:0,sweepAngle:180,clockwise:!0}}}r==="container"&&(le.autoSize=!1,le.text="",le.elementId=`container-${Date.now()}`,le.style={...le.style||{},backgroundColor:"transparent",borderRadius:"6px"}),K(),E.value.push(le),c.value=o}function ht(r){const{el:o}=Ye(r.id);o&&(q.value||(K(),q.value=!0),o.left=r.left,o.top=r.top,o.x=r.left,o.y=r.top)}function wt(r){const{el:o}=Ye(r.id);o&&(q.value||(K(),q.value=!0),o.width=r.width,o.height=r.height,r.left!==void 0&&(o.left=r.left,o.x=r.left),r.top!==void 0&&(o.top=r.top,o.y=r.top))}function At(r){c.value=r,xt()}function Ft(r){c.value=r,xt(),tr(()=>{const o=document.querySelector(`[data-el-id="${r}"]`);o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})}function zt(r,o){if(r===o||r<0||o<0||r>=E.value.length||o>=E.value.length)return;K();const[a]=E.value.splice(r,1);a&&(E.value.splice(o,0,a),c.value=a.id)}function xt(){if(Pe(),!ft.value)return;const r=c.value;if(!r)return;const o=Ke.value.find(f=>f.id===r);if(!o)return;const a=Ke.value.filter(f=>f.id!==r),p={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY};Ce.value={left:p.left,top:p.top,right:p.right,bottom:p.bottom,centerX:p.centerX,centerY:p.centerY},Fe.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1};const m=4;for(const f of a)Math.abs(p.centerX-f.centerX)<=m&&f.w>0&&(Fe.value.centerV=!0,Ce.value.centerX=f.centerX),Math.abs(p.centerY-f.centerY)<=m&&f.h>0&&(Fe.value.centerH=!0,Ce.value.centerY=f.centerY),Math.abs(p.left-f.left)<=m&&(Fe.value.left=!0,Ce.value.left=f.left),Math.abs(p.right-f.right)<=m&&f.w>0&&(Fe.value.right=!0,Ce.value.right=f.right),Math.abs(p.top-f.top)<=m&&(Fe.value.top=!0,Ce.value.top=f.top),Math.abs(p.bottom-f.bottom)<=m&&f.h>0&&(Fe.value.bottom=!0,Ce.value.bottom=f.bottom);Re.value=Object.values(Fe.value).some(Boolean)}function jt(){c.value=null,nt()}const Fe=ge({centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1}),xe=ge({left:null,right:null,up:null,down:null}),gt=ge(!0),ft=ge(!0),Ue=ge(!1),He=Ve(()=>E.value.filter(r=>r.hidden));function Je(r){const o=E.value.find(a=>a.id===r);o&&(o.hidden=!1,c.value=r,tr(()=>{const a=document.querySelector(`[data-el-id="${r}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"}),Ue.value=!1}))}const Ee=ge(null),je=ge(null),Ke=Ve(()=>{const r=[];function o(a,p,m,f){var A,F,N,S;for(const i of a){const u=R.value[i.id],B=u?u.left:(A=i.left)!=null?A:0,H=u?u.top:(F=i.top)!=null?F:0,de=u?u.width:(N=i.width)!=null?N:0,pe=u?u.height:(S=i.height)!=null?S:0,ae=p+B,me=m+H;r.push({id:i.id,left:ae,top:me,right:ae+de,bottom:me+pe,centerX:ae+de/2,centerY:me+pe/2,w:de,h:pe,type:i.type,parentId:f}),(i.type==="group"||i.type==="container")&&Array.isArray(i.children)&&o(i.children,ae,me,i.id)}}return o(E.value,0,0,null),r});function yt(r){q.value||(K(),q.value=!0),Ce.value={left:r.left,top:r.top,right:r.right,bottom:r.bottom,centerX:r.centerX,centerY:r.centerY},Fe.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},xe.value={left:null,right:null,up:null,down:null};const o=.5,a=c.value,p=Ke.value.find(u=>u.id===a),m=p?p.parentId:null,f=Ke.value.filter(u=>u.parentId===m);function A(u,B,H,de){const pe=Math.max(u,H);return Math.min(B,de)-pe}let F=null,N=null,S=null,i=null;for(const u of f)if(!(!a||u.id===a)){if(Math.abs(r.centerX-u.centerX)<=o&&u.w>0&&(Fe.value.centerV=!0,Ce.value.centerX=u.centerX),Math.abs(r.centerY-u.centerY)<=o&&u.h>0&&(Fe.value.centerH=!0,Ce.value.centerY=u.centerY),Math.abs(r.left-u.left)<=o&&(Fe.value.left=!0,Ce.value.left=u.left),Math.abs(r.right-u.right)<=o&&u.w>0&&(Fe.value.right=!0,Ce.value.right=u.right),Math.abs(r.top-u.top)<=o&&(Fe.value.top=!0,Ce.value.top=u.top),Math.abs(r.bottom-u.bottom)<=o&&u.h>0&&(Fe.value.bottom=!0,Ce.value.bottom=u.bottom),A(r.top,r.bottom,u.top,u.bottom)>0){const B=r.left-u.right;B>=0&&(!F||B<F.gap)&&(F={gap:B,m:u});const H=u.left-r.right;H>=0&&(!N||H<N.gap)&&(N={gap:H,m:u})}if(A(r.left,r.right,u.left,u.right)>0){const B=r.top-u.bottom;B>=0&&(!S||B<S.gap)&&(S={gap:B,m:u});const H=u.top-r.bottom;H>=0&&(!i||H<i.gap)&&(i={gap:H,m:u})}}if(Re.value=Object.values(Fe.value).some(Boolean),!gt.value){xe.value={left:null,right:null,up:null,down:null};return}if(F){const u=F.m,B=(Math.max(r.left,u.left)+Math.min(r.right,u.right))/2,H=(Math.max(r.top,u.top)+Math.min(r.bottom,u.bottom))/2;xe.value.left={gap:Math.floor(F.gap),exact:F.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}if(N){const u=N.m,B=(Math.max(r.left,u.left)+Math.min(r.right,u.right))/2,H=(Math.max(r.top,u.top)+Math.min(r.bottom,u.bottom))/2;xe.value.right={gap:Math.floor(N.gap),exact:N.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}if(S){const u=S.m,B=(Math.max(r.left,u.left)+Math.min(r.right,u.right))/2,H=(u.bottom+r.top)/2;xe.value.up={gap:Math.floor(S.gap),exact:S.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}if(i){const u=i.m,B=(Math.max(r.left,u.left)+Math.min(r.right,u.right))/2,H=(r.bottom+u.top)/2;xe.value.down={gap:Math.floor(i.gap),exact:i.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}ft.value||(Fe.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},Re.value=!1)}function Pe(){if(!gt.value){xe.value={left:null,right:null,up:null,down:null};return}const r=c.value;if(!r){xe.value={left:null,right:null,up:null,down:null};return}const o=Ke.value.find(u=>u.id===r);if(!o){xe.value={left:null,right:null,up:null,down:null};return}const a={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY},p=o.parentId,m=Ke.value.filter(u=>u.id!==r&&u.parentId===p);function f(u,B,H,de){const pe=Math.max(u,H);return Math.min(B,de)-pe}let A=null,F=null,N=null,S=null;for(const u of m){if(f(a.top,a.bottom,u.top,u.bottom)>0){const B=a.left-u.right;B>=0&&(!A||B<A.gap)&&(A={gap:B,m:u});const H=u.left-a.right;H>=0&&(!F||H<F.gap)&&(F={gap:H,m:u})}if(f(a.left,a.right,u.left,u.right)>0){const B=a.top-u.bottom;B>=0&&(!N||B<N.gap)&&(N={gap:B,m:u});const H=u.top-a.bottom;H>=0&&(!S||H<S.gap)&&(S={gap:H,m:u})}}const i={left:null,right:null,up:null,down:null};if(A){const u=A.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,H=(Math.max(a.top,u.top)+Math.min(a.bottom,u.bottom))/2;i.left={gap:Math.floor(A.gap),exact:A.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}if(F){const u=F.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,H=(Math.max(a.top,u.top)+Math.min(a.bottom,u.bottom))/2;i.right={gap:Math.floor(F.gap),exact:F.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}if(N){const u=N.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,H=(u.bottom+a.top)/2;i.up={gap:Math.floor(N.gap),exact:N.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}if(S){const u=S.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,H=(a.bottom+u.top)/2;i.down={gap:Math.floor(S.gap),exact:S.gap,refId:u.id,x:Math.round(B),y:Math.round(H)}}xe.value=i}function nt(){q.value=!1,ft.value&&c.value?xt():Re.value=!1,Pe()}function Ye(r){if(!r)return{el:null,parentGroup:null};const o=(a,p)=>{for(const m of a){if(m.id===r)return{el:m,parentGroup:p};if((m.type==="group"||m.type==="container")&&Array.isArray(m.children)){const f=o(m.children,m);if(f)return f}}return null};return o(E.value,null)||{el:null,parentGroup:null}}const Mt=ge(null);function Ot(r,o){if(!r.children||!Array.isArray(r.children))return!1;const a=[...r.children];for(;a.length;){const p=a.pop();if((p==null?void 0:p.id)===o.id)return!0;p!=null&&p.children&&Array.isArray(p.children)&&a.push(...p.children)}return!1}function vl(r){var B,H,de,pe;const{id:o,globalLeft:a,globalTop:p}=r;if(!o)return;const m=(B=Mt.value)==null?void 0:B.getBoundingClientRect();if(!m)return;const{el:f,parentGroup:A}=Ye(o);if(!f)return;const F=(((H=R.value[o])==null?void 0:H.width)||Number(f.width)||0)*Ze.value,N=(((de=R.value[o])==null?void 0:de.height)||Number(f.height)||0)*Ze.value,S={left:a,top:p,right:a+F,bottom:p+N};function i(){const ae=S.left+1,me=S.top+1,ye=S.right-1,le=S.bottom-1;return[{x:(S.left+S.right)/2,y:(S.top+S.bottom)/2},{x:ae,y:me},{x:ye,y:me},{x:ae,y:le},{x:ye,y:le}]}let u=null;for(const ae of i()){const me=document.elementsFromPoint(ae.x,ae.y);for(const ye of me){const le=(pe=ye.closest("[data-box-id]"))==null?void 0:pe.getAttribute("data-box-id");if(!le||le===o)continue;const{el:re}=Ye(le);if(re&&!(re.type!=="container"&&re.type!=="group")&&re.id!==f.id&&!Ot(f,re)){u=le;break}}if(u)break}if(A?Array.isArray(A.children)&&(A.children=A.children.filter(ae=>ae.id!==o)):E.value=E.value.filter(ae=>ae.id!==o),u){const{el:ae}=Ye(u);if(ae){const me=document.querySelector(`[data-box-id="${u}"]`);if(me){const ye=me.getBoundingClientRect(),le=(a-ye.left)/Ze.value,re=(p-ye.top)/Ze.value;f.left=Math.round(le),f.top=Math.round(re),f.x=f.left,f.y=f.top,ae.children||(ae.children=[]),ae.children.push(f)}}}else{const ae=(a-m.left)/Ze.value,me=(p-m.top)/Ze.value;f.left=Math.round(ae),f.top=Math.round(me),f.x=f.left,f.y=f.top,E.value.push(f)}K(),tr(()=>{c.value=o})}function Bt(r){const o=xe.value[r];o&&(Ee.value=r,je.value=o.gap)}function Dt(){var F,N,S,i,u;if(!Ee.value||je.value==null){Ee.value=null,je.value=null;return}const r=Ee.value,o=xe.value[r];if(!o){Ee.value=null,je.value=null;return}const a=Ke.value.find(B=>B.id===o.refId),p=je.value,m=$t.value;if(!a||!m){Ee.value=null,je.value=null;return}K();const f=(F=o.exact)!=null?F:o.gap,A=p-f;r==="left"?m.left=Math.round(((N=m.left)!=null?N:0)+A):r==="right"?m.left=Math.round(((S=m.left)!=null?S:0)-A):r==="up"?m.top=Math.round(((i=m.top)!=null?i:0)+A):r==="down"&&(m.top=Math.round(((u=m.top)!=null?u:0)-A)),Ee.value=null,je.value=null,Pe()}bt(c,()=>{q.value||Pe()}),bt(R,()=>{q.value||Pe()},{deep:!0}),bt(gt,r=>{r?Pe():(Ee.value=null,je.value=null,xe.value={left:null,right:null,up:null,down:null})}),bt(ft,r=>{r?xt():(Fe.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},Re.value=!1)});const $t=Ve(()=>c.value?Ye(c.value).el:null);async function hl(){return new Promise((r,o)=>{const a=indexedDB.open("lowcode-db",1);a.onupgradeneeded=()=>{const p=a.result;if(!p.objectStoreNames.contains("objects")){const m=p.createObjectStore("objects",{keyPath:"id"});try{m.createIndex("projectId","projectId",{unique:!1}),m.createIndex("name","name",{unique:!1})}catch{}}},a.onsuccess=()=>r(a.result),a.onerror=()=>o(a.error)})}async function wl(){try{const r=(await hl()).transaction(["objects"],"readonly").objectStore("objects").getAll();r.onsuccess=()=>{D.value=(r.result||[]).filter(o=>!o.projectId||o.projectId===(n.projectId||void 0))},r.onerror=()=>{console.warn("loadDatabaseObjects error",r.error)}}catch(r){console.warn("openDatabaseDB error",r)}}const $l=Ve(()=>{const r={};for(const o of D.value)o&&o.name&&(r[o.name]=o.content);return r}),Ct=ge({}),Tt=Ve(()=>{const r={...$l.value};for(const o in Ct.value)Object.assign(r,Ct.value[o]);return r});function El(r,o){const a={};for(const p of o)p&&p.name&&(a[p.name]=p.content);Ct.value[r]=a}function Qt(r){Ct.value[r]&&delete Ct.value[r];const o=`component-fonts-${r}`,a=document.getElementById(o);a&&a.parentNode&&a.parentNode.removeChild(a)}function kl(r,o="#000000"){try{const a=String(r||"").trim();return/^#([0-9a-fA-F]{6})$/.test(a)?a:o}catch{return o}}function Sl(){if(!c.value)return;K();const{el:r,parentGroup:o}=Ye(c.value);r&&o&&Array.isArray(o.children)?o.children=o.children.filter(a=>a.id!==r.id):(E.value=E.value.filter(a=>a.id!==c.value),r&&r.type==="group"&&Qt(r.id)),c.value=null}function el(r){(!r.className||!r.className.trim())&&(r.className=`cls-${String(r.id).slice(0,8)}`)}function Ml(r){try{el(r);const o=String(r.className||"").trim();String(r.customClassCss||"").trim()||(r.customClassCss=`.${o} {
  
}`)}catch{}}function Cl(r){const o=String(r||"").trim();return o?o.split(";").map(a=>{const p=a.trim();return p?/!important\s*$/.test(p)?p+";":p+" !important;":""}).filter(Boolean).join(`
`):""}function Nl(r){return String(r||"").replace(/\{([^}]*)\}/g,(o,a)=>`{
`+String(a||"").split(";").map(p=>{const m=p.trim();return m?m.startsWith("@")||!/:/.test(m)||/!important\s*$/.test(m)?m+";":m+" !important;":""}).filter(Boolean).join(`
`)+`
}`)}function Il(r){try{if(!r.enableClassStyle)return;el(r);const o=String(r.customClassCss||"").trim();if(!o)return;const a=`custom-class-${r.id}`;let p=document.getElementById(a);if(p||(p=document.createElement("style"),p.id=a,document.head.appendChild(p)),/{[^}]*}/.test(o)){p.textContent=Nl(o);return}const m=Cl(o);p.textContent=`.${String(r.className).trim()} {
${m}
}`}catch(o){console.warn("注入自定义类样式失败：",o)}}function tl(r){try{const o=`custom-class-${r}`,a=document.getElementById(o);a&&a.remove()}catch{}}function ll(r,o){for(const a of r)o(a),(a.type==="group"||a.type==="container")&&Array.isArray(a.children)&&ll(a.children,o)}let Pt=null;function Wt(){Pt&&clearTimeout(Pt),Pt=setTimeout(()=>{try{ll(E.value,r=>{r.enableClassStyle&&r.customClassCss&&r.className?Il(r):tl(r.id)})}catch(r){console.warn("刷新自定义类样式失败：",r)}},50)}async function Al(){var r,o,a,p,m,f,A,F,N,S;try{const i=$t.value;if(!i){alert("请先选中要保存的元素或分组");return}const u=ce.value||(i.type==="group"?"分组组件":"元素组件"),B=prompt("请输入组件名称",u);if(B===null)return;const H=(B||u).trim()||"未命名组件";let de=[];if(i.type==="group"&&Array.isArray(i.children)){const b=Number((o=(r=i.left)!=null?r:i.x)!=null?o:0),h=Number((p=(a=i.top)!=null?a:i.y)!=null?p:0);de=i.children.map(U=>{var ue,Se,be,ke,Ne,Oe;const I=JSON.parse(JSON.stringify(U)),G=Number((Se=(ue=I.left)!=null?ue:I.x)!=null?Se:0),Y=Number((ke=(be=I.top)!=null?be:I.y)!=null?ke:0);I.left=b+G,I.top=h+Y,I.x=I.left,I.y=I.top;const v=R.value[U.id],V=Number(I.width||0),$=Number(I.height||0);if(!(V>0)){const ot=(()=>{var lt,dt,Qe,pt,st;if(I.type==="text"){const Et=Number((lt=I.fontSize)!=null?lt:16),Zt=String((dt=I.text)!=null?dt:"").trim();return Math.max(50,Math.round((Zt.length||2)*Et*.6))}if(I.type==="image")return 100;if(I.type==="chart")return 240;if(I.type==="line"){const Et=Number((pt=(Qe=I.style)==null?void 0:Qe.lineThickness)!=null?pt:2);return(((st=I.style)==null?void 0:st.lineOrientation)||"horizontal")==="vertical"?Et:100}return 50})();I.width=Math.max(1,Math.round((Ne=v==null?void 0:v.width)!=null?Ne:ot))}if(!($>0)){const ot=(()=>{var lt,dt,Qe,pt;if(I.type==="text"){const st=Number((lt=I.fontSize)!=null?lt:16);return Math.max(20,Math.round(st*1.5))}if(I.type==="image")return 100;if(I.type==="chart")return 160;if(I.type==="line"){const st=Number((Qe=(dt=I.style)==null?void 0:dt.lineThickness)!=null?Qe:2);return(((pt=I.style)==null?void 0:pt.lineOrientation)||"horizontal")==="vertical"?100:st}return 20})();I.height=Math.max(1,Math.round((Oe=v==null?void 0:v.height)!=null?Oe:ot))}return I.id=`${I.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,I})}else{const b=JSON.parse(JSON.stringify(i)),h=Number((f=(m=b.left)!=null?m:b.x)!=null?f:0),U=Number((F=(A=b.top)!=null?A:b.y)!=null?F:0);b.left=h,b.top=U,b.x=b.left,b.y=b.top;const I=R.value[i.id],G=Number(b.width||0),Y=Number(b.height||0);if(!(G>0)){const v=(()=>{var V,$,ue,Se,be;if(b.type==="text"){const ke=Number((V=b.fontSize)!=null?V:16),Ne=String(($=b.text)!=null?$:"").trim();return Math.max(50,Math.round((Ne.length||2)*ke*.6))}if(b.type==="image")return 100;if(b.type==="chart")return 240;if(b.type==="line"){const ke=Number((Se=(ue=b.style)==null?void 0:ue.lineThickness)!=null?Se:2);return(((be=b.style)==null?void 0:be.lineOrientation)||"horizontal")==="vertical"?ke:100}return 50})();b.width=Math.max(1,Math.round((N=I==null?void 0:I.width)!=null?N:v))}if(!(Y>0)){const v=(()=>{var V,$,ue,Se;if(b.type==="text"){const be=Number((V=b.fontSize)!=null?V:16);return Math.max(20,Math.round(be*1.5))}if(b.type==="image")return 100;if(b.type==="chart")return 160;if(b.type==="line"){const be=Number((ue=($=b.style)==null?void 0:$.lineThickness)!=null?ue:2);return(((Se=b.style)==null?void 0:Se.lineOrientation)||"horizontal")==="vertical"?100:be}return 20})();b.height=Math.max(1,Math.round((S=I==null?void 0:I.height)!=null?S:v))}b.id=`${b.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,de=[b]}const pe=Math.min(...de.map(b=>{var h,U;return Number((U=(h=b.left)!=null?h:b.x)!=null?U:0)})),ae=Math.min(...de.map(b=>{var h,U;return Number((U=(h=b.top)!=null?h:b.y)!=null?U:0)})),me=Math.max(...de.map(b=>{var h,U,I;return Number((U=(h=b.left)!=null?h:b.x)!=null?U:0)+Number((I=b.width)!=null?I:0)})),ye=Math.max(...de.map(b=>{var h,U,I;return Number((U=(h=b.top)!=null?h:b.y)!=null?U:0)+Number((I=b.height)!=null?I:0)})),le=Math.max(1,Math.round(me-pe)),re=Math.max(1,Math.round(ye-ae));de=de.map(b=>{var G,Y,v,V;const h=JSON.parse(JSON.stringify(b)),U=Number((Y=(G=h.left)!=null?G:h.x)!=null?Y:0)-pe,I=Number((V=(v=h.top)!=null?v:h.y)!=null?V:0)-ae;return h.left=Math.max(0,Math.round(U)),h.top=Math.max(0,Math.round(I)),h.x=h.left,h.y=h.top,h});const X={width:le,height:re,backgroundUrl:"",backgroundColor:"transparent",globalFontFamily:k.globalFontFamily,globalFontSize:k.globalFontSize,globalColor:k.globalColor},ne=`${Date.now()}${Math.random().toString(36).slice(2,9)}`,Me={id:ne,name:H,description:"",tags:[],elements:de,config:X,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await et.init(),await et.saveComponent(JSON.parse(JSON.stringify(Me))),await Yt(`component-${ne}`,{config:X,elements:de,exportName:H}),alert("组件已保存到组件库")}catch(i){console.warn("保存组件失败：",i),alert("保存组件失败，请稍后重试")}}const Fl=ge(null);function zl(r){var p;const o=(p=r.target.files)==null?void 0:p[0];if(!o)return;const a=new FileReader;a.onload=()=>{const m=String(a.result);k.backgroundUrl=m;const f=new Image;f.onload=()=>{Fl.value={width:f.naturalWidth,height:f.naturalHeight},k.width=f.naturalWidth,k.height=f.naturalHeight},f.src=m},a.readAsDataURL(o)}function Gt(r){var o;return r&&((o=r.split(",")[0])!=null?o:"").trim().replace(/^['"]|['"]$/g,"")||null}function vt(r){return{"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","image/avif":"avif","image/apng":"apng","image/x-icon":"ico","image/vnd.microsoft.icon":"ico","font/ttf":"ttf","font/otf":"otf","font/woff":"woff","font/woff2":"woff2","application/font-ttf":"ttf","application/font-otf":"otf","application/font-woff":"woff","application/font-woff2":"woff2","application/x-font-ttf":"ttf","application/x-font-otf":"otf","application/x-font-woff":"woff","application/x-font-woff2":"woff2","application/vnd.ms-fontobject":"eot","application/octet-stream":"bin"}[r]||"bin"}function rl(r){var p;const o=/\.([A-Za-z0-9]+)$/.exec(r||"");if(!o)return null;const a=((p=o[1])!=null?p:"").toLowerCase();return a?["png","jpg","jpeg","gif","svg","webp","avif","apng","ico"].includes(a)?a==="jpeg"?"jpg":a:["ttf","otf","woff","woff2","eot"].includes(a)?a:null:null}async function Lt(r){try{const o="lowcode-icons",a="icons",p=await new Promise((m,f)=>{const A=indexedDB.open(o);A.onsuccess=()=>{const F=A.result;if(F.objectStoreNames.contains(a))m(F);else{const N=F.version+1;F.close();const S=indexedDB.open(o,N);S.onupgradeneeded=()=>{const i=S.result;i.objectStoreNames.contains(a)||i.createObjectStore(a,{keyPath:"id"})},S.onsuccess=()=>m(S.result),S.onerror=()=>f(S.error)}},A.onerror=()=>f(A.error)});return await new Promise((m,f)=>{const A=p.transaction(a,"readonly").objectStore(a).get(r);A.onsuccess=()=>m(A.result||null),A.onerror=()=>f(A.error)})}catch{return null}}function nl(r){var o,a,p,m,f,A,F,N;try{const S=new Uint8Array(r),i=String.fromCharCode((o=S[0])!=null?o:0,(a=S[1])!=null?a:0,(p=S[2])!=null?p:0,(m=S[3])!=null?m:0);return i==="wOFF"?"woff":i==="wOF2"?"woff2":i==="OTTO"?"otf":(((f=S[0])!=null?f:0)===0&&((A=S[1])!=null?A:0)===1&&((F=S[2])!=null?F:0)===0&&((N=S[3])!=null?N:0)===0||i==="true"||i==="typ1","ttf")}catch{return"ttf"}}async function jl(r){const o=prompt("请输入导出名称",ce.value||"GeneratedComponent");if(o===null)return;const a=o.trim()||"GeneratedComponent";ce.value=a;function p(b){const h=new Set,U={};function I(Y){let v=Date.now(),V=`${Y}-${v}`;for(;h.has(V);)v+=1,V=`${Y}-${v}`;return V}function G(Y){const v=JSON.parse(JSON.stringify(Y)),V=String(v.id);let $=V;return h.has($)&&($=I(String(v.type||"el"))),h.add($),U[V]=$,v.id=$,(v.type==="group"||v.type==="container")&&Array.isArray(v.children)&&(v.children=v.children.map(ue=>G(ue))),v}return{normalized:b.map(Y=>G(Y)),remap:U}}const{normalized:m}=p(E.value),f=[],A=b=>{for(const h of b)(h.type==="group"||h.type==="container")&&Array.isArray(h.children)?A(h.children):h.type==="image"&&(h.src||h.iconId)&&f.push(h)};A(m);const F={},N=new Map;let S=0;for(const b of f)try{let h;if(b.src)h=await(await fetch(String(b.src))).blob();else if(b.iconId){const v=b.iconId,V=await Lt(v);if(!V)throw new Error("icon record missing: "+v);h=new Blob([V.buffer],{type:String(V.mime||"image/png")})}else continue;let U=vt(h.type);if(U==="bin"&&b.iconId){const v=b.iconId,V=await Lt(v);if(V){const $=vt(String(V.mime||"")),ue=rl(String(V.originalName||""));U=$!=="bin"?$:ue||U}U==="bin"&&(U="png")}const I=await h.arrayBuffer(),G=await crypto.subtle.digest("SHA-256",I),Y=Array.from(new Uint8Array(G)).map(v=>v.toString(16).padStart(2,"0")).join("");if(N.has(Y)){const{fileName:v}=N.get(Y);F[b.id]=v}else{const v=`${a}_img_${S}.${U}`;N.set(Y,{fileName:v,blob:h}),S++,F[b.id]=v}}catch(h){console.warn("导出图片失败：",h)}const i=Array.from(N.values());let u=null,B=null;if(k.backgroundUrl)try{const b=await(await fetch(String(k.backgroundUrl))).blob(),h=vt(b.type);u=`${a}_bg.${h}`,B=b}catch(b){console.warn("导出背景图片失败：",b)}const H=new Set,de=Gt(k.globalFontFamily);de&&H.add(de);const pe=b=>{var h;for(const U of b)if((U.type==="group"||U.type==="container")&&Array.isArray(U.children))pe(U.children);else if(U.type==="text"){const I=Gt((h=U.style)==null?void 0:h.fontFamily);I&&H.add(I)}};pe(E.value);const ae=[],me=[];if(H.size>0)try{const b="lowcode-fonts",h="fonts",U=await new Promise((v,V)=>{const $=indexedDB.open(b);$.onsuccess=()=>{const ue=$.result;if(ue.objectStoreNames.contains(h))v(ue);else{const Se=ue.version+1;ue.close();const be=indexedDB.open(b,Se);be.onupgradeneeded=()=>{const ke=be.result;ke.objectStoreNames.contains(h)||ke.createObjectStore(h,{keyPath:"id"})},be.onsuccess=()=>v(be.result),be.onerror=()=>V(be.error)}},$.onerror=()=>V($.error)}),I=await new Promise((v,V)=>{const $=U.transaction(h,"readonly").objectStore(h).getAll();$.onsuccess=()=>v($.result),$.onerror=()=>V($.error)}),G=w.value,Y=G?I.filter(v=>v.projectId===G):I.filter(v=>!v.projectId);for(const v of Y)if(H.has(v.name)){const V=new Blob([v.buffer],{type:v.mime});let $=vt(v.mime);if($==="bin")try{$=nl(v.buffer)}catch{$="ttf"}const ue=v.name.replace(/[^A-Za-z0-9_\-]/g,"_"),Se=`${a}_${ue}.${$}`;ae.push({family:v.name,file:Se}),me.push({file:Se,blob:V})}}catch(b){console.warn("读取字体库失败：",b)}const ye=new Jn.default,le=ye.folder(a),re=le.folder("imgs");for(const b of i)re.file(b.fileName,b.blob);B&&u&&re.file(u,B);const X=le.folder("fonts");for(const b of me)X.file(b.file,b.blob);let ne="";r==="vue2"?(ne=Un(a,k,m,{imageFileNames:i.map(b=>b.fileName),imageFileMap:F,backgroundFileName:B&&u?u:null,fontFaces:ae,hideDirective:"if"},Tt.value),le.file("index.vue",ne)):r==="vue3"?(ne=Vn(a,k,m,{imageFileNames:i.map(b=>b.fileName),imageFileMap:F,backgroundFileName:B&&u?u:null,fontFaces:ae,hideDirective:"if"}),le.file("index.vue",ne)):r==="react"?(ne=Wn(a,k,m,{imageFileNames:i.map(b=>b.fileName),imageFileMap:F,backgroundFileName:B&&u?u:null,fontFaces:ae}),le.file("index.jsx",ne),le.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。")):(ne=Rn(a,k,m,{imageFileNames:i.map(b=>b.fileName),imageFileMap:F,backgroundFileName:B&&u?u:null,fontFaces:ae}),le.file("index.html",ne));const Me=await ye.generateAsync({type:"blob"});(0,Hn.saveAs)(Me,`${a}.zip`)}async function Ol(){const r=prompt("请输入导出名称",ce.value||"GeneratedComponent");if(r===null)return;const o=r.trim()||"GeneratedComponent";ce.value=o;const a=[],p=b=>{for(const h of b)(h.type==="group"||h.type==="container")&&Array.isArray(h.children)?p(h.children):h.type==="image"&&h.src&&a.push(h)};p(E.value);const m={},f=new Map;let A=0;for(const b of a)try{let h;if(b.src)h=await(await fetch(String(b.src))).blob();else if(b.iconId){const v=b.iconId,V=await Lt(v);if(!V)throw new Error("icon record missing: "+v);h=new Blob([V.buffer],{type:String(V.mime||"image/png")})}else continue;let U=vt(h.type);if(U==="bin"&&b.iconId){const v=b.iconId,V=await Lt(v);if(V){const $=vt(String(V.mime||"")),ue=rl(String(V.originalName||""));U=$!=="bin"?$:ue||U}U==="bin"&&(U="png")}const I=await h.arrayBuffer(),G=await crypto.subtle.digest("SHA-256",I),Y=Array.from(new Uint8Array(G)).map(v=>v.toString(16).padStart(2,"0")).join("");if(f.has(Y)){const{fileName:v}=f.get(Y);m[b.id]=v}else{const v=`${o}_img_${A}.${U}`;f.set(Y,{fileName:v,blob:h}),A++,m[b.id]=v}}catch(h){console.warn("导出图片失败：",h)}const F=Array.from(f.values());let N=null,S=null;if(k.backgroundUrl)try{const b=await(await fetch(String(k.backgroundUrl))).blob(),h=vt(b.type);N=`${o}_bg.${h}`,S=b}catch(b){console.warn("导出背景图片失败：",b)}const i=new Set,u=Gt(k.globalFontFamily);u&&i.add(u);const B=b=>{var h;for(const U of b)if((U.type==="group"||U.type==="container")&&Array.isArray(U.children))B(U.children);else if(U.type==="text"){const I=Gt((h=U.style)==null?void 0:h.fontFamily);I&&i.add(I)}};B(E.value);const H=[],de=[];if(i.size>0)try{const b="lowcode-fonts",h="fonts",U=await new Promise((v,V)=>{const $=indexedDB.open(b);$.onsuccess=()=>{const ue=$.result;if(ue.objectStoreNames.contains(h))v(ue);else{const Se=ue.version+1;ue.close();const be=indexedDB.open(b,Se);be.onupgradeneeded=()=>{const ke=be.result;ke.objectStoreNames.contains(h)||ke.createObjectStore(h,{keyPath:"id"})},be.onsuccess=()=>v(be.result),be.onerror=()=>V(be.error)}},$.onerror=()=>V($.error)}),I=await new Promise((v,V)=>{const $=U.transaction(h,"readonly").objectStore(h).getAll();$.onsuccess=()=>v($.result),$.onerror=()=>V($.error)}),G=w.value,Y=G?I.filter(v=>v.projectId===G):I.filter(v=>!v.projectId);for(const v of Y)if(i.has(v.name)){const V=new Blob([v.buffer],{type:v.mime});let $=vt(v.mime);if($==="bin")try{$=nl(v.buffer)}catch{$="ttf"}const ue=v.name.replace(/[^A-Za-z0-9_\-]/g,"_"),Se=`${o}_${ue}.${$}`;H.push({family:v.name,file:Se}),de.push({file:Se,blob:V})}}catch(b){console.warn("读取字体库失败：",b)}const pe=new Jn.default,ae=pe.folder(`${o}_all`),me=[],ye={imageFileNames:F.map(b=>b.fileName),imageFileMap:m,backgroundFileName:S&&N?N:null,fontFaces:H,hideDirective:"if"},le=Un(o,k,E.value,ye,Tt.value);me.push({key:"vue2",file:"index.vue",content:le});const re=Vn(o,k,E.value,ye);me.push({key:"vue3",file:"index.vue",content:re});const X=Wn(o,k,E.value,ye);me.push({key:"react",file:"index.jsx",content:X});const ne=Rn(o,k,E.value,ye);me.push({key:"html",file:"index.html",content:ne});for(const b of me){const h=ae.folder(b.key);h.file(b.file,b.content),b.key==="react"&&h.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。");const U=h.folder("imgs");for(const G of F)U.file(G.fileName,G.blob);S&&N&&U.file(N,S);const I=h.folder("fonts");for(const G of de)I.file(G.file,G.blob)}const Me=await pe.generateAsync({type:"blob"});(0,Hn.saveAs)(Me,`${o}-all.zip`)}function Bl(){confirm("确认清空当前画布与元素吗？")&&(E.value=[],c.value=null)}const Ze=ge(1),Nt=ge(null);function Dl(){Ze.value=Math.min(2,+(Ze.value+.1).toFixed(2))}function Tl(){Ze.value=Math.max(.2,+(Ze.value-.1).toFixed(2))}function ol(){const r=Nt.value;if(!r)return;const o=r.clientWidth-16,a=r.clientHeight-16,p=o/k.width,m=a/k.height;Ze.value=+Math.max(.2,Math.min(2,Math.min(p,m))).toFixed(2)}rr(async()=>{ol(),await wl()});const sl=ge([]);function al(r){const o=JSON.parse(JSON.stringify(r));let a=Date.now();function p(f){return a+=1,`${f}-${a}`}function m(f){f.id=p(String(f.type||"el")),(f.type==="chart"||f.type==="container")&&f.elementId&&(f.elementId=String(f.elementId)+"_"+String(a%1e3)),(f.type==="group"||f.type==="container")&&Array.isArray(f.children)&&f.children.forEach(A=>m(A))}return m(o),o.left=(r.left||0)+10,o.top=(r.top||0)+10,o.x=o.left,o.y=o.top,o.zIndex=(r.zIndex||1)+1,o}function Gl(){var m,f,A,F,N,S,i,u,B,H,de,pe,ae,me,ye;if(!$t.value)return;let r=$t.value;const o=Ye(r.id);o.parentGroup&&(r=o.parentGroup);const a=al(r),{parentGroup:p}=Ye(r.id);if(p){const le=Number((f=(m=p.left)!=null?m:p.x)!=null?f:0),re=Number((F=(A=p.top)!=null?A:p.y)!=null?F:0),X=Number((N=p.width)!=null?N:0),ne=Number((S=p.height)!=null?S:0),Me=le+X,b=re+ne,h=Number((i=r.width)!=null?i:0),U=Number((u=r.height)!=null?u:0);let I=h,G=U;if(!I||!G)if(r.type==="text"){const be=Number((B=r.fontSize)!=null?B:16),ke=String((de=(H=r.text)!=null?H:r.content)!=null?de:"").trim();I=Math.max(h||50,Math.round((ke.length||2)*be*.6)),G=Math.max(U||20,Math.round(be*1.5))}else r.type==="image"?(I=h||200,G=U||150):r.type==="chart"?(I=h||240,G=U||160):r.type==="line"?(I=h||200,G=U||2):(I=h||100,G=U||60);const Y=10,v=le+X/2,V=re+ne/2;let $=!1,ue=Me+Y,Se=Math.round(V-G/2);if(!$&&ue+I<=k.width&&(a.left=Math.max(0,Math.min(ue,Math.max(0,k.width-I))),a.top=Math.max(0,Math.min(Se,Math.max(0,k.height-G))),$=!0),ue=le-I-Y,Se=Math.round(V-G/2),!$&&ue>=0&&(a.left=Math.max(0,Math.min(ue,Math.max(0,k.width-I))),a.top=Math.max(0,Math.min(Se,Math.max(0,k.height-G))),$=!0),ue=Math.round(v-I/2),Se=b+Y,!$&&Se+G<=k.height&&(a.left=Math.max(0,Math.min(ue,Math.max(0,k.width-I))),a.top=Math.max(0,Math.min(Se,Math.max(0,k.height-G))),$=!0),ue=Math.round(v-I/2),Se=re-G-Y,!$&&Se>=0&&(a.left=Math.max(0,Math.min(ue,Math.max(0,k.width-I))),a.top=Math.max(0,Math.min(Se,Math.max(0,k.height-G))),$=!0),!$){const be=Number((ae=(pe=r.left)!=null?pe:r.x)!=null?ae:0),ke=Number((ye=(me=r.top)!=null?me:r.y)!=null?ye:0),Ne=le+be+Y,Oe=re+ke+Y;a.left=Math.max(0,Math.min(Math.round(Ne),Math.max(0,k.width-I))),a.top=Math.max(0,Math.min(Math.round(Oe),Math.max(0,k.height-G)))}a.x=a.left,a.y=a.top}K(),E.value.push(a),c.value=a.id}const Ut=ge(!1),Ht=ge([]),Jt=ge(""),qt=ge(!1),il=Ve(()=>{const r=Jt.value.trim().toLowerCase();return r?Ht.value.filter(o=>o.name.toLowerCase().includes(r)||(o.description||"").toLowerCase().includes(r)||Array.isArray(o.tags)&&o.tags.some(a=>a.toLowerCase().includes(r))):Ht.value});async function dl(){try{qt.value=!0,await et.init(),Ht.value=(await et.getAllComponents()||[]).sort((r,o)=>(o.updatedAt||0)-(r.updatedAt||0))}catch(r){console.warn("加载组件缓存失败：",r)}finally{qt.value=!1}}async function Ll(){await dl(),Ut.value=!0}function ul(){Ut.value=!1}const ct=ge(!1);let it=null;function Ul(){ct.value=!0,it&&(clearTimeout(it),it=null)}function Vl(){it&&clearTimeout(it),it=setTimeout(()=>{ct.value=!1,it=null},120)}function Rl(){ct.value=!0,it&&(clearTimeout(it),it=null)}function Pl(){ct.value=!1,it&&(clearTimeout(it),it=null)}function Wl(r){const o=[],a=[],p=[],m=[];function f(i){var H,de,pe,ae,me;const u=Number(i.width||0),B=Number(i.height||0);if(u>0&&B>0)return{w:u,h:B};if(i.type==="text"){const ye=Number((H=i.fontSize)!=null?H:16),le=String((de=i.text)!=null?de:"").trim(),re=Math.max(50,Math.round((le.length||2)*ye*.6)),X=Math.max(20,Math.round(ye*1.5));return{w:u||re,h:B||X}}if(i.type==="image")return{w:u||100,h:B||100};if(i.type==="chart")return{w:u||240,h:B||160};if(i.type==="line"){const ye=Number((ae=(pe=i.style)==null?void 0:pe.lineThickness)!=null?ae:2);return(((me=i.style)==null?void 0:me.lineOrientation)||"horizontal")==="vertical"?{w:u||ye,h:B||100}:{w:u||100,h:B||ye}}return{w:u||50,h:B||20}}for(const i of r){const u=Number(i.left||i.x||0),B=Number(i.top||i.y||0),{w:H,h:de}=f(i);o.push(u),a.push(B),p.push(u+(H||0)),m.push(B+(de||0))}const A=o.length?Math.min(...o):0,F=a.length?Math.min(...a):0,N=p.length?Math.max(...p):A,S=m.length?Math.max(...m):F;return{minX:A,minY:F,maxX:N,maxY:S,width:Math.max(0,N-A),height:Math.max(0,S-F)}}async function Hl(r){var o,a,p,m,f,A,F,N,S,i;try{const u=await pl(`component-${r.id}`),B=JSON.parse(JSON.stringify((u==null?void 0:u.elements)||r.elements||[]));if(!B||B.length===0){console.warn("该组件没有可插入的元素");return}let H=Date.now();const de=G=>{G.id=`${G.type||"el"}-${H++}-${Math.random().toString(36).slice(2,8)}`,(G.type==="chart"||G.type==="container")&&G.elementId&&(G.elementId=String(G.elementId)+"_"+String(H%1e3)),(G.type==="group"||G.type==="container")&&Array.isArray(G.children)&&G.children.forEach(Y=>de(Y))},pe=Nt.value,ae=Ze.value||1,me=(o=pe==null?void 0:pe.clientWidth)!=null?o:0,ye=(a=pe==null?void 0:pe.clientHeight)!=null?a:0,le=pe?(pe.scrollLeft+me/2)/ae:20,re=pe?(pe.scrollTop+ye/2)/ae:20,X=Wl(B),ne=X.minX+X.width/2,Me=X.minY+X.height/2,b=Math.round(le-ne),h=Math.round(re-Me),U=E.value.reduce((G,Y)=>Math.max(G,Number(Y.zIndex||0)),0);let I=null;if(B.length===1){const G=B[0];if(!G){console.warn("单元素组件插入失败：源元素不存在");return}const v=JSON.parse(JSON.stringify(G));de(v);const V=Number((m=(p=v.left)!=null?p:v.x)!=null?m:0),$=Number((A=(f=v.top)!=null?f:v.y)!=null?A:0);v.left=Math.round(V+b),v.top=Math.round($+h),v.x=v.left,v.y=v.top;const{w:ue,h:Se}=(function(){var Ne,Oe,ot,lt,dt;const be=Number(v.width||0),ke=Number(v.height||0);if(be>0&&ke>0)return{w:be,h:ke};if(v.type==="text"){const Qe=Number((Ne=v.fontSize)!=null?Ne:16),pt=String((Oe=v.text)!=null?Oe:"").trim(),st=Math.max(50,Math.round((pt.length||2)*Qe*.6)),Et=Math.max(20,Math.round(Qe*1.5));return{w:be||st,h:ke||Et}}if(v.type==="image")return{w:be||100,h:ke||100};if(v.type==="chart")return{w:be||240,h:ke||160};if(v.type==="line"){const Qe=Number((lt=(ot=v.style)==null?void 0:ot.lineThickness)!=null?lt:2);return(((dt=v.style)==null?void 0:dt.lineOrientation)||"horizontal")==="vertical"?{w:be||Qe,h:ke||100}:{w:be||100,h:ke||Qe}}return{w:be||50,h:ke||20}})();if(v.width=ue,v.height=Se,v.type==="image"&&!(v.src||"").startsWith("data:")&&v.iconId)try{Vt(v.iconId).then(be=>{be&&(v.src=be)}).catch(()=>{})}catch{}v.zIndex=Math.max(1,U+1),K(),E.value=E.value.concat(v),c.value=v.id,I=v.id}else{const G=`group-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,Y=[];for(const V of B){const $=JSON.parse(JSON.stringify(V));de($);const ue=Number((N=(F=$.left)!=null?F:$.x)!=null?N:0),Se=Number((i=(S=$.top)!=null?S:$.y)!=null?i:0);$.left=Math.round(ue-X.minX),$.top=Math.round(Se-X.minY),$.x=$.left,$.y=$.top;const{w:be,h:ke}=(function(){var ot,lt,dt,Qe,pt;const Ne=Number($.width||0),Oe=Number($.height||0);if(Ne>0&&Oe>0)return{w:Ne,h:Oe};if($.type==="text"){const st=Number((ot=$.fontSize)!=null?ot:16),Et=String((lt=$.text)!=null?lt:"").trim(),Zt=Math.max(50,Math.round((Et.length||2)*st*.6)),Yl=Math.max(20,Math.round(st*1.5));return{w:Ne||Zt,h:Oe||Yl}}if($.type==="image")return{w:Ne||100,h:Oe||100};if($.type==="chart")return{w:Ne||240,h:Oe||160};if($.type==="line"){const st=Number((Qe=(dt=$.style)==null?void 0:dt.lineThickness)!=null?Qe:2);return(((pt=$.style)==null?void 0:pt.lineOrientation)||"horizontal")==="vertical"?{w:Ne||st,h:Oe||100}:{w:Ne||100,h:Oe||st}}return{w:Ne||50,h:Oe||20}})();if($.width=be,$.height=ke,$.type==="image"&&!($.src||"").startsWith("data:")&&$.iconId)try{Vt($.iconId).then(Ne=>{Ne&&($.src=Ne)}).catch(()=>{})}catch{}Y.push($)}const v={id:G,type:"group",left:Math.round(X.minX+b),top:Math.round(X.minY+h),width:Math.max(1,Math.round(X.width)),height:Math.max(1,Math.round(X.height)),zIndex:Math.max(1,U+1),className:r.name?`component-${r.name.replace(/[^A-Za-z0-9_-]/g,"-")}`:void 0,children:Y,componentId:r.id,editable:!0,style:{backgroundColor:"transparent"}};K(),E.value=E.value.concat(v),c.value=v.id,I=G}try{if(I){const G=await et.getFontsByComponentId(r.id);if(Array.isArray(G)&&G.length>0){let Y=document.getElementById(`component-fonts-${I}`);Y||(Y=document.createElement("style"),Y.id=`component-fonts-${I}`,document.head.appendChild(Y));const v=[];for(const V of G){const $=String(V.name||"").replace(/[^A-Za-z0-9_\-]/g,"_"),ue=V.bufferBase64;ue&&v.push(`@font-face { font-family: '${$}'; src: url('${ue}'); font-weight: normal; font-style: normal; font-display: swap; }`)}Y.textContent=v.join(`
`)}}}catch(G){console.warn("注入组件字体失败：",G)}try{if(I){const G=await et.getDatabaseObjectsByComponentId(r.id);Array.isArray(G)&&G.length>0&&El(I,G.map(Y=>({name:Y.name,content:Y.content})))}}catch(G){console.warn("注入组件数据库对象失败：",G)}await et.incrementUsageCount(r.id),Ut.value=!1}catch(u){console.warn("插入组件失败：",u)}}const cl=()=>w.value?`lowcode-builder-state-${w.value}`:"lowcode-builder-state-v1",Xt=()=>w.value?n.isComponent?`component-${w.value}`:`project-${w.value}`:"default";async function Yt(r,o){try{const a=JSON.parse(JSON.stringify(o));if(r.startsWith("component-")){const p=r.replace(/^component-/,"");await et.saveBuilderStateForComponent(p,a)}else if(r.startsWith("project-")){const p=r.replace(/^project-/,"");await et.saveBuilderStateForProject(p,a)}else await et.saveBuilderStateForProject(r,a)}catch(a){console.warn("保存构建器状态失败：",a)}}async function pl(r){try{if(r.startsWith("component-")){const o=r.replace(/^component-/,"");return await et.getBuilderStateForComponent(o)}else if(r.startsWith("project-")){const o=r.replace(/^project-/,"");return await et.getBuilderStateForProject(o)}return await et.getBuilderStateForProject(r)}catch(o){return console.warn("恢复构建器状态失败：",o),null}}let _t=null;function Kt(){_t&&clearTimeout(_t),_t=setTimeout(()=>{const r={config:k,elements:E.value,exportName:ce.value};try{const o=async()=>{if(await Yt(Xt(),r),n.isComponent&&w.value)try{const a=String(w.value),p=await et.getComponent(a),m={id:a,name:ce.value||(p==null?void 0:p.name)||"未命名组件",description:(p==null?void 0:p.description)||"",tags:(p==null?void 0:p.tags)||[],elements:E.value,config:k,usageCount:(p==null?void 0:p.usageCount)||0,createdAt:(p==null?void 0:p.createdAt)||Date.now(),updatedAt:Date.now()};await et.saveComponent(JSON.parse(JSON.stringify(m))),yl()}catch(a){console.warn("同步保存组件记录失败：",a)}};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{o()}):o()}catch(o){console.warn("保存失败：",o)}},400)}bt(k,Kt,{deep:!0}),bt(E,Kt,{deep:!0}),bt(ce,Kt),bt(E,()=>{Wt()},{deep:!0});async function Jl(){try{const r="lowcode-icons",o="icons",a=await new Promise((f,A)=>{const F=indexedDB.open(r);F.onsuccess=()=>{const N=F.result;if(N.objectStoreNames.contains(o))f(N);else{const S=N.version+1;N.close();const i=indexedDB.open(r,S);i.onupgradeneeded=()=>{const u=i.result;u.objectStoreNames.contains(o)||u.createObjectStore(o,{keyPath:"id"})},i.onsuccess=()=>f(i.result),i.onerror=()=>A(i.error)}},F.onerror=()=>A(F.error)}),p=await new Promise((f,A)=>{const F=a.transaction(o,"readonly").objectStore(o).getAll();F.onsuccess=()=>f(F.result),F.onerror=()=>A(F.error)}),m=w.value;sl.value=(m?p.filter(f=>f.projectId===m):p.filter(f=>!f.projectId)).map(f=>{const A=new Blob([f.buffer],{type:f.mime}),F=URL.createObjectURL(A);return{id:f.id,url:F,name:f.name}})}catch(r){console.warn("图标库初始化失败：",r)}}async function Vt(r){try{const o="lowcode-icons",a="icons",p=await new Promise((A,F)=>{const N=indexedDB.open(o);N.onsuccess=()=>{const S=N.result;if(S.objectStoreNames.contains(a))A(S);else{const i=S.version+1;S.close();const u=indexedDB.open(o,i);u.onupgradeneeded=()=>{const B=u.result;B.objectStoreNames.contains(a)||B.createObjectStore(a,{keyPath:"id"})},u.onsuccess=()=>A(u.result),u.onerror=()=>F(u.error)}},N.onerror=()=>F(N.error)}),m=await new Promise((A,F)=>{const N=p.transaction(a,"readonly").objectStore(a).get(r);N.onsuccess=()=>A(N.result),N.onerror=()=>F(N.error)});if(!m||!m.buffer)return null;const f=new Blob([m.buffer],{type:m.mime||"application/octet-stream"});return await new Promise((A,F)=>{const N=new FileReader;N.onload=()=>A(String(N.result)),N.onerror=()=>F(N.error),N.readAsDataURL(f)})}catch(o){return console.warn("读取图标数据失败：",o),null}}async function gl(){const r=E.value.filter(o=>o.type==="image");for(const o of r){if((o.src||"").startsWith("data:")||!o.iconId)continue;const a=await Vt(o.iconId);a&&(o.src=a)}}async function ql(){try{const r="lowcode-fonts",o="fonts",a=await new Promise((m,f)=>{const A=indexedDB.open(r);A.onsuccess=()=>{const F=A.result;if(F.objectStoreNames.contains(o))m(F);else{const N=F.version+1;F.close();const S=indexedDB.open(r,N);S.onupgradeneeded=()=>{const i=S.result;i.objectStoreNames.contains(o)||i.createObjectStore(o,{keyPath:"id"})},S.onsuccess=()=>m(S.result),S.onerror=()=>f(S.error)}},A.onerror=()=>f(A.error)}),p=await new Promise((m,f)=>{const A=a.transaction(o,"readonly").objectStore(o).getAll();A.onsuccess=()=>m(A.result),A.onerror=()=>f(A.error)});if(p.length>0){let m=document.querySelector("style[data-font-lib]");m||(m=document.createElement("style"),m.setAttribute("data-font-lib",""),document.head.appendChild(m));const f=[],A=[],F=w.value,N=F?p.filter(i=>i.projectId===F):p.filter(i=>!i.projectId);for(const i of N){const u=new Blob([i.buffer],{type:i.mime}),B=URL.createObjectURL(u),H=i.name;A.push(H),f.push(`@font-face { font-family: '${H}'; src: url('${B}'); font-weight: normal; font-style: normal; }`)}m.textContent=f.join(`
`);const S=new Set([...P.value,...A]);P.value=Array.from(S)}}catch(r){console.warn("字体库初始化失败：",r)}}rr(async()=>{await W(),await ql(),await Jl();try{if(n.isComponent&&w.value){const r=String(w.value);if(!await et.getComponent(r)){const o={id:r,name:ce.value||"未命名组件",description:"",tags:[],elements:[],config:k,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await et.saveComponent(JSON.parse(JSON.stringify(o)))}}}catch(r){console.warn("预创建组件记录失败：",r)}try{const r=await pl(Xt());if(r){r.config&&Object.assign(k,r.config),Array.isArray(r.elements)&&(E.value=r.elements),typeof r.exportName=="string"&&r.exportName&&(ce.value=r.exportName),await gl();try{E.value=E.value.map(o=>{if(o.type==="chart"&&o.style&&typeof o.style.border=="string"&&o.style.border.includes("dashed")){const a={...o,style:{...o.style}};return delete a.style.border,a}return o})}catch{}}else{const o=localStorage.getItem(cl());if(o){const a=JSON.parse(o);a&&a.config&&Object.assign(k,a.config),Array.isArray(a==null?void 0:a.elements)&&(E.value=a.elements),typeof(a==null?void 0:a.exportName)=="string"&&a.exportName&&(ce.value=a.exportName),await gl();try{E.value=E.value.map(p=>{if(p.type==="chart"&&p.style&&typeof p.style.border=="string"&&p.style.border.includes("dashed")){const m={...p,style:{...p.style}};return delete m.style.border,m}return p})}catch{}await Yt(Xt(),{config:k,elements:E.value,exportName:ce.value});try{localStorage.removeItem(cl())}catch{}}}}catch(r){console.warn("恢复失败：",r)}Wt(),window.addEventListener("keydown",qe),window.addEventListener("keyup",ze)}),nr(()=>{window.removeEventListener("keydown",qe),window.removeEventListener("keyup",ze),yl()});let fl=0;async function Xl(r,o){var a,p,m;try{const f=k.width||r.clientWidth||800,A=k.height||r.clientHeight||600,F=(a=o==null?void 0:o.maxWidth)!=null?a:420,N=(p=o==null?void 0:o.scale)!=null?p:Math.min(1,F/f),S=(m=o==null?void 0:o.quality)!=null?m:.85,i=r.cloneNode(!0);i.style.transform="none",i.style.transformOrigin="top left",i.style.width=`${f}px`,i.style.height=`${A}px`;const u=new XMLSerializer().serializeToString(i),B=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${Math.round(f*N)}" height="${Math.round(A*N)}">
  <foreignObject width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml" style="transform: scale(${N}); transform-origin: top left;">${u}</div>
  </foreignObject>
</svg>`,H="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(B),de=new Image;return await new Promise(pe=>{de.onload=()=>{try{const ae=document.createElement("canvas");ae.width=de.width,ae.height=de.height;const me=ae.getContext("2d");if(!me)return pe(null);me.drawImage(de,0,0);const ye=ae.toDataURL("image/jpeg",S);pe(ye)}catch{pe(null)}},de.onerror=()=>pe(null),de.src=H})}catch{return null}}async function yl(){try{const r=Date.now();if(r-fl<5e3||(fl=r,!n.isComponent||!w.value))return;const o=Nt.value;if(!o)return;const a=o.firstElementChild;if(!a)return;const p=await Xl(a,{maxWidth:420,quality:.8});if(!p)return;const m=String(w.value),f=await et.getComponent(m);if(!f)return;const A={...f,previewDataUrl:p,updatedAt:Date.now()};await et.saveComponent(JSON.parse(JSON.stringify(A)))}catch(r){console.warn("生成缩略图失败：",r)}}return(r,o)=>{var a,p,m,f,A,F,N,S;return z(),O(It,null,[l("div",du,[o[33]||(o[33]=Zl('<div class="absolute inset-0 opacity-10" data-v-40266622><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-40266622></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-40266622></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-40266622></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-40266622></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-40266622></div>',2)),l("div",uu,[at(fs,{exportName:ce.value,config:k,fontLibrary:P.value,spacingEnabled:gt.value,alignmentEnabled:ft.value,"onUpdate:exportName":o[0]||(o[0]=i=>ce.value=i),"onUpdate:configWidth":o[1]||(o[1]=i=>k.width=i),"onUpdate:configHeight":o[2]||(o[2]=i=>k.height=i),"onUpdate:backgroundColor":o[3]||(o[3]=i=>k.backgroundColor=i),"onUpdate:globalFontFamily":o[4]||(o[4]=i=>k.globalFontFamily=i),"onUpdate:globalFontSize":o[5]||(o[5]=i=>k.globalFontSize=i),"onUpdate:globalColor":o[6]||(o[6]=i=>k.globalColor=i),"onUpdate:spacingEnabled":o[7]||(o[7]=i=>gt.value=i),"onUpdate:alignmentEnabled":o[8]||(o[8]=i=>ft.value=i),onBackgroundFileChange:zl,onOpenPreview:oe,onDownloadByFormat:o[9]||(o[9]=i=>jl(i)),onDownloadAllFormats:Ol,onResetCanvas:Bl,elements:E.value,selectedId:c.value,onSelectElement:o[10]||(o[10]=i=>Ft(i)),onReorderTopElements:o[11]||(o[11]=i=>zt(i.from,i.to))},null,8,["exportName","config","fontLibrary","spacingEnabled","alignmentEnabled","elements","selectedId"]),l("div",cu,[l("div",pu,[l("div",gu,[l("div",fu,[l("button",{onMouseenter:Ul,onMouseleave:Vl,onClick:o[12]||(o[12]=i=>ct.value=!0),class:"px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"}," 插入元素 ",32),fe(l("div",{onMouseenter:Rl,onMouseleave:Pl,class:"absolute left-0 top-full w-72 p-3 bg-gray-900/95 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl z-50"},[l("div",yu,[l("button",{onClick:o[13]||(o[13]=i=>{Xe("text"),ct.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded"},"文本"),l("button",{onClick:o[14]||(o[14]=i=>{Xe("arc-text"),ct.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-indigo-600 hover:from-cyan-500 hover:to-indigo-500 text-white rounded"},"环绕文字"),l("button",{onClick:o[15]||(o[15]=i=>{Xe("image"),ct.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500 text-white rounded"},"图片"),l("button",{onClick:o[16]||(o[16]=i=>{Xe("chart"),ct.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-500 hover:to-red-500 text-white rounded"},"图表"),l("button",{onClick:o[17]||(o[17]=i=>{Xe("line"),ct.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"线条"),l("button",{onClick:o[18]||(o[18]=i=>{Xe("container"),ct.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded col-span-2"},"容器")])],544),[[ao,ct.value]])]),l("button",{onClick:o[19]||(o[19]=i=>Ue.value=!0),class:"px-4 py-2 bg-gradient-to-r from-gray-600 to-slate-700 hover:from-gray-500 hover:to-slate-600 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-gray-500/25"}," 隐藏元素 "),l("button",{onClick:Ll,class:"px-4 py-2 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-pink-500/25"}," 插入组件 ")]),l("div",mu,[l("button",{onClick:Tl,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[31]||(o[31]=[l("span",{class:"text-gray-300"},"-",-1)])]),l("span",bu,rt(Math.round(Ze.value*100))+"%",1),l("button",{onClick:Dl,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[32]||(o[32]=[l("span",{class:"text-gray-300"},"+",-1)])]),l("button",{onClick:ol,class:"px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg text-xs text-gray-300 transition-colors duration-200"}," 适应 ")])]),l("div",{ref_key:"canvasScrollRef",ref:Nt,class:"flex-1 overflow-auto bg-gray-800/30 p-4 min-h-0 custom-scrollbar"},[l("div",{ref_key:"canvasContentRef",ref:Mt,class:"relative border border-gray-600/50 bg-gray-100 shadow-2xl mx-auto",onMousedown:Yn(jt,["self"]),style:ut({width:`${k.width}px`,height:`${k.height}px`,backgroundColor:k.backgroundColor||"transparent",backgroundImage:k.backgroundUrl?`url(${k.backgroundUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`scale(${Ze.value})`,transformOrigin:"top left"})},[Re.value?(z(),O("div",xu,[Fe.value.left?(z(),O("div",{key:0,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:ut([{"border-width":"0.5px"},{left:`${Ce.value.left}px`}])},null,4)):te("",!0),Fe.value.right?(z(),O("div",{key:1,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:ut([{"border-width":"0.5px"},{left:`${Ce.value.right}px`}])},null,4)):te("",!0),Fe.value.top?(z(),O("div",{key:2,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:ut([{"border-width":"0.5px"},{top:`${Ce.value.top}px`}])},null,4)):te("",!0),Fe.value.bottom?(z(),O("div",{key:3,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:ut([{"border-width":"0.5px"},{top:`${Ce.value.bottom}px`}])},null,4)):te("",!0),Fe.value.centerV?(z(),O("div",{key:4,class:"absolute top-0 bottom-0 border-l border-dashed border-blue-400/60",style:ut([{"border-width":"0.5px"},{left:`${Ce.value.centerX}px`}])},null,4)):te("",!0),Fe.value.centerH?(z(),O("div",{key:5,class:"absolute left-0 right-0 border-t border-dashed border-blue-400/60",style:ut([{"border-width":"0.5px"},{top:`${Ce.value.centerY}px`}])},null,4)):te("",!0)])):te("",!0),gt.value&&(xe.value.left||xe.value.right||xe.value.up||xe.value.down)?(z(),O("div",vu,[xe.value.left&&Ee.value!=="left"?(z(),O("div",{key:0,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:ut({left:`${xe.value.left.x-14}px`,top:`${xe.value.left.y-14}px`}),onDblclick:o[20]||(o[20]=i=>Bt("left"))},rt(xe.value.left.gap)+"px ",37)):te("",!0),xe.value.right&&Ee.value!=="right"?(z(),O("div",{key:1,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:ut({left:`${xe.value.right.x-14}px`,top:`${xe.value.right.y-14}px`}),onDblclick:o[21]||(o[21]=i=>Bt("right"))},rt(xe.value.right.gap)+"px ",37)):te("",!0),xe.value.up&&Ee.value!=="up"?(z(),O("div",{key:2,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:ut({left:`${xe.value.up.x-14}px`,top:`${xe.value.up.y-18}px`}),onDblclick:o[22]||(o[22]=i=>Bt("up"))},rt(xe.value.up.gap)+"px ",37)):te("",!0),xe.value.down&&Ee.value!=="down"?(z(),O("div",{key:3,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:ut({left:`${xe.value.down.x-14}px`,top:`${xe.value.down.y-18}px`}),onDblclick:o[23]||(o[23]=i=>Bt("down"))},rt(xe.value.down.gap)+"px ",37)):te("",!0),Ee.value==="left"?fe((z(),O("input",{key:4,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:ut({left:`${(((a=xe.value.left)==null?void 0:a.x)||0)-28}px`,top:`${(((p=xe.value.left)==null?void 0:p.y)||0)-14}px`}),"onUpdate:modelValue":o[24]||(o[24]=i=>je.value=i),onKeydown:_l(Dt,["enter"])},null,36)),[[we,je.value,void 0,{number:!0}]]):te("",!0),Ee.value==="right"?fe((z(),O("input",{key:5,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:ut({left:`${(((m=xe.value.right)==null?void 0:m.x)||0)-28}px`,top:`${(((f=xe.value.right)==null?void 0:f.y)||0)-14}px`}),"onUpdate:modelValue":o[25]||(o[25]=i=>je.value=i),onKeydown:_l(Dt,["enter"])},null,36)),[[we,je.value,void 0,{number:!0}]]):te("",!0),Ee.value==="up"?fe((z(),O("input",{key:6,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:ut({left:`${(((A=xe.value.up)==null?void 0:A.x)||0)-28}px`,top:`${(((F=xe.value.up)==null?void 0:F.y)||0)-18}px`}),"onUpdate:modelValue":o[26]||(o[26]=i=>je.value=i),onKeydown:_l(Dt,["enter"])},null,36)),[[we,je.value,void 0,{number:!0}]]):te("",!0),Ee.value==="down"?fe((z(),O("input",{key:7,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:ut({left:`${(((N=xe.value.down)==null?void 0:N.x)||0)-28}px`,top:`${(((S=xe.value.down)==null?void 0:S.y)||0)-18}px`}),"onUpdate:modelValue":o[27]||(o[27]=i=>je.value=i),onKeydown:_l(Dt,["enter"])},null,36)),[[we,je.value,void 0,{number:!0}]]):te("",!0)])):te("",!0),(z(!0),O(It,null,Rt(E.value,i=>(z(),er(co,{key:i.id,element:i,selected:i.id===c.value,"selected-id":c.value,config:k,zoom:Ze.value,dbMap:Tt.value,"metrics-map":R.value,onSelect:At,"onUpdate:position":ht,"onUpdate:size":wt,onShowGuidelines:yt,onHideGuidelines:nt,onReportMetrics:tt,onDragEnd:vl},null,8,["element","selected","selected-id","config","zoom","dbMap","metrics-map"]))),128))],36)],512)]),at(iu,{selectedEl:$t.value,config:k,fontLibrary:P.value,fontSizeLibrary:Q.value,fontWeightOptions:se.value,fontStyleOptions:_.value,databaseObjects:D.value,dbMap:Tt.value,iconLibrary:sl.value,defaultChartOption:_e,safeHex:kl,initCustomClassSkeleton:Ml,refreshAllCustomClassCss:Wt,removeCustomClassCssForElement:tl,getIconDataUrlById:Vt,onDuplicateSelected:Gl,onRemoveSelected:Sl,onSaveSelectedAsComponent:Al},null,8,["selectedEl","config","fontLibrary","fontSizeLibrary","fontWeightOptions","fontStyleOptions","databaseObjects","dbMap","iconLibrary"])])]),Ut.value?(z(),O("div",hu,[l("div",{class:"absolute inset-0 bg-black/60",onClick:ul}),l("div",wu,[l("div",{class:"flex items-center justify-between p-4 border-b border-fuchsia-500/30 bg-gradient-to-r from-fuchsia-600/20 to-pink-600/20"},[o[34]||(o[34]=l("h3",{class:"text-lg font-bold text-pink-300"},"插入组件",-1)),l("button",{onClick:ul,class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),l("div",$u,[l("div",Eu,[fe(l("input",{"onUpdate:modelValue":o[28]||(o[28]=i=>Jt.value=i),type:"text",placeholder:"搜索名称、描述或标签",class:"flex-1 px-3 py-2 bg-gray-800/60 border border-fuchsia-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-fuchsia-400 focus:ring-1 focus:ring-fuchsia-400 focus:outline-none transition-all duration-200"},null,512),[[we,Jt.value]]),l("button",{onClick:dl,class:"px-3 py-2 bg-pink-600/70 hover:bg-pink-600 text-white rounded"},"刷新")]),qt.value?(z(),O("div",ku,"正在加载组件...")):(z(),O("div",Su,[il.value.length===0?(z(),O("div",Mu,"暂无匹配的组件")):(z(),O("div",Cu,[(z(!0),O(It,null,Rt(il.value,i=>(z(),O("div",{key:i.id,class:"bg-gray-800/60 border border-pink-500/20 rounded-lg overflow-hidden"},[l("div",Nu,[i.previewDataUrl?(z(),O("img",{key:0,src:i.previewDataUrl,alt:"预览",class:"max-w-full max-h-full object-contain"},null,8,Iu)):(z(),O("div",Au,"无预览"))]),l("div",Fu,[l("div",zu,[l("div",{class:"text-sm text-gray-100 font-medium truncate",title:i.name},rt(i.name),9,ju),l("div",Ou,rt(i.usageCount||0)+" 次",1)]),l("div",Bu,[(z(!0),O(It,null,Rt(i.tags||[],u=>(z(),O("span",{key:u,class:"px-1.5 py-0.5 text-[10px] rounded bg-pink-600/30 text-pink-200"},rt(u),1))),128))]),l("div",Du,[l("button",{onClick:u=>Hl(i),class:"w-full px-3 py-1.5 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded text-sm transition"}," 插入到画布 ",8,Tu)])])]))),128))]))]))])])])):te("",!0),Ue.value?(z(),O("div",Gu,[l("div",{class:"absolute inset-0 bg-black/60",onClick:o[29]||(o[29]=i=>Ue.value=!1)}),l("div",Lu,[l("div",Uu,[o[35]||(o[35]=l("h3",{class:"text-lg font-bold text-cyan-300"},"隐藏元素列表",-1)),l("button",{onClick:o[30]||(o[30]=i=>Ue.value=!1),class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),l("div",Vu,[He.value.length===0?(z(),O("div",Ru,"暂无隐藏元素")):(z(),O("div",Pu,[(z(!0),O(It,null,Rt(He.value,i=>(z(),O("div",{key:i.id,class:"flex items-center justify-between bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2"},[l("div",{class:"text-sm text-gray-100 truncate",title:i.hiddenLabel||i.className||i.id},rt(i.hiddenLabel||i.className||i.id),9,Wu),l("button",{onClick:u=>Je(i.id),class:"px-3 py-1 bg-cyan-600/70 hover:bg-cyan-600 text-white rounded text-sm"},"取消隐藏并定位",8,Hu)]))),128))]))])])])):te("",!0)],64)}}}),Xu=or(qu,[["__scopeId","data-v-40266622"]]),Yu=St({__name:"index",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(x){const n=x;return(e,g)=>(z(),er(Xu,{"project-id":n.projectId,"current-project":n.currentProject,"is-component":n.isComponent},null,8,["project-id","current-project","is-component"]))}}),rc=Yu;export{rc as default};
