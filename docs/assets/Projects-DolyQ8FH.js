import{E as d,I as C,O,R as g,_ as $,c as T,d as P,f as c,h as V,l as t,lt as v,m as U,o as F,u as I,w as K}from"./codemirror-B25QCqWr.js";import{f as M,h as Q,m as G,s as J}from"./vendor-vue-fZ-TTK_Z.js";import{t as W}from"./index-R3-RO9Tt.js";var X={class:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden"},Y={class:"relative z-10 container mx-auto px-6 py-8"},Z={class:"flex flex-col md:flex-row gap-4 mb-8"},ee={class:"flex-1"},te={class:"relative"},re={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},oe={class:"flex items-start justify-between mb-4"},ae={class:"flex-1"},ne={class:"text-xl font-semibold text-cyan-300 mb-2"},se={key:0,class:"text-gray-400 text-sm mb-3"},le={class:"flex gap-2"},ie=["onClick"],de=["onClick"],ue={class:"text-xs text-gray-500 mb-4"},ce=["onClick"],ve={key:1,class:"text-center py-16"},pe={class:"text-xl font-semibold text-gray-400 mb-2"},me={class:"text-gray-500 mb-6"},fe={class:"bg-gray-800 border border-purple-500/30 rounded-xl p-6 w-full max-w-md"},ge={class:"text-xl font-semibold text-cyan-300 mb-4"},be={class:"space-y-4"},xe={class:"flex gap-3 mt-6"},ye=["disabled"],N="lowcode-projects",i="projects",we=$({__name:"ProjectManager",setup(L){const h=J(),x=g([]),p=g(""),b=g(!1),u=g(null),s=g(""),m=g("");async function k(){return new Promise((r,e)=>{const o=indexedDB.open(N);o.onsuccess=()=>{const n=o.result;if(n.objectStoreNames.contains(i))r(n);else{const w=n.version+1;n.close();const a=indexedDB.open(N,w);a.onupgradeneeded=()=>{const f=a.result;f.objectStoreNames.contains(i)||f.createObjectStore(i,{keyPath:"id"})},a.onsuccess=()=>r(a.result),a.onerror=()=>e(a.error)}},o.onerror=()=>e(o.error)})}async function _(){try{const r=(await k()).transaction(i,"readonly").objectStore(i).getAll();r.onsuccess=()=>{x.value=r.result.sort((e,o)=>o.updatedAt-e.updatedAt)}}catch(r){console.warn("加载项目失败：",r)}}async function j(r){try{await(await k()).transaction(i,"readwrite").objectStore(i).put(r),await _()}catch(e){console.warn("保存项目失败：",e)}}async function E(r){if(confirm("确认删除此项目吗？这将清空项目相关的所有数据（图标、字体、画布等）。"))try{await(await k()).transaction(i,"readwrite").objectStore(i).delete(r),await z(r),await _()}catch(e){console.warn("删除项目失败：",e)}}async function z(r){try{const e=(await new Promise((a,f)=>{const l=indexedDB.open("lowcode-icons",1);l.onsuccess=()=>a(l.result),l.onerror=()=>f(l.error)})).transaction("icons","readwrite").objectStore("icons"),o=e.getAll();o.onsuccess=()=>{o.result.filter(a=>a.projectId===r).forEach(a=>e.delete(a.id))};const n=(await new Promise((a,f)=>{const l=indexedDB.open("lowcode-fonts",1);l.onsuccess=()=>a(l.result),l.onerror=()=>f(l.error)})).transaction("fonts","readwrite").objectStore("fonts"),w=n.getAll();w.onsuccess=()=>{w.result.filter(a=>a.projectId===r).forEach(a=>n.delete(a.id))},localStorage.removeItem(`lowcode-builder-state-${r}`)}catch(e){console.warn("清空项目数据失败：",e)}}function B(){if(!s.value.trim())return;const r={id:`project-${Date.now()}`,name:s.value.trim(),description:m.value.trim(),createdAt:Date.now(),updatedAt:Date.now()};j(r),y()}function D(){if(!u.value||!s.value.trim())return;const r={...u.value,name:s.value.trim(),description:m.value.trim(),updatedAt:Date.now()};j(r),y()}function H(r){u.value=r,s.value=r.name,m.value=r.description||"",b.value=!0}function y(){b.value=!1,u.value=null,s.value="",m.value=""}const S=T(()=>{if(!p.value.trim())return x.value;const r=p.value.toLowerCase();return x.value.filter(e=>e.name.toLowerCase().includes(r)||e.description&&e.description.toLowerCase().includes(r))});function q(r){const e={...r,updatedAt:Date.now()};j(e),h.push(`/project/${r.id}/builder`)}function A(r){return new Date(r).toLocaleString("zh-CN")}K(()=>{_()});function R(){h.push("/low-code")}return(r,e)=>(d(),c("div",X,[e[16]||(e[16]=U('<div class="absolute inset-0 opacity-10" data-v-4f16d5d2><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-4f16d5d2></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-4f16d5d2></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-4f16d5d2></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-4f16d5d2></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-4f16d5d2></div>',2)),t("div",Y,[t("div",{class:"flex items-center justify-between mb-12"},[t("button",{onClick:R,class:"flex items-center gap-2 px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg border border-cyan-500/30 text-gray-300 hover:text-white transition-all duration-200"},[...e[7]||(e[7]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M19 12H5M12 19L5 12L12 5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),V(" 返回 ",-1)])]),e[8]||(e[8]=t("h1",{class:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent"}," 项目管理 ",-1))]),t("div",Z,[t("div",ee,[t("div",te,[C(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>p.value=o),type:"text",placeholder:"搜索项目...",class:"w-full px-4 py-3 pl-12 bg-gray-800/50 border border-cyan-500/30 rounded-xl text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-2 focus:ring-cyan-400/20 focus:outline-none transition-all duration-200"},null,512),[[M,p.value]]),e[9]||(e[9]=t("div",{class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),t("button",{onClick:e[1]||(e[1]=o=>b.value=!0),class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-xl font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},[...e[10]||(e[10]=[t("span",{class:"flex items-center gap-2"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),V(" 新建项目 ")],-1)])])]),S.value.length>0?(d(),c("div",re,[(d(!0),c(F,null,O(S.value,o=>(d(),c("div",{key:o.id,class:"bg-gray-800/50 backdrop-blur-sm border border-purple-500/30 rounded-xl p-6 hover:border-purple-400/50 transition-all duration-200 transform hover:scale-105 hover:shadow-lg hover:shadow-purple-500/20"},[t("div",oe,[t("div",ae,[t("h3",ne,v(o.name),1),o.description?(d(),c("p",se,v(o.description),1)):P("",!0)]),t("div",le,[t("button",{onClick:n=>H(o),class:"p-2 text-blue-400 hover:text-blue-300 hover:bg-blue-500/20 rounded-lg transition-colors duration-200",title:"编辑项目"},[...e[11]||(e[11]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ie),t("button",{onClick:n=>E(o.id),class:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded-lg transition-colors duration-200",title:"删除项目"},[...e[12]||(e[12]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,de)])]),t("div",ue,[t("div",null,"创建时间: "+v(A(o.createdAt)),1),t("div",null,"更新时间: "+v(A(o.updatedAt)),1)]),t("button",{onClick:n=>q(o),class:"w-full px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"}," 进入编辑 ",8,ce)]))),128))])):(d(),c("div",ve,[e[13]||(e[13]=t("div",{class:"w-24 h-24 mx-auto mb-6 bg-gray-800/50 rounded-full flex items-center justify-center"},[t("svg",{class:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),t("h3",pe,v(p.value?"未找到匹配的项目":"还没有项目"),1),t("p",me,v(p.value?"尝试使用其他关键词搜索":"创建您的第一个可视化组件项目"),1),p.value?P("",!0):(d(),c("button",{key:0,onClick:e[2]||(e[2]=o=>b.value=!0),class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-xl font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"}," 创建项目 "))]))]),b.value?(d(),c("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:Q(y,["self"])},[t("div",fe,[t("h3",ge,v(u.value?"编辑项目":"创建新项目"),1),t("div",be,[t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"项目名称",-1)),C(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.value=o),type:"text",placeholder:"输入项目名称...",class:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",onKeyup:e[4]||(e[4]=G(o=>u.value?D():B(),["enter"]))},null,544),[[M,s.value]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"项目描述（可选）",-1)),C(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=o=>m.value=o),placeholder:"输入项目描述...",rows:"3",class:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200 resize-none"},null,512),[[M,m.value]])])]),t("div",xe,[t("button",{onClick:y,class:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-medium transition-colors duration-200"}," 取消 "),t("button",{onClick:e[6]||(e[6]=o=>u.value?D():B()),disabled:!s.value.trim(),class:"flex-1 px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 disabled:from-gray-600 disabled:to-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-all duration-200"},v(u.value?"保存":"创建"),9,ye)])])])):P("",!0)]))}}),he=W(we,[["__scopeId","data-v-4f16d5d2"]]),ke=$({__name:"index",setup(L){return(h,x)=>(d(),I(he))}}),Pe=ke;export{Pe as default};
