import{i as Jn}from"./rolldown-runtime-CKFmjIRy.js";import{C as tl,E as j,H as qn,I as ye,L as Tn,O as Lt,P as mt,R as we,S as Zr,_ as Mt,b as St,c as Re,ct as st,d as ee,f as O,g as rt,h as mr,i as eo,l as r,lt as Qe,m as Yr,n as to,o as At,r as ro,st as je,t as lo,u as Kr,w as el}from"./codemirror-B25QCqWr.js";import{d as Gn,f as ke,h as Xn,m as qr,n as no,o as oo,p as so,r as ao,s as io,u as _r}from"./vendor-vue-C93_ecI2.js";import{t as rl}from"./index-Dltv_GnR.js";import{t as Xe}from"./componentStorage-DB4dbTb9.js";import"./echarts-xBohgwka.js";import{t as uo}from"./DraggableBox-_xZoMIJo.js";function fr(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function co(y){var p,h;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((p=n.backgroundGradient.colors)!=null&&p.length)){const C=n.backgroundGradient.angle||0,V=n.backgroundGradient.colors[0]||"#000000",ae=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${C}deg, ${V}, ${ae})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"){n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`);const C=n.textOrientation;if(C==="vertical"?(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")):C==="horizontal"&&e.push("writing-mode:horizontal-tb"),n.textGradient&&((h=n.textGradient.colors)!=null&&h.length)){const V=n.textGradient.angle||0,ae=n.textGradient.colors[0]||"#000000",$e=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${V}deg, ${ae}, ${$e})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}}return y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),e.join(";")}function po(y){const n=y.style||{},e=[];return n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.color&&e.push(`fill:${n.color}`),e.join(";")}function go(y){var d,G,R,Q;const n=Math.max(1,Math.round(y.width||1)),e=Math.max(1,Math.round(y.height||1)),p=n/2,h=e/2,C=((d=y.style)==null?void 0:d.arcText)||{},V=Math.max(1,Number((G=C.radius)!=null?G:Math.min(n,e)/2-4)),ae=Number((R=C.startAngle)!=null?R:0),$e=Math.max(0,Number((Q=C.sweepAngle)!=null?Q:180)),k=C.clockwise!==!1,ge=ae*Math.PI/180,U=(ae+$e)*Math.PI/180,Z=p+V*Math.cos(ge),de=h+V*Math.sin(ge),_=p+V*Math.cos(U),E=h+V*Math.sin(U);return`M ${Z} ${de} A ${V} ${V} 0 ${$e>180?1:0} ${k?1:0} ${_} ${E}`}function fo(y){var e;const n=((e=y.style)==null?void 0:e.textAlign)||"center";return n==="left"?"0%":n==="right"?"100%":"50%"}function yo(y){var e;const n=((e=y.style)==null?void 0:e.textAlign)||"center";return n==="left"?"start":n==="right"?"end":"middle"}function Yn(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function mo(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Yn(e)} }`)}function bo(y){const n=[],e=p=>{p.forEach(h=>{if((h.type==="group"||h.type==="container")&&Array.isArray(h.children))e(h.children);else{const C=(h.className||"").trim(),V=h.customClassCss?String(h.customClassCss).trim():"";if(!C||!V)return;/\{[^}]*\}/.test(V)?n.push(mo(V)):n.push(`.${C} { ${Yn(V)} }`)}})};return e(y),n.join(`
`)}function Un(y,n,e,p,h){const C=y.replace(/[^A-Za-z0-9_]/g,"_");let V=0;const ae=[],$e=[],k=n.backgroundUrl||"",ge=n.backgroundColor||"transparent",U=n.globalFontFamily||"",Z=n.globalFontSize||14,de=n.globalColor||"#000000",_=e.some(b=>b.type==="chart");function E(b){const Y=String(b||"").trim();if(!Y)return"";let oe=Y.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(oe[0]||"")||(oe="_"+oe),oe}function d(b){if(!b.hidden)return"";const Y=E(b.hiddenLabel);return Y?` ${p&&p.hideDirective==="show"?"v-show":"v-if"}="${Y}"`:""}function G(b,Y){var He,We,Ye,_e,at,vt,ht,wt,Ft,ze,ve,gt,ft,bt,Ct;const oe=co(b),x=b.zIndex||1,t=b.className&&b.className.trim()?` class="${b.className.trim()}"`:"",se=b.eventBinding,te=se&&se.enabled&&se.handlerName?` @click="${String(se.handlerName)}($event)"`:"";if(b.type==="group"&&Array.isArray(b.children)){const Pe=b.children.map((Ne,Ce)=>G(Ne,Ce)).join(`
        `);return`<div${t}${d(b)} style="${oe};z-index:${x}">
        ${Pe}
      </div>`}if(b.type==="text"){const Pe=(()=>{var dt;const Oe=((dt=b.style)==null?void 0:dt.textAlign)||"left";return Oe==="center"?"text-flex-center":Oe==="right"?"text-flex-right":"text-flex-left"})(),Ne=[(He=b.className)==null?void 0:He.trim(),Pe].filter(Boolean).join(" "),Ce=Ne?` class="${Ne}"`:"",Fe=b.style||{},it=b.elementId&&b.elementId.trim()?b.elementId.trim():`text_${Y}`,Ke=!!(Fe.textWave&&Fe.textWave.enabled),ct=!!Fe.skewFlowEnabled;if(Ke||ct){const Oe=b.dynamic&&b.dynamic.enabled&&b.dynamic.objectName&&b.dynamic.propertyPath?{type:"dynamic",obj:b.dynamic.objectName,path:b.dynamic.propertyPath}:{type:"static",text:b.text||""};ae.push(`'${it.replace(/'/g,"\\'")}' : ${JSON.stringify(Oe)}`);const dt={textWaveEnabled:Ke,amplitude:(Ye=(We=Fe.textWave)==null?void 0:We.amplitude)!=null?Ye:0,frequency:(at=(_e=Fe.textWave)==null?void 0:_e.frequency)!=null?at:0,phase:(ht=(vt=Fe.textWave)==null?void 0:vt.phase)!=null?ht:0,skewFlowEnabled:ct,skewAngle:(wt=Fe.skewAngle)!=null?wt:0,textOrientation:Fe.textOrientation||"horizontal",fontSize:(Ft=Fe.fontSize)!=null?Ft:Z,letterSpacing:(ze=Fe.letterSpacing)!=null?ze:0};return $e.push(`'${it.replace(/'/g,"\\'")}' : ${JSON.stringify(dt)}`),`<div${Ce}${d(b)}${te} style="${oe};z-index:${x}">
        <span v-for="(p,pi) in getTextPieces('${it.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
      </div>`}if(b.dynamic&&b.dynamic.enabled&&b.dynamic.objectName&&b.dynamic.propertyPath){const Oe=`${b.dynamic.objectName}.${b.dynamic.propertyPath}`;return`<div${Ce}${d(b)}${te} style="${oe};z-index:${x}">{{ ${Oe} }}</div>`}else{const Oe=fr(b.text||"");return`<div${Ce}${d(b)}${te} style="${oe};z-index:${x}">${Oe}</div>`}}if(b.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[b.id]){const Ce=p.imageFileMap[b.id],Fe=b.elementId&&b.elementId.trim()?` id="${b.elementId.trim()}"`:"";return`<img${t}${Fe}${d(b)}${te} src="./imgs/${Ce}" style="${oe};z-index:${x}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[V]){const Ce=p.imageFileNames[V++],Fe=b.elementId&&b.elementId.trim()?` id="${b.elementId.trim()}"`:"";return`<img${t}${Fe}${d(b)}${te} src="./imgs/${Ce}" style="${oe};z-index:${x}" alt="" />`}const Pe=b.elementId&&b.elementId.trim()?b.elementId.trim():`img_${Y}`,Ne=b.elementId&&b.elementId.trim()?` id="${b.elementId.trim()}"`:"";return`<img${t}${Ne}${d(b)}${te} :src="images['${Pe}']" style="${oe};z-index:${x}" alt="" />`}if(b.type==="chart"){const Pe=fr(b.text||"chart"),Ne=b.elementId&&b.elementId.trim()?b.elementId.trim():`chart_${Y}`;return`<div${t}${d(b)}${te} id="${Ne}" style="${oe};z-index:${x}">${Pe}</div>`}if(b.type==="container"){const Pe=b.elementId&&b.elementId.trim()?` id="${b.elementId.trim()}"`:"",Ne=b.comment?`<!-- ${b.comment.replace(/-->/g,"")} -->
      `:"";if(Array.isArray(b.children)){const Fe=b.children.map((it,Ke)=>G(it,Ke)).join(`
        `);return`${Ne}<div${t}${d(b)}${te}${Pe} style="${oe};z-index:${x}">
        ${Fe}
      </div>`}const Ce=fr(b.text||"");return`${Ne}<div${t}${d(b)}${te}${Pe} style="${oe};z-index:${x}">${Ce}</div>`}if(b.type==="line"){const Pe=b.style||{},Ne=Pe.lineColor||"#ffffff",Ce=(ve=Pe.lineThickness)!=null?ve:2,Fe=Pe.lineOrientation||"horizontal",it=Pe.lineStyle==="dashed",Ke=(gt=Pe.lineDashLength)!=null?gt:6,ct=(ft=Pe.lineDashGap)!=null?ft:4,Oe=Math.max(1,Math.round((bt=b.width)!=null?bt:Fe==="horizontal"?200:2)),dt=Math.max(1,Math.round((Ct=b.height)!=null?Ct:Fe==="horizontal"?2:200)),jt=Math.round(dt/2),zt=Math.round(Oe/2),$t=it?` stroke-dasharray="${Ke} ${ct}"`:"";return Fe==="horizontal"?`<svg${t}${d(b)}${te} viewBox="0 0 ${Oe} ${dt}" preserveAspectRatio="none" style="${oe};z-index:${x}"><line x1="0" y1="${jt}" x2="${Oe}" y2="${jt}" stroke="${Ne}" stroke-width="${Ce}"${$t} fill="none" /></svg>`:`<svg${t}${d(b)}${te} viewBox="0 0 ${Oe} ${dt}" preserveAspectRatio="none" style="${oe};z-index:${x}"><line x1="${zt}" y1="0" x2="${zt}" y2="${dt}" stroke="${Ne}" stroke-width="${Ce}"${$t} fill="none" /></svg>`}if(b.type==="arc-text"){const Pe=Math.max(1,Math.round(b.width||1)),Ne=Math.max(1,Math.round(b.height||1)),Ce=`arc_${b.id.replace(/"/g,"").replace(/'/g,"\\'")}`,Fe=po(b),it=fo(b),Ke=yo(b),ct=b.dynamic&&b.dynamic.enabled&&b.dynamic.objectName&&b.dynamic.propertyPath?`{{ ${`${b.dynamic.objectName}.${b.dynamic.propertyPath}`} }}`:fr(b.text||"");return`<svg${t}${d(b)}${te} viewBox="0 0 ${Pe} ${Ne}" preserveAspectRatio="none" style="${oe};z-index:${x}">
        <defs>
          <path id="${Ce}" d="${go(b)}" fill="none" />
        </defs>
        <text style="${Fe}">
          <textPath :href="'#${Ce}'" startOffset="${it}" text-anchor="${Ke}">${ct}</textPath>
        </text>
      </svg>`}const lt=fr(b.text||"element");return`<div${t}${d(b)}${te} style="${oe};z-index:${x}">${lt}</div>`}const R=e.map((b,Y)=>G(b,Y)).join(`
      `),Q=bo(e);function H(b,Y){b.forEach(oe=>{(oe.type==="group"||oe.type==="container")&&Array.isArray(oe.children)?(Y(oe),H(oe.children,Y)):Y(oe)})}const X=new Set;H(e,b=>{(b.type==="text"||b.type==="arc-text")&&b.dynamic&&b.dynamic.enabled&&b.dynamic.objectName&&X.add(String(b.dynamic.objectName))});const Ee=Array.from(X),q=!h||Ee.length===0?"":Ee.map(b=>{try{const Y=h[b],oe=JSON.stringify(Y!=null?Y:{});return`      ${b}: ${oe},`}catch{return`      ${b}: {},`}}).join(`
`),D=(()=>{const b=[];let Y=0;return H(e,oe=>{if(oe.type==="chart"){const x=oe.elementId&&oe.elementId.trim()?oe.elementId.trim():`chart_${Y}`;Y++;const t=oe.chartOption||{};try{b.push(`'${x.replace(/'/g,"\\'")}' : ${JSON.stringify(t)}`)}catch{b.push(`'${x.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${b.join(", ")} }`})(),P=(()=>{const b=new Set;return H(e,Y=>{const oe=String(Y.hiddenLabel||"").trim(),x=E(oe),t=!!Y.hidden;x&&t&&b.add(x)}),Array.from(b).map(Y=>`      ${Y}: false,`).join(`
`)})(),Be=(()=>{const b=new Map;function Y(x){x.forEach(t=>{const se=t.eventBinding;se&&se.enabled&&se.handlerName&&b.set(String(se.handlerName),String(se.code||"")),Array.isArray(t.children)&&Y(t.children)})}Y(e);const oe=Array.from(b.entries());return oe.length?oe.map(([x,t])=>`${x}(e) {
${t}
}`).join(`,
`):""})();return`
<template>
  <div class="container" :style="containerStyle">
    ${R}
  </div>
</template>

<script>
${_?`import * as echarts from 'echarts';
`:""}
export default {
  name: '${C}',
  data() {
    return {
      config: {
        width: ${Math.round(n.width)},
        height: ${Math.round(n.height)},
        backgroundColor: '${ge.replace(/'/g,"\\'")}',
        globalFontFamily: '${U.replace(/'/g,"\\'")}',
        globalFontSize: ${Math.round(Z)},
        globalColor: '${de}',
      },
      backgroundUrl: ${p!=null&&p.backgroundFileName?`(() => { try { return require('./imgs/${p.backgroundFileName.replace(/'/g,"\\'")}'); } catch(e) { return './imgs/${p.backgroundFileName.replace(/'/g,"\\'")}'; } })()`:`'${k.replace(/'/g,"\\'")}'`},
      ${p!=null&&p.imageFileNames?`// 使用本地资源路径，动态映射不再需要
      images: {},`:`// 图片 src 动态映射，初始写入 base64（若存在），blob 留空待替换
      images: {},`}
      // 图表配置导出，键为元素ID或序号
      chartOptions: ${D},
      ${q?`// 数据库对象（按页面引用注入到 data）
${q}`:""}
      ${ae.length?`// 文本数据源映射（支持静态/动态）
      textSources: { ${ae.join(", ")} },`:""}
      ${$e.length?`// 文本效果参数映射（波形与倾斜跟随）
      textEffects: { ${$e.join(", ")} },`:""}
      ${P}
    };
  },
  computed: {
    containerStyle() {
      const base = {
        position: 'relative',
        width: this.config.width + 'px',
        height: this.config.height + 'px',
        fontFamily: this.config.globalFontFamily,
        fontSize: this.config.globalFontSize + 'px',
        color: this.config.globalColor,
        backgroundColor: this.config.backgroundColor || 'transparent',
      };
      if (this.backgroundUrl) {
        return Object.assign({}, base, {
          backgroundImage: 'url(' + this.backgroundUrl + ')',
          backgroundSize: 'cover',
          backgroundRepeat: 'no-repeat',
        });
      }
      return base;
    }
  },
  methods: {
    getByPath(obj, path) {
      try {
        const segs = String(path).split('.');
        return segs.reduce((acc, k) => (acc ? acc[k] : undefined), obj);
      } catch(e) {
        return undefined;
      }
    },
    getTextValue(id) {
      const srcMap = this.textSources || {};
      const src = srcMap[id];
      if (!src) return '';
      if (src.type === 'static') return String(src.text || '');
      const root = this[src.obj] || {};
      const v = this.getByPath(root, src.path);
      return v != null ? String(v) : '';
    },
    getTextPieces(id) {
      const text = this.getTextValue(id);
      const effMap = this.textEffects || {};
      const eff = effMap[id] || {};
      const orientation = eff.textOrientation || 'horizontal';
      const fontSize = Number(eff.fontSize || (this.config && this.config.globalFontSize) || 14);
      const letterSpacing = Number(eff.letterSpacing || 0);
      const step = fontSize * 0.6 + letterSpacing;

      const amp = eff.textWaveEnabled ? Number(eff.amplitude || 0) : 0;
      const freq = eff.textWaveEnabled ? Number(eff.frequency || 0) : 0;
      const phase = eff.textWaveEnabled ? Number(eff.phase || 0) : 0;

      const skewAngle = eff.skewFlowEnabled ? Number(eff.skewAngle || 0) : 0;
      const tan = Math.tan(skewAngle * Math.PI / 180);

      const pieces = [];
      for (let i = 0; i < text.length; i++) {
        const ch = text[i];
        const wave = amp ? amp * Math.sin(i * freq + phase) : 0;
        let dx = 0, dy = 0;
        if (orientation === 'horizontal') {
          dy += wave;
          dy += tan * step * i;
        } else {
          dx += wave;
          dx += tan * step * i;
        }
        const style = 'display:inline-block;white-space:pre;transform: translate(' + Math.round(dx) + 'px, ' + Math.round(dy) + 'px);';
        pieces.push({ char: ch, style });
      }
      return pieces;
    }${Be?`,
${Be}`:""}
  },
  mounted() {
    // 使用 npm 依赖的 echarts 初始化图表实例
    Object.keys(this.chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) {
        const inst = echarts.init(el);
        inst.setOption(this.chartOptions[id], true);
      }
    });
  }
};
<\/script>

${p!=null&&p.fontFaces&&p.fontFaces.length>0?`
<style>
${p.fontFaces.map(b=>`@font-face { font-family: '${b.family.replace(/'/g,"\\'")}'; src: url('./fonts/${b.file}'); font-weight: normal; font-style: normal; }`).join(`
`)}
</style>
`:""}
<style scoped>
.container { box-sizing: border-box; }
/* 文本对齐公共样式，减少重复的内联 CSS */
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${Q}
</style>
`}function Qr(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function xo(y){var h,C;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((h=n.backgroundGradient.colors)!=null&&h.length)){const V=n.backgroundGradient.angle||0,ae=n.backgroundGradient.colors[0]||"#000000",$e=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${V}deg, ${ae}, ${$e})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&((C=n.textGradient.colors)!=null&&C.length))){const V=n.textGradient.angle||0,ae=n.textGradient.colors[0]||"#000000",$e=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${V}deg, ${ae}, ${$e})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const p=y.eventBinding;return p&&p.enabled&&p.cursor&&e.push(`cursor:${p.cursor}`),e.join(";")}function _n(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function vo(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${_n(e)} }`)}function ho(y){const n=[],e=p=>{p.forEach(h=>{if((h.type==="group"||h.type==="container")&&Array.isArray(h.children))e(h.children);else{const C=(h.className||"").trim(),V=h.customClassCss?String(h.customClassCss).trim():"";if(!C||!V)return;/\{[^}]*\}/.test(V)?n.push(vo(V)):n.push(`.${C} { ${_n(V)} }`)}})};return e(y),n.join(`
`)}function Kn(y){const n=String(y||"").trim();if(!n)return"";let e=n.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(e[0]||"")||(e="_"+e),e}function wo(y,n){if(!y.hidden)return"";const e=Kn(y.hiddenLabel);return e?` ${n!=null&&n.useShow?"v-show":"v-if"}="${e}"`:""}function Ln(y,n,e,p){let h=0;const C=e.some(d=>d.type==="chart");function V(d,G){var P,Be,b,Y,oe;const R=xo(d),Q=d.zIndex||1,H=d.className&&d.className.trim()?` class="${d.className.trim()}"`:"",X=wo(d,{useShow:(p==null?void 0:p.hideDirective)==="show"}),Ee=d.eventBinding,q=Ee&&Ee.enabled&&Ee.handlerName?` @click="${String(Ee.handlerName)}($event)"`:"",D=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"";if((d.type==="group"||d.type==="container")&&Array.isArray(d.children)){const x=d.children.map((t,se)=>V(t,se)).join(`
        `);return`<div${H}${X}${q}${D} style="${R};z-index:${Q}">
        ${x}
      </div>`}if(d.type==="text"){const x=Qr(d.text||"");return`<div${H}${X}${q} style="${R};z-index:${Q}">${x}</div>`}if(d.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[d.id]){const x=p.imageFileMap[d.id],t=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"";return`<img${H}${t}${X}${q} :src="assetUrl('./imgs/${x}')" style="${R};z-index:${Q}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[h]){const x=p.imageFileNames[h++],t=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"";return`<img${H}${t}${X}${q} :src="assetUrl('./imgs/${x}')" style="${R};z-index:${Q}" alt="" />`}return`<div${H}${X}${q} style="${R};z-index:${Q}"></div>`}if(d.type==="line"){const x=d.style||{},t=x.lineColor||"#ffffff",se=(P=x.lineThickness)!=null?P:2,te=x.lineOrientation||"horizontal",lt=x.lineStyle==="dashed",He=(Be=x.lineDashLength)!=null?Be:6,We=(b=x.lineDashGap)!=null?b:4,Ye=Math.max(1,Math.round((Y=d.width)!=null?Y:te==="horizontal"?200:2)),_e=Math.max(1,Math.round((oe=d.height)!=null?oe:te==="horizontal"?2:200)),at=Math.round(_e/2),vt=Math.round(Ye/2),ht=lt?` stroke-dasharray="${He} ${We}"`:"";return te==="horizontal"?`<svg${H}${X}${q} viewBox="0 0 ${Ye} ${_e}" preserveAspectRatio="none" style="${R};z-index:${Q}"><line x1="0" y1="${at}" x2="${Ye}" y2="${at}" stroke="${t}" stroke-width="${se}"${ht} fill="none" /></svg>`:`<svg${H}${X}${q} viewBox="0 0 ${Ye} ${_e}" preserveAspectRatio="none" style="${R};z-index:${Q}"><line x1="${vt}" y1="0" x2="${vt}" y2="${_e}" stroke="${t}" stroke-width="${se}"${ht} fill="none" /></svg>`}if(d.type==="chart"){const x=d.elementId&&d.elementId.trim()?d.elementId.trim():`chart_${G}`,t=Qr(d.text||"chart");return`<div${H}${X}${q} id="${x}" style="${R};z-index:${Q}">${t}</div>`}return`<div${H}${X}${q} style="${R};z-index:${Q}">${Qr(d.text||"")}</div>`}const ae=e.map((d,G)=>V(d,G)).join(`
      `),$e=ho(e),k=n.backgroundUrl||"",ge=n.backgroundColor||"transparent",U=n.globalFontFamily||"",Z=n.globalFontSize||14,de=n.globalColor||"#000000",_=(()=>{const d=[];let G=0;return e.forEach(R=>{if(R.type==="chart"){const Q=R.elementId&&R.elementId.trim()?R.elementId.trim():`chart_${G}`;G++;const H=R.chartOption||{};try{d.push(`'${Q.replace(/'/g,"\\'")}' : ${JSON.stringify(H)}`)}catch{d.push(`'${Q.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${d.join(", ")} }`})(),E=(()=>{const d=new Set;return e.forEach(G=>{const R=String(G.hiddenLabel||"").trim(),Q=Kn(R),H=!!G.hidden;Q&&H&&d.add(Q)}),Array.from(d).map(G=>`const ${G} = ref(false)`).join(`
`)})();return`
<template>
  <div class="container" :style="containerStyle">
    ${ae}
  </div>
</template>

<script setup lang="ts">
import { onMounted, ref, computed } from 'vue'
${C?`import * as echarts from 'echarts'
`:""}
function assetUrl(p: string): string { try { return new URL(p, import.meta.url).href } catch { return p } }
const config = {
  width: ${Math.round(n.width)},
  height: ${Math.round(n.height)},
  backgroundColor: '${ge.replace(/'/g,"\\'")}',
  globalFontFamily: '${U.replace(/'/g,"\\'")}',
  globalFontSize: ${Math.round(Z)},
  globalColor: '${de}',
}
const backgroundUrl: string = ${p!=null&&p.backgroundFileName?`assetUrl('./imgs/${String(p.backgroundFileName).replace(/'/g,"\\'")}')`:`'${k.replace(/'/g,"\\'")}'`}
const images: Record<string, string> = {}
${C?`const chartOptions: Record<string, any> = ${_}`:""}
${E?`${E}
`:""}
const containerStyle = computed(() => {
  const base: Record<string, string> = {
    position: 'relative',
    width: config.width + 'px',
    height: config.height + 'px',
    fontFamily: config.globalFontFamily,
    fontSize: config.globalFontSize + 'px',
    color: config.globalColor,
    backgroundColor: (config.backgroundColor || 'transparent') as string,
  }
  if (backgroundUrl) {
    return Object.assign({}, base, {
      backgroundImage: 'url(' + backgroundUrl + ')',
      backgroundSize: 'cover',
      backgroundRepeat: 'no-repeat',
    }) as Record<string, string>
  }
  return base
})
// 事件处理函数
${(()=>{const d=new Map,G=R=>{R.forEach(Q=>{const H=Q.eventBinding;H&&H.enabled&&H.handlerName&&d.set(String(H.handlerName),String(H.code||"")),Array.isArray(Q.children)&&G(Q.children)})};return G(e),Array.from(d.entries()).map(([R,Q])=>`function ${R}(e: MouseEvent){
${Q}
}`).join(`
`)})()}
${C?`onMounted(() => {
  Object.keys(chartOptions || {}).forEach((id) => {
    const el = document.getElementById(id)
    if (el && (echarts as any)) { const inst = (echarts as any).init(el); inst.setOption((chartOptions as any)[id], true) }
  })
})`:""}
<\/script>

<style scoped>
.container { box-sizing: border-box; }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${$e}
</style>
`}function yr(y){return String(y).replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function $o(y){const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||y.x||0)}px`),e.push(`top:${Math.round(y.top||y.y||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&n.backgroundGradient.colors&&n.backgroundGradient.colors.length){const h=n.backgroundGradient.angle||0,C=n.backgroundGradient.colors[0]||"#000000",V=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${h}deg, ${C}, ${V})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&n.textGradient.colors&&n.textGradient.colors.length)){const h=n.textGradient.angle||0,C=n.textGradient.colors[0]||"#000000",V=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${h}deg, ${C}, ${V})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const p=y.eventBinding;return p&&p.enabled&&p.cursor&&e.push(`cursor:${p.cursor}`),y.hidden&&e.push("display:none"),e.join(";")}function Zn(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function Eo(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Zn(e)} }`)}function ko(y){const n=[],e=p=>{p.forEach(h=>{if((h.type==="group"||h.type==="container")&&Array.isArray(h.children))e(h.children);else{const C=(h.className||"").trim(),V=h.customClassCss?String(h.customClassCss).trim():"";if(!C||!V)return;/\{[^}]*\}/.test(V)?n.push(Eo(V)):n.push(`.${C} { ${Zn(V)} }`)}})};return e(y),n.join(`
`)}function Vn(y,n,e,p){function h(d){for(const G of d)if((G.type==="group"||G.type==="container")&&Array.isArray(G.children)){if(h(G.children))return!0}else if(G.type==="chart")return!0;return!1}const C=h(e),V=n.backgroundUrl||"",ae=p!=null&&p.backgroundFileName?`background-image:url('./imgs/${p.backgroundFileName}');background-size:cover;background-repeat:no-repeat;`:V?`background-image:url('${V}');background-size:cover;background-repeat:no-repeat;`:"";let $e=0;const k={};(function(G){let R=0;const Q=H=>{H.forEach(X=>{if((X.type==="group"||X.type==="container")&&Array.isArray(X.children))Q(X.children);else if(X.type==="chart"){const Ee=X.elementId&&String(X.elementId).trim()?String(X.elementId).trim():`chart_${R++}`;k[X.id]=Ee}})};Q(G)})(e);function ge(d){var q,D,P,Be,b;const G=$o(d),R=d.zIndex||1,Q=d.className&&d.className.trim()?` class="${d.className.trim()}"`:"",H=d.eventBinding,X=H&&H.enabled&&H.handlerName?` onclick="${String(H.handlerName)}(event)"`:"",Ee=d.elementId&&d.elementId.trim()?` id="${d.elementId.trim()}"`:"";if((d.type==="group"||d.type==="container")&&Array.isArray(d.children)&&d.children.length>0){const Y=d.children.map(oe=>ge(oe)).join(`
        `);return`<div${Q}${X}${Ee} style="${G};z-index:${R}">
        ${Y}
      </div>`}if(d.type==="text"){const Y=(d.style||{}).textAlign||"left",oe=Y==="center"?"text-flex-center":Y==="right"?"text-flex-right":"text-flex-left",x=[(d.className||"").trim(),oe].filter(Boolean).join(" ");return`<div${x?` class="${x}"`:""}${X} style="${G};z-index:${R}">${yr(d.text||"")}</div>`}if(d.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[d.id]){const Y=p.imageFileMap[d.id];return`<img${Q}${X} src="./imgs/${Y}" style="${G};z-index:${R}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[$e]){const Y=p.imageFileNames[$e++];return`<img${Q}${X} src="./imgs/${Y}" style="${G};z-index:${R}" alt="" />`}return`<div${Q}${X} style="${G};z-index:${R}"></div>`}if(d.type==="line"){const Y=d.style||{},oe=Y.lineColor||"#ffffff",x=(q=Y.lineThickness)!=null?q:2,t=Y.lineOrientation||"horizontal",se=Y.lineStyle==="dashed",te=(D=Y.lineDashLength)!=null?D:6,lt=(P=Y.lineDashGap)!=null?P:4,He=Math.max(1,Math.round((Be=d.width)!=null?Be:t==="horizontal"?200:2)),We=Math.max(1,Math.round((b=d.height)!=null?b:t==="horizontal"?2:200)),Ye=Math.round(We/2),_e=Math.round(He/2),at=se?` stroke-dasharray="${te} ${lt}"`:"";return t==="horizontal"?`<svg${Q}${X} viewBox="0 0 ${He} ${We}" preserveAspectRatio="none" style="${G};z-index:${R}"><line x1="0" y1="${Ye}" x2="${He}" y2="${Ye}" stroke="${oe}" stroke-width="${x}"${at} fill="none" /></svg>`:`<svg${Q}${X} viewBox="0 0 ${He} ${We}" preserveAspectRatio="none" style="${G};z-index:${R}"><line x1="${_e}" y1="0" x2="${_e}" y2="${We}" stroke="${oe}" stroke-width="${x}"${at} fill="none" /></svg>`}if(d.type==="chart"){const Y=k[d.id]||String(d.elementId||"");return`<div${Q}${X} id="${Y}" style="${G};z-index:${R}">${yr(d.text||"chart")}</div>`}return d.type==="container"?`<div${Q}${X} style="${G};z-index:${R}">${yr(d.text||"")}</div>`:`<div${Q}${X} style="${G};z-index:${R}">${yr(d.text||"")}</div>`}const U=e.map(d=>ge(d)).join(`
      `),Z=ko(e),de=p!=null&&p.fontFaces&&p.fontFaces.length>0?p.fontFaces.map(d=>`@font-face { font-family: '${String(d.family).replace(/'/g,"\\'")}'; src: url('./fonts/${String(d.file)}'); font-weight: normal; font-style: normal; }`).join(`
`):"";function _(d,G){d.forEach(R=>{if((R.type==="group"||R.type==="container")&&Array.isArray(R.children))_(R.children,G);else if(R.type==="chart"){const Q=k[R.id]||String(R.elementId||"");try{G.push(`chartOptions['${Q.replace(/'/g,"\\'")}'] = ${JSON.stringify(R.chartOption||{})};`)}catch{G.push(`chartOptions['${Q.replace(/'/g,"\\'")}'] = {};`)}}})}const E=C?`
    (function(){
      var chartOptions = {};
      ${(()=>{const d=[];return _(e,d),d.join(`
      `)})()}
      Object.keys(chartOptions).forEach(function(id){
        var el = document.getElementById(id);
        if (el && window.echarts) { var inst = window.echarts.init(el); inst.setOption(chartOptions[id], true); }
      });
    })();
  `:"";return`<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>${yr(y)}</title>
<style>
.container { position:relative; width:${Math.round(n.width)}px; height:${Math.round(n.height)}px; font-family:${String(n.globalFontFamily||"").replace(/'/g,"\\'")}; font-size:${Math.round(n.globalFontSize)}px; color:${String(n.globalColor)}; background-color:${String(n.backgroundColor||"transparent")}; ${ae} }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${de}
${Z}
</style>
${C?'<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"><\/script>':""}
</head>
<body>
<div class="container">
  ${U}
</div>
<script>
${(()=>{const d=new Map,G=R=>{R.forEach(Q=>{const H=Q.eventBinding;H&&H.enabled&&H.handlerName&&d.set(String(H.handlerName),String(H.code||"")),Array.isArray(Q.children)&&G(Q.children)})};return G(e),Array.from(d.entries()).map(([R,Q])=>`function ${R}(event){
${Q}
}`).join(`
`)})()}
${E}
<\/script>
</body>
</html>`}function Xr(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Rn(y){var p,h;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((p=n.backgroundGradient.colors)!=null&&p.length)){const C=n.backgroundGradient.angle||0,V=n.backgroundGradient.colors[0]||"#000000",ae=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${C}deg, ${V}, ${ae})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&((h=n.textGradient.colors)!=null&&h.length))){const C=n.textGradient.angle||0,V=n.textGradient.colors[0]||"#000000",ae=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${C}deg, ${V}, ${ae})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}return y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),y.hidden&&e.push("display:none"),e.join(";")}function Qn(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function So(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Qn(e)} }`)}function Mo(y){const n=[],e=p=>{p.forEach(h=>{if((h.type==="group"||h.type==="container")&&Array.isArray(h.children))e(h.children);else{const C=(h.className||"").trim(),V=h.customClassCss?String(h.customClassCss).trim():"";if(!C||!V)return;/\{[^}]*\}/.test(V)?n.push(So(V)):n.push(`.${C} { ${Qn(V)} }`)}})};return e(y),n.join(`
`)}function Pn(y,n,e,p){const h=e.some(U=>U.type==="chart");let C=0;const V=e.map((U,Z)=>{var d,G,R,Q,H;const de=Rn(U),_=U.zIndex||1,E=U.className&&U.className.trim()?` class="${U.className.trim()}"`:"";if((U.type==="group"||U.type==="container")&&Array.isArray(U.children)){const X=U.children.map(q=>{const D=Rn(q),P=q.zIndex||1,Be=q.className&&q.className.trim()?` class="${q.className.trim()}"`:"",b=q.elementId&&q.elementId.trim()?` id="${q.elementId.trim()}"`:"";if(q.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[q.id]){const Y=p.imageFileMap[q.id];return`<img${Be}${b} src="/imgs/${Y}" style="${D};z-index:${P}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[C]){const Y=p.imageFileNames[C++];return`<img${Be}${b} src="/imgs/${Y}" style="${D};z-index:${P}" alt="" />`}}return`<div${Be}${b} style="${D};z-index:${P}">${Xr(q.text||"")}</div>`}).join(`
        `),Ee=U.elementId&&U.elementId.trim()?` id="${U.elementId.trim()}"`:"";return`<div${E}${Ee} style="${de};z-index:${_}">${X}</div>`}if(U.type==="text")return`<div${E} style="${de};z-index:${_}">${Xr(U.text||"")}</div>`;if(U.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[U.id]){const X=p.imageFileMap[U.id];return`<img${E} src="/imgs/${X}" style="${de};z-index:${_}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[C]){const X=p.imageFileNames[C++];return`<img${E} src="/imgs/${X}" style="${de};z-index:${_}" alt="" />`}return`<div${E} style="${de};z-index:${_}"></div>`}if(U.type==="line"){const X=U.style||{},Ee=X.lineColor||"#ffffff",q=(d=X.lineThickness)!=null?d:2,D=X.lineOrientation||"horizontal",P=X.lineStyle==="dashed",Be=(G=X.lineDashLength)!=null?G:6,b=(R=X.lineDashGap)!=null?R:4,Y=Math.max(1,Math.round((Q=U.width)!=null?Q:D==="horizontal"?200:2)),oe=Math.max(1,Math.round((H=U.height)!=null?H:D==="horizontal"?2:200)),x=Math.round(oe/2),t=Math.round(Y/2),se=P?` stroke-dasharray="${Be} ${b}"`:"";return D==="horizontal"?`<svg${E} viewBox="0 0 ${Y} ${oe}" preserveAspectRatio="none" style="${de};z-index:${_}"><line x1="0" y1="${x}" x2="${Y}" y2="${x}" stroke="${Ee}" stroke-width="${q}"${se} fill="none" /></svg>`:`<svg${E} viewBox="0 0 ${Y} ${oe}" preserveAspectRatio="none" style="${de};z-index:${_}"><line x1="${t}" y1="0" x2="${t}" y2="${oe}" stroke="${Ee}" stroke-width="${q}"${se} fill="none" /></svg>`}if(U.type==="chart"){const X=U.elementId&&U.elementId.trim()?U.elementId.trim():`chart_${Z}`;return`<div${E} id="${X}" style="${de};z-index:${_}">${Xr(U.text||"chart")}</div>`}return`<div${E} style="${de};z-index:${_}">${Xr(U.text||"")}</div>`}).join(`
      `),ae=Mo(e),$e=p!=null&&p.fontFaces&&p.fontFaces.length>0?p.fontFaces.map(U=>`@font-face { font-family: '${U.family.replace(/'/g,"\\'")}'; src: url('/fonts/${U.file}'); font-weight: normal; font-style: normal; }`).join(`
`):"",k=(()=>{const U=[];return e.forEach((Z,de)=>{if(Z.type==="chart"){const _=Z.elementId&&Z.elementId.trim()?Z.elementId.trim():`chart_${de}`,E=Z.chartOption||{};try{U.push(`'${_.replace(/'/g,"\\'")}' : ${JSON.stringify(E)}`)}catch{U.push(`'${_.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${U.join(", ")} }`})(),ge=p!=null&&p.backgroundFileName?`'/imgs/${String(p.backgroundFileName).replace(/'/g,"\\'")}'`:`'${(n.backgroundUrl||"").replace(/'/g,"\\'")}'`;return`import React, { useEffect } from 'react';
${h?`import * as echarts from 'echarts';
`:""}
export default function ${y.replace(/[^A-Za-z0-9_]/g,"_")}() {
  const config = { width: ${Math.round(n.width)}, height: ${Math.round(n.height)}, backgroundColor: '${(n.backgroundColor||"transparent").replace(/'/g,"\\'")}', globalFontFamily: '${(n.globalFontFamily||"").replace(/'/g,"\\'")}', globalFontSize: ${Math.round(n.globalFontSize)}, globalColor: '${n.globalColor}' };
  const backgroundUrl = ${ge};
  ${h?`const chartOptions = ${k};
  useEffect(() => {
    Object.keys(chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) { const inst = echarts.init(el); inst.setOption(chartOptions[id], true); }
    });
  }, []);
`:""}  const containerStyle = { position:'relative', width: config.width + 'px', height: config.height + 'px', fontFamily: config.globalFontFamily, fontSize: config.globalFontSize + 'px', color: config.globalColor, backgroundColor: config.backgroundColor, ...(backgroundUrl ? { backgroundImage: 'url(' + backgroundUrl + ')', backgroundSize: 'cover', backgroundRepeat: 'no-repeat' } : {}) };
  return (
    <div className="container" style={containerStyle}>
      <style>{\`.text-flex-left{display:flex;align-items:center;justify-content:flex-start}.text-flex-center{display:flex;align-items:center;justify-content:center}.text-flex-right{display:flex;align-items:center;justify-content:flex-end${$e?"\\n"+$e:""}${ae?"\\n"+ae:""}\`}</style>
      <div dangerouslySetInnerHTML={{ __html: \`${V.replace(/`/g,"\\`")}\` }} />
    </div>
  );
}
`}var Hn=Jn(no()),Co=["placeholder"],No={key:0,class:"absolute z-10 bg-gray-900 border border-gray-700 rounded w-full mt-1 max-h-40 overflow-auto shadow custom-scrollbar"},Io=["onMousedown"],Ao={key:0,class:"px-2 py-2 text-xs text-gray-400"},Fo=Mt({__name:"SearchableSelect",props:{modelValue:{},options:{},placeholder:{},numeric:{type:Boolean}},emits:["update:modelValue"],setup(y,{emit:n}){const e=y,p=n,h=we(!1),C=we(""),V=we(null),ae=we("");let $e=null;const k=we(!1);mt(()=>e.modelValue,H=>{H==null?C.value="":C.value=String(H)},{immediate:!0});const ge=Re(()=>e.options.map(H=>String(H))),U=Re(()=>{const H=ae.value.trim().toLowerCase();return H?ge.value.filter(X=>X.toLowerCase().includes(H)):ge.value});function Z(H){C.value=H;const X=e.numeric?Number(H):H;p("update:modelValue",X),h.value=!1}function de(){const H=C.value.trim();if(!H){p("update:modelValue",(e.numeric,null)),h.value=!1;return}const X=e.numeric?Number(H):H;p("update:modelValue",X),h.value=!1}function _(){k.value=!1,h.value=!0,G(C.value)}function E(){}function d(H){H.key==="Enter"&&de()}function G(H){$e&&window.clearTimeout($e),$e=window.setTimeout(()=>{ae.value=H},180)}function R(){k.value=!0,h.value=!0,G(C.value)}function Q(H){V.value&&(V.value.contains(H.target)||(h.value=!1))}return el(()=>{window.addEventListener("click",Q),ae.value=C.value}),tl(()=>{window.removeEventListener("click",Q),$e&&window.clearTimeout($e)}),(H,X)=>(j(),O("div",{class:"relative",ref_key:"root",ref:V},[ye(r("input",{class:"border border-gray-700 bg-gray-900 text-gray-100 rounded w-full px-2 py-1",placeholder:y.placeholder||"搜索选择或直接输入","onUpdate:modelValue":X[0]||(X[0]=Ee=>C.value=Ee),onInput:R,onFocus:_,onBlur:E,onKeydown:d},null,40,Co),[[ke,C.value]]),h.value?(j(),O("div",No,[(j(!0),O(At,null,Lt(U.value,Ee=>(j(),O("div",{key:Ee,class:"px-2 py-1 hover:bg-gray-700 cursor-pointer text-sm text-gray-100",onMousedown:Xn(q=>Z(Ee),["prevent"])},Qe(Ee),41,Io))),128)),U.value.length===0?(j(),O("div",Ao,"无匹配项，回车使用当前输入")):ee("",!0)])):ee("",!0)],512))}}),yt=Fo,jo={class:"space-y-3"},zo={class:"flex items-center justify-between"},Oo={class:"inline-flex items-center cursor-pointer"},Bo={class:"flex items-center justify-between"},Do={class:"inline-flex items-center cursor-pointer"},To=Mt({__name:"CanvasSettingsPanel",props:{spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean}},emits:["update:spacingEnabled","update:alignmentEnabled"],setup(y,{emit:n}){const e=y,p=n,h=Re({get:()=>e.spacingEnabled,set:V=>p("update:spacingEnabled",V)}),C=Re({get:()=>e.alignmentEnabled,set:V=>p("update:alignmentEnabled",V)});return(V,ae)=>(j(),O("div",jo,[ae[6]||(ae[6]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"辅助间距",-1)),r("div",zo,[ae[3]||(ae[3]=r("label",{class:"text-xs text-gray-400"},"显示间距标注",-1)),r("label",Oo,[ye(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":ae[0]||(ae[0]=$e=>h.value=$e)},null,512),[[_r,h.value]]),ae[2]||(ae[2]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:je(["ml-3 text-xs",h.value?"text-cyan-300":"text-gray-300"])},Qe(h.value?"已开启":"已关闭"),3)])]),r("div",Bo,[ae[5]||(ae[5]=r("label",{class:"text-xs text-gray-400"},"显示对齐参考线",-1)),r("label",Do,[ye(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":ae[1]||(ae[1]=$e=>C.value=$e)},null,512),[[_r,C.value]]),ae[4]||(ae[4]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:je(["ml-3 text-xs",C.value?"text-cyan-300":"text-gray-300"])},Qe(C.value?"已开启":"已关闭"),3)])])]))}}),Go=To,Uo={class:"space-y-3"},Lo={key:0,class:"text-sm text-gray-400"},Vo={key:1,class:"space-y-2"},Ro=Mt({__name:"LayersList",props:{elements:{},selectedId:{}},emits:["select","reorderTop"],setup(y,{emit:n}){const e=y,p=n,h=Re(()=>e.elements),C=we({});function V(_){C.value[_]=!C.value[_]}function ae(_){const E=_.children;return Array.isArray(E)&&E.length>0}function $e(_){const E=_.children;return Array.isArray(E)?E:[]}const k=we(null),ge=we(null);function U(_){const E=(_.elementId||"").trim(),d=(_.className||"").trim(),G=(_.text||"").trim();return E||d||G||_.id}function Z(_){const E=String(_.type||"").toLowerCase();return E==="text"?{label:"文本",cls:"bg-blue-600/30 text-blue-200"}:E==="arc-text"?{label:"环绕",cls:"bg-cyan-600/30 text-cyan-200"}:E==="image"?{label:"图片",cls:"bg-emerald-600/30 text-emerald-200"}:E==="chart"?{label:"图表",cls:"bg-orange-600/30 text-orange-200"}:E==="line"?{label:"线条",cls:"bg-slate-600/30 text-slate-200"}:E==="container"?{label:"容器",cls:"bg-cyan-600/30 text-cyan-200"}:E==="group"?{label:"分组",cls:"bg-purple-600/30 text-purple-200"}:{label:"元素",cls:"bg-gray-600/30 text-gray-200"}}const de=Mt({name:"LayerNode",props:{node:{type:Object,required:!0},selectedId:{type:String,default:null},depth:{type:Number,default:0},index:{type:Number,default:-1}},emits:["select","reorderTop"],setup(_,{emit:E}){return()=>{const d=_.node,G=_.depth===0,R=d.id===_.selectedId,Q=Z(d),H=St("div",{class:"flex items-center gap-2"},[G&&_.index>=0?St("span",{class:"px-1.5 py-0.5 text-[10px] rounded bg-cyan-600/30 text-cyan-200"},String(_.index+1)):null,ae(d)?St("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:q=>{q.stopPropagation(),V(d.id)},title:C.value[d.id]?"收起":"展开"},C.value[d.id]?"▼":"▶"):null,St("span",{class:`px-1.5 py-0.5 text-[10px] rounded ${Q.cls}`},Q.label),St("span",{class:"text-left text-sm text-gray-100 truncate whitespace-nowrap max-w-[180px]",title:U(d)},U(d))]),X=St("div",{class:["bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2 cursor-grab hover:bg-gray-700/60 transition-colors",R?"ring-2 ring-cyan-400/40 bg-gray-700/70":"",G&&ge.value===_.index?"border-purple-400":"",_.depth>0?"ml-3":""].filter(Boolean).join(" "),onClick:()=>E("select",d.id),draggable:G?!0:void 0,onDragstart:q=>{G&&(k.value=_.index,q.target.classList.add("cursor-grabbing"))},onDragover:q=>{G&&(q.preventDefault(),ge.value=_.index)},onDragenter:()=>{G&&(ge.value=_.index)},onDrop:q=>{if(!G)return;q.preventDefault();const D=k.value,P=_.index;k.value=null,ge.value=null,typeof D=="number"&&typeof P=="number"&&D!==P&&E("reorderTop",{from:D,to:P})},onDragend:q=>{k.value=null,ge.value=null,q.target.classList.remove("cursor-grabbing")}},[H,null]),Ee=C.value[d.id]&&ae(d)?St("div",{class:"mt-2 space-y-2 pl-3"},[...$e(d)].map(q=>St(de,{node:q,selectedId:_.selectedId,depth:_.depth+1,index:-1,onSelect:D=>E("select",D)}))):null;return St("div",{},[X,Ee])}}});return(_,E)=>(j(),O("div",Uo,[E[2]||(E[2]=r("div",{class:"text-xs text-gray-400"},"所有元素按层叠从上到下显示，支持展开分组/容器",-1)),h.value.length===0?(j(),O("div",Lo,"暂无元素")):(j(),O("div",Vo,[(j(!0),O(At,null,Lt(h.value,(d,G)=>(j(),Kr(qn(de),{key:d.id,node:d,selectedId:y.selectedId,depth:0,index:G,onSelect:E[0]||(E[0]=R=>p("select",R)),onReorderTop:E[1]||(E[1]=R=>p("reorderTop",R))},null,8,["node","selectedId","index"]))),128))]))]))}}),Po=Ro,Ho={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},Wo={class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Jo={class:"flex items-center gap-2"},qo={key:0,class:"space-y-2"},Xo={key:1,class:"space-y-2"},Yo={class:"grid grid-cols-2 gap-2"},_o={key:2,class:"space-y-2"},Ko={class:"flex gap-2"},Zo={key:3,class:"space-y-2"},Qo={class:"flex gap-2"},es=["value"],ts={key:4,class:"space-y-3"},rs={class:"space-y-2"},ls={class:"space-y-2"},ns={class:"space-y-2"},os={key:6,class:"space-y-2 pt-4 border-t border-cyan-500/30"},ss={class:"relative"},as={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},is={class:"relative w-[520px] max-w-[90vw] p-4 bg-gray-900/95 backdrop-blur-md border border-emerald-500/40 rounded-xl shadow-2xl"},ds={class:"flex items-center justify-between mb-3"},us={class:"grid grid-cols-2 gap-2"},cs={key:7,class:"space-y-3"},ps=Mt({__name:"CanvasSidebar",props:{exportName:{},config:{},fontLibrary:{},spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean},elements:{},selectedId:{}},emits:["update:exportName","update:configWidth","update:configHeight","update:backgroundColor","update:globalFontFamily","update:globalFontSize","update:globalColor","update:spacingEnabled","update:alignmentEnabled","backgroundFileChange","openPreview","downloadByFormat","downloadAllFormats","resetCanvas","selectElement","moveElementUp","moveElementDown","moveElementTop","moveElementBottom","reorderTopElements"],setup(y,{emit:n}){const e=y,p=n,h=Re({get:()=>e.exportName,set:q=>p("update:exportName",q)}),C=Re({get:()=>e.config.width,set:q=>p("update:configWidth",q)}),V=Re({get:()=>e.config.height,set:q=>p("update:configHeight",q)}),ae=Re({get:()=>e.config.backgroundColor||"",set:q=>p("update:backgroundColor",q)}),$e=Re({get:()=>e.config.globalFontFamily||"",set:q=>p("update:globalFontFamily",q)}),k=Re({get:()=>e.config.globalFontSize||14,set:q=>p("update:globalFontSize",q)}),ge=Re({get:()=>e.config.globalColor||"#ffffff",set:q=>p("update:globalColor",q)}),U=Re({get:()=>e.spacingEnabled,set:q=>p("update:spacingEnabled",q)}),Z=Re({get:()=>e.alignmentEnabled,set:q=>p("update:alignmentEnabled",q)});function de(q){try{return String(q||"#000000")}catch{return"#000000"}}const _=Re({get:()=>E.value,set:q=>E.value=q}),E=we(!1),d=we("settings");function G(q){p("backgroundFileChange",q)}function R(){p("openPreview")}function Q(){E.value=!E.value}function H(q){p("downloadByFormat",q),E.value=!1}function X(){p("downloadAllFormats"),E.value=!1}function Ee(){p("resetCanvas")}return(q,D)=>(j(),O("div",Ho,[D[31]||(D[31]=r("div",{class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),mr(" 画布设置 ")])],-1)),r("div",Wo,[r("div",Jo,[r("button",{class:je(["px-3 py-1 text-xs rounded bg-gradient-to-r from-cyan-600 to-blue-600 text-white",d.value==="settings"?"":"opacity-50"]),onClick:D[0]||(D[0]=P=>d.value="settings")},"设置",2),r("button",{class:je(["px-3 py-1 text-xs rounded bg-gradient-to-r from-purple-600 to-pink-600 text-white",d.value==="layers"?"":"opacity-50"]),onClick:D[1]||(D[1]=P=>d.value="layers")},"容器层级",2)]),d.value==="settings"?(j(),O("div",qo,[D[21]||(D[21]=r("label",{class:"block text-sm font-medium text-cyan-300"},"组件名称",-1)),ye(r("input",{"onUpdate:modelValue":D[2]||(D[2]=P=>h.value=P),class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"GeneratedComponent"},null,512),[[ke,h.value]])])):ee("",!0),d.value==="settings"?(j(),O("div",Xo,[D[22]||(D[22]=r("label",{class:"block text-sm font-medium text-cyan-300"},"画布尺寸",-1)),r("div",Yo,[ye(r("input",{"onUpdate:modelValue":D[3]||(D[3]=P=>C.value=P),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"宽度"},null,512),[[ke,C.value,void 0,{number:!0}]]),ye(r("input",{"onUpdate:modelValue":D[4]||(D[4]=P=>V.value=P),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"高度"},null,512),[[ke,V.value,void 0,{number:!0}]])])])):ee("",!0),d.value==="settings"?(j(),O("div",_o,[D[23]||(D[23]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景图片",-1)),r("div",Ko,[r("input",{type:"file",onChange:G,accept:"image/*",class:"flex-1 text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-cyan-600 file:text-white hover:file:bg-cyan-500 file:cursor-pointer"},null,32)])])):ee("",!0),d.value==="settings"?(j(),O("div",Zo,[D[24]||(D[24]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景颜色",-1)),r("div",Qo,[r("input",{value:de(ae.value),type:"color",onInput:D[5]||(D[5]=P=>p("update:backgroundColor",P.target.value)),class:"w-16 h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,40,es),ye(r("input",{"onUpdate:modelValue":D[6]||(D[6]=P=>ae.value=P),type:"text",class:"flex-1 px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"#000000 或 rgba(...)"},null,512),[[ke,ae.value]])])])):ee("",!0),d.value==="settings"?(j(),O("div",ts,[D[28]||(D[28]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"全局字体设置",-1)),r("div",rs,[D[25]||(D[25]=r("label",{class:"block text-xs text-gray-400"},"字体族",-1)),rt(yt,{options:y.fontLibrary,modelValue:$e.value,"onUpdate:modelValue":D[7]||(D[7]=P=>$e.value=P),placeholder:"选择字体"},null,8,["options","modelValue"])]),r("div",ls,[D[26]||(D[26]=r("label",{class:"block text-xs text-gray-400"},"字号 (px)",-1)),ye(r("input",{"onUpdate:modelValue":D[8]||(D[8]=P=>k.value=P),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-cyan-500/30 rounded text-gray-100 text-sm focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[ke,k.value,void 0,{number:!0}]])]),r("div",ns,[D[27]||(D[27]=r("label",{class:"block text-xs text-gray-400"},"颜色",-1)),ye(r("input",{"onUpdate:modelValue":D[9]||(D[9]=P=>ge.value=P),type:"color",class:"w-full h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,512),[[ke,ge.value]])])])):ee("",!0),d.value==="settings"?(j(),Kr(Go,{key:5,spacingEnabled:U.value,alignmentEnabled:Z.value,"onUpdate:spacingEnabled":D[10]||(D[10]=P=>U.value=P),"onUpdate:alignmentEnabled":D[11]||(D[11]=P=>Z.value=P)},null,8,["spacingEnabled","alignmentEnabled"])):ee("",!0),d.value==="settings"?(j(),O("div",os,[r("button",{onClick:R,class:"w-full px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"},"预览（新窗口）"),r("div",ss,[r("button",{onClick:Q,class:"w-full px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},"导出"),_.value?(j(),O("div",as,[r("div",{class:"absolute inset-0 bg-black/60",onClick:D[12]||(D[12]=P=>_.value=!1)}),r("div",is,[r("div",ds,[D[29]||(D[29]=r("h3",{class:"text-sm font-medium text-emerald-300"},"选择导出格式",-1)),r("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:D[13]||(D[13]=P=>_.value=!1)},"关闭")]),r("div",us,[r("button",{onClick:D[14]||(D[14]=P=>H("vue2")),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded"},"Vue2 组件"),r("button",{onClick:D[15]||(D[15]=P=>H("vue3")),class:"px-3 py-2 text-xs bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-500 hover:to-cyan-500 text-white rounded"},"Vue3 组件"),r("button",{onClick:D[16]||(D[16]=P=>H("react")),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"React 组件"),r("button",{onClick:D[17]||(D[17]=P=>H("html")),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded"},"纯 HTML 页面"),r("button",{onClick:D[18]||(D[18]=P=>X()),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded col-span-2"},"一键导出（全部）")])])])):ee("",!0)]),r("button",{onClick:Ee,class:"w-full px-4 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"清空画布")])):ee("",!0),d.value==="layers"?(j(),O("div",cs,[D[30]||(D[30]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器层级",-1)),rt(Po,{elements:e.elements||[],selectedId:e.selectedId||null,onSelect:D[19]||(D[19]=P=>p("selectElement",P)),onReorderTop:D[20]||(D[20]=P=>p("reorderTopElements",P))},null,8,["elements","selectedId"])])):ee("",!0)])]))}}),gs=ps,Wn=Jn(ao()),fs={class:"relative w-full"},ys=Mt({__name:"CssEditor",props:{modelValue:{},height:{},debounceMs:{}},emits:["update:modelValue"],setup(y,{emit:n}){const e=y,p=n,h=we(e.modelValue||"");let C=null;const V=typeof e.debounceMs=="number"?Math.max(0,e.debounceMs):250;mt(()=>e.modelValue,U=>{C&&(clearTimeout(C),C=null);const Z=U||"";Z!==h.value&&(h.value=Z)}),mt(h,U=>{C&&clearTimeout(C),C=window.setTimeout(()=>{p("update:modelValue",U),C=null},V)}),tl(()=>{C&&(clearTimeout(C),C=null)});function ae(){const U=h.value||"";if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText(U).catch(()=>{try{const Z=document.createElement("textarea");Z.value=U,document.body.appendChild(Z),Z.select(),document.execCommand("copy"),document.body.removeChild(Z)}catch{}});else try{const Z=document.createElement("textarea");Z.value=U,document.body.appendChild(Z),Z.select(),document.execCommand("copy"),document.body.removeChild(Z)}catch{}}function $e(){C&&(clearTimeout(C),C=null),h.value="",p("update:modelValue","")}const k=[eo,to(),lo],ge=Re(()=>{var U;return(U=e.height)!=null?U:"180px"});return(U,Z)=>(j(),O("div",fs,[r("div",{class:"absolute right-2 top-2 z-10 flex gap-2"},[r("button",{type:"button",class:"px-2 py-1 text-xs bg-gray-700/70 hover:bg-gray-700 text-gray-100 rounded",onClick:ae},"复制"),r("button",{type:"button",class:"px-2 py-1 text-xs bg-red-600/70 hover:bg-red-600 text-white rounded",onClick:$e},"清空")]),rt(qn(ro),{modelValue:h.value,"onUpdate:modelValue":Z[0]||(Z[0]=de=>h.value=de),extensions:k,style:st({height:ge.value,width:"100%"}),class:"w-full rounded border border-purple-500/30 bg-gray-800/50"},null,8,["modelValue","style"])]))}}),ms=rl(ys,[["__scopeId","data-v-c1c6cbbe"]]);function bs(y,n,e,p,h,C){y&&(y.style=y.style||{},y.style.boxShadow=`${n}px ${e}px ${p}px ${h}px ${C}`)}function xs(y){y.style=y.style||{},y.style.textGradient=y.style.textGradient||{colors:["#00A3FF","#ffffff"],angle:0}}function vs(y){y.style=y.style||{},y.style.backgroundGradient=y.style.backgroundGradient||{colors:["#00A3FF","#ffffff"],angle:90}}function hs(y,n){var ge,U,Z;const e=(ge=n==null?void 0:n.maxDepth)!=null?ge:6,p=(U=n==null?void 0:n.maxEntries)!=null?U:400,h=(Z=n==null?void 0:n.includeIntermediate)!=null?Z:!1,C=[],V=new WeakSet;function ae(de){return Object.prototype.toString.call(de)==="[object Object]"}function $e(de){C.length<p&&C.push(de)}function k(de,_,E){if(!(E>e)&&de!=null){if(typeof de!="object"){$e(_);return}if(!V.has(de)){if(V.add(de),Array.isArray(de)){$e(_);const d=Math.min(de.length,20);for(let G=0;G<d;G++)k(de[G],`${_}[${G}]`,E+1);return}if(ae(de)){h&&$e(_);const d=Object.keys(de).slice(0,50);for(const G of d)k(de[G],_?`${_}.${G}`:G,E+1);return}$e(_)}}}return k(y,"",0),C.filter(Boolean)}function ws(y,n){try{if(!y||!n)return"";const e=n.replace(/\[(\d+)\]/g,".$1").replace(/\['([^']+)'\]/g,".$1").replace(/\["([^\"]+)"\]/g,".$1").split(".").filter(Boolean);let p=y;for(const h of e){if(p==null)return"";p=p[h]}return typeof p=="object"?JSON.stringify(p):p!=null?p:""}catch{return""}}function $s(y,n){var h;if(!n||!((h=n.dynamic)!=null&&h.enabled)||!n.dynamic.objectName||!n.dynamic.propertyPath)return"";const e=n.dynamic,p=y[e.objectName];return String(ws(p,e.propertyPath))}var Es={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20 flex flex-col"},ks={key:0,class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Ss={class:"space-y-3"},Ms={class:"grid grid-cols-2 gap-2"},Cs={class:"col-span-2"},Ns={key:0,class:"space-y-3"},Is={class:"space-y-2"},As={class:"grid grid-cols-2 gap-2"},Fs={class:"grid grid-cols-2 gap-2"},js={class:"grid grid-cols-2 gap-2"},zs=["value"],Os=["value"],Bs={class:"space-y-2"},Ds={class:"flex gap-1"},Ts=["value"],Gs=["value"],Us={class:"space-y-2"},Ls={class:"grid grid-cols-3 gap-1"},Vs={class:"space-y-2"},Rs={class:"grid grid-cols-2 gap-2"},Ps=["value"],Hs=["value"],Ws=["value"],Js=["value"],qs={class:"grid grid-cols-4 gap-1"},Xs={class:"space-y-3"},Ys={class:"flex items-center justify-between"},_s={class:"inline-flex items-center cursor-pointer"},Ks={key:0,class:"grid grid-cols-2 gap-2"},Zs={key:1},Qs={class:"space-y-3"},ea={class:"space-y-2"},ta={class:"flex items-center justify-between"},ra={key:0},la={class:"flex gap-2"},na={key:1},oa={key:2},sa={key:3,class:"space-y-2 pt-2 border-t border-purple-500/20"},aa={class:"flex items-center justify-between"},ia={class:"inline-flex items-center cursor-pointer"},da=["checked"],ua={key:0,class:"space-y-1"},ca=["value"],pa={key:1,class:"space-y-3"},ga={class:"flex items-center gap-2"},fa=["value"],ya=["value"],ma={class:"space-y-2"},ba={class:"flex items-center justify-between"},xa={class:"flex items-center gap-1 text-xs text-gray-300"},va=["checked"],ha={key:0,class:"grid grid-cols-3 gap-2 items-end"},wa={class:"flex items-center gap-2"},$a=["value"],Ea=["value"],ka={class:"flex items-center gap-2"},Sa=["value"],Ma=["value"],Ca={class:"space-y-1"},Na=["value"],Ia=["value"],Aa={class:"space-y-2"},Fa={class:"flex items-center justify-between"},ja={class:"flex items-center gap-1 text-xs text-gray-300"},za=["checked"],Oa={key:0,class:"space-y-1"},Ba={class:"flex items-center gap-2"},Da={key:0,class:"space-y-1"},Ta=["value"],Ga=["value"],Ua={key:1,class:"space-y-1"},La=["value"],Va={class:"flex items-center gap-1"},Ra=["value"],Pa={class:"space-y-2"},Ha={class:"flex items-center justify-between"},Wa={class:"flex items-center gap-1 text-xs text-gray-300"},Ja=["checked"],qa={key:0,class:"space-y-2"},Xa=["value"],Ya={class:"space-y-1"},_a={class:"flex items-center gap-2"},Ka=["value"],Za=["value"],Qa={class:"space-y-1"},ei={class:"flex items-center gap-2"},ti=["value"],ri=["value"],li={class:"space-y-1"},ni={class:"flex items-center gap-2"},oi=["value"],si=["value"],ai={class:"space-y-1"},ii={class:"flex items-center gap-2"},di=["value"],ui=["value"],ci={class:"space-y-1"},pi={key:0,class:"flex items-center gap-2"},gi=["value"],fi=["value"],yi={key:2,class:"space-y-3"},mi={class:"flex items-center gap-2"},bi={key:0,class:"space-y-2"},xi=["value"],vi={class:"grid grid-cols-2 gap-2"},hi=["value"],wi=["value"],$i={key:0,class:"grid grid-cols-2 gap-2"},Ei=["value"],ki=["value"],Si={key:1,class:"grid grid-cols-2 gap-2"},Mi={key:2,class:"grid grid-cols-3 gap-2 items-end"},Ci={key:1},Ni={class:"flex items-center justify-between mt-2"},Ii={key:0,class:"text-xs text-red-400"},Ai={key:3,class:"space-y-3"},Fi={class:"space-y-2"},ji={class:"flex gap-1"},zi=["value"],Oi=["value"],Bi={class:"grid grid-cols-2 gap-2"},Di={class:"grid grid-cols-2 gap-1"},Ti=["value"],Gi={class:"grid grid-cols-2 gap-2"},Ui=["value"],Li={key:0},Vi=["value"],Ri={key:0,class:"grid grid-cols-2 gap-2"},Pi=["value"],Hi={key:4,class:"space-y-3"},Wi={class:"space-y-2"},Ji={class:"space-y-2 mt-2"},qi={class:"flex items-center gap-2"},Xi=["checked"],Yi={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},_i={class:"text-xs text-gray-400"},Ki={class:"space-y-2"},Zi={class:"grid grid-cols-2 gap-1"},Qi={class:"grid grid-cols-2 gap-2"},ed={class:"grid grid-cols-2 gap-2"},td={class:"grid grid-cols-2 gap-2"},rd=["value"],ld=["value"],nd={class:"space-y-2"},od={class:"flex gap-1"},sd=["value","disabled"],ad=["value","disabled"],id={key:0,class:"text-xs text-yellow-400 mt-1"},dd={class:"space-y-2"},ud={class:"flex gap-1"},cd=["value"],pd=["value"],gd={class:"space-y-2"},fd={class:"grid grid-cols-3 gap-1"},yd={class:"space-y-2"},md={class:"grid grid-cols-2 gap-1"},bd={class:"space-y-2"},xd={class:"flex items-center gap-2"},vd={class:"flex items-center gap-2 mt-1"},hd={class:"space-y-2"},wd={class:"flex items-center justify-between"},$d={class:"flex gap-1"},Ed={key:0,class:"grid grid-cols-3 gap-2 items-center"},kd={class:"col-span-1"},Sd={class:"col-span-1"},Md={class:"col-span-1"},Cd={class:"space-y-2"},Nd={class:"grid grid-cols-3 gap-1"},Id={class:"space-y-2"},Ad={class:"flex items-center justify-between"},Fd={class:"flex gap-1"},jd={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},zd={class:"grid grid-cols-2 gap-2"},Od={class:"flex gap-1"},Bd={class:"flex gap-1"},Dd={class:"block text-xs text-gray-400 mb-1"},Td={class:"space-y-2"},Gd={class:"flex items-center justify-between"},Ud={class:"flex gap-1"},Ld={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Vd={class:"grid grid-cols-2 gap-2"},Rd={class:"flex gap-1"},Pd={class:"flex gap-1"},Hd={class:"block text-xs text-gray-400 mb-1"},Wd={key:5,class:"space-y-3"},Jd={class:"space-y-2"},qd={key:0,class:"space-y-2"},Xd={class:"max-h-32 overflow-y-auto custom-scrollbar bg-gray-800/30 rounded p-2"},Yd={class:"grid grid-cols-4 gap-2"},_d=["onClick"],Kd=["src","alt"],Zd={key:0,class:"text-xs text-gray-500 text-center py-2"},Qd={class:"grid grid-cols-3 gap-2"},eu={class:"space-y-2"},tu={class:"pt-4 border-t border-purple-500/30 space-y-2"},ru={key:1,class:"p-4 text-center text-gray-400 flex-1 flex flex-col justify-center"},lu={},nu=Mt({...lu,__name:"ElementSettingsPanel",props:{selectedEl:{},config:{},fontLibrary:{},fontSizeLibrary:{},fontWeightOptions:{},fontStyleOptions:{},databaseObjects:{},dbMap:{},iconLibrary:{},defaultChartOption:{type:Function},safeHex:{type:Function},initCustomClassSkeleton:{type:Function},refreshAllCustomClassCss:{type:Function},removeCustomClassCssForElement:{type:Function},getIconDataUrlById:{type:Function}},emits:["duplicateSelected","removeSelected","saveSelectedAsComponent"],setup(y,{emit:n}){const e=y,p=n,h=we("visual"),C=we(""),V=we("");mt(()=>{var x;return(x=e.selectedEl)==null?void 0:x.id},()=>{var t;const x=e.selectedEl;x&&x.type==="chart"&&(h.value="visual",V.value="",C.value=JSON.stringify((t=x.chartOption)!=null?t:e.defaultChartOption(x.chartType||"line"),null,2))});const ae=Re(()=>{var se,te;const x=(te=(se=e.selectedEl)==null?void 0:se.dynamic)==null?void 0:te.objectName;if(!x)return[];const t=e.dbMap[x];try{return hs(t,{maxDepth:6,maxEntries:400})}catch{return[]}});function $e(x){return $s(e.dbMap,x)}function k(x){return typeof x=="string"&&x.trim().endsWith("%")?"%":"px"}function ge(x){if(x==null)return 0;if(typeof x=="number")return x;const t=String(x).trim();if(t.endsWith("%")){const te=Number(t.replace("%",""));return Number.isFinite(te)?te:0}const se=Number(t.replace("px",""));return Number.isFinite(se)?se:0}function U(x,t){const se=e.selectedEl;se&&(se.style=se.style||{},se.style.borderRadius=`${x}${t}`)}function Z(x){const t={x:0,y:8,blur:24,spread:0,color:"#000000"};if(!x||!x.trim())return t;const se=x.split(/\s+/).filter(Boolean);if(se.length<3)return t;const te=se.slice(0,4).map(at=>Number(String(at).replace("px",""))),lt=se.slice(4).join(" ")||t.color,[He=NaN,We=NaN,Ye=NaN,_e=NaN]=te;return{x:Number.isFinite(He)?He:t.x,y:Number.isFinite(We)?We:t.y,blur:Number.isFinite(Ye)?Ye:t.blur,spread:Number.isFinite(_e)?_e:t.spread,color:lt}}function de(x,t,se,te,lt){bs(e.selectedEl,x,t,se,te,lt)}function _(x){xs(x)}function E(x){vs(x)}function d(){V.value="";try{const x=JSON.parse(C.value);e.selectedEl&&e.selectedEl.type==="chart"&&(e.selectedEl.chartOption=x)}catch(x){V.value=`JSON 解析失败：${(x==null?void 0:x.message)||String(x)}`}}function G(x,t){if(!e.selectedEl||e.selectedEl.type!=="chart"||!e.selectedEl.chartOption)return;const se=e.selectedEl.chartOption,te=se.series||[],lt={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:x},{offset:1,color:t}],global:!1};te.forEach(He=>{He.type==="bar"&&(He.itemStyle=He.itemStyle||{},He.itemStyle.color=lt)}),C.value=JSON.stringify(se,null,2)}function R(){const x=e.selectedEl;return!x||x.type!=="chart"?null:(x.chartOption||(x.chartOption=e.defaultChartOption(x.chartType||"line")),x.chartOption)}function Q(x){const t=R();t&&(t.title=t.title||{},t.title.text=x,C.value=JSON.stringify(t,null,2))}function H(x){const t=R();t&&(t.color=x.split(",").map(se=>se.trim()).filter(Boolean),C.value=JSON.stringify(t,null,2))}function X(x){const t=R();t&&(t.legend=t.legend||{},t.legend.show=x==="1",C.value=JSON.stringify(t,null,2))}function Ee(x){var se;const t=(se=x.target.files)==null?void 0:se[0];if(t&&e.selectedEl){const te=new FileReader;te.onload=()=>{e.selectedEl&&(e.selectedEl.src=String(te.result),e.selectedEl.iconId=void 0)},te.readAsDataURL(t)}}async function q(x){const t=e.selectedEl;if(!t||t.type!=="image")return;const se=await e.getIconDataUrlById(x.id);if(!se)return;t.src=se,t.iconId=x.id;const te=new Image;te.onload=()=>{e.selectedEl&&e.selectedEl.id===t.id&&(e.selectedEl.width=te.naturalWidth,e.selectedEl.height=te.naturalHeight)},te.src=se}function D(){const x=e.selectedEl;if(!x||x.type!=="image"||!x.src)return;const t=new Image;t.onload=()=>{e.selectedEl&&(e.selectedEl.width=t.naturalWidth,e.selectedEl.height=t.naturalHeight)},t.src=x.src}function P(){}const Be=Re({get(){const x=e.selectedEl;return!!(x&&x.eventBinding&&x.eventBinding.enabled)},set(x){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!1,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.enabled=x,(t.eventBinding.handlerName==null||String(t.eventBinding.handlerName).trim()==="")&&(t.eventBinding.handlerName="handleClick"),(t.eventBinding.cursor==null||String(t.eventBinding.cursor).trim()==="")&&(t.eventBinding.cursor="pointer"),t.eventBinding.code==null&&(t.eventBinding.code=""))}}),b=Re({get(){var x,t;return(t=(x=e.selectedEl)==null?void 0:x.eventBinding)==null?void 0:t.cursor},set(x){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.cursor=x)}}),Y=Re({get(){var x,t;return(t=(x=e.selectedEl)==null?void 0:x.eventBinding)==null?void 0:t.handlerName},set(x){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.handlerName=x)}}),oe=Re({get(){var x,t;return(t=(x=e.selectedEl)==null?void 0:x.eventBinding)==null?void 0:t.code},set(x){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.code=x)}});return(x,t)=>{var se,te,lt,He,We,Ye,_e,at,vt,ht,wt,Ft,ze,ve,gt,ft,bt,Ct,Pe,Ne,Ce,Fe,it,Ke,ct,Oe,dt,jt,zt,$t,Ot,Et,br,xr,vr,Nt,Bt,hr,Kt,wr,$r,Zt,Er,kr,Sr,Mr,Qt,er,Vt,Rt,Cr,Nr,Ir,Dt,xt,tr,Tt,rr,Ar,Fr,jr,Je,It,zr,Or,lr,nr,or,Br,Gt,Pt,Ht,Wt,sr,ar,Dr,ir,ut,nt,Tr,Gr,Ur,Lr,Vr,Rr,dr,Jt,qt,ur,Xt,Yt,Pr,Ut,cr,Hr,pr,Wr,gr,l,o,a,c,f,g,I,A,N,S,i,u,B,J,ce,fe,ue,be,me,re,ne,le,ie,Ie,m,w,L,F,T,K,v,W,$,pe,Me,xe,Se,Ae,De,et,Ze,ot,qe,pt,tt,kt,_t,Jr,ll,nl,ol,sl,al,il,dl,ul,cl,pl,gl,fl,yl,ml,bl,xl,vl,hl,wl,$l,El,kl,Sl,Ml,Cl,Nl,Il,Al,Fl,jl,zl,Ol,Bl,Dl,Tl,Gl,Ul,Ll,Vl,Rl,Pl,Hl,Wl,Jl,ql,Xl,Yl,_l,Kl,Zl,Ql,en,tn,rn,ln,nn,on,sn,an,dn,un,cn,pn,gn,fn,yn,mn,bn,xn,vn,hn,wn,$n,En,kn,Sn,Mn,Cn,Nn,In,An,Fn,jn,zn,On,Bn,Dn;return j(),O("div",Es,[t[270]||(t[270]=r("div",{class:"p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-purple-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),mr(" 元素设置 ")])],-1)),e.selectedEl?(j(),O("div",ks,[r("div",Ss,[t[148]||(t[148]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"位置和尺寸",-1)),r("div",Ms,[r("div",null,[t[143]||(t[143]=r("label",{class:"block text-xs text-gray-400 mb-1"},"X",-1)),ye(r("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>e.selectedEl.left=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.left,void 0,{number:!0}]])]),r("div",null,[t[144]||(t[144]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y",-1)),ye(r("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.selectedEl.top=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.top,void 0,{number:!0}]])]),r("div",null,[t[145]||(t[145]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度",-1)),ye(r("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.selectedEl.width=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[146]||(t[146]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度",-1)),ye(r("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>e.selectedEl.height=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.height,void 0,{number:!0}]])]),r("div",Cs,[t[147]||(t[147]=r("label",{class:"block text-xs text-gray-400 mb-1"},"层级（z-index）",-1)),ye(r("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.selectedEl.zIndex=s),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.zIndex,void 0,{number:!0}]])])])]),e.selectedEl&&e.selectedEl.type==="arc-text"?(j(),O("div",Ns,[t[164]||(t[164]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"环绕文字设置",-1)),r("div",Is,[t[149]||(t[149]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),ye(r("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>e.selectedEl.text=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[ke,e.selectedEl.text]])]),r("div",As,[r("div",null,[t[150]||(t[150]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),rt(yt,{options:e.fontSizeLibrary,modelValue:((se=e.selectedEl.style)==null?void 0:se.fontSize)||e.config.globalFontSize,"onUpdate:modelValue":t[6]||(t[6]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=s)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[t[151]||(t[151]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),rt(yt,{options:e.fontLibrary,modelValue:((te=e.selectedEl.style)==null?void 0:te.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[7]||(t[7]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=s)})},null,8,["options","modelValue"])])]),r("div",Fs,[r("div",null,[t[152]||(t[152]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),rt(yt,{options:e.fontWeightOptions,modelValue:((lt=e.selectedEl.style)==null?void 0:lt.fontWeight)||"400","onUpdate:modelValue":t[8]||(t[8]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=s)})},null,8,["options","modelValue"])]),r("div",null,[t[153]||(t[153]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),rt(yt,{options:e.fontStyleOptions,modelValue:((He=e.selectedEl.style)==null?void 0:He.fontStyle)||"normal","onUpdate:modelValue":t[9]||(t[9]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=s)})},null,8,["options","modelValue"])])]),r("div",js,[r("div",null,[t[154]||(t[154]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:(Ye=(We=e.selectedEl.style)==null?void 0:We.letterSpacing)!=null?Ye:0,onInput:t[10]||(t[10]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(s.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,zs)]),r("div",null,[t[155]||(t[155]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:(at=(_e=e.selectedEl.style)==null?void 0:_e.lineHeight)!=null?at:1.5,onInput:t[11]||(t[11]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(s.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Os)])]),r("div",Bs,[t[156]||(t[156]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",Ds,[r("input",{value:((ht=(vt=e.selectedEl)==null?void 0:vt.style)==null?void 0:ht.color)||e.config.globalColor,onInput:t[12]||(t[12]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Ts),r("input",{value:(ze=(Ft=(wt=e.selectedEl)==null?void 0:wt.style)==null?void 0:Ft.color)!=null?ze:e.config.globalColor,onInput:t[13]||(t[13]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,40,Gs)])]),r("div",Us,[t[157]||(t[157]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对齐方式",-1)),r("div",Ls,[r("button",{onClick:t[14]||(t[14]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ve=e.selectedEl.style)==null?void 0:ve.textAlign)||"center")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左",2),r("button",{onClick:t[15]||(t[15]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((gt=e.selectedEl.style)==null?void 0:gt.textAlign)||"center")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"中",2),r("button",{onClick:t[16]||(t[16]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ft=e.selectedEl.style)==null?void 0:ft.textAlign)||"center")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右",2)])]),r("div",Vs,[t[163]||(t[163]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆弧参数",-1)),r("div",Rs,[r("div",null,[t[158]||(t[158]=r("label",{class:"block text-xs text-gray-400 mb-1"},"半径(px)",-1)),r("input",{value:(Ne=(Pe=(Ct=(bt=e.selectedEl)==null?void 0:bt.style)==null?void 0:Ct.arcText)==null?void 0:Pe.radius)!=null?Ne:Math.min(e.selectedEl.width||0,e.selectedEl.height||0)/2,onInput:t[17]||(t[17]=s=>{if(e.selectedEl){const z=Number(s.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.radius=z}}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ps)]),r("div",null,[t[159]||(t[159]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始角(°)",-1)),r("input",{value:(Ke=(it=(Fe=(Ce=e.selectedEl)==null?void 0:Ce.style)==null?void 0:Fe.arcText)==null?void 0:it.startAngle)!=null?Ke:0,onInput:t[18]||(t[18]=s=>{if(e.selectedEl){const z=Number(s.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=z}}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Hs)]),r("div",null,[t[160]||(t[160]=r("label",{class:"block text-xs text-gray-400 mb-1"},"扫过角(°)",-1)),r("input",{value:(jt=(dt=(Oe=(ct=e.selectedEl)==null?void 0:ct.style)==null?void 0:Oe.arcText)==null?void 0:dt.sweepAngle)!=null?jt:180,onInput:t[19]||(t[19]=s=>{if(e.selectedEl){const z=Number(s.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.sweepAngle=z}}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ws)]),r("div",null,[t[162]||(t[162]=r("label",{class:"block text-xs text-gray-400 mb-1"},"顺时针",-1)),r("select",{value:(Et=(Ot=($t=(zt=e.selectedEl)==null?void 0:zt.style)==null?void 0:$t.arcText)==null?void 0:Ot.clockwise)==null||Et?"1":"0",onChange:t[20]||(t[20]=s=>{if(e.selectedEl){const z=s.target.value==="1";e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.clockwise=z}}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[161]||(t[161]=[r("option",{value:"1"},"是",-1),r("option",{value:"0"},"否",-1)])],40,Js)])]),r("div",qs,[r("button",{onClick:t[21]||(t[21]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=180,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"上"),r("button",{onClick:t[22]||(t[22]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=0,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下"),r("button",{onClick:t[23]||(t[23]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=90,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左"),r("button",{onClick:t[24]||(t[24]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=270,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右")])])])):ee("",!0),r("div",Xs,[t[171]||(t[171]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"事件绑定",-1)),r("div",Ys,[t[166]||(t[166]=r("label",{class:"text-xs text-gray-400"},"开启事件绑定",-1)),r("label",_s,[ye(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":t[25]||(t[25]=s=>Be.value=s)},null,512),[[_r,Be.value]]),t[165]||(t[165]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:je(["ml-3 text-xs",Be.value?"text-cyan-300":"text-gray-300"])},Qe(Be.value?"已开启":"已关闭"),3)])]),Be.value?(j(),O("div",Ks,[r("div",null,[t[168]||(t[168]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Cursor",-1)),ye(r("select",{"onUpdate:modelValue":t[26]||(t[26]=s=>b.value=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[167]||(t[167]=[Yr('<option value="pointer" data-v-0aecde2c>pointer</option><option value="default" data-v-0aecde2c>default</option><option value="move" data-v-0aecde2c>move</option><option value="crosshair" data-v-0aecde2c>crosshair</option><option value="grab" data-v-0aecde2c>grab</option>',5)])],512),[[Gn,b.value]])]),r("div",null,[t[169]||(t[169]=r("label",{class:"block text-xs text-gray-400 mb-1"},"函数名",-1)),ye(r("input",{"onUpdate:modelValue":t[27]||(t[27]=s=>Y.value=s),type:"text",placeholder:"handleClick",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[ke,Y.value]])])])):ee("",!0),Be.value?(j(),O("div",Zs,[t[170]||(t[170]=r("label",{class:"block text-xs text-gray-400 mb-1"},"事件代码",-1)),ye(r("textarea",{"onUpdate:modelValue":t[28]||(t[28]=s=>oe.value=s),rows:"6",placeholder:"function body...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[ke,oe.value]])])):ee("",!0)]),r("div",Qs,[t[181]||(t[181]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"元素属性",-1)),r("div",ea,[r("div",ta,[t[172]||(t[172]=r("label",{class:"text-xs text-gray-400"},"启用 Class 样式",-1)),ye(r("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=s=>e.selectedEl.enableClassStyle=s),onChange:t[30]||(t[30]=s=>{e.selectedEl&&s.target.checked?(e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss()):e.selectedEl&&!s.target.checked&&e.removeCustomClassCssForElement(e.selectedEl.id)}),class:"rounded border-purple-500/30 text-purple-400 focus:ring-purple-400"},null,544),[[_r,e.selectedEl.enableClassStyle]])]),(br=e.selectedEl)!=null&&br.enableClassStyle?(j(),O("div",ra,[t[173]||(t[173]=r("label",{class:"block text-xs text-gray-400 mb-1"},"CSS Class",-1)),r("div",la,[ye(r("input",{"onUpdate:modelValue":t[31]||(t[31]=s=>e.selectedEl.className=s),type:"text",placeholder:"自动生成唯一类名，可修改",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.className]]),r("button",{type:"button",onClick:t[32]||(t[32]=()=>{e.selectedEl&&(e.selectedEl.className=`cls-${String(e.selectedEl.id).slice(0,8)}`,e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss())}),class:"px-2 py-1 text-xs bg-purple-600/60 hover:bg-purple-600 rounded text-white"},"生成默认")])])):ee("",!0),(xr=e.selectedEl)!=null&&xr.enableClassStyle?(j(),O("div",na,[t[174]||(t[174]=r("label",{class:"block text-xs text-gray-400 mb-1"},"自定义样式（CSS 声明）",-1)),rt(ms,{modelValue:String((vr=e.selectedEl.customClassCss)!=null?vr:""),"onUpdate:modelValue":t[33]||(t[33]=s=>{e.selectedEl.customClassCss=s,e.refreshAllCustomClassCss()}),height:"180px"},null,8,["modelValue"]),t[175]||(t[175]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"提示：已为当前类名生成 .className { } 模板；也可直接填写声明，系统会自动包裹并追加 !important。",-1))])):ee("",!0),e.selectedEl&&(e.selectedEl.type==="chart"||e.selectedEl.type==="container")?(j(),O("div",oa,[t[176]||(t[176]=r("label",{class:"block text-xs text-gray-400 mb-1"},"元素ID",-1)),ye(r("input",{"onUpdate:modelValue":t[34]||(t[34]=s=>e.selectedEl.elementId=s),type:"text",placeholder:"输入元素ID",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.elementId]])])):ee("",!0),e.selectedEl?(j(),O("div",sa,[t[180]||(t[180]=r("h3",{class:"text-sm font-medium text-purple-300"},"显示与隐藏",-1)),r("div",aa,[t[178]||(t[178]=r("label",{class:"text-xs text-gray-400"},"隐藏该元素",-1)),r("label",ia,[r("input",{type:"checkbox",class:"sr-only peer",checked:!!e.selectedEl.hidden,onChange:t[35]||(t[35]=s=>{const z=s.target.checked;e.selectedEl&&(e.selectedEl.hidden=z,z&&!e.selectedEl.hiddenLabel&&(e.selectedEl.hiddenLabel=`hidden-${String(e.selectedEl.id).slice(0,8)}`))})},null,40,da),t[177]||(t[177]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-purple-600 peer-checked:to-pink-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:je(["ml-3 text-xs",e.selectedEl.hidden?"text-purple-300":"text-gray-300"])},Qe(e.selectedEl.hidden?"已隐藏":"显示中"),3)])]),e.selectedEl.hidden?(j(),O("div",ua,[t[179]||(t[179]=r("label",{class:"block text-xs text-gray-400"},"隐藏标识",-1)),r("input",{type:"text",value:e.selectedEl.hiddenLabel||"",onInput:t[36]||(t[36]=s=>{e.selectedEl&&(e.selectedEl.hiddenLabel=s.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1",placeholder:"hidden-xxxx"},null,40,ca)])):ee("",!0)])):ee("",!0)])]),e.selectedEl&&e.selectedEl.type==="container"?(j(),O("div",pa,[t[203]||(t[203]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器样式",-1)),r("div",null,[t[182]||(t[182]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色（HEX）",-1)),r("div",ga,[r("input",{type:"color",value:((Bt=(Nt=e.selectedEl)==null?void 0:Nt.style)==null?void 0:Bt.backgroundColor)||"#000000",onInput:t[37]||(t[37]=s=>{const z=s.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=z)}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,fa),r("input",{type:"text",value:((Kt=(hr=e.selectedEl)==null?void 0:hr.style)==null?void 0:Kt.backgroundColor)||"",placeholder:"#1e293b 或 transparent",onInput:t[38]||(t[38]=s=>{const z=s.target.value.trim();e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=z)}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,ya)]),t[183]||(t[183]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"支持 #RGB/#RRGGBB 或 CSS 颜色名；启用渐变时该颜色被覆盖。",-1))]),r("div",null,[t[184]||(t[184]=r("label",{class:"block text-xs text-gray-400 mb-1"},"容器注释（导出可见）",-1)),ye(r("textarea",{"onUpdate:modelValue":t[39]||(t[39]=s=>e.selectedEl.comment=s),rows:"2",placeholder:"输入注释，方便代码维护...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.comment]])]),r("div",ma,[r("div",ba,[t[186]||(t[186]=r("label",{class:"block text-xs text-gray-400 mb-1"},"渐变背景",-1)),r("label",xa,[r("input",{type:"checkbox",checked:!!(($r=(wr=e.selectedEl)==null?void 0:wr.style)!=null&&$r.backgroundGradient),onChange:t[40]||(t[40]=s=>{const z=s.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},z?e.selectedEl.style.backgroundGradient||(e.selectedEl.style.backgroundGradient={colors:["#42b883","#0ea5e9"],angle:90}):delete e.selectedEl.style.backgroundGradient)})},null,40,va),t[185]||(t[185]=mr(" 启用 ",-1))])]),(Er=(Zt=e.selectedEl)==null?void 0:Zt.style)!=null&&Er.backgroundGradient?(j(),O("div",ha,[r("div",null,[t[187]||(t[187]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"起始色（HEX）",-1)),r("div",wa,[r("input",{type:"color",value:((Qt=(Mr=(Sr=(kr=e.selectedEl)==null?void 0:kr.style)==null?void 0:Sr.backgroundGradient)==null?void 0:Mr.colors)==null?void 0:Qt[0])||"#42b883",onInput:t[41]||(t[41]=s=>{var he;const z=s.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(he=M.colors)!=null&&he.length?M.colors:["","#"],M.colors[0]=z,e.selectedEl.style.backgroundGradient=M}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,$a),r("input",{type:"text",value:((Cr=(Rt=(Vt=(er=e.selectedEl)==null?void 0:er.style)==null?void 0:Vt.backgroundGradient)==null?void 0:Rt.colors)==null?void 0:Cr[0])||"",placeholder:"#42b883",onInput:t[42]||(t[42]=s=>{var he;const z=s.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(he=M.colors)!=null&&he.length?M.colors:["","#"],M.colors[0]=z,e.selectedEl.style.backgroundGradient=M}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ea)])]),r("div",null,[t[188]||(t[188]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"结束色（HEX）",-1)),r("div",ka,[r("input",{type:"color",value:((xt=(Dt=(Ir=(Nr=e.selectedEl)==null?void 0:Nr.style)==null?void 0:Ir.backgroundGradient)==null?void 0:Dt.colors)==null?void 0:xt[1])||"#0ea5e9",onInput:t[43]||(t[43]=s=>{var he;const z=s.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(he=M.colors)!=null&&he.length?M.colors:["","#"],M.colors[1]=z,e.selectedEl.style.backgroundGradient=M}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,Sa),r("input",{type:"text",value:((Ar=(rr=(Tt=(tr=e.selectedEl)==null?void 0:tr.style)==null?void 0:Tt.backgroundGradient)==null?void 0:rr.colors)==null?void 0:Ar[1])||"",placeholder:"#0ea5e9",onInput:t[44]||(t[44]=s=>{var he;const z=s.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.colors=(he=M.colors)!=null&&he.length?M.colors:["","#"],M.colors[1]=z,e.selectedEl.style.backgroundGradient=M}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ma)])]),r("div",Ca,[t[189]||(t[189]=r("label",{class:"block text-[11px] text-gray-400"},"角度（0-360）",-1)),r("input",{type:"range",min:"0",max:"360",step:"1",value:(It=(Je=(jr=(Fr=e.selectedEl)==null?void 0:Fr.style)==null?void 0:jr.backgroundGradient)==null?void 0:Je.angle)!=null?It:90,onInput:t[45]||(t[45]=s=>{const z=Number(s.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.angle=z,e.selectedEl.style.backgroundGradient=M}),class:"w-full"},null,40,Na),r("input",{type:"number",value:(nr=(lr=(Or=(zr=e.selectedEl)==null?void 0:zr.style)==null?void 0:Or.backgroundGradient)==null?void 0:lr.angle)!=null?nr:90,onInput:t[46]||(t[46]=s=>{const z=Number(s.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const M=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};M.angle=z,e.selectedEl.style.backgroundGradient=M}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ia)])])):ee("",!0),t[190]||(t[190]=r("p",{class:"text-[11px] text-gray-500"},"提示：仅在启用后显示渐变设置；未启用时使用背景色。",-1))]),r("div",Aa,[r("div",Fa,[t[192]||(t[192]=r("label",{class:"block text-xs text-gray-400"},"圆角",-1)),r("label",ja,[r("input",{type:"checkbox",checked:!!((Br=(or=e.selectedEl)==null?void 0:or.style)!=null&&Br.borderRadius)&&ge((Pt=(Gt=e.selectedEl)==null?void 0:Gt.style)==null?void 0:Pt.borderRadius)>0,onChange:t[47]||(t[47]=s=>{const z=s.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},z?e.selectedEl.style.borderRadius||(e.selectedEl.style.borderRadius="8px"):e.selectedEl.style.borderRadius="0")})},null,40,za),t[191]||(t[191]=mr(" 启用 ",-1))])]),(Wt=(Ht=e.selectedEl)==null?void 0:Ht.style)!=null&&Wt.borderRadius&&ge((ar=(sr=e.selectedEl)==null?void 0:sr.style)==null?void 0:ar.borderRadius)>=0?(j(),O("div",Oa,[r("div",Ba,[t[193]||(t[193]=r("span",{class:"text-[11px] text-gray-400"},"单位",-1)),r("button",{type:"button",class:je(["px-2 py-0.5 rounded text-[11px]",k((ir=(Dr=e.selectedEl)==null?void 0:Dr.style)==null?void 0:ir.borderRadius)==="px"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[48]||(t[48]=()=>{var z,M;const s=ge((M=(z=e.selectedEl)==null?void 0:z.style)==null?void 0:M.borderRadius);U(s,"px")})},"px",2),r("button",{type:"button",class:je(["px-2 py-0.5 rounded text-[11px]",k((nt=(ut=e.selectedEl)==null?void 0:ut.style)==null?void 0:nt.borderRadius)==="%"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[49]||(t[49]=()=>{var z,M;const s=ge((M=(z=e.selectedEl)==null?void 0:z.style)==null?void 0:M.borderRadius);U(s,"%")})},"%",2)]),k((Gr=(Tr=e.selectedEl)==null?void 0:Tr.style)==null?void 0:Gr.borderRadius)==="px"?(j(),O("div",Da,[r("input",{type:"range",min:"0",max:"64",step:"1",value:ge((Lr=(Ur=e.selectedEl)==null?void 0:Ur.style)==null?void 0:Lr.borderRadius),onInput:t[50]||(t[50]=s=>{const z=Number(s.target.value)||0;U(z,"px")}),class:"w-full"},null,40,Ta),r("input",{type:"number",value:ge((Rr=(Vr=e.selectedEl)==null?void 0:Vr.style)==null?void 0:Rr.borderRadius),onInput:t[51]||(t[51]=s=>{const z=Number(s.target.value)||0;U(z,"px")}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ga)])):(j(),O("div",Ua,[r("input",{type:"range",min:"0",max:"100",step:"1",value:ge((Jt=(dr=e.selectedEl)==null?void 0:dr.style)==null?void 0:Jt.borderRadius),onInput:t[52]||(t[52]=s=>{const z=Number(s.target.value)||0;U(z,"%")}),class:"w-full"},null,40,La),r("div",Va,[r("input",{type:"number",value:ge((ur=(qt=e.selectedEl)==null?void 0:qt.style)==null?void 0:ur.borderRadius),onInput:t[53]||(t[53]=s=>{const z=Number(s.target.value)||0;U(z,"%")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ra),t[194]||(t[194]=r("span",{class:"text-xs text-gray-400"},"%",-1))])]))])):ee("",!0)]),r("div",Pa,[r("div",Ha,[t[196]||(t[196]=r("label",{class:"block text-xs text-gray-400"},"阴影（box-shadow）",-1)),r("label",Wa,[r("input",{type:"checkbox",checked:!!((Yt=(Xt=e.selectedEl)==null?void 0:Xt.style)!=null&&Yt.boxShadow),onChange:t[54]||(t[54]=s=>{const z=s.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},z?e.selectedEl.style.boxShadow||(e.selectedEl.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)"):delete e.selectedEl.style.boxShadow)})},null,40,Ja),t[195]||(t[195]=mr(" 启用 ",-1))])]),(Ut=(Pr=e.selectedEl)==null?void 0:Pr.style)!=null&&Ut.boxShadow?(j(),O("div",qa,[r("input",{type:"text",value:((Hr=(cr=e.selectedEl)==null?void 0:cr.style)==null?void 0:Hr.boxShadow)||"",placeholder:"例如: 0 8px 24px rgba(0,0,0,0.25)",onInput:t[55]||(t[55]=s=>{const z=s.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.boxShadow=z)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Xa),r("div",Ya,[t[197]||(t[197]=r("label",{class:"block text-[11px] text-gray-400"},"X 偏移",-1)),r("div",_a,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:Z((Wr=(pr=e.selectedEl)==null?void 0:pr.style)==null?void 0:Wr.boxShadow).x,onInput:t[56]||(t[56]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de(z!=null?z:0,(Ge=M.y)!=null?Ge:0,(Ue=M.blur)!=null?Ue:0,(Le=M.spread)!=null?Le:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"flex-1"},null,40,Ka),r("input",{type:"number",value:Z((l=(gr=e.selectedEl)==null?void 0:gr.style)==null?void 0:l.boxShadow).x,onInput:t[57]||(t[57]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de(z!=null?z:0,(Ge=M.y)!=null?Ge:0,(Ue=M.blur)!=null?Ue:0,(Le=M.spread)!=null?Le:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Za)])]),r("div",Qa,[t[198]||(t[198]=r("label",{class:"block text-[11px] text-gray-400"},"Y 偏移",-1)),r("div",ei,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:Z((a=(o=e.selectedEl)==null?void 0:o.style)==null?void 0:a.boxShadow).y,onInput:t[58]||(t[58]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,z!=null?z:0,(Ue=M.blur)!=null?Ue:0,(Le=M.spread)!=null?Le:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"flex-1"},null,40,ti),r("input",{type:"number",value:Z((f=(c=e.selectedEl)==null?void 0:c.style)==null?void 0:f.boxShadow).y,onInput:t[59]||(t[59]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,z!=null?z:0,(Ue=M.blur)!=null?Ue:0,(Le=M.spread)!=null?Le:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ri)])]),r("div",li,[t[199]||(t[199]=r("label",{class:"block text-[11px] text-gray-400"},"模糊",-1)),r("div",ni,[r("input",{type:"range",min:"0",max:"128",step:"1",value:Z((I=(g=e.selectedEl)==null?void 0:g.style)==null?void 0:I.boxShadow).blur,onInput:t[60]||(t[60]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,(Ue=M.y)!=null?Ue:0,z!=null?z:0,(Le=M.spread)!=null?Le:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"flex-1"},null,40,oi),r("input",{type:"number",value:Z((N=(A=e.selectedEl)==null?void 0:A.style)==null?void 0:N.boxShadow).blur,onInput:t[61]||(t[61]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,(Ue=M.y)!=null?Ue:0,z!=null?z:0,(Le=M.spread)!=null?Le:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,si)])]),r("div",ai,[t[200]||(t[200]=r("label",{class:"block text-[11px] text-gray-400"},"扩散",-1)),r("div",ii,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:Z((i=(S=e.selectedEl)==null?void 0:S.style)==null?void 0:i.boxShadow).spread,onInput:t[62]||(t[62]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,(Ue=M.y)!=null?Ue:0,(Le=M.blur)!=null?Le:0,z!=null?z:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"flex-1"},null,40,di),r("input",{type:"number",value:Z((B=(u=e.selectedEl)==null?void 0:u.style)==null?void 0:B.boxShadow).spread,onInput:t[63]||(t[63]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=Number(s.target.value)||0,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,(Ue=M.y)!=null?Ue:0,(Le=M.blur)!=null?Le:0,z!=null?z:0,(Ve=M.color)!=null?Ve:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ui)])])])):ee("",!0),r("div",ci,[t[201]||(t[201]=r("label",{class:"block text-[11px] text-gray-400"},"阴影颜色",-1)),(ce=(J=e.selectedEl)==null?void 0:J.style)!=null&&ce.boxShadow?(j(),O("div",pi,[r("input",{type:"color",value:Z((ue=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:ue.boxShadow).color||"#000000",onInput:t[64]||(t[64]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=s.target.value,M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,(Ue=M.y)!=null?Ue:0,(Le=M.blur)!=null?Le:0,(Ve=M.spread)!=null?Ve:0,z||"#000000")}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,gi),r("input",{type:"text",value:Z((me=(be=e.selectedEl)==null?void 0:be.style)==null?void 0:me.boxShadow).color||"",placeholder:"#000000 或 rgba(...)",onInput:t[65]||(t[65]=s=>{var he,Te,Ge,Ue,Le,Ve;const z=s.target.value.trim(),M=Z((Te=(he=e.selectedEl)==null?void 0:he.style)==null?void 0:Te.boxShadow);de((Ge=M.x)!=null?Ge:0,(Ue=M.y)!=null?Ue:0,(Le=M.blur)!=null?Le:0,(Ve=M.spread)!=null?Ve:0,z||"#000000")}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,fi)])):ee("",!0)]),t[202]||(t[202]=r("p",{class:"text-[11px] text-gray-500"},"支持滑动或数字输入；颜色可选色块与 HEX 文本。",-1))])])):ee("",!0),e.selectedEl&&e.selectedEl.type==="chart"?(j(),O("div",yi,[t[218]||(t[218]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"图表配置",-1)),r("div",mi,[r("button",{onClick:t[66]||(t[66]=s=>h.value="visual"),class:je(["px-3 py-1 rounded text-sm",h.value==="visual"?"bg-purple-600/60":"bg-gray-700"])},"可视化",2),r("button",{onClick:t[67]||(t[67]=s=>h.value="json"),class:je(["px-3 py-1 rounded text-sm",h.value==="json"?"bg-purple-600/60":"bg-gray-700"])},"JSON",2)]),h.value==="visual"?(j(),O("div",bi,[r("div",null,[t[204]||(t[204]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图表类型",-1)),rt(yt,{options:["line","bar","pie","mix"],modelValue:e.selectedEl.chartType||"line","onUpdate:modelValue":t[68]||(t[68]=s=>{e.selectedEl&&(e.selectedEl.chartType=s,e.selectedEl.chartOption=e.defaultChartOption(s),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))})},null,8,["modelValue"])]),r("div",null,[t[205]||(t[205]=r("label",{class:"block text-xs text-gray-400 mb-1"},"标题",-1)),r("input",{value:((le=(ne=(re=e.selectedEl)==null?void 0:re.chartOption)==null?void 0:ne.title)==null?void 0:le.text)||"",onInput:t[69]||(t[69]=s=>Q(s.target.value)),type:"text",placeholder:"输入图表标题",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,xi)]),r("div",vi,[r("div",null,[t[206]||(t[206]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色列表（逗号分隔）",-1)),r("input",{value:((m=(Ie=(ie=e.selectedEl)==null?void 0:ie.chartOption)==null?void 0:Ie.color)==null?void 0:m.join(","))||"",onInput:t[70]||(t[70]=s=>H(s.target.value)),type:"text",placeholder:"#42b883,#ff9800",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,hi)]),r("div",null,[t[208]||(t[208]=r("label",{class:"block text-xs text-gray-400 mb-1"},"显示图例",-1)),r("select",{value:(T=(F=(L=(w=e.selectedEl)==null?void 0:w.chartOption)==null?void 0:L.legend)==null?void 0:F.show)==null||T?"1":"0",onChange:t[71]||(t[71]=s=>X(s.target.value)),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[207]||(t[207]=[r("option",{value:"1"},"显示",-1),r("option",{value:"0"},"隐藏",-1)])],40,wi)])]),e.selectedEl&&e.selectedEl.chartType!=="pie"?(j(),O("div",$i,[r("div",null,[t[209]||(t[209]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最小值",-1)),r("input",{value:Array.isArray((v=(K=e.selectedEl)==null?void 0:K.chartOption)==null?void 0:v.yAxis)?(xe=(Me=(pe=($=(W=e.selectedEl)==null?void 0:W.chartOption)==null?void 0:$.yAxis)==null?void 0:pe[0])==null?void 0:Me.min)!=null?xe:"":(et=(De=(Ae=(Se=e.selectedEl)==null?void 0:Se.chartOption)==null?void 0:Ae.yAxis)==null?void 0:De.min)!=null?et:"",onInput:t[72]||(t[72]=s=>{const z=s.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const M=e.selectedEl.chartOption.yAxis,he=z===""?null:Number(z);Array.isArray(M)?(M[0]=M[0]||{},M[0].min=he):(e.selectedEl.chartOption.yAxis=M||{},e.selectedEl.chartOption.yAxis.min=he),C.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ei)]),r("div",null,[t[210]||(t[210]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最大值",-1)),r("input",{value:Array.isArray((ot=(Ze=e.selectedEl)==null?void 0:Ze.chartOption)==null?void 0:ot.yAxis)?(_t=(kt=(tt=(pt=(qe=e.selectedEl)==null?void 0:qe.chartOption)==null?void 0:pt.yAxis)==null?void 0:tt[0])==null?void 0:kt.max)!=null?_t:"":(ol=(nl=(ll=(Jr=e.selectedEl)==null?void 0:Jr.chartOption)==null?void 0:ll.yAxis)==null?void 0:nl.max)!=null?ol:"",onInput:t[73]||(t[73]=s=>{const z=s.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const M=e.selectedEl.chartOption.yAxis,he=z===""?null:Number(z);Array.isArray(M)?(M[0]=M[0]||{},M[0].max=he):(e.selectedEl.chartOption.yAxis=M||{},e.selectedEl.chartOption.yAxis.max=he),C.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,ki)])])):ee("",!0),e.selectedEl&&(e.selectedEl.chartType==="line"||e.selectedEl.chartType==="mix")?(j(),O("div",Si,[r("div",null,[t[212]||(t[212]=r("label",{class:"block text-xs text-gray-400 mb-1"},"折线平滑",-1)),r("select",{value:"1",onChange:t[74]||(t[74]=s=>{const z=s.target.value==="1";e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(M=>{M.type==="line"&&(M.smooth=z)}),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[211]||(t[211]=[r("option",{value:"1"},"平滑",-1),r("option",{value:"0"},"不平滑",-1)])],32)]),r("div",null,[t[213]||(t[213]=r("label",{class:"block text-xs text-gray-400 mb-1"},"线宽",-1)),r("input",{value:2,onInput:t[75]||(t[75]=s=>{const z=Number(s.target.value)||2;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(M=>{M.type==="line"&&(M.lineStyle=M.lineStyle||{},M.lineStyle.width=z)}),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):ee("",!0),e.selectedEl&&(e.selectedEl.chartType==="bar"||e.selectedEl.chartType==="mix")?(j(),O("div",Mi,[r("div",null,[t[214]||(t[214]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变起始色",-1)),r("input",{type:"color",value:"#42b883",onInput:t[76]||(t[76]=s=>{const z=s.target.value;G(z,"#0ea5e9")}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[215]||(t[215]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变结束色",-1)),r("input",{type:"color",value:"#0ea5e9",onInput:t[77]||(t[77]=s=>{const z=s.target.value;G("#42b883",z)}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[216]||(t[216]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),r("input",{value:4,onInput:t[78]||(t[78]=s=>{const z=Number(s.target.value)||0;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(M=>{M.type==="bar"&&(M.itemStyle=M.itemStyle||{},M.itemStyle.borderRadius=[z,z,0,0])}),C.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):ee("",!0)])):(j(),O("div",Ci,[t[217]||(t[217]=r("label",{class:"block text-xs text-gray-400 mb-1"},"ECharts Option JSON",-1)),ye(r("textarea",{"onUpdate:modelValue":t[79]||(t[79]=s=>C.value=s),rows:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs font-mono"},null,512),[[ke,C.value]]),r("div",Ni,[r("button",{onClick:t[80]||(t[80]=s=>d()),class:"px-3 py-1 bg-emerald-600 rounded text-sm"},"应用配置"),V.value?(j(),O("div",Ii,Qe(V.value),1)):ee("",!0)])]))])):ee("",!0),e.selectedEl&&e.selectedEl.type==="line"?(j(),O("div",Ai,[t[226]||(t[226]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"线条设置",-1)),r("div",Fi,[t[219]||(t[219]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",ji,[r("input",{value:e.safeHex(((al=(sl=e.selectedEl)==null?void 0:sl.style)==null?void 0:al.lineColor)||""),onInput:t[81]||(t[81]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=s.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,zi),r("input",{value:(ul=(dl=(il=e.selectedEl)==null?void 0:il.style)==null?void 0:dl.lineColor)!=null?ul:"#ffffff",onInput:t[82]||(t[82]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=s.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,40,Oi)])]),r("div",Bi,[r("div",null,[t[220]||(t[220]=r("label",{class:"block text-xs text-gray-400 mb-1"},"方向",-1)),r("div",Di,[r("button",{onClick:t[83]||(t[83]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="horizontal")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((pl=(cl=e.selectedEl)==null?void 0:cl.style)==null?void 0:pl.lineOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[84]||(t[84]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="vertical")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((fl=(gl=e.selectedEl)==null?void 0:gl.style)==null?void 0:fl.lineOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)])]),r("div",null,[t[221]||(t[221]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细(px)",-1)),r("input",{value:(bl=(ml=(yl=e.selectedEl)==null?void 0:yl.style)==null?void 0:ml.lineThickness)!=null?bl:2,onInput:t[85]||(t[85]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineThickness=Number(s.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ti)])]),r("div",Gi,[r("div",null,[t[223]||(t[223]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),r("select",{value:((vl=(xl=e.selectedEl)==null?void 0:xl.style)==null?void 0:vl.lineStyle)||"solid",onChange:t[86]||(t[86]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineStyle=s.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[222]||(t[222]=[r("option",{value:"solid"},"实线",-1),r("option",{value:"dashed"},"虚线",-1)])],40,Ui)]),((wl=(hl=e.selectedEl)==null?void 0:hl.style)==null?void 0:wl.lineStyle)==="dashed"?(j(),O("div",Li,[t[224]||(t[224]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线长度(px)",-1)),r("input",{value:(kl=(El=($l=e.selectedEl)==null?void 0:$l.style)==null?void 0:El.lineDashLength)!=null?kl:6,onInput:t[87]||(t[87]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashLength=Number(s.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Vi)])):ee("",!0)]),((Ml=(Sl=e.selectedEl)==null?void 0:Sl.style)==null?void 0:Ml.lineStyle)==="dashed"?(j(),O("div",Ri,[r("div",null,[t[225]||(t[225]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线间距(px)",-1)),r("input",{value:(Il=(Nl=(Cl=e.selectedEl)==null?void 0:Cl.style)==null?void 0:Nl.lineDashGap)!=null?Il:4,onInput:t[88]||(t[88]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashGap=Number(s.target.value))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Pi)])])):ee("",!0)])):ee("",!0),e.selectedEl&&e.selectedEl.type==="text"?(j(),O("div",Hi,[t[259]||(t[259]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"文本设置",-1)),r("div",Wi,[t[231]||(t[231]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),ye(r("textarea",{"onUpdate:modelValue":t[89]||(t[89]=s=>e.selectedEl.text=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[ke,e.selectedEl.text]]),r("div",Ji,[t[230]||(t[230]=r("label",{class:"block text-xs text-gray-400 mb-1"},"动态值",-1)),r("div",qi,[r("input",{type:"checkbox",checked:!!((Fl=(Al=e.selectedEl)==null?void 0:Al.dynamic)!=null&&Fl.enabled),onChange:t[90]||(t[90]=s=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!1,objectName:"",propertyPath:""},e.selectedEl.dynamic.enabled=s.target.checked)}),class:"rounded accent-purple-600"},null,40,Xi),t[227]||(t[227]=r("span",{class:"text-xs text-gray-400"},"启用后从数据库对象绑定",-1))]),(zl=(jl=e.selectedEl)==null?void 0:jl.dynamic)!=null&&zl.enabled?(j(),O("div",Yi,[r("div",null,[t[228]||(t[228]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择对象",-1)),rt(yt,{options:e.databaseObjects.map(s=>s.name),modelValue:((Bl=(Ol=e.selectedEl)==null?void 0:Ol.dynamic)==null?void 0:Bl.objectName)||"","onUpdate:modelValue":t[91]||(t[91]=s=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.objectName=String(s||""))})},null,8,["options","modelValue"])]),r("div",null,[t[229]||(t[229]=r("label",{class:"block text-xs text-gray-400 mb-1"},"属性路径",-1)),rt(yt,{options:ae.value,modelValue:((Tl=(Dl=e.selectedEl)==null?void 0:Dl.dynamic)==null?void 0:Tl.propertyPath)||"","onUpdate:modelValue":t[92]||(t[92]=s=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.propertyPath=String(s||""))})},null,8,["options","modelValue"])]),r("div",_i,"预览值: "+Qe($e(e.selectedEl)),1)])):ee("",!0)])]),r("div",Ki,[t[232]||(t[232]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",Zi,[r("button",{onClick:t[93]||(t[93]=()=>{const s=e.selectedEl;!s||s.type!=="text"||(s.autoSize=!0)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize!==!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"自适应",2),r("button",{onClick:t[94]||(t[94]=()=>{const s=e.selectedEl;!s||s.type!=="text"||(s.autoSize=!1)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize===!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"固定尺寸",2)])]),r("div",Qi,[r("div",null,[t[233]||(t[233]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),rt(yt,{options:e.fontSizeLibrary,modelValue:((Gl=e.selectedEl.style)==null?void 0:Gl.fontSize)||14,"onUpdate:modelValue":t[95]||(t[95]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=s)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[t[234]||(t[234]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),rt(yt,{options:e.fontLibrary,modelValue:((Ul=e.selectedEl.style)==null?void 0:Ul.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[96]||(t[96]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=s)})},null,8,["options","modelValue"])])]),r("div",ed,[r("div",null,[t[235]||(t[235]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),rt(yt,{options:e.fontWeightOptions,modelValue:((Ll=e.selectedEl.style)==null?void 0:Ll.fontWeight)||"400","onUpdate:modelValue":t[97]||(t[97]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=s)})},null,8,["options","modelValue"])]),r("div",null,[t[236]||(t[236]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),rt(yt,{options:e.fontStyleOptions,modelValue:((Vl=e.selectedEl.style)==null?void 0:Vl.fontStyle)||"normal","onUpdate:modelValue":t[98]||(t[98]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=s)})},null,8,["options","modelValue"])])]),r("div",td,[r("div",null,[t[237]||(t[237]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:((Rl=e.selectedEl.style)==null?void 0:Rl.letterSpacing)||0,onInput:t[99]||(t[99]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(s.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,rd)]),r("div",null,[t[238]||(t[238]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:((Pl=e.selectedEl.style)==null?void 0:Pl.lineHeight)||1.5,onInput:t[100]||(t[100]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(s.target.value))}),type:"number",step:"0.1",min:"0.5",max:"3",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,ld)])]),r("div",nd,[t[239]||(t[239]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",od,[r("input",{value:(Wl=(Hl=e.selectedEl)==null?void 0:Hl.style)!=null&&Wl.textGradient?"#000000":((ql=(Jl=e.selectedEl)==null?void 0:Jl.style)==null?void 0:ql.color)||e.config.globalColor,onInput:t[101]||(t[101]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"color",disabled:!!((Yl=(Xl=e.selectedEl)==null?void 0:Xl.style)!=null&&Yl.textGradient),class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"},null,40,sd),r("input",{value:(Kl=(_l=e.selectedEl)==null?void 0:_l.style)!=null&&Kl.textGradient?"transparent":(en=(Ql=(Zl=e.selectedEl)==null?void 0:Zl.style)==null?void 0:Ql.color)!=null?en:e.config.globalColor,onInput:t[102]||(t[102]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=s.target.value)}),type:"text",disabled:!!((rn=(tn=e.selectedEl)==null?void 0:tn.style)!=null&&rn.textGradient),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"#000000"},null,40,ad)]),(nn=(ln=e.selectedEl)==null?void 0:ln.style)!=null&&nn.textGradient?(j(),O("div",id,"文字渐变启用时，文字颜色自动设为透明")):ee("",!0)]),r("div",dd,[t[240]||(t[240]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色",-1)),r("div",ud,[r("input",{value:e.safeHex(((sn=(on=e.selectedEl)==null?void 0:on.style)==null?void 0:sn.backgroundColor)||""),onInput:t[103]||(t[103]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=s.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,cd),r("input",{value:(un=(dn=(an=e.selectedEl)==null?void 0:an.style)==null?void 0:dn.backgroundColor)!=null?un:"transparent",onInput:t[104]||(t[104]=s=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=s.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"transparent"},null,40,pd)])]),r("div",gd,[t[241]||(t[241]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本对齐",-1)),r("div",fd,[r("button",{onClick:t[105]||(t[105]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((cn=e.selectedEl.style)==null?void 0:cn.textAlign)||"left")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左对齐",2),r("button",{onClick:t[106]||(t[106]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((pn=e.selectedEl.style)==null?void 0:pn.textAlign)||"left")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"居中",2),r("button",{onClick:t[107]||(t[107]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((gn=e.selectedEl.style)==null?void 0:gn.textAlign)||"left")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右对齐",2)])]),r("div",yd,[t[242]||(t[242]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本方向",-1)),r("div",md,[r("button",{onClick:t[108]||(t[108]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="horizontal")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((yn=(fn=e.selectedEl)==null?void 0:fn.style)==null?void 0:yn.textOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[109]||(t[109]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="vertical")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((bn=(mn=e.selectedEl)==null?void 0:mn.style)==null?void 0:bn.textOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)]),t[243]||(t[243]=r("p",{class:"text-[11px] text-gray-400"},"纵向使用 CSS writing-mode 展示，适合竖排文本。",-1))]),r("div",bd,[t[245]||(t[245]=r("label",{class:"block text-xs text-gray-400 mb-1"},"布局倾斜",-1)),r("div",xd,[ye(r("input",{"onUpdate:modelValue":t[110]||(t[110]=s=>e.selectedEl.style.skewAngle=s),type:"range",min:"-45",max:"45",class:"flex-1"},null,512),[[ke,e.selectedEl.style.skewAngle,void 0,{number:!0}]]),ye(r("input",{"onUpdate:modelValue":t[111]||(t[111]=s=>e.selectedEl.style.skewAngle=s),type:"number",min:"-45",max:"45",class:"w-16 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.style.skewAngle,void 0,{number:!0}]])]),r("div",vd,[t[244]||(t[244]=r("label",{class:"text-xs text-gray-400"},"布局倾斜跟随",-1)),r("button",{onClick:t[112]||(t[112]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!0)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(vn=(xn=e.selectedEl)==null?void 0:xn.style)!=null&&vn.skewFlowEnabled?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"开",2),r("button",{onClick:t[113]||(t[113]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!1)}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(wn=(hn=e.selectedEl)==null?void 0:hn.style)!=null&&wn.skewFlowEnabled?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-purple-600 text-white"])},"关",2)]),t[246]||(t[246]=r("p",{class:"text-[11px] text-gray-400"},"调整整体容器的 X 轴倾斜角度（-45° ~ 45°）。启用“跟随”后，文本布局按父视图倾斜线性排布，字符保持正立，可与波形叠加。",-1))]),r("div",hd,[r("div",wd,[t[247]||(t[247]=r("label",{class:"text-xs text-gray-400"},"文本波形",-1)),r("div",$d,[(kn=(En=($n=e.selectedEl)==null?void 0:$n.style)==null?void 0:En.textWave)!=null&&kn.enabled?(j(),O("button",{key:1,onClick:t[115]||(t[115]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!1})}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):(j(),O("button",{key:0,onClick:t[114]||(t[114]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!0,amplitude:8,frequency:.5,phase:0})}),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用"))])]),(Cn=(Mn=(Sn=e.selectedEl)==null?void 0:Sn.style)==null?void 0:Mn.textWave)!=null&&Cn.enabled?(j(),O("div",Ed,[r("div",kd,[t[248]||(t[248]=r("label",{class:"block text-xs text-gray-400 mb-1"},"幅度(px)",-1)),ye(r("input",{"onUpdate:modelValue":t[116]||(t[116]=s=>e.selectedEl.style.textWave.amplitude=s),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.style.textWave.amplitude,void 0,{number:!0}]])]),r("div",Sd,[t[249]||(t[249]=r("label",{class:"block text-xs text-gray-400 mb-1"},"频率(rad/字)",-1)),ye(r("input",{"onUpdate:modelValue":t[117]||(t[117]=s=>e.selectedEl.style.textWave.frequency=s),type:"number",step:"0.1",min:"0.1",max:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.style.textWave.frequency,void 0,{number:!0}]])]),r("div",Md,[t[250]||(t[250]=r("label",{class:"block text-xs text-gray-400 mb-1"},"相位(rad)",-1)),ye(r("input",{"onUpdate:modelValue":t[118]||(t[118]=s=>e.selectedEl.style.textWave.phase=s),type:"number",step:"0.1",min:"-100",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.style.textWave.phase,void 0,{number:!0}]])])])):ee("",!0),t[251]||(t[251]=r("p",{class:"text-[11px] text-gray-400"},"每个字符沿 Y 轴按正弦位移，字符保持正立。",-1))]),r("div",Cd,[t[252]||(t[252]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本装饰",-1)),r("div",Nd,[r("button",{onClick:t[119]||(t[119]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="underline"?"none":"underline")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Nn=e.selectedEl.style)==null?void 0:Nn.textDecoration)||"none")==="underline"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下划线",2),r("button",{onClick:t[120]||(t[120]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="line-through"?"none":"line-through")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((In=e.selectedEl.style)==null?void 0:In.textDecoration)||"none")==="line-through"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"删除线",2),r("button",{onClick:t[121]||(t[121]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration="none")}),class:je(["px-2 py-1 text-xs rounded transition-colors duration-200",(((An=e.selectedEl.style)==null?void 0:An.textDecoration)||"none")==="none"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"无",2)])]),r("div",Id,[r("div",Ad,[t[253]||(t[253]=r("label",{class:"text-xs text-gray-400"},"文本渐变",-1)),r("div",Fd,[(Fn=e.selectedEl.style)!=null&&Fn.textGradient?ee("",!0):(j(),O("button",{key:0,onClick:t[122]||(t[122]=s=>_(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(jn=e.selectedEl.style)!=null&&jn.textGradient?(j(),O("button",{key:1,onClick:t[123]||(t[123]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.textGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):ee("",!0)])]),(zn=e.selectedEl.style)!=null&&zn.textGradient?(j(),O("div",jd,[r("div",zd,[r("div",null,[t[254]||(t[254]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Od,[ye(r("input",{"onUpdate:modelValue":t[124]||(t[124]=s=>e.selectedEl.style.textGradient.colors[0]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[ke,e.selectedEl.style.textGradient.colors[0]]]),ye(r("input",{"onUpdate:modelValue":t[125]||(t[125]=s=>e.selectedEl.style.textGradient.colors[0]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#DFDD5A"},null,512),[[ke,e.selectedEl.style.textGradient.colors[0]]])])]),r("div",null,[t[255]||(t[255]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Bd,[ye(r("input",{"onUpdate:modelValue":t[126]||(t[126]=s=>e.selectedEl.style.textGradient.colors[1]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[ke,e.selectedEl.style.textGradient.colors[1]]]),ye(r("input",{"onUpdate:modelValue":t[127]||(t[127]=s=>e.selectedEl.style.textGradient.colors[1]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,512),[[ke,e.selectedEl.style.textGradient.colors[1]]])])])]),r("div",null,[r("label",Dd,"角度: "+Qe(e.selectedEl.style.textGradient.angle||0)+"°",1),ye(r("input",{"onUpdate:modelValue":t[128]||(t[128]=s=>e.selectedEl.style.textGradient.angle=s),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[ke,e.selectedEl.style.textGradient.angle,void 0,{number:!0}]])])])):ee("",!0)]),r("div",Td,[r("div",Gd,[t[256]||(t[256]=r("label",{class:"text-xs text-gray-400"},"背景渐变",-1)),r("div",Ud,[(On=e.selectedEl.style)!=null&&On.backgroundGradient?ee("",!0):(j(),O("button",{key:0,onClick:t[129]||(t[129]=s=>E(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(Bn=e.selectedEl.style)!=null&&Bn.backgroundGradient?(j(),O("button",{key:1,onClick:t[130]||(t[130]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.backgroundGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):ee("",!0)])]),(Dn=e.selectedEl.style)!=null&&Dn.backgroundGradient?(j(),O("div",Ld,[r("div",Vd,[r("div",null,[t[257]||(t[257]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Rd,[ye(r("input",{"onUpdate:modelValue":t[131]||(t[131]=s=>e.selectedEl.style.backgroundGradient.colors[0]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[ke,e.selectedEl.style.backgroundGradient.colors[0]]]),ye(r("input",{"onUpdate:modelValue":t[132]||(t[132]=s=>e.selectedEl.style.backgroundGradient.colors[0]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#00A3FF"},null,512),[[ke,e.selectedEl.style.backgroundGradient.colors[0]]])])]),r("div",null,[t[258]||(t[258]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Pd,[ye(r("input",{"onUpdate:modelValue":t[133]||(t[133]=s=>e.selectedEl.style.backgroundGradient.colors[1]=s),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[ke,e.selectedEl.style.backgroundGradient.colors[1]]]),ye(r("input",{"onUpdate:modelValue":t[134]||(t[134]=s=>e.selectedEl.style.backgroundGradient.colors[1]=s),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,512),[[ke,e.selectedEl.style.backgroundGradient.colors[1]]])])])]),r("div",null,[r("label",Hd,"角度: "+Qe(e.selectedEl.style.backgroundGradient.angle||0)+"°",1),ye(r("input",{"onUpdate:modelValue":t[135]||(t[135]=s=>e.selectedEl.style.backgroundGradient.angle=s),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[ke,e.selectedEl.style.backgroundGradient.angle,void 0,{number:!0}]])])])):ee("",!0)])])):ee("",!0),e.selectedEl&&e.selectedEl.type==="image"?(j(),O("div",Wd,[t[268]||(t[268]=Yr('<h3 class="text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1" data-v-0aecde2c>图片设置</h3><div class="space-y-2" data-v-0aecde2c><label class="block text-xs text-gray-400 mb-1" data-v-0aecde2c>图片来源</label><div class="grid grid-cols-2 gap-2" data-v-0aecde2c><button class="px-3 py-2 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200" data-v-0aecde2c>上传文件</button><button class="px-3 py-2 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200" data-v-0aecde2c>选择图标</button></div></div>',2)),r("div",Jd,[t[260]||(t[260]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图片文件",-1)),r("input",{type:"file",onChange:Ee,accept:"image/*",class:"w-full text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-purple-600 file:text-white hover:file:bg-purple-500 file:cursor-pointer"},null,32)]),e.iconLibrary.length>0?(j(),O("div",qd,[t[261]||(t[261]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择图标",-1)),r("div",Xd,[r("div",Yd,[(j(!0),O(At,null,Lt(e.iconLibrary,s=>(j(),O("div",{key:s.id,onClick:z=>q(s),class:"aspect-square bg-gray-700/50 rounded cursor-pointer hover:bg-gray-600/50 transition-colors duration-200 flex items-center justify-center p-1 border border-transparent hover:border-green-400/50"},[r("img",{src:s.url,alt:s.name,class:"max-w-full max-h-full object-contain",loading:"lazy"},null,8,Kd)],8,_d))),128))])]),e.iconLibrary.length===0?(j(),O("div",Zd,"暂无图标，请先在图标库管理中上传图标")):ee("",!0)])):ee("",!0),r("div",{class:"space-y-2"},[t[262]||(t[262]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",{class:"grid grid-cols-2 gap-2"},[r("button",{onClick:D,class:je(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-blue-600/30 hover:bg-blue-600/50 text-blue-300"])},"自适应（原始尺寸）"),r("button",{onClick:P,class:je(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-purple-600/30 hover:bg-purple-600/50 text-purple-300"])},"固定大小")])]),r("div",Qd,[r("div",null,[t[263]||(t[263]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度(px)",-1)),ye(r("input",{"onUpdate:modelValue":t[136]||(t[136]=s=>e.selectedEl.width=s),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[264]||(t[264]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度(px)",-1)),ye(r("input",{"onUpdate:modelValue":t[137]||(t[137]=s=>e.selectedEl.height=s),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.height,void 0,{number:!0}]])]),r("div",null,[t[266]||(t[266]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对象适配",-1)),ye(r("select",{"onUpdate:modelValue":t[138]||(t[138]=s=>e.selectedEl.style.objectFit=s),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[265]||(t[265]=[Yr('<option value="contain" data-v-0aecde2c>contain（完整显示）</option><option value="cover" data-v-0aecde2c>cover（填充裁剪）</option><option value="fill" data-v-0aecde2c>fill（拉伸填充）</option><option value="scale-down" data-v-0aecde2c>scale-down（缩小适配）</option><option value="none" data-v-0aecde2c>none（不适配）</option>',5)])],512),[[Gn,e.selectedEl.style.objectFit]])])]),r("div",eu,[t[267]||(t[267]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),ye(r("input",{"onUpdate:modelValue":t[139]||(t[139]=s=>e.selectedEl.style.borderRadius=s),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[ke,e.selectedEl.style.borderRadius,void 0,{number:!0}]])])])):ee("",!0),r("div",tu,[r("button",{onClick:t[140]||(t[140]=s=>p("saveSelectedAsComponent")),class:"w-full px-3 py-2 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"},"保存为组件"),r("button",{onClick:t[141]||(t[141]=s=>p("duplicateSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-blue-500/25"},"复制元素"),r("button",{onClick:t[142]||(t[142]=s=>p("removeSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"删除元素")])])):ee("",!0),e.selectedEl?ee("",!0):(j(),O("div",ru,[...t[269]||(t[269]=[r("div",{class:"w-16 h-16 mx-auto mb-4 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center"},[r("span",{class:"text-2xl"},"📝")],-1),r("p",{class:"text-sm"},"选择一个元素来编辑其属性",-1)])]))])}}}),ou=rl(nu,[["__scopeId","data-v-0aecde2c"]]),su={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},au={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},iu={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},du={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},uu={class:"flex gap-2"},cu={class:"relative"},pu={class:"grid grid-cols-2 gap-2"},gu={class:"flex items-center gap-2"},fu={class:"text-sm text-gray-400 min-w-[60px] text-center"},yu={key:0,class:"absolute inset-0 pointer-events-none z-50"},mu={key:1,class:"absolute inset-0 z-[9999] select-none pointer-events-none"},bu={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},xu={class:"relative w-[800px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-fuchsia-500/40 rounded-xl shadow-2xl"},vu={class:"p-4 space-y-3"},hu={class:"flex items-center gap-2"},wu={key:0,class:"text-center text-sm text-gray-400 py-6"},$u={key:1},Eu={key:0,class:"text-center text-sm text-gray-400 py-6"},ku={key:1,class:"grid grid-cols-3 gap-3"},Su={class:"aspect-video bg-gray-700/50 flex items-center justify-center"},Mu=["src"],Cu={key:1,class:"text-gray-400 text-xs"},Nu={class:"p-3 space-y-1"},Iu={class:"flex items-center justify-between"},Au=["title"],Fu={class:"text-xs text-gray-500"},ju={class:"flex flex-wrap gap-1 mt-1"},zu={class:"pt-2"},Ou=["onClick"],Bu={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},Du={class:"relative w-[600px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl"},Tu={class:"flex items-center justify-between p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20"},Gu={class:"p-4 space-y-3 max-h-[50vh] overflow-y-auto"},Uu={key:0,class:"text-center text-sm text-gray-400 py-6"},Lu={key:1,class:"space-y-2"},Vu=["title"],Ru=["onClick"],Pu=50,Hu=Mt({__name:"LowCodeBuilder",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(y){const n=y,e=oo(),p=io(),h=Re(()=>{var l;return(l=n.projectId)!=null?l:e.params.id?String(e.params.id):void 0}),C=we(null);async function V(){if(h.value)try{const l=(await $e()).transaction(["projects"],"readonly").objectStore("projects").get(h.value);l.onsuccess=()=>{C.value=l.result}}catch(l){console.error("加载项目信息失败:",l)}}function ae(){if(!h.value)return;const l=n.isComponent?{path:`/project/${h.value}/preview`,query:{type:"component"}}:{path:`/project/${h.value}/preview`},o=p.resolve(l).href;window.open(o,"_blank")}async function $e(){return new Promise((l,o)=>{const a="lowcode-projects",c="projects",f=indexedDB.open(a);f.onerror=()=>o(f.error),f.onupgradeneeded=()=>{const g=f.result;g.objectStoreNames.contains(c)||g.createObjectStore(c,{keyPath:"id"})},f.onsuccess=()=>{const g=f.result;if(g.objectStoreNames.contains(c))l(g);else{const I=g.version+1;g.close();const A=indexedDB.open(a,I);A.onerror=()=>o(A.error),A.onupgradeneeded=()=>{const N=A.result;N.objectStoreNames.contains(c)||N.createObjectStore(c,{keyPath:"id"})},A.onsuccess=()=>l(A.result)}}})}const k=Tn({width:1024,height:576,backgroundUrl:"",backgroundColor:"#000000",globalFontFamily:"Arial, Helvetica, sans-serif",globalFontSize:14,globalColor:"#FFFFFF"}),ge=we("GeneratedComponent"),U=we(["Arial, Helvetica, sans-serif","PingFang SC","Microsoft YaHei","Roboto","Inter"]),Z=we([8,9,10,11,12,14,16,18,20,24,28,32,36,48,64]),de=we(["100","200","300","400","500","600","700","800","900"]),_=we(["normal","italic","oblique"]),E=we([]),d=we(null),G=we([]),R=we({}),Q=we(null),H=we([]),X=we(!1);function Ee(){try{const l=JSON.parse(JSON.stringify(E.value));H.value.push(l),H.value.length>Pu&&H.value.shift()}catch(l){console.warn("pushHistory 序列化失败：",l)}}function q(){H.value.length!==0&&(E.value=H.value.pop(),d.value=null,se.value=!1)}function D(l){var g,I,A,N,S,i,u,B,J,ce,fe,ue,be,me,re;function o(ne){var ie;if(!ne)return!1;const le=(ie=ne.tagName)==null?void 0:ie.toLowerCase();return ne.isContentEditable||!!ne.closest('[contenteditable="true"]')||le==="input"||le==="textarea"||le==="select"}const a=document.activeElement;if(o(a)||o(l.target))return;const c=l.metaKey||l.ctrlKey,f=l.key.toLowerCase();if(f==="arrowleft"||f==="arrowright"||f==="arrowup"||f==="arrowdown"){if(!d.value)return;const{el:ne}=Oe(d.value);if(!ne)return;P.shift=l.shiftKey,f==="arrowleft"&&(P.left=!0),f==="arrowright"&&(P.right=!0),f==="arrowup"&&(P.up=!0),f==="arrowdown"&&(P.down=!0);const le=l.shiftKey?10:1;oe(f==="arrowleft"?-le:f==="arrowright"?le:0,f==="arrowup"?-le:f==="arrowdown"?le:0),Y!=null&&(clearTimeout(Y),Y=null),Y=window.setTimeout(()=>{x()},220),l.preventDefault();return}if(c&&f==="c"){if(Et.value){try{Q.value=JSON.parse(JSON.stringify(Et.value))}catch{}l.preventDefault()}}else if(c&&f==="v"){if(Q.value){const ne=Q.value,le=or(ne),{parentGroup:ie}=Oe(ne.id);if(ie){const Ie=Number((I=(g=ie.left)!=null?g:ie.x)!=null?I:0),m=Number((N=(A=ie.top)!=null?A:ie.y)!=null?N:0),w=Number((S=ie.width)!=null?S:0),L=Number((i=ie.height)!=null?i:0),F=Ie+w,T=m+L,K=Number((u=ne.width)!=null?u:0),v=Number((B=ne.height)!=null?B:0);let W=K,$=v;if(!W||!$)if(ne.type==="text"){const et=Number((J=ne.fontSize)!=null?J:16),Ze=String((fe=(ce=ne.text)!=null?ce:ne.content)!=null?fe:"").trim();W=Math.max(K||50,Math.round((Ze.length||2)*et*.6)),$=Math.max(v||20,Math.round(et*1.5))}else ne.type==="image"?(W=K||200,$=v||150):ne.type==="chart"?(W=K||240,$=v||160):ne.type==="line"?(W=K||200,$=v||2):(W=K||100,$=v||60);const pe=10,Me=Ie+w/2,xe=m+L/2;let Se=!1,Ae=F+pe,De=Math.round(xe-$/2);if(!Se&&Ae+W<=k.width&&(le.left=Math.max(0,Math.min(Ae,Math.max(0,k.width-W))),le.top=Math.max(0,Math.min(De,Math.max(0,k.height-$))),Se=!0),Ae=Ie-W-pe,De=Math.round(xe-$/2),!Se&&Ae>=0&&(le.left=Math.max(0,Math.min(Ae,Math.max(0,k.width-W))),le.top=Math.max(0,Math.min(De,Math.max(0,k.height-$))),Se=!0),Ae=Math.round(Me-W/2),De=T+pe,!Se&&De+$<=k.height&&(le.left=Math.max(0,Math.min(Ae,Math.max(0,k.width-W))),le.top=Math.max(0,Math.min(De,Math.max(0,k.height-$))),Se=!0),Ae=Math.round(Me-W/2),De=m-$-pe,!Se&&De>=0&&(le.left=Math.max(0,Math.min(Ae,Math.max(0,k.width-W))),le.top=Math.max(0,Math.min(De,Math.max(0,k.height-$))),Se=!0),!Se){const et=Number((be=(ue=ne.left)!=null?ue:ne.x)!=null?be:0),Ze=Number((re=(me=ne.top)!=null?me:ne.y)!=null?re:0),ot=Ie+et+pe,qe=m+Ze+pe;le.left=Math.max(0,Math.min(Math.round(ot),Math.max(0,k.width-W))),le.top=Math.max(0,Math.min(Math.round(qe),Math.max(0,k.height-$)))}le.x=le.left,le.y=le.top}Ee(),E.value.push(le),d.value=le.id,l.preventDefault()}}else if(f==="delete"||f==="backspace"){if(d.value){Ee();const{el:ne,parentGroup:le}=Oe(d.value);ne&&le&&Array.isArray(le.children)?le.children=le.children.filter(ie=>ie.id!==ne.id):(E.value=E.value.filter(ie=>ie.id!==d.value),ne&&ne.type==="group"&&Kt(ne.id)),d.value=null,l.preventDefault()}}else c&&f==="z"&&(q(),l.preventDefault())}const P=Tn({left:!1,right:!1,up:!1,down:!1,shift:!1});let Be=null,b=0,Y=null;function oe(l,o){var be,me,re,ne,le,ie,Ie,m;const a=d.value;if(!a)return;const{el:c,parentGroup:f}=Oe(a);if(!c)return;const g=(re=(me=c.width)!=null?me:(be=R.value[a])==null?void 0:be.width)!=null?re:0,I=(ie=(le=c.height)!=null?le:(ne=R.value[a])==null?void 0:ne.height)!=null?ie:0;let A=k.width,N=k.height;f&&f.width&&f.height&&(A=Number(f.width)||A,N=Number(f.height)||N);let S=((Ie=c.left)!=null?Ie:0)+l,i=((m=c.top)!=null?m:0)+o;S=Math.round(S),i=Math.round(i),S=Math.max(0,Math.min(S,A-(g||0))),i=Math.max(0,Math.min(i,N-(I||0))),c.left=S,c.top=i,c.x=c.left,c.y=c.top;const u=c.left,B=c.top,J=u+(g||0),ce=B+(I||0),fe=u+(g||0)/2,ue=B+(I||0)/2;it({left:u,top:B,right:J,bottom:ce,centerX:fe,centerY:ue})}function x(){if(Be!=null)return;b=Date.now(),Ee();const l=()=>{if(!P.left&&!P.right&&!P.up&&!P.down){Be!=null&&cancelAnimationFrame(Be),Be=null,ct();return}const o=Date.now()-b,a=o>1500?8:o>800?4:o>300?2:1,c=(P.shift?10:1)*a,f=(P.left?-c:0)+(P.right?c:0),g=(P.up?-c:0)+(P.down?c:0);oe(f,g),Be=requestAnimationFrame(l)};Be=requestAnimationFrame(l)}function t(l){const o=l.key.toLowerCase();o==="shift"&&(P.shift=!1),o==="arrowleft"&&(P.left=!1),o==="arrowright"&&(P.right=!1),o==="arrowup"&&(P.up=!1),o==="arrowdown"&&(P.down=!1),Y!=null&&(clearTimeout(Y),Y=null),!P.left&&!P.right&&!P.up&&!P.down&&Be==null&&Ee(),!P.left&&!P.right&&!P.up&&!P.down&&ct()}const se=we(!1),te=we({left:0,top:0,right:0,bottom:0,centerX:0,centerY:0});function lt(l){R.value[l.id]=l}function He(l){return l==="pie"?{backgroundColor:"transparent",tooltip:{trigger:"item"},legend:{top:"5%",left:"center",textStyle:{color:"#fff"},show:!0},series:[{name:"分类占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#111",borderWidth:2},label:{show:!0,color:"#fff"},labelLine:{show:!0},data:[{value:1048,name:"A"},{value:735,name:"B"},{value:580,name:"C"},{value:484,name:"D"},{value:300,name:"E"}]}]}:l==="mix"?{backgroundColor:"transparent",color:["#00bcd4","#ff9800"],tooltip:{trigger:"axis"},legend:{textStyle:{color:"#fff"},show:!0},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"销量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}},{name:"均价",type:"line",smooth:!0,data:[30,40,45,50,49,60,70],lineStyle:{width:2}}]}:l==="bar"?{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"数量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}}]}:{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"趋势",type:"line",smooth:!0,data:[150,230,224,218,135,147,260],lineStyle:{width:2}}]}}function We(l){var ne,le;const o=`${l}-${Date.now()}`,a=It.value,c=Je.value||1,f=(ne=a==null?void 0:a.clientWidth)!=null?ne:0,g=(le=a==null?void 0:a.clientHeight)!=null?le:0,I=a?(a.scrollLeft+f/2)/c:20,A=a?(a.scrollTop+g/2)/c:20,N=l==="chart"?240:l==="image"||l==="line"?200:l==="container"?240:void 0,S=l==="chart"?160:l==="image"?150:l==="line"?2:l==="container"?160:void 0,i=Math.round(I-(N?N/2:10)),u=Math.round(A-(S?S/2:10)),B=Math.max(0,Math.min(i,Math.max(0,k.width-(N!=null?N:0)))),J=Math.max(0,Math.min(u,Math.max(0,k.height-(S!=null?S:0)))),ce=(ie,Ie,m,w)=>{const L=Math.max(0,Math.min(ie,Math.max(0,k.width-(m!=null?m:0)))),F=Math.max(0,Math.min(Ie,Math.max(0,k.height-(w!=null?w:0))));return{cl:L,ct:F}},fe=E.value.map(ie=>{var F,T,K,v,W,$;const Ie=(F=ie.width)!=null?F:0,m=(T=ie.height)!=null?T:0,w=Number((v=(K=ie.left)!=null?K:ie.x)!=null?v:0),L=Number(($=(W=ie.top)!=null?W:ie.y)!=null?$:0);return{l:w,t:L,r:w+Ie,b:L+m}}),ue=(ie,Ie,m,w)=>{const L=ie+(m!=null?m:0),F=Ie+(w!=null?w:0);for(const T of fe)if(!(m===void 0||w===void 0)&&!(L<=T.l||F<=T.t||ie>=T.r||Ie>=T.b))return!0;return!1},be=24;let me={cl:B,ct:J};if(N&&S&&ue(me.cl,me.ct,N,S)){let ie=!1;for(let Ie=1;Ie<=20&&!ie;Ie++)for(const m of[[Ie,0],[0,Ie],[-Ie,0],[0,-Ie]]){const[w,L]=m,F=i+w*be,T=u+L*be,K=ce(F,T,N,S);if(!ue(K.cl,K.ct,N,S)){me=K,ie=!0;break}}}const re={id:o,type:l,left:me.cl,top:me.ct,autoSize:l==="text",width:N,height:S,text:l==="text"?"文字":l==="image"||l==="line"?"":"图表",className:"",zIndex:1,style:{}};if(l==="text"?Object.assign(re,{content:"文字",fontSize:16,fontWeight:"400",fontFamily:"Arial, Helvetica, sans-serif",color:"#ffffff",letterSpacing:"0px",lineHeight:"1.5",fontStyle:"normal",useGradient:!1,gradientStart:"#00A3FF",gradientEnd:"#ffffff",gradientDirection:"to right",x:me.cl,y:me.ct}):l==="image"&&(Object.assign(re,{src:"",borderRadius:0,x:me.cl,y:me.ct}),re.style={...re.style||{},objectFit:"contain"}),l==="chart"&&Object.assign(re,{elementId:`chart-${Date.now()}`,chartType:"line",chartOption:He("line")}),l==="line"&&(re.autoSize=!1,re.style={...re.style||{},lineColor:"#ffffff",lineThickness:2,lineOrientation:"horizontal",lineStyle:"solid",lineDashLength:6,lineDashGap:4}),l==="arc-text"){re.autoSize=!1,re.text="环绕文字";const ie=60;re.width=re.width||ie*2+20,re.height=re.height||ie*2+20,re.style={...re.style||{},fontFamily:k.globalFontFamily,fontSize:Math.max(12,k.globalFontSize),color:k.globalColor,textAlign:"center",arcText:{radius:ie,startAngle:0,sweepAngle:180,clockwise:!0}}}l==="container"&&(re.autoSize=!1,re.text="",re.elementId=`container-${Date.now()}`,re.style={...re.style||{},backgroundColor:"transparent",borderRadius:"6px"}),Ee(),E.value.push(re),d.value=o}function Ye(l){const{el:o}=Oe(l.id);o&&(X.value||(Ee(),X.value=!0),o.left=l.left,o.top=l.top,o.x=l.left,o.y=l.top)}function _e(l){const{el:o}=Oe(l.id);o&&(X.value||(Ee(),X.value=!0),o.width=l.width,o.height=l.height,l.left!==void 0&&(o.left=l.left,o.x=l.left),l.top!==void 0&&(o.top=l.top,o.y=l.top))}function at(l){d.value=l,wt()}function vt(l){d.value=l,wt(),Zr(()=>{const o=document.querySelector(`[data-el-id="${l}"]`);o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})}function ht(l,o){if(l===o||l<0||o<0||l>=E.value.length||o>=E.value.length)return;Ee();const[a]=E.value.splice(l,1);a&&(E.value.splice(o,0,a),d.value=a.id)}function wt(){if(Ke(),!ft.value)return;const l=d.value;if(!l)return;const o=Fe.value.find(g=>g.id===l);if(!o)return;const a=Fe.value.filter(g=>g.id!==l),c={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY};te.value={left:c.left,top:c.top,right:c.right,bottom:c.bottom,centerX:c.centerX,centerY:c.centerY},ze.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1};const f=4;for(const g of a)Math.abs(c.centerX-g.centerX)<=f&&g.w>0&&(ze.value.centerV=!0,te.value.centerX=g.centerX),Math.abs(c.centerY-g.centerY)<=f&&g.h>0&&(ze.value.centerH=!0,te.value.centerY=g.centerY),Math.abs(c.left-g.left)<=f&&(ze.value.left=!0,te.value.left=g.left),Math.abs(c.right-g.right)<=f&&g.w>0&&(ze.value.right=!0,te.value.right=g.right),Math.abs(c.top-g.top)<=f&&(ze.value.top=!0,te.value.top=g.top),Math.abs(c.bottom-g.bottom)<=f&&g.h>0&&(ze.value.bottom=!0,te.value.bottom=g.bottom);se.value=Object.values(ze.value).some(Boolean)}function Ft(){d.value=null,ct()}const ze=we({centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1}),ve=we({left:null,right:null,up:null,down:null}),gt=we(!0),ft=we(!0),bt=we(!1),Ct=Re(()=>E.value.filter(l=>l.hidden));function Pe(l){const o=E.value.find(a=>a.id===l);o&&(o.hidden=!1,d.value=l,Zr(()=>{const a=document.querySelector(`[data-el-id="${l}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"}),bt.value=!1}))}const Ne=we(null),Ce=we(null),Fe=Re(()=>{const l=[];function o(a,c,f,g){var I,A,N,S;for(const i of a){const u=R.value[i.id],B=u?u.left:(I=i.left)!=null?I:0,J=u?u.top:(A=i.top)!=null?A:0,ce=u?u.width:(N=i.width)!=null?N:0,fe=u?u.height:(S=i.height)!=null?S:0,ue=c+B,be=f+J;l.push({id:i.id,left:ue,top:be,right:ue+ce,bottom:be+fe,centerX:ue+ce/2,centerY:be+fe/2,w:ce,h:fe,type:i.type,parentId:g}),(i.type==="group"||i.type==="container")&&Array.isArray(i.children)&&o(i.children,ue,be,i.id)}}return o(E.value,0,0,null),l});function it(l){X.value||(Ee(),X.value=!0),te.value={left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.centerX,centerY:l.centerY},ze.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},ve.value={left:null,right:null,up:null,down:null};const o=.5,a=d.value,c=Fe.value.find(u=>u.id===a),f=c?c.parentId:null,g=Fe.value.filter(u=>u.parentId===f);function I(u,B,J,ce){const fe=Math.max(u,J);return Math.min(B,ce)-fe}let A=null,N=null,S=null,i=null;for(const u of g)if(!(!a||u.id===a)){if(Math.abs(l.centerX-u.centerX)<=o&&u.w>0&&(ze.value.centerV=!0,te.value.centerX=u.centerX),Math.abs(l.centerY-u.centerY)<=o&&u.h>0&&(ze.value.centerH=!0,te.value.centerY=u.centerY),Math.abs(l.left-u.left)<=o&&(ze.value.left=!0,te.value.left=u.left),Math.abs(l.right-u.right)<=o&&u.w>0&&(ze.value.right=!0,te.value.right=u.right),Math.abs(l.top-u.top)<=o&&(ze.value.top=!0,te.value.top=u.top),Math.abs(l.bottom-u.bottom)<=o&&u.h>0&&(ze.value.bottom=!0,te.value.bottom=u.bottom),I(l.top,l.bottom,u.top,u.bottom)>0){const B=l.left-u.right;B>=0&&(!A||B<A.gap)&&(A={gap:B,m:u});const J=u.left-l.right;J>=0&&(!N||J<N.gap)&&(N={gap:J,m:u})}if(I(l.left,l.right,u.left,u.right)>0){const B=l.top-u.bottom;B>=0&&(!S||B<S.gap)&&(S={gap:B,m:u});const J=u.top-l.bottom;J>=0&&(!i||J<i.gap)&&(i={gap:J,m:u})}}if(se.value=Object.values(ze.value).some(Boolean),!gt.value){ve.value={left:null,right:null,up:null,down:null};return}if(A){const u=A.m,B=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,J=(Math.max(l.top,u.top)+Math.min(l.bottom,u.bottom))/2;ve.value.left={gap:Math.floor(A.gap),exact:A.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}if(N){const u=N.m,B=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,J=(Math.max(l.top,u.top)+Math.min(l.bottom,u.bottom))/2;ve.value.right={gap:Math.floor(N.gap),exact:N.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}if(S){const u=S.m,B=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,J=(u.bottom+l.top)/2;ve.value.up={gap:Math.floor(S.gap),exact:S.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}if(i){const u=i.m,B=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,J=(l.bottom+u.top)/2;ve.value.down={gap:Math.floor(i.gap),exact:i.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}ft.value||(ze.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},se.value=!1)}function Ke(){if(!gt.value){ve.value={left:null,right:null,up:null,down:null};return}const l=d.value;if(!l){ve.value={left:null,right:null,up:null,down:null};return}const o=Fe.value.find(u=>u.id===l);if(!o){ve.value={left:null,right:null,up:null,down:null};return}const a={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY},c=o.parentId,f=Fe.value.filter(u=>u.id!==l&&u.parentId===c);function g(u,B,J,ce){const fe=Math.max(u,J);return Math.min(B,ce)-fe}let I=null,A=null,N=null,S=null;for(const u of f){if(g(a.top,a.bottom,u.top,u.bottom)>0){const B=a.left-u.right;B>=0&&(!I||B<I.gap)&&(I={gap:B,m:u});const J=u.left-a.right;J>=0&&(!A||J<A.gap)&&(A={gap:J,m:u})}if(g(a.left,a.right,u.left,u.right)>0){const B=a.top-u.bottom;B>=0&&(!N||B<N.gap)&&(N={gap:B,m:u});const J=u.top-a.bottom;J>=0&&(!S||J<S.gap)&&(S={gap:J,m:u})}}const i={left:null,right:null,up:null,down:null};if(I){const u=I.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,J=(Math.max(a.top,u.top)+Math.min(a.bottom,u.bottom))/2;i.left={gap:Math.floor(I.gap),exact:I.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}if(A){const u=A.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,J=(Math.max(a.top,u.top)+Math.min(a.bottom,u.bottom))/2;i.right={gap:Math.floor(A.gap),exact:A.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}if(N){const u=N.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,J=(u.bottom+a.top)/2;i.up={gap:Math.floor(N.gap),exact:N.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}if(S){const u=S.m,B=(Math.max(a.left,u.left)+Math.min(a.right,u.right))/2,J=(a.bottom+u.top)/2;i.down={gap:Math.floor(S.gap),exact:S.gap,refId:u.id,x:Math.round(B),y:Math.round(J)}}ve.value=i}function ct(){X.value=!1,ft.value&&d.value?wt():se.value=!1,Ke()}function Oe(l){if(!l)return{el:null,parentGroup:null};const o=(a,c)=>{for(const f of a){if(f.id===l)return{el:f,parentGroup:c};if((f.type==="group"||f.type==="container")&&Array.isArray(f.children)){const g=o(f.children,f);if(g)return g}}return null};return o(E.value,null)||{el:null,parentGroup:null}}const dt=we(null);function jt(l,o){if(!l.children||!Array.isArray(l.children))return!1;const a=[...l.children];for(;a.length;){const c=a.pop();if((c==null?void 0:c.id)===o.id)return!0;c!=null&&c.children&&Array.isArray(c.children)&&a.push(...c.children)}return!1}function zt(l){var B,J,ce,fe;const{id:o,globalLeft:a,globalTop:c}=l;if(!o)return;const f=(B=dt.value)==null?void 0:B.getBoundingClientRect();if(!f)return;const{el:g,parentGroup:I}=Oe(o);if(!g)return;const A=(((J=R.value[o])==null?void 0:J.width)||Number(g.width)||0)*Je.value,N=(((ce=R.value[o])==null?void 0:ce.height)||Number(g.height)||0)*Je.value,S={left:a,top:c,right:a+A,bottom:c+N};function i(){const ue=S.left+1,be=S.top+1,me=S.right-1,re=S.bottom-1;return[{x:(S.left+S.right)/2,y:(S.top+S.bottom)/2},{x:ue,y:be},{x:me,y:be},{x:ue,y:re},{x:me,y:re}]}let u=null;for(const ue of i()){const be=document.elementsFromPoint(ue.x,ue.y);for(const me of be){const re=(fe=me.closest("[data-box-id]"))==null?void 0:fe.getAttribute("data-box-id");if(!re||re===o)continue;const{el:ne}=Oe(re);if(ne&&!(ne.type!=="container"&&ne.type!=="group")&&ne.id!==g.id&&!jt(g,ne)){u=re;break}}if(u)break}if(I?Array.isArray(I.children)&&(I.children=I.children.filter(ue=>ue.id!==o)):E.value=E.value.filter(ue=>ue.id!==o),u){const{el:ue}=Oe(u);if(ue){const be=document.querySelector(`[data-box-id="${u}"]`);if(be){const me=be.getBoundingClientRect(),re=(a-me.left)/Je.value,ne=(c-me.top)/Je.value;g.left=Math.round(re),g.top=Math.round(ne),g.x=g.left,g.y=g.top,ue.children||(ue.children=[]),ue.children.push(g)}}}else{const ue=(a-f.left)/Je.value,be=(c-f.top)/Je.value;g.left=Math.round(ue),g.top=Math.round(be),g.x=g.left,g.y=g.top,E.value.push(g)}Ee(),Zr(()=>{d.value=o})}function $t(l){const o=ve.value[l];o&&(Ne.value=l,Ce.value=o.gap)}function Ot(){var A,N,S,i,u;if(!Ne.value||Ce.value==null){Ne.value=null,Ce.value=null;return}const l=Ne.value,o=ve.value[l];if(!o){Ne.value=null,Ce.value=null;return}const a=Fe.value.find(B=>B.id===o.refId),c=Ce.value,f=Et.value;if(!a||!f){Ne.value=null,Ce.value=null;return}Ee();const g=(A=o.exact)!=null?A:o.gap,I=c-g;l==="left"?f.left=Math.round(((N=f.left)!=null?N:0)+I):l==="right"?f.left=Math.round(((S=f.left)!=null?S:0)-I):l==="up"?f.top=Math.round(((i=f.top)!=null?i:0)+I):l==="down"&&(f.top=Math.round(((u=f.top)!=null?u:0)-I)),Ne.value=null,Ce.value=null,Ke()}mt(d,()=>{X.value||Ke()}),mt(R,()=>{X.value||Ke()},{deep:!0}),mt(gt,l=>{l?Ke():(Ne.value=null,Ce.value=null,ve.value={left:null,right:null,up:null,down:null})}),mt(ft,l=>{l?wt():(ze.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},se.value=!1)});const Et=Re(()=>d.value?Oe(d.value).el:null);async function br(){return new Promise((l,o)=>{const a=indexedDB.open("lowcode-db",1);a.onupgradeneeded=()=>{const c=a.result;if(!c.objectStoreNames.contains("objects")){const f=c.createObjectStore("objects",{keyPath:"id"});try{f.createIndex("projectId","projectId",{unique:!1}),f.createIndex("name","name",{unique:!1})}catch{}}},a.onsuccess=()=>l(a.result),a.onerror=()=>o(a.error)})}async function xr(){try{const l=(await br()).transaction(["objects"],"readonly").objectStore("objects").getAll();l.onsuccess=()=>{G.value=(l.result||[]).filter(o=>!o.projectId||o.projectId===(n.projectId||void 0))},l.onerror=()=>{console.warn("loadDatabaseObjects error",l.error)}}catch(l){console.warn("openDatabaseDB error",l)}}const vr=Re(()=>{const l={};for(const o of G.value)o&&o.name&&(l[o.name]=o.content);return l}),Nt=we({}),Bt=Re(()=>{const l={...vr.value};for(const o in Nt.value)Object.assign(l,Nt.value[o]);return l});function hr(l,o){const a={};for(const c of o)c&&c.name&&(a[c.name]=c.content);Nt.value[l]=a}function Kt(l){Nt.value[l]&&delete Nt.value[l];const o=`component-fonts-${l}`,a=document.getElementById(o);a&&a.parentNode&&a.parentNode.removeChild(a)}function wr(l,o="#000000"){try{const a=String(l||"").trim();return/^#([0-9a-fA-F]{6})$/.test(a)?a:o}catch{return o}}function $r(){if(!d.value)return;Ee();const{el:l,parentGroup:o}=Oe(d.value);l&&o&&Array.isArray(o.children)?o.children=o.children.filter(a=>a.id!==l.id):(E.value=E.value.filter(a=>a.id!==d.value),l&&l.type==="group"&&Kt(l.id)),d.value=null}function Zt(l){(!l.className||!l.className.trim())&&(l.className=`cls-${String(l.id).slice(0,8)}`)}function Er(l){try{Zt(l);const o=String(l.className||"").trim();String(l.customClassCss||"").trim()||(l.customClassCss=`.${o} {
  
}`)}catch{}}function kr(l){const o=String(l||"").trim();return o?o.split(";").map(a=>{const c=a.trim();return c?/!important\s*$/.test(c)?c+";":c+" !important;":""}).filter(Boolean).join(`
`):""}function Sr(l){return String(l||"").replace(/\{([^}]*)\}/g,(o,a)=>`{
`+String(a||"").split(";").map(c=>{const f=c.trim();return f?f.startsWith("@")||!/:/.test(f)||/!important\s*$/.test(f)?f+";":f+" !important;":""}).filter(Boolean).join(`
`)+`
}`)}function Mr(l){try{if(!l.enableClassStyle)return;Zt(l);const o=String(l.customClassCss||"").trim();if(!o)return;const a=`custom-class-${l.id}`;let c=document.getElementById(a);if(c||(c=document.createElement("style"),c.id=a,document.head.appendChild(c)),/{[^}]*}/.test(o)){c.textContent=Sr(o);return}const f=kr(o);c.textContent=`.${String(l.className).trim()} {
${f}
}`}catch(o){console.warn("注入自定义类样式失败：",o)}}function Qt(l){try{const o=`custom-class-${l}`,a=document.getElementById(o);a&&a.remove()}catch{}}function er(l,o){for(const a of l)o(a),(a.type==="group"||a.type==="container")&&Array.isArray(a.children)&&er(a.children,o)}let Vt=null;function Rt(){Vt&&clearTimeout(Vt),Vt=setTimeout(()=>{try{er(E.value,l=>{l.enableClassStyle&&l.customClassCss&&l.className?Mr(l):Qt(l.id)})}catch(l){console.warn("刷新自定义类样式失败：",l)}},50)}async function Cr(){var l,o,a,c,f,g,I,A,N,S;try{const i=Et.value;if(!i){alert("请先选中要保存的元素或分组");return}const u=ge.value||(i.type==="group"?"分组组件":"元素组件"),B=prompt("请输入组件名称",u);if(B===null)return;const J=(B||u).trim()||"未命名组件";let ce=[];if(i.type==="group"&&Array.isArray(i.children)){const m=Number((o=(l=i.left)!=null?l:i.x)!=null?o:0),w=Number((c=(a=i.top)!=null?a:i.y)!=null?c:0);ce=i.children.map(L=>{var pe,Me,xe,Se,Ae,De;const F=JSON.parse(JSON.stringify(L)),T=Number((Me=(pe=F.left)!=null?pe:F.x)!=null?Me:0),K=Number((Se=(xe=F.top)!=null?xe:F.y)!=null?Se:0);F.left=m+T,F.top=w+K,F.x=F.left,F.y=F.top;const v=R.value[L.id],W=Number(F.width||0),$=Number(F.height||0);if(!(W>0)){const et=(()=>{var Ze,ot,qe,pt,tt;if(F.type==="text"){const kt=Number((Ze=F.fontSize)!=null?Ze:16),_t=String((ot=F.text)!=null?ot:"").trim();return Math.max(50,Math.round((_t.length||2)*kt*.6))}if(F.type==="image")return 100;if(F.type==="chart")return 240;if(F.type==="line"){const kt=Number((pt=(qe=F.style)==null?void 0:qe.lineThickness)!=null?pt:2);return(((tt=F.style)==null?void 0:tt.lineOrientation)||"horizontal")==="vertical"?kt:100}return 50})();F.width=Math.max(1,Math.round((Ae=v==null?void 0:v.width)!=null?Ae:et))}if(!($>0)){const et=(()=>{var Ze,ot,qe,pt;if(F.type==="text"){const tt=Number((Ze=F.fontSize)!=null?Ze:16);return Math.max(20,Math.round(tt*1.5))}if(F.type==="image")return 100;if(F.type==="chart")return 160;if(F.type==="line"){const tt=Number((qe=(ot=F.style)==null?void 0:ot.lineThickness)!=null?qe:2);return(((pt=F.style)==null?void 0:pt.lineOrientation)||"horizontal")==="vertical"?100:tt}return 20})();F.height=Math.max(1,Math.round((De=v==null?void 0:v.height)!=null?De:et))}return F.id=`${F.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,F})}else{const m=JSON.parse(JSON.stringify(i)),w=Number((g=(f=m.left)!=null?f:m.x)!=null?g:0),L=Number((A=(I=m.top)!=null?I:m.y)!=null?A:0);m.left=w,m.top=L,m.x=m.left,m.y=m.top;const F=R.value[i.id],T=Number(m.width||0),K=Number(m.height||0);if(!(T>0)){const v=(()=>{var W,$,pe,Me,xe;if(m.type==="text"){const Se=Number((W=m.fontSize)!=null?W:16),Ae=String(($=m.text)!=null?$:"").trim();return Math.max(50,Math.round((Ae.length||2)*Se*.6))}if(m.type==="image")return 100;if(m.type==="chart")return 240;if(m.type==="line"){const Se=Number((Me=(pe=m.style)==null?void 0:pe.lineThickness)!=null?Me:2);return(((xe=m.style)==null?void 0:xe.lineOrientation)||"horizontal")==="vertical"?Se:100}return 50})();m.width=Math.max(1,Math.round((N=F==null?void 0:F.width)!=null?N:v))}if(!(K>0)){const v=(()=>{var W,$,pe,Me;if(m.type==="text"){const xe=Number((W=m.fontSize)!=null?W:16);return Math.max(20,Math.round(xe*1.5))}if(m.type==="image")return 100;if(m.type==="chart")return 160;if(m.type==="line"){const xe=Number((pe=($=m.style)==null?void 0:$.lineThickness)!=null?pe:2);return(((Me=m.style)==null?void 0:Me.lineOrientation)||"horizontal")==="vertical"?100:xe}return 20})();m.height=Math.max(1,Math.round((S=F==null?void 0:F.height)!=null?S:v))}m.id=`${m.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,ce=[m]}const fe=Math.min(...ce.map(m=>{var w,L;return Number((L=(w=m.left)!=null?w:m.x)!=null?L:0)})),ue=Math.min(...ce.map(m=>{var w,L;return Number((L=(w=m.top)!=null?w:m.y)!=null?L:0)})),be=Math.max(...ce.map(m=>{var w,L,F;return Number((L=(w=m.left)!=null?w:m.x)!=null?L:0)+Number((F=m.width)!=null?F:0)})),me=Math.max(...ce.map(m=>{var w,L,F;return Number((L=(w=m.top)!=null?w:m.y)!=null?L:0)+Number((F=m.height)!=null?F:0)})),re=Math.max(1,Math.round(be-fe)),ne=Math.max(1,Math.round(me-ue));ce=ce.map(m=>{var T,K,v,W;const w=JSON.parse(JSON.stringify(m)),L=Number((K=(T=w.left)!=null?T:w.x)!=null?K:0)-fe,F=Number((W=(v=w.top)!=null?v:w.y)!=null?W:0)-ue;return w.left=Math.max(0,Math.round(L)),w.top=Math.max(0,Math.round(F)),w.x=w.left,w.y=w.top,w});const le={width:re,height:ne,backgroundUrl:"",backgroundColor:"transparent",globalFontFamily:k.globalFontFamily,globalFontSize:k.globalFontSize,globalColor:k.globalColor},ie=`${Date.now()}${Math.random().toString(36).slice(2,9)}`,Ie={id:ie,name:J,description:"",tags:[],elements:ce,config:le,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await Xe.init(),await Xe.saveComponent(JSON.parse(JSON.stringify(Ie))),await qt(`component-${ie}`,{config:le,elements:ce,exportName:J}),alert("组件已保存到组件库")}catch(i){console.warn("保存组件失败：",i),alert("保存组件失败，请稍后重试")}}const Nr=we(null);function Ir(l){var c;const o=(c=l.target.files)==null?void 0:c[0];if(!o)return;const a=new FileReader;a.onload=()=>{const f=String(a.result);k.backgroundUrl=f;const g=new Image;g.onload=()=>{Nr.value={width:g.naturalWidth,height:g.naturalHeight},k.width=g.naturalWidth,k.height=g.naturalHeight},g.src=f},a.readAsDataURL(o)}function Dt(l){var o;return l&&((o=l.split(",")[0])!=null?o:"").trim().replace(/^['"]|['"]$/g,"")||null}function xt(l){return{"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","image/avif":"avif","image/apng":"apng","image/x-icon":"ico","image/vnd.microsoft.icon":"ico","font/ttf":"ttf","font/otf":"otf","font/woff":"woff","font/woff2":"woff2","application/font-ttf":"ttf","application/font-otf":"otf","application/font-woff":"woff","application/font-woff2":"woff2","application/x-font-ttf":"ttf","application/x-font-otf":"otf","application/x-font-woff":"woff","application/x-font-woff2":"woff2","application/vnd.ms-fontobject":"eot","application/octet-stream":"bin"}[l]||"bin"}function tr(l){var c;const o=/\.([A-Za-z0-9]+)$/.exec(l||"");if(!o)return null;const a=((c=o[1])!=null?c:"").toLowerCase();return a?["png","jpg","jpeg","gif","svg","webp","avif","apng","ico"].includes(a)?a==="jpeg"?"jpg":a:["ttf","otf","woff","woff2","eot"].includes(a)?a:null:null}async function Tt(l){try{const o="lowcode-icons",a="icons",c=await new Promise((f,g)=>{const I=indexedDB.open(o);I.onsuccess=()=>{const A=I.result;if(A.objectStoreNames.contains(a))f(A);else{const N=A.version+1;A.close();const S=indexedDB.open(o,N);S.onupgradeneeded=()=>{const i=S.result;i.objectStoreNames.contains(a)||i.createObjectStore(a,{keyPath:"id"})},S.onsuccess=()=>f(S.result),S.onerror=()=>g(S.error)}},I.onerror=()=>g(I.error)});return await new Promise((f,g)=>{const I=c.transaction(a,"readonly").objectStore(a).get(l);I.onsuccess=()=>f(I.result||null),I.onerror=()=>g(I.error)})}catch{return null}}function rr(l){var o,a,c,f,g,I,A,N;try{const S=new Uint8Array(l),i=String.fromCharCode((o=S[0])!=null?o:0,(a=S[1])!=null?a:0,(c=S[2])!=null?c:0,(f=S[3])!=null?f:0);return i==="wOFF"?"woff":i==="wOF2"?"woff2":i==="OTTO"?"otf":(((g=S[0])!=null?g:0)===0&&((I=S[1])!=null?I:0)===1&&((A=S[2])!=null?A:0)===0&&((N=S[3])!=null?N:0)===0||i==="true"||i==="typ1","ttf")}catch{return"ttf"}}async function Ar(l){const o=prompt("请输入导出名称",ge.value||"GeneratedComponent");if(o===null)return;const a=o.trim()||"GeneratedComponent";ge.value=a;function c(m){const w=new Set,L={};function F(K){let v=Date.now(),W=`${K}-${v}`;for(;w.has(W);)v+=1,W=`${K}-${v}`;return W}function T(K){const v=JSON.parse(JSON.stringify(K)),W=String(v.id);let $=W;return w.has($)&&($=F(String(v.type||"el"))),w.add($),L[W]=$,v.id=$,(v.type==="group"||v.type==="container")&&Array.isArray(v.children)&&(v.children=v.children.map(pe=>T(pe))),v}return{normalized:m.map(K=>T(K)),remap:L}}const{normalized:f}=c(E.value),g=[],I=m=>{for(const w of m)(w.type==="group"||w.type==="container")&&Array.isArray(w.children)?I(w.children):w.type==="image"&&(w.src||w.iconId)&&g.push(w)};I(f);const A={},N=new Map;let S=0;for(const m of g)try{let w;if(m.src)w=await(await fetch(String(m.src))).blob();else if(m.iconId){const v=m.iconId,W=await Tt(v);if(!W)throw new Error("icon record missing: "+v);w=new Blob([W.buffer],{type:String(W.mime||"image/png")})}else continue;let L=xt(w.type);if(L==="bin"&&m.iconId){const v=m.iconId,W=await Tt(v);if(W){const $=xt(String(W.mime||"")),pe=tr(String(W.originalName||""));L=$!=="bin"?$:pe||L}L==="bin"&&(L="png")}const F=await w.arrayBuffer(),T=await crypto.subtle.digest("SHA-256",F),K=Array.from(new Uint8Array(T)).map(v=>v.toString(16).padStart(2,"0")).join("");if(N.has(K)){const{fileName:v}=N.get(K);A[m.id]=v}else{const v=`${a}_img_${S}.${L}`;N.set(K,{fileName:v,blob:w}),S++,A[m.id]=v}}catch(w){console.warn("导出图片失败：",w)}const i=Array.from(N.values());let u=null,B=null;if(k.backgroundUrl)try{const m=await(await fetch(String(k.backgroundUrl))).blob(),w=xt(m.type);u=`${a}_bg.${w}`,B=m}catch(m){console.warn("导出背景图片失败：",m)}const J=new Set,ce=Dt(k.globalFontFamily);ce&&J.add(ce);const fe=m=>{var w;for(const L of m)if((L.type==="group"||L.type==="container")&&Array.isArray(L.children))fe(L.children);else if(L.type==="text"){const F=Dt((w=L.style)==null?void 0:w.fontFamily);F&&J.add(F)}};fe(E.value);const ue=[],be=[];if(J.size>0)try{const m="lowcode-fonts",w="fonts",L=await new Promise((v,W)=>{const $=indexedDB.open(m);$.onsuccess=()=>{const pe=$.result;if(pe.objectStoreNames.contains(w))v(pe);else{const Me=pe.version+1;pe.close();const xe=indexedDB.open(m,Me);xe.onupgradeneeded=()=>{const Se=xe.result;Se.objectStoreNames.contains(w)||Se.createObjectStore(w,{keyPath:"id"})},xe.onsuccess=()=>v(xe.result),xe.onerror=()=>W(xe.error)}},$.onerror=()=>W($.error)}),F=await new Promise((v,W)=>{const $=L.transaction(w,"readonly").objectStore(w).getAll();$.onsuccess=()=>v($.result),$.onerror=()=>W($.error)}),T=h.value,K=T?F.filter(v=>v.projectId===T):F.filter(v=>!v.projectId);for(const v of K)if(J.has(v.name)){const W=new Blob([v.buffer],{type:v.mime});let $=xt(v.mime);if($==="bin")try{$=rr(v.buffer)}catch{$="ttf"}const pe=v.name.replace(/[^A-Za-z0-9_\-]/g,"_"),Me=`${a}_${pe}.${$}`;ue.push({family:v.name,file:Me}),be.push({file:Me,blob:W})}}catch(m){console.warn("读取字体库失败：",m)}const me=new Wn.default,re=me.folder(a),ne=re.folder("imgs");for(const m of i)ne.file(m.fileName,m.blob);B&&u&&ne.file(u,B);const le=re.folder("fonts");for(const m of be)le.file(m.file,m.blob);let ie="";l==="vue2"?(ie=Un(a,k,f,{imageFileNames:i.map(m=>m.fileName),imageFileMap:A,backgroundFileName:B&&u?u:null,fontFaces:ue,hideDirective:"if"},Bt.value),re.file("index.vue",ie)):l==="vue3"?(ie=Ln(a,k,f,{imageFileNames:i.map(m=>m.fileName),imageFileMap:A,backgroundFileName:B&&u?u:null,fontFaces:ue,hideDirective:"if"}),re.file("index.vue",ie)):l==="react"?(ie=Pn(a,k,f,{imageFileNames:i.map(m=>m.fileName),imageFileMap:A,backgroundFileName:B&&u?u:null,fontFaces:ue}),re.file("index.jsx",ie),re.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。")):(ie=Vn(a,k,f,{imageFileNames:i.map(m=>m.fileName),imageFileMap:A,backgroundFileName:B&&u?u:null,fontFaces:ue}),re.file("index.html",ie));const Ie=await me.generateAsync({type:"blob"});(0,Hn.saveAs)(Ie,`${a}.zip`)}async function Fr(){const l=prompt("请输入导出名称",ge.value||"GeneratedComponent");if(l===null)return;const o=l.trim()||"GeneratedComponent";ge.value=o;const a=[],c=m=>{for(const w of m)(w.type==="group"||w.type==="container")&&Array.isArray(w.children)?c(w.children):w.type==="image"&&w.src&&a.push(w)};c(E.value);const f={},g=new Map;let I=0;for(const m of a)try{let w;if(m.src)w=await(await fetch(String(m.src))).blob();else if(m.iconId){const v=m.iconId,W=await Tt(v);if(!W)throw new Error("icon record missing: "+v);w=new Blob([W.buffer],{type:String(W.mime||"image/png")})}else continue;let L=xt(w.type);if(L==="bin"&&m.iconId){const v=m.iconId,W=await Tt(v);if(W){const $=xt(String(W.mime||"")),pe=tr(String(W.originalName||""));L=$!=="bin"?$:pe||L}L==="bin"&&(L="png")}const F=await w.arrayBuffer(),T=await crypto.subtle.digest("SHA-256",F),K=Array.from(new Uint8Array(T)).map(v=>v.toString(16).padStart(2,"0")).join("");if(g.has(K)){const{fileName:v}=g.get(K);f[m.id]=v}else{const v=`${o}_img_${I}.${L}`;g.set(K,{fileName:v,blob:w}),I++,f[m.id]=v}}catch(w){console.warn("导出图片失败：",w)}const A=Array.from(g.values());let N=null,S=null;if(k.backgroundUrl)try{const m=await(await fetch(String(k.backgroundUrl))).blob(),w=xt(m.type);N=`${o}_bg.${w}`,S=m}catch(m){console.warn("导出背景图片失败：",m)}const i=new Set,u=Dt(k.globalFontFamily);u&&i.add(u);const B=m=>{var w;for(const L of m)if((L.type==="group"||L.type==="container")&&Array.isArray(L.children))B(L.children);else if(L.type==="text"){const F=Dt((w=L.style)==null?void 0:w.fontFamily);F&&i.add(F)}};B(E.value);const J=[],ce=[];if(i.size>0)try{const m="lowcode-fonts",w="fonts",L=await new Promise((v,W)=>{const $=indexedDB.open(m);$.onsuccess=()=>{const pe=$.result;if(pe.objectStoreNames.contains(w))v(pe);else{const Me=pe.version+1;pe.close();const xe=indexedDB.open(m,Me);xe.onupgradeneeded=()=>{const Se=xe.result;Se.objectStoreNames.contains(w)||Se.createObjectStore(w,{keyPath:"id"})},xe.onsuccess=()=>v(xe.result),xe.onerror=()=>W(xe.error)}},$.onerror=()=>W($.error)}),F=await new Promise((v,W)=>{const $=L.transaction(w,"readonly").objectStore(w).getAll();$.onsuccess=()=>v($.result),$.onerror=()=>W($.error)}),T=h.value,K=T?F.filter(v=>v.projectId===T):F.filter(v=>!v.projectId);for(const v of K)if(i.has(v.name)){const W=new Blob([v.buffer],{type:v.mime});let $=xt(v.mime);if($==="bin")try{$=rr(v.buffer)}catch{$="ttf"}const pe=v.name.replace(/[^A-Za-z0-9_\-]/g,"_"),Me=`${o}_${pe}.${$}`;J.push({family:v.name,file:Me}),ce.push({file:Me,blob:W})}}catch(m){console.warn("读取字体库失败：",m)}const fe=new Wn.default,ue=fe.folder(`${o}_all`),be=[],me={imageFileNames:A.map(m=>m.fileName),imageFileMap:f,backgroundFileName:S&&N?N:null,fontFaces:J,hideDirective:"if"},re=Un(o,k,E.value,me,Bt.value);be.push({key:"vue2",file:"index.vue",content:re});const ne=Ln(o,k,E.value,me);be.push({key:"vue3",file:"index.vue",content:ne});const le=Pn(o,k,E.value,me);be.push({key:"react",file:"index.jsx",content:le});const ie=Vn(o,k,E.value,me);be.push({key:"html",file:"index.html",content:ie});for(const m of be){const w=ue.folder(m.key);w.file(m.file,m.content),m.key==="react"&&w.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。");const L=w.folder("imgs");for(const T of A)L.file(T.fileName,T.blob);S&&N&&L.file(N,S);const F=w.folder("fonts");for(const T of ce)F.file(T.file,T.blob)}const Ie=await fe.generateAsync({type:"blob"});(0,Hn.saveAs)(Ie,`${o}-all.zip`)}function jr(){confirm("确认清空当前画布与元素吗？")&&(E.value=[],d.value=null)}const Je=we(1),It=we(null);function zr(){Je.value=Math.min(2,+(Je.value+.1).toFixed(2))}function Or(){Je.value=Math.max(.2,+(Je.value-.1).toFixed(2))}function lr(){const l=It.value;if(!l)return;const o=l.clientWidth-16,a=l.clientHeight-16,c=o/k.width,f=a/k.height;Je.value=+Math.max(.2,Math.min(2,Math.min(c,f))).toFixed(2)}el(async()=>{lr(),await xr()});const nr=we([]);function or(l){const o=JSON.parse(JSON.stringify(l));let a=Date.now();function c(g){return a+=1,`${g}-${a}`}function f(g){g.id=c(String(g.type||"el")),(g.type==="chart"||g.type==="container")&&g.elementId&&(g.elementId=String(g.elementId)+"_"+String(a%1e3)),(g.type==="group"||g.type==="container")&&Array.isArray(g.children)&&g.children.forEach(I=>f(I))}return f(o),o.left=(l.left||0)+10,o.top=(l.top||0)+10,o.x=o.left,o.y=o.top,o.zIndex=(l.zIndex||1)+1,o}function Br(){var f,g,I,A,N,S,i,u,B,J,ce,fe,ue,be,me;if(!Et.value)return;let l=Et.value;const o=Oe(l.id);o.parentGroup&&(l=o.parentGroup);const a=or(l),{parentGroup:c}=Oe(l.id);if(c){const re=Number((g=(f=c.left)!=null?f:c.x)!=null?g:0),ne=Number((A=(I=c.top)!=null?I:c.y)!=null?A:0),le=Number((N=c.width)!=null?N:0),ie=Number((S=c.height)!=null?S:0),Ie=re+le,m=ne+ie,w=Number((i=l.width)!=null?i:0),L=Number((u=l.height)!=null?u:0);let F=w,T=L;if(!F||!T)if(l.type==="text"){const xe=Number((B=l.fontSize)!=null?B:16),Se=String((ce=(J=l.text)!=null?J:l.content)!=null?ce:"").trim();F=Math.max(w||50,Math.round((Se.length||2)*xe*.6)),T=Math.max(L||20,Math.round(xe*1.5))}else l.type==="image"?(F=w||200,T=L||150):l.type==="chart"?(F=w||240,T=L||160):l.type==="line"?(F=w||200,T=L||2):(F=w||100,T=L||60);const K=10,v=re+le/2,W=ne+ie/2;let $=!1,pe=Ie+K,Me=Math.round(W-T/2);if(!$&&pe+F<=k.width&&(a.left=Math.max(0,Math.min(pe,Math.max(0,k.width-F))),a.top=Math.max(0,Math.min(Me,Math.max(0,k.height-T))),$=!0),pe=re-F-K,Me=Math.round(W-T/2),!$&&pe>=0&&(a.left=Math.max(0,Math.min(pe,Math.max(0,k.width-F))),a.top=Math.max(0,Math.min(Me,Math.max(0,k.height-T))),$=!0),pe=Math.round(v-F/2),Me=m+K,!$&&Me+T<=k.height&&(a.left=Math.max(0,Math.min(pe,Math.max(0,k.width-F))),a.top=Math.max(0,Math.min(Me,Math.max(0,k.height-T))),$=!0),pe=Math.round(v-F/2),Me=ne-T-K,!$&&Me>=0&&(a.left=Math.max(0,Math.min(pe,Math.max(0,k.width-F))),a.top=Math.max(0,Math.min(Me,Math.max(0,k.height-T))),$=!0),!$){const xe=Number((ue=(fe=l.left)!=null?fe:l.x)!=null?ue:0),Se=Number((me=(be=l.top)!=null?be:l.y)!=null?me:0),Ae=re+xe+K,De=ne+Se+K;a.left=Math.max(0,Math.min(Math.round(Ae),Math.max(0,k.width-F))),a.top=Math.max(0,Math.min(Math.round(De),Math.max(0,k.height-T)))}a.x=a.left,a.y=a.top}Ee(),E.value.push(a),d.value=a.id}const Gt=we(!1),Pt=we([]),Ht=we(""),Wt=we(!1),sr=Re(()=>{const l=Ht.value.trim().toLowerCase();return l?Pt.value.filter(o=>o.name.toLowerCase().includes(l)||(o.description||"").toLowerCase().includes(l)||Array.isArray(o.tags)&&o.tags.some(a=>a.toLowerCase().includes(l))):Pt.value});async function ar(){try{Wt.value=!0,await Xe.init(),Pt.value=(await Xe.getAllComponents()||[]).sort((l,o)=>(o.updatedAt||0)-(l.updatedAt||0))}catch(l){console.warn("加载组件缓存失败：",l)}finally{Wt.value=!1}}async function Dr(){await ar(),Gt.value=!0}function ir(){Gt.value=!1}const ut=we(!1);let nt=null;function Tr(){ut.value=!0,nt&&(clearTimeout(nt),nt=null)}function Gr(){nt&&clearTimeout(nt),nt=setTimeout(()=>{ut.value=!1,nt=null},120)}function Ur(){ut.value=!0,nt&&(clearTimeout(nt),nt=null)}function Lr(){ut.value=!1,nt&&(clearTimeout(nt),nt=null)}function Vr(l){const o=[],a=[],c=[],f=[];function g(i){var J,ce,fe,ue,be;const u=Number(i.width||0),B=Number(i.height||0);if(u>0&&B>0)return{w:u,h:B};if(i.type==="text"){const me=Number((J=i.fontSize)!=null?J:16),re=String((ce=i.text)!=null?ce:"").trim(),ne=Math.max(50,Math.round((re.length||2)*me*.6)),le=Math.max(20,Math.round(me*1.5));return{w:u||ne,h:B||le}}if(i.type==="image")return{w:u||100,h:B||100};if(i.type==="chart")return{w:u||240,h:B||160};if(i.type==="line"){const me=Number((ue=(fe=i.style)==null?void 0:fe.lineThickness)!=null?ue:2);return(((be=i.style)==null?void 0:be.lineOrientation)||"horizontal")==="vertical"?{w:u||me,h:B||100}:{w:u||100,h:B||me}}return{w:u||50,h:B||20}}for(const i of l){const u=Number(i.left||i.x||0),B=Number(i.top||i.y||0),{w:J,h:ce}=g(i);o.push(u),a.push(B),c.push(u+(J||0)),f.push(B+(ce||0))}const I=o.length?Math.min(...o):0,A=a.length?Math.min(...a):0,N=c.length?Math.max(...c):I,S=f.length?Math.max(...f):A;return{minX:I,minY:A,maxX:N,maxY:S,width:Math.max(0,N-I),height:Math.max(0,S-A)}}async function Rr(l){var o,a,c,f,g,I,A,N,S,i;try{const u=await ur(`component-${l.id}`),B=JSON.parse(JSON.stringify((u==null?void 0:u.elements)||l.elements||[]));if(!B||B.length===0){console.warn("该组件没有可插入的元素");return}let J=Date.now();const ce=T=>{T.id=`${T.type||"el"}-${J++}-${Math.random().toString(36).slice(2,8)}`,(T.type==="chart"||T.type==="container")&&T.elementId&&(T.elementId=String(T.elementId)+"_"+String(J%1e3)),(T.type==="group"||T.type==="container")&&Array.isArray(T.children)&&T.children.forEach(K=>ce(K))},fe=It.value,ue=Je.value||1,be=(o=fe==null?void 0:fe.clientWidth)!=null?o:0,me=(a=fe==null?void 0:fe.clientHeight)!=null?a:0,re=fe?(fe.scrollLeft+be/2)/ue:20,ne=fe?(fe.scrollTop+me/2)/ue:20,le=Vr(B),ie=le.minX+le.width/2,Ie=le.minY+le.height/2,m=Math.round(re-ie),w=Math.round(ne-Ie),L=E.value.reduce((T,K)=>Math.max(T,Number(K.zIndex||0)),0);let F=null;if(B.length===1){const T=B[0];if(!T){console.warn("单元素组件插入失败：源元素不存在");return}const v=JSON.parse(JSON.stringify(T));ce(v);const W=Number((f=(c=v.left)!=null?c:v.x)!=null?f:0),$=Number((I=(g=v.top)!=null?g:v.y)!=null?I:0);v.left=Math.round(W+m),v.top=Math.round($+w),v.x=v.left,v.y=v.top;const{w:pe,h:Me}=(function(){var Ae,De,et,Ze,ot;const xe=Number(v.width||0),Se=Number(v.height||0);if(xe>0&&Se>0)return{w:xe,h:Se};if(v.type==="text"){const qe=Number((Ae=v.fontSize)!=null?Ae:16),pt=String((De=v.text)!=null?De:"").trim(),tt=Math.max(50,Math.round((pt.length||2)*qe*.6)),kt=Math.max(20,Math.round(qe*1.5));return{w:xe||tt,h:Se||kt}}if(v.type==="image")return{w:xe||100,h:Se||100};if(v.type==="chart")return{w:xe||240,h:Se||160};if(v.type==="line"){const qe=Number((Ze=(et=v.style)==null?void 0:et.lineThickness)!=null?Ze:2);return(((ot=v.style)==null?void 0:ot.lineOrientation)||"horizontal")==="vertical"?{w:xe||qe,h:Se||100}:{w:xe||100,h:Se||qe}}return{w:xe||50,h:Se||20}})();if(v.width=pe,v.height=Me,v.type==="image"&&!(v.src||"").startsWith("data:")&&v.iconId)try{Ut(v.iconId).then(xe=>{xe&&(v.src=xe)}).catch(()=>{})}catch{}v.zIndex=Math.max(1,L+1),Ee(),E.value=E.value.concat(v),d.value=v.id,F=v.id}else{const T=`group-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,K=[];for(const W of B){const $=JSON.parse(JSON.stringify(W));ce($);const pe=Number((N=(A=$.left)!=null?A:$.x)!=null?N:0),Me=Number((i=(S=$.top)!=null?S:$.y)!=null?i:0);$.left=Math.round(pe-le.minX),$.top=Math.round(Me-le.minY),$.x=$.left,$.y=$.top;const{w:xe,h:Se}=(function(){var et,Ze,ot,qe,pt;const Ae=Number($.width||0),De=Number($.height||0);if(Ae>0&&De>0)return{w:Ae,h:De};if($.type==="text"){const tt=Number((et=$.fontSize)!=null?et:16),kt=String((Ze=$.text)!=null?Ze:"").trim(),_t=Math.max(50,Math.round((kt.length||2)*tt*.6)),Jr=Math.max(20,Math.round(tt*1.5));return{w:Ae||_t,h:De||Jr}}if($.type==="image")return{w:Ae||100,h:De||100};if($.type==="chart")return{w:Ae||240,h:De||160};if($.type==="line"){const tt=Number((qe=(ot=$.style)==null?void 0:ot.lineThickness)!=null?qe:2);return(((pt=$.style)==null?void 0:pt.lineOrientation)||"horizontal")==="vertical"?{w:Ae||tt,h:De||100}:{w:Ae||100,h:De||tt}}return{w:Ae||50,h:De||20}})();if($.width=xe,$.height=Se,$.type==="image"&&!($.src||"").startsWith("data:")&&$.iconId)try{Ut($.iconId).then(Ae=>{Ae&&($.src=Ae)}).catch(()=>{})}catch{}K.push($)}const v={id:T,type:"group",left:Math.round(le.minX+m),top:Math.round(le.minY+w),width:Math.max(1,Math.round(le.width)),height:Math.max(1,Math.round(le.height)),zIndex:Math.max(1,L+1),className:l.name?`component-${l.name.replace(/[^A-Za-z0-9_-]/g,"-")}`:void 0,children:K,componentId:l.id,editable:!0,style:{backgroundColor:"transparent"}};Ee(),E.value=E.value.concat(v),d.value=v.id,F=T}try{if(F){const T=await Xe.getFontsByComponentId(l.id);if(Array.isArray(T)&&T.length>0){let K=document.getElementById(`component-fonts-${F}`);K||(K=document.createElement("style"),K.id=`component-fonts-${F}`,document.head.appendChild(K));const v=[];for(const W of T){const $=String(W.name||"").replace(/[^A-Za-z0-9_\-]/g,"_"),pe=W.bufferBase64;pe&&v.push(`@font-face { font-family: '${$}'; src: url('${pe}'); font-weight: normal; font-style: normal; font-display: swap; }`)}K.textContent=v.join(`
`)}}}catch(T){console.warn("注入组件字体失败：",T)}try{if(F){const T=await Xe.getDatabaseObjectsByComponentId(l.id);Array.isArray(T)&&T.length>0&&hr(F,T.map(K=>({name:K.name,content:K.content})))}}catch(T){console.warn("注入组件数据库对象失败：",T)}await Xe.incrementUsageCount(l.id),Gt.value=!1}catch(u){console.warn("插入组件失败：",u)}}const dr=()=>h.value?`lowcode-builder-state-${h.value}`:"lowcode-builder-state-v1",Jt=()=>h.value?n.isComponent?`component-${h.value}`:`project-${h.value}`:"default";async function qt(l,o){try{const a=JSON.parse(JSON.stringify(o));if(l.startsWith("component-")){const c=l.replace(/^component-/,"");await Xe.saveBuilderStateForComponent(c,a)}else if(l.startsWith("project-")){const c=l.replace(/^project-/,"");await Xe.saveBuilderStateForProject(c,a)}else await Xe.saveBuilderStateForProject(l,a)}catch(a){console.warn("保存构建器状态失败：",a)}}async function ur(l){try{if(l.startsWith("component-")){const o=l.replace(/^component-/,"");return await Xe.getBuilderStateForComponent(o)}else if(l.startsWith("project-")){const o=l.replace(/^project-/,"");return await Xe.getBuilderStateForProject(o)}return await Xe.getBuilderStateForProject(l)}catch(o){return console.warn("恢复构建器状态失败：",o),null}}let Xt=null;function Yt(){Xt&&clearTimeout(Xt),Xt=setTimeout(()=>{const l={config:k,elements:E.value,exportName:ge.value};try{const o=async()=>{if(await qt(Jt(),l),n.isComponent&&h.value)try{const a=String(h.value),c=await Xe.getComponent(a),f={id:a,name:ge.value||(c==null?void 0:c.name)||"未命名组件",description:(c==null?void 0:c.description)||"",tags:(c==null?void 0:c.tags)||[],elements:E.value,config:k,usageCount:(c==null?void 0:c.usageCount)||0,createdAt:(c==null?void 0:c.createdAt)||Date.now(),updatedAt:Date.now()};await Xe.saveComponent(JSON.parse(JSON.stringify(f))),gr()}catch(a){console.warn("同步保存组件记录失败：",a)}};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{o()}):o()}catch(o){console.warn("保存失败：",o)}},400)}mt(k,Yt,{deep:!0}),mt(E,Yt,{deep:!0}),mt(ge,Yt),mt(E,()=>{Rt()},{deep:!0});async function Pr(){try{const l="lowcode-icons",o="icons",a=await new Promise((g,I)=>{const A=indexedDB.open(l);A.onsuccess=()=>{const N=A.result;if(N.objectStoreNames.contains(o))g(N);else{const S=N.version+1;N.close();const i=indexedDB.open(l,S);i.onupgradeneeded=()=>{const u=i.result;u.objectStoreNames.contains(o)||u.createObjectStore(o,{keyPath:"id"})},i.onsuccess=()=>g(i.result),i.onerror=()=>I(i.error)}},A.onerror=()=>I(A.error)}),c=await new Promise((g,I)=>{const A=a.transaction(o,"readonly").objectStore(o).getAll();A.onsuccess=()=>g(A.result),A.onerror=()=>I(A.error)}),f=h.value;nr.value=(f?c.filter(g=>g.projectId===f):c.filter(g=>!g.projectId)).map(g=>{const I=new Blob([g.buffer],{type:g.mime}),A=URL.createObjectURL(I);return{id:g.id,url:A,name:g.name}})}catch(l){console.warn("图标库初始化失败：",l)}}async function Ut(l){try{const o="lowcode-icons",a="icons",c=await new Promise((I,A)=>{const N=indexedDB.open(o);N.onsuccess=()=>{const S=N.result;if(S.objectStoreNames.contains(a))I(S);else{const i=S.version+1;S.close();const u=indexedDB.open(o,i);u.onupgradeneeded=()=>{const B=u.result;B.objectStoreNames.contains(a)||B.createObjectStore(a,{keyPath:"id"})},u.onsuccess=()=>I(u.result),u.onerror=()=>A(u.error)}},N.onerror=()=>A(N.error)}),f=await new Promise((I,A)=>{const N=c.transaction(a,"readonly").objectStore(a).get(l);N.onsuccess=()=>I(N.result),N.onerror=()=>A(N.error)});if(!f||!f.buffer)return null;const g=new Blob([f.buffer],{type:f.mime||"application/octet-stream"});return await new Promise((I,A)=>{const N=new FileReader;N.onload=()=>I(String(N.result)),N.onerror=()=>A(N.error),N.readAsDataURL(g)})}catch(o){return console.warn("读取图标数据失败：",o),null}}async function cr(){const l=E.value.filter(o=>o.type==="image");for(const o of l){if((o.src||"").startsWith("data:")||!o.iconId)continue;const a=await Ut(o.iconId);a&&(o.src=a)}}async function Hr(){try{const l="lowcode-fonts",o="fonts",a=await new Promise((f,g)=>{const I=indexedDB.open(l);I.onsuccess=()=>{const A=I.result;if(A.objectStoreNames.contains(o))f(A);else{const N=A.version+1;A.close();const S=indexedDB.open(l,N);S.onupgradeneeded=()=>{const i=S.result;i.objectStoreNames.contains(o)||i.createObjectStore(o,{keyPath:"id"})},S.onsuccess=()=>f(S.result),S.onerror=()=>g(S.error)}},I.onerror=()=>g(I.error)}),c=await new Promise((f,g)=>{const I=a.transaction(o,"readonly").objectStore(o).getAll();I.onsuccess=()=>f(I.result),I.onerror=()=>g(I.error)});if(c.length>0){let f=document.querySelector("style[data-font-lib]");f||(f=document.createElement("style"),f.setAttribute("data-font-lib",""),document.head.appendChild(f));const g=[],I=[],A=h.value,N=A?c.filter(i=>i.projectId===A):c.filter(i=>!i.projectId);for(const i of N){const u=new Blob([i.buffer],{type:i.mime}),B=URL.createObjectURL(u),J=i.name;I.push(J),g.push(`@font-face { font-family: '${J}'; src: url('${B}'); font-weight: normal; font-style: normal; }`)}f.textContent=g.join(`
`);const S=new Set([...U.value,...I]);U.value=Array.from(S)}}catch(l){console.warn("字体库初始化失败：",l)}}el(async()=>{await V(),await Hr(),await Pr();try{if(n.isComponent&&h.value){const l=String(h.value);if(!await Xe.getComponent(l)){const o={id:l,name:ge.value||"未命名组件",description:"",tags:[],elements:[],config:k,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await Xe.saveComponent(JSON.parse(JSON.stringify(o)))}}}catch(l){console.warn("预创建组件记录失败：",l)}try{const l=await ur(Jt());if(l){l.config&&Object.assign(k,l.config),Array.isArray(l.elements)&&(E.value=l.elements),typeof l.exportName=="string"&&l.exportName&&(ge.value=l.exportName),await cr();try{E.value=E.value.map(o=>{if(o.type==="chart"&&o.style&&typeof o.style.border=="string"&&o.style.border.includes("dashed")){const a={...o,style:{...o.style}};return delete a.style.border,a}return o})}catch{}}else{const o=localStorage.getItem(dr());if(o){const a=JSON.parse(o);a&&a.config&&Object.assign(k,a.config),Array.isArray(a==null?void 0:a.elements)&&(E.value=a.elements),typeof(a==null?void 0:a.exportName)=="string"&&a.exportName&&(ge.value=a.exportName),await cr();try{E.value=E.value.map(c=>{if(c.type==="chart"&&c.style&&typeof c.style.border=="string"&&c.style.border.includes("dashed")){const f={...c,style:{...c.style}};return delete f.style.border,f}return c})}catch{}await qt(Jt(),{config:k,elements:E.value,exportName:ge.value});try{localStorage.removeItem(dr())}catch{}}}}catch(l){console.warn("恢复失败：",l)}Rt(),window.addEventListener("keydown",D),window.addEventListener("keyup",t)}),tl(()=>{window.removeEventListener("keydown",D),window.removeEventListener("keyup",t),gr()});let pr=0;async function Wr(l,o){var a,c,f;try{const g=k.width||l.clientWidth||800,I=k.height||l.clientHeight||600,A=(a=o==null?void 0:o.maxWidth)!=null?a:420,N=(c=o==null?void 0:o.scale)!=null?c:Math.min(1,A/g),S=(f=o==null?void 0:o.quality)!=null?f:.85,i=l.cloneNode(!0);i.style.transform="none",i.style.transformOrigin="top left",i.style.width=`${g}px`,i.style.height=`${I}px`;const u=new XMLSerializer().serializeToString(i),B=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${Math.round(g*N)}" height="${Math.round(I*N)}">
  <foreignObject width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml" style="transform: scale(${N}); transform-origin: top left;">${u}</div>
  </foreignObject>
</svg>`,J="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(B),ce=new Image;return await new Promise(fe=>{ce.onload=()=>{try{const ue=document.createElement("canvas");ue.width=ce.width,ue.height=ce.height;const be=ue.getContext("2d");if(!be)return fe(null);be.drawImage(ce,0,0);const me=ue.toDataURL("image/jpeg",S);fe(me)}catch{fe(null)}},ce.onerror=()=>fe(null),ce.src=J})}catch{return null}}async function gr(){try{const l=Date.now();if(l-pr<5e3||(pr=l,!n.isComponent||!h.value))return;const o=It.value;if(!o)return;const a=o.firstElementChild;if(!a)return;const c=await Wr(a,{maxWidth:420,quality:.8});if(!c)return;const f=String(h.value),g=await Xe.getComponent(f);if(!g)return;const I={...g,previewDataUrl:c,updatedAt:Date.now()};await Xe.saveComponent(JSON.parse(JSON.stringify(I)))}catch(l){console.warn("生成缩略图失败：",l)}}return(l,o)=>{var a,c,f,g,I,A,N,S;return j(),O(At,null,[r("div",su,[o[33]||(o[33]=Yr('<div class="absolute inset-0 opacity-10" data-v-03055715><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-03055715></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-03055715></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-03055715></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-03055715></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-03055715></div>',2)),r("div",au,[rt(gs,{exportName:ge.value,config:k,fontLibrary:U.value,spacingEnabled:gt.value,alignmentEnabled:ft.value,"onUpdate:exportName":o[0]||(o[0]=i=>ge.value=i),"onUpdate:configWidth":o[1]||(o[1]=i=>k.width=i),"onUpdate:configHeight":o[2]||(o[2]=i=>k.height=i),"onUpdate:backgroundColor":o[3]||(o[3]=i=>k.backgroundColor=i),"onUpdate:globalFontFamily":o[4]||(o[4]=i=>k.globalFontFamily=i),"onUpdate:globalFontSize":o[5]||(o[5]=i=>k.globalFontSize=i),"onUpdate:globalColor":o[6]||(o[6]=i=>k.globalColor=i),"onUpdate:spacingEnabled":o[7]||(o[7]=i=>gt.value=i),"onUpdate:alignmentEnabled":o[8]||(o[8]=i=>ft.value=i),onBackgroundFileChange:Ir,onOpenPreview:ae,onDownloadByFormat:o[9]||(o[9]=i=>Ar(i)),onDownloadAllFormats:Fr,onResetCanvas:jr,elements:E.value,selectedId:d.value,onSelectElement:o[10]||(o[10]=i=>vt(i)),onReorderTopElements:o[11]||(o[11]=i=>ht(i.from,i.to))},null,8,["exportName","config","fontLibrary","spacingEnabled","alignmentEnabled","elements","selectedId"]),r("div",iu,[r("div",du,[r("div",uu,[r("div",cu,[r("button",{onMouseenter:Tr,onMouseleave:Gr,onClick:o[12]||(o[12]=i=>ut.value=!0),class:"px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"}," 插入元素 ",32),ye(r("div",{onMouseenter:Ur,onMouseleave:Lr,class:"absolute left-0 top-full w-72 p-3 bg-gray-900/95 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl z-50"},[r("div",pu,[r("button",{onClick:o[13]||(o[13]=i=>{We("text"),ut.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded"},"文本"),r("button",{onClick:o[14]||(o[14]=i=>{We("arc-text"),ut.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-indigo-600 hover:from-cyan-500 hover:to-indigo-500 text-white rounded"},"环绕文字"),r("button",{onClick:o[15]||(o[15]=i=>{We("image"),ut.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500 text-white rounded"},"图片"),r("button",{onClick:o[16]||(o[16]=i=>{We("chart"),ut.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-500 hover:to-red-500 text-white rounded"},"图表"),r("button",{onClick:o[17]||(o[17]=i=>{We("line"),ut.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"线条"),r("button",{onClick:o[18]||(o[18]=i=>{We("container"),ut.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded col-span-2"},"容器")])],544),[[so,ut.value]])]),r("button",{onClick:o[19]||(o[19]=i=>bt.value=!0),class:"px-4 py-2 bg-gradient-to-r from-gray-600 to-slate-700 hover:from-gray-500 hover:to-slate-600 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-gray-500/25"}," 隐藏元素 "),r("button",{onClick:Dr,class:"px-4 py-2 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-pink-500/25"}," 插入组件 ")]),r("div",gu,[r("button",{onClick:Or,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[31]||(o[31]=[r("span",{class:"text-gray-300"},"-",-1)])]),r("span",fu,Qe(Math.round(Je.value*100))+"%",1),r("button",{onClick:zr,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[32]||(o[32]=[r("span",{class:"text-gray-300"},"+",-1)])]),r("button",{onClick:lr,class:"px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg text-xs text-gray-300 transition-colors duration-200"}," 适应 ")])]),r("div",{ref_key:"canvasScrollRef",ref:It,class:"flex-1 overflow-auto bg-gray-800/30 p-4 min-h-0 custom-scrollbar"},[r("div",{ref_key:"canvasContentRef",ref:dt,class:"relative border border-gray-600/50 bg-gray-100 shadow-2xl mx-auto",onMousedown:Xn(Ft,["self"]),style:st({width:`${k.width}px`,height:`${k.height}px`,backgroundColor:k.backgroundColor||"transparent",backgroundImage:k.backgroundUrl?`url(${k.backgroundUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`scale(${Je.value})`,transformOrigin:"top left"})},[se.value?(j(),O("div",yu,[ze.value.left?(j(),O("div",{key:0,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:st([{"border-width":"0.5px"},{left:`${te.value.left}px`}])},null,4)):ee("",!0),ze.value.right?(j(),O("div",{key:1,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:st([{"border-width":"0.5px"},{left:`${te.value.right}px`}])},null,4)):ee("",!0),ze.value.top?(j(),O("div",{key:2,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:st([{"border-width":"0.5px"},{top:`${te.value.top}px`}])},null,4)):ee("",!0),ze.value.bottom?(j(),O("div",{key:3,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:st([{"border-width":"0.5px"},{top:`${te.value.bottom}px`}])},null,4)):ee("",!0),ze.value.centerV?(j(),O("div",{key:4,class:"absolute top-0 bottom-0 border-l border-dashed border-blue-400/60",style:st([{"border-width":"0.5px"},{left:`${te.value.centerX}px`}])},null,4)):ee("",!0),ze.value.centerH?(j(),O("div",{key:5,class:"absolute left-0 right-0 border-t border-dashed border-blue-400/60",style:st([{"border-width":"0.5px"},{top:`${te.value.centerY}px`}])},null,4)):ee("",!0)])):ee("",!0),gt.value&&(ve.value.left||ve.value.right||ve.value.up||ve.value.down)?(j(),O("div",mu,[ve.value.left&&Ne.value!=="left"?(j(),O("div",{key:0,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:st({left:`${ve.value.left.x-14}px`,top:`${ve.value.left.y-14}px`}),onDblclick:o[20]||(o[20]=i=>$t("left"))},Qe(ve.value.left.gap)+"px ",37)):ee("",!0),ve.value.right&&Ne.value!=="right"?(j(),O("div",{key:1,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:st({left:`${ve.value.right.x-14}px`,top:`${ve.value.right.y-14}px`}),onDblclick:o[21]||(o[21]=i=>$t("right"))},Qe(ve.value.right.gap)+"px ",37)):ee("",!0),ve.value.up&&Ne.value!=="up"?(j(),O("div",{key:2,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:st({left:`${ve.value.up.x-14}px`,top:`${ve.value.up.y-18}px`}),onDblclick:o[22]||(o[22]=i=>$t("up"))},Qe(ve.value.up.gap)+"px ",37)):ee("",!0),ve.value.down&&Ne.value!=="down"?(j(),O("div",{key:3,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:st({left:`${ve.value.down.x-14}px`,top:`${ve.value.down.y-18}px`}),onDblclick:o[23]||(o[23]=i=>$t("down"))},Qe(ve.value.down.gap)+"px ",37)):ee("",!0),Ne.value==="left"?ye((j(),O("input",{key:4,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:st({left:`${(((a=ve.value.left)==null?void 0:a.x)||0)-28}px`,top:`${(((c=ve.value.left)==null?void 0:c.y)||0)-14}px`}),"onUpdate:modelValue":o[24]||(o[24]=i=>Ce.value=i),onKeydown:qr(Ot,["enter"])},null,36)),[[ke,Ce.value,void 0,{number:!0}]]):ee("",!0),Ne.value==="right"?ye((j(),O("input",{key:5,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:st({left:`${(((f=ve.value.right)==null?void 0:f.x)||0)-28}px`,top:`${(((g=ve.value.right)==null?void 0:g.y)||0)-14}px`}),"onUpdate:modelValue":o[25]||(o[25]=i=>Ce.value=i),onKeydown:qr(Ot,["enter"])},null,36)),[[ke,Ce.value,void 0,{number:!0}]]):ee("",!0),Ne.value==="up"?ye((j(),O("input",{key:6,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:st({left:`${(((I=ve.value.up)==null?void 0:I.x)||0)-28}px`,top:`${(((A=ve.value.up)==null?void 0:A.y)||0)-18}px`}),"onUpdate:modelValue":o[26]||(o[26]=i=>Ce.value=i),onKeydown:qr(Ot,["enter"])},null,36)),[[ke,Ce.value,void 0,{number:!0}]]):ee("",!0),Ne.value==="down"?ye((j(),O("input",{key:7,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:st({left:`${(((N=ve.value.down)==null?void 0:N.x)||0)-28}px`,top:`${(((S=ve.value.down)==null?void 0:S.y)||0)-18}px`}),"onUpdate:modelValue":o[27]||(o[27]=i=>Ce.value=i),onKeydown:qr(Ot,["enter"])},null,36)),[[ke,Ce.value,void 0,{number:!0}]]):ee("",!0)])):ee("",!0),(j(!0),O(At,null,Lt(E.value,i=>(j(),Kr(uo,{key:i.id,element:i,selected:i.id===d.value,"selected-id":d.value,config:k,zoom:Je.value,dbMap:Bt.value,"metrics-map":R.value,onSelect:at,"onUpdate:position":Ye,"onUpdate:size":_e,onShowGuidelines:it,onHideGuidelines:ct,onReportMetrics:lt,onDragEnd:zt},null,8,["element","selected","selected-id","config","zoom","dbMap","metrics-map"]))),128))],36)],512)]),rt(ou,{selectedEl:Et.value,config:k,fontLibrary:U.value,fontSizeLibrary:Z.value,fontWeightOptions:de.value,fontStyleOptions:_.value,databaseObjects:G.value,dbMap:Bt.value,iconLibrary:nr.value,defaultChartOption:He,safeHex:wr,initCustomClassSkeleton:Er,refreshAllCustomClassCss:Rt,removeCustomClassCssForElement:Qt,getIconDataUrlById:Ut,onDuplicateSelected:Br,onRemoveSelected:$r,onSaveSelectedAsComponent:Cr},null,8,["selectedEl","config","fontLibrary","fontSizeLibrary","fontWeightOptions","fontStyleOptions","databaseObjects","dbMap","iconLibrary"])])]),Gt.value?(j(),O("div",bu,[r("div",{class:"absolute inset-0 bg-black/60",onClick:ir}),r("div",xu,[r("div",{class:"flex items-center justify-between p-4 border-b border-fuchsia-500/30 bg-gradient-to-r from-fuchsia-600/20 to-pink-600/20"},[o[34]||(o[34]=r("h3",{class:"text-lg font-bold text-pink-300"},"插入组件",-1)),r("button",{onClick:ir,class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",vu,[r("div",hu,[ye(r("input",{"onUpdate:modelValue":o[28]||(o[28]=i=>Ht.value=i),type:"text",placeholder:"搜索名称、描述或标签",class:"flex-1 px-3 py-2 bg-gray-800/60 border border-fuchsia-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-fuchsia-400 focus:ring-1 focus:ring-fuchsia-400 focus:outline-none transition-all duration-200"},null,512),[[ke,Ht.value]]),r("button",{onClick:ar,class:"px-3 py-2 bg-pink-600/70 hover:bg-pink-600 text-white rounded"},"刷新")]),Wt.value?(j(),O("div",wu,"正在加载组件...")):(j(),O("div",$u,[sr.value.length===0?(j(),O("div",Eu,"暂无匹配的组件")):(j(),O("div",ku,[(j(!0),O(At,null,Lt(sr.value,i=>(j(),O("div",{key:i.id,class:"bg-gray-800/60 border border-pink-500/20 rounded-lg overflow-hidden"},[r("div",Su,[i.previewDataUrl?(j(),O("img",{key:0,src:i.previewDataUrl,alt:"预览",class:"max-w-full max-h-full object-contain"},null,8,Mu)):(j(),O("div",Cu,"无预览"))]),r("div",Nu,[r("div",Iu,[r("div",{class:"text-sm text-gray-100 font-medium truncate",title:i.name},Qe(i.name),9,Au),r("div",Fu,Qe(i.usageCount||0)+" 次",1)]),r("div",ju,[(j(!0),O(At,null,Lt(i.tags||[],u=>(j(),O("span",{key:u,class:"px-1.5 py-0.5 text-[10px] rounded bg-pink-600/30 text-pink-200"},Qe(u),1))),128))]),r("div",zu,[r("button",{onClick:u=>Rr(i),class:"w-full px-3 py-1.5 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded text-sm transition"}," 插入到画布 ",8,Ou)])])]))),128))]))]))])])])):ee("",!0),bt.value?(j(),O("div",Bu,[r("div",{class:"absolute inset-0 bg-black/60",onClick:o[29]||(o[29]=i=>bt.value=!1)}),r("div",Du,[r("div",Tu,[o[35]||(o[35]=r("h3",{class:"text-lg font-bold text-cyan-300"},"隐藏元素列表",-1)),r("button",{onClick:o[30]||(o[30]=i=>bt.value=!1),class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",Gu,[Ct.value.length===0?(j(),O("div",Uu,"暂无隐藏元素")):(j(),O("div",Lu,[(j(!0),O(At,null,Lt(Ct.value,i=>(j(),O("div",{key:i.id,class:"flex items-center justify-between bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2"},[r("div",{class:"text-sm text-gray-100 truncate",title:i.hiddenLabel||i.className||i.id},Qe(i.hiddenLabel||i.className||i.id),9,Vu),r("button",{onClick:u=>Pe(i.id),class:"px-3 py-1 bg-cyan-600/70 hover:bg-cyan-600 text-white rounded text-sm"},"取消隐藏并定位",8,Ru)]))),128))]))])])])):ee("",!0)],64)}}}),Wu=rl(Hu,[["__scopeId","data-v-03055715"]]),Ju=Mt({__name:"index",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(y){const n=y;return(e,p)=>(j(),Kr(Wu,{"project-id":n.projectId,"current-project":n.currentProject,"is-component":n.isComponent},null,8,["project-id","current-project","is-component"]))}}),ec=Ju;export{ec as default};
