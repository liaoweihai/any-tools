import{E as v,H as P,I as C,O as F,R as h,_ as L,c as O,d as M,f as m,h as V,l as e,lt as f,m as T,o as U,u as q,w as K}from"./codemirror-B25QCqWr.js";import{f as D,h as W,m as Q,s as H}from"./vendor-vue-C93_ecI2.js";import{t as G}from"./index-Dz3DFcMx.js";import{t as N}from"./componentStorage-DB4dbTb9.js";var $="lowcode-projects",p="projects";async function B(){return new Promise((y,u)=>{const n=indexedDB.open($);n.onsuccess=()=>{const i=n.result;if(i.objectStoreNames.contains(p))y(i);else{const g=i.version+1;i.close();const d=indexedDB.open($,g);d.onupgradeneeded=()=>{const w=d.result;w.objectStoreNames.contains(p)||w.createObjectStore(p,{keyPath:"id"})},d.onsuccess=()=>y(d.result),d.onerror=()=>u(d.error)}},n.onerror=()=>u(n.error)})}function I(){const y=H(),u=h([]);async function n(){try{const r=(await B()).transaction(p,"readonly").objectStore(p).getAll();return await new Promise(o=>{r.onsuccess=()=>{u.value=(r.result||[]).sort((l,x)=>x.updatedAt-l.updatedAt),o(u.value)}})}catch(r){return console.warn("加载项目失败：",r),[]}}async function i(r){try{await(await B()).transaction(p,"readwrite").objectStore(p).put(r),await n()}catch(o){console.warn("保存项目失败：",o)}}async function g(r){try{await(await B()).transaction(p,"readwrite").objectStore(p).delete(r),await n()}catch(o){console.warn("删除项目失败：",o)}}async function d(r){if(confirm("确认删除此项目吗？这将清空项目相关的所有数据（图标、字体、画布等）。")){await g(r);try{await N.clearProjectResources(r),await N.clearBuilderStateForProject(r)}catch(o){console.warn("清空项目相关资源失败：",o)}await n()}}function w(r,o){const l={id:`project-${Date.now()}`,name:r.trim(),description:(o==null?void 0:o.trim())||"",createdAt:Date.now(),updatedAt:Date.now()};return i(l)}function k(r,o){var x,_;const l={...r,name:((x=o.name)!=null?x:r.name).trim(),description:(((_=o.description)!=null?_:r.description)||"").trim(),updatedAt:Date.now()};return i(l)}async function c(r){await k(r,{}),y.push(`/project/${r.id}/builder`)}function b(r){return new Date(r).toLocaleString("zh-CN")}return{projects:u,loadProjects:n,saveProject:i,deleteProject:g,deleteProjectWithResources:d,createProject:w,updateProject:k,enterProject:c,formatDate:b}}var J={class:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden"},X={class:"relative z-10 container mx-auto px-6 py-8"},Y={class:"flex flex-col md:flex-row gap-4 mb-8"},Z={class:"flex-1"},ee={class:"relative"},te={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},re={class:"flex items-start justify-between mb-4"},oe={class:"flex-1"},ae={class:"text-xl font-semibold text-cyan-300 mb-2"},ne={key:0,class:"text-gray-400 text-sm mb-3 clamp-2"},se={class:"flex gap-2"},le=["onClick"],ie=["onClick"],de={class:"text-xs text-gray-500 mb-4"},ue=["onClick"],ce={key:1,class:"text-center py-16"},ve={class:"text-xl font-semibold text-gray-400 mb-2"},pe={class:"text-gray-500 mb-6"},me={class:"bg-gray-800 border border-purple-500/30 rounded-xl p-6 w-full max-w-md"},fe={class:"text-xl font-semibold text-cyan-300 mb-4"},ge={class:"space-y-4"},be={class:"flex gap-3 mt-6"},xe=["disabled"],ye=L({__name:"ProjectManager",setup(y){const u=H(),{projects:n,loadProjects:i,saveProject:g,deleteProjectWithResources:d,enterProject:w,formatDate:k}=I(),c=h(""),b=h(!1),r=h(null),o=h(""),l=h("");function x(){if(!o.value.trim())return;const s={id:`project-${Date.now()}`,name:o.value.trim(),description:l.value.trim(),createdAt:Date.now(),updatedAt:Date.now()};g(s),j()}function _(){if(!r.value||!o.value.trim())return;const s={...r.value,name:o.value.trim(),description:l.value.trim(),updatedAt:Date.now()};g(s),j()}function z(s){r.value=s,o.value=s.name,l.value=s.description||"",b.value=!0}function j(){b.value=!1,r.value=null,o.value="",l.value=""}const A=O(()=>{if(!c.value.trim())return n.value;const s=c.value.toLowerCase();return n.value.filter(t=>t.name.toLowerCase().includes(s)||t.description&&t.description.toLowerCase().includes(s))});function E(s){d(s)}K(()=>{i()});function R(){u.push("/low-code")}return(s,t)=>(v(),m("div",J,[t[16]||(t[16]=T('<div class="absolute inset-0 opacity-10" data-v-2e641760><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-2e641760></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-2e641760></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-2e641760></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-2e641760></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-2e641760></div>',2)),e("div",X,[e("div",{class:"flex items-center justify-between mb-12"},[e("button",{onClick:R,class:"flex items-center gap-2 px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg border border-cyan-500/30 text-gray-300 hover:text-white transition-all duration-200"},[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M19 12H5M12 19L5 12L12 5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),V(" 返回 ",-1)])]),t[8]||(t[8]=e("h1",{class:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent"}," 项目管理 ",-1))]),e("div",Y,[e("div",Z,[e("div",ee,[C(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>c.value=a),type:"text",placeholder:"搜索项目...",class:"w-full px-4 py-3 pl-12 bg-gray-800/50 border border-cyan-500/30 rounded-xl text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-2 focus:ring-cyan-400/20 focus:outline-none transition-all duration-200"},null,512),[[D,c.value]]),t[9]||(t[9]=e("div",{class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),e("button",{onClick:t[1]||(t[1]=a=>b.value=!0),class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-xl font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},[...t[10]||(t[10]=[e("span",{class:"flex items-center gap-2"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),V(" 新建项目 ")],-1)])])]),A.value.length>0?(v(),m("div",te,[(v(!0),m(U,null,F(A.value,a=>(v(),m("div",{key:a.id,class:"pm-card bg-gray-800/50 backdrop-blur-sm border border-purple-500/30 rounded-xl p-6 hover:border-purple-400/50 transition-all duration-200 transform hover:scale-105 hover:shadow-lg hover:shadow-purple-500/20 flex flex-col"},[e("div",re,[e("div",oe,[e("h3",ae,f(a.name),1),a.description?(v(),m("p",ne,f(a.description),1)):M("",!0)]),e("div",se,[e("button",{onClick:S=>z(a),class:"p-2 text-blue-400 hover:text-blue-300 hover:bg-blue-500/20 rounded-lg transition-colors duration-200",title:"编辑项目"},[...t[11]||(t[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,le),e("button",{onClick:S=>E(a.id),class:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded-lg transition-colors duration-200",title:"删除项目"},[...t[12]||(t[12]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ie)])]),e("div",de,[e("div",null,"创建时间: "+f(P(k)(a.createdAt)),1),e("div",null,"更新时间: "+f(P(k)(a.updatedAt)),1)]),e("button",{onClick:S=>P(w)(a),class:"mt-auto w-full px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"}," 进入编辑 ",8,ue)]))),128))])):(v(),m("div",ce,[t[13]||(t[13]=e("div",{class:"w-24 h-24 mx-auto mb-6 bg-gray-800/50 rounded-full flex items-center justify-center"},[e("svg",{class:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),e("h3",ve,f(c.value?"未找到匹配的项目":"还没有项目"),1),e("p",pe,f(c.value?"尝试使用其他关键词搜索":"创建您的第一个可视化组件项目"),1),c.value?M("",!0):(v(),m("button",{key:0,onClick:t[2]||(t[2]=a=>b.value=!0),class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-xl font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"}," 创建项目 "))]))]),b.value?(v(),m("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:W(j,["self"])},[e("div",me,[e("h3",fe,f(r.value?"编辑项目":"创建新项目"),1),e("div",ge,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"项目名称",-1)),C(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>o.value=a),type:"text",placeholder:"输入项目名称...",class:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",onKeyup:t[4]||(t[4]=Q(a=>r.value?_():x(),["enter"]))},null,544),[[D,o.value]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"项目描述（可选）",-1)),C(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value=a),placeholder:"输入项目描述...",rows:"3",class:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200 resize-none"},null,512),[[D,l.value]])])]),e("div",be,[e("button",{onClick:j,class:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-medium transition-colors duration-200"}," 取消 "),e("button",{onClick:t[6]||(t[6]=a=>r.value?_():x()),disabled:!o.value.trim(),class:"flex-1 px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 disabled:from-gray-600 disabled:to-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-all duration-200"},f(r.value?"保存":"创建"),9,xe)])])])):M("",!0)]))}}),we=G(ye,[["__scopeId","data-v-2e641760"]]),he=L({__name:"index",setup(y){return(u,n)=>(v(),q(we))}}),Ce=he;export{Ce as default};
