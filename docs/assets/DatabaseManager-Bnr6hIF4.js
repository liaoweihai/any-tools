import{E as n,I as f,L as $,O as T,P as E,R as v,_ as F,c as Z,d as p,f as i,h as M,l as t,lt as h,m as H,o as Q,st as S,w as R}from"./codemirror-B25QCqWr.js";import{f as g,h as G}from"./vendor-vue-fZ-TTK_Z.js";import{n as N,t as K}from"./index-R3-RO9Tt.js";var W={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},X={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},Y={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},ee={class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},te={class:"flex items-center justify-between"},re={class:"flex gap-2"},ae={class:"p-4 space-y-2 overflow-y-auto flex-1 custom-scrollbar"},oe={class:"mb-4"},se={key:0,class:"text-center text-gray-400 py-8"},le=["onClick"],ne={class:"flex items-center justify-between"},ie={class:"flex-1 min-w-0"},de={class:"flex items-center gap-2 mb-1"},ue={class:"text-sm font-medium text-white truncate"},ce={key:0,class:"text-xs text-gray-400 truncate"},pe=["onClick"],ve={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},be={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},fe={class:"text-lg font-bold text-purple-300 flex items-center gap-2"},ge={key:0,class:"flex gap-2"},xe={class:"flex-1 overflow-y-auto p-4 custom-scrollbar"},ye={key:0,class:"flex items-center justify-center h-full text-gray-400"},me={key:1,class:"space-y-6"},we={class:"space-y-4"},he={class:"grid grid-cols-2 gap-4"},ke={class:"space-y-2"},_e={class:"space-y-2"},je={class:"space-y-4"},Oe={class:"space-y-2"},Se={key:0,class:"text-xs text-red-400"},Ne={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Ce={class:"bg-gray-900/95 border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 p-6 w-96 max-w-[90vw]"},Je={class:"flex items-center justify-between mb-4"},De={class:"space-y-4"},Ie={class:"space-y-2"},Me={class:"space-y-2"},Ve={class:"flex gap-2 mt-6"},Ae={key:1,class:"fixed top-4 right-4 z-50"},Be=F({__name:"DatabaseManager",props:{projectId:{}},setup(V){const C=V,b=v([]),o=v(null),y=v(""),x=v(!1),s=v(""),l=v(""),k=v(!1),d=$({name:"",description:""}),J=Z(()=>{if(!y.value)return b.value;const a=y.value.toLowerCase();return b.value.filter(e=>e.name.toLowerCase().includes(a)||(e.description||"").toLowerCase().includes(a))});async function _(){return new Promise((a,e)=>{const r=indexedDB.open("lowcode-db",1);r.onupgradeneeded=()=>{const c=r.result;if(!c.objectStoreNames.contains("objects")){const u=c.createObjectStore("objects",{keyPath:"id"});try{u.createIndex("projectId","projectId",{unique:!1}),u.createIndex("name","name",{unique:!1})}catch{}}},r.onsuccess=()=>a(r.result),r.onerror=()=>e(r.error)})}async function m(){try{const a=(await _()).transaction(["objects"],"readonly").objectStore("objects").getAll();a.onsuccess=()=>{b.value=(a.result||[]).filter(e=>!e.projectId||e.projectId===(C.projectId||void 0)).sort((e,r)=>r.updatedAt-e.updatedAt)}}catch(a){console.error("åŠ è½½å¯¹è±¡åˆ—è¡¨å¤±è´¥:",a)}}async function D(a){var e;try{const r=(await _()).transaction(["objects"],"readwrite").objectStore("objects"),c=JSON.parse(JSON.stringify({...a,projectId:(e=C.projectId)!=null?e:void 0}));await new Promise((u,I)=>{const O=r.put(c);O.onsuccess=()=>u(),O.onerror=()=>I(O.error)})}catch(r){throw console.error("ä¿å­˜å¯¹è±¡å¤±è´¥:",r),r}}async function A(a){try{const e=(await _()).transaction(["objects"],"readwrite").objectStore("objects");await new Promise((r,c)=>{const u=e.delete(a);u.onsuccess=()=>r(),u.onerror=()=>c(u.error)})}catch(e){console.error("åˆ é™¤å¯¹è±¡å¤±è´¥:",e)}}function B(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function w(a){return a?/^[A-Za-z_][A-Za-z0-9_]*$/.test(a):!1}function j(a){o.value={...a};try{s.value=a.content?JSON.stringify(a.content,null,2):"",l.value=""}catch{s.value="",l.value="å†…å®¹åºåˆ—åŒ–å¤±è´¥"}}async function L(){if(!d.name||!w(d.name)){N("è¯·å¡«å†™åˆæ³•çš„å¯¹è±¡åç§°ï¼ˆå­—æ¯/ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä»…å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰","warning");return}const a={id:B(),name:d.name.trim(),description:d.description.trim(),content:{},createdAt:Date.now(),updatedAt:Date.now()};await D(a),await m(),Object.assign(d,{name:"",description:""}),x.value=!1,j(a)}async function q(){if(!o.value)return;if(!w(o.value.name)){N("å¯¹è±¡åç§°éæ³•ï¼Œè¯·ä¿®æ”¹åå†ä¿å­˜","error");return}if(s.value&&s.value.trim())try{const r=JSON.parse(s.value);o.value.content=r,l.value=""}catch(r){l.value="JSONæ ¼å¼é”™è¯¯: "+r.message;return}else o.value.content={};o.value.updatedAt=Date.now();const a=JSON.parse(JSON.stringify(o.value)),e=b.value.findIndex(r=>r.id===a.id);e>=0?b.value.splice(e,1,a):b.value.unshift(a),j(a),await D(a),await m(),k.value=!0,setTimeout(()=>k.value=!1,1800)}async function z(a){var e;confirm("ç¡®è®¤åˆ é™¤æ­¤æ•°æ®å¯¹è±¡å—ï¼Ÿ")&&(await A(a),await m(),((e=o.value)==null?void 0:e.id)===a&&(o.value=null,s.value="",l.value=""))}function P(){if(s.value)try{const a=JSON.parse(s.value);s.value=JSON.stringify(a,null,2),l.value=""}catch(a){l.value="JSONæ ¼å¼é”™è¯¯: "+a.message}}function U(){if(!s.value){l.value="";return}try{JSON.parse(s.value),l.value="",N("JSONæ ¼å¼æ­£ç¡®ï¼","success")}catch(a){l.value="JSONæ ¼å¼é”™è¯¯: "+a.message}}return E(o,a=>{if(a)try{s.value=a.content?JSON.stringify(a.content,null,2):""}catch{}}),R(()=>{m()}),(a,e)=>(n(),i("div",W,[e[25]||(e[25]=H('<div class="absolute inset-0 opacity-10" data-v-26995c94><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-26995c94></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-26995c94></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-26995c94></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-26995c94></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-26995c94></div>',2)),t("div",X,[t("div",Y,[t("div",ee,[t("div",te,[e[9]||(e[9]=t("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[t("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),M(" æ•°æ®å¯¹è±¡åˆ—è¡¨ ")],-1)),t("div",re,[t("button",{onClick:e[0]||(e[0]=r=>x.value=!0),class:"px-3 py-1 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25 text-sm"}," + æ–°å¢ ")])])]),t("div",ae,[t("div",oe,[f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>y.value=r),placeholder:"æœç´¢å¯¹è±¡...",class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200 text-sm"},null,512),[[g,y.value]])]),J.value.length===0?(n(),i("div",se,[...e[10]||(e[10]=[t("div",{class:"text-4xl mb-2"},"ğŸ—‚ï¸",-1),t("p",null,"æš‚æ— æ•°æ®å¯¹è±¡",-1),t("p",{class:"text-xs mt-1"},'ç‚¹å‡»å³ä¸Šè§’"æ–°å¢"æŒ‰é’®æ·»åŠ å¯¹è±¡',-1)])])):p("",!0),(n(!0),i(Q,null,T(J.value,r=>{var c;return n(),i("div",{key:r.id,onClick:u=>j(r),class:S(["p-3 rounded-lg cursor-pointer transition-all duration-200 border",((c=o.value)==null?void 0:c.id)===r.id?"bg-cyan-600/30 border-cyan-400/50 shadow-lg shadow-cyan-500/20":"bg-gray-800/30 border-gray-600/30 hover:bg-gray-700/40 hover:border-gray-500/50"])},[t("div",ne,[t("div",ie,[t("div",de,[e[11]||(e[11]=t("span",{class:"px-2 py-0.5 rounded text-xs font-medium bg-cyan-600/80 text-cyan-100"},"Object",-1)),t("span",ue,h(r.name),1)]),r.description?(n(),i("div",ce,h(r.description),1)):p("",!0)]),t("button",{onClick:G(u=>z(r.id),["stop"]),class:"ml-2 p-1 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded transition-colors duration-200"},[...e[12]||(e[12]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,pe)])],10,le)}),128))])]),t("div",ve,[t("div",be,[t("h2",fe,[e[13]||(e[13]=t("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"},null,-1)),M(" "+h(o.value?"å¯¹è±¡è¯¦æƒ…ç¼–è¾‘":"é€‰æ‹©ä¸€ä¸ªæ•°æ®å¯¹è±¡"),1)]),o.value?(n(),i("div",ge,[t("button",{onClick:q,class:"px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"}," ä¿å­˜ ")])):p("",!0)]),t("div",xe,[o.value?p("",!0):(n(),i("div",ye,[...e[14]||(e[14]=[t("div",{class:"text-center"},[t("div",{class:"text-6xl mb-4"},"ğŸ“¦"),t("p",{class:"text-lg"},"è¯·ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ªæ•°æ®å¯¹è±¡è¿›è¡Œç¼–è¾‘"),t("p",{class:"text-sm mt-2"},'æˆ–è€…ç‚¹å‡»"æ–°å¢"æŒ‰é’®åˆ›å»ºæ–°çš„å¯¹è±¡')],-1)])])),o.value?(n(),i("div",me,[t("div",we,[e[17]||(e[17]=t("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-2"},"åŸºæœ¬ä¿¡æ¯",-1)),t("div",he,[t("div",ke,[e[15]||(e[15]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡åç§°",-1)),f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.name=r),type:"text",placeholder:"å¦‚: powerSourceData",class:"w-full px-3 py-2 bg-gray-800/50 border border-purple-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[g,o.value.name]]),t("div",{class:S(["text-xs",w(o.value.name)?"text-gray-500":"text-red-400"])}," åç§°éœ€ä¸ºåˆæ³•æ ‡è¯†ç¬¦ï¼ˆç”¨äº Vue2 data é”®ï¼‰ ",2)]),t("div",_e,[e[16]||(e[16]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡æè¿°",-1)),f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.description=r),type:"text",placeholder:"å¯¹è±¡ç”¨é€”æè¿°ï¼ˆå¯é€‰ï¼‰",class:"w-full px-3 py-2 bg-gray-800/50 border border-purple-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[g,o.value.description]])])])]),t("div",je,[e[19]||(e[19]=t("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-2"},"å¯¹è±¡å†…å®¹ (JSON)",-1)),t("div",Oe,[e[18]||(e[18]=t("label",{class:"block text-xs text-gray-400"},"JSON å†…å®¹",-1)),f(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=r=>s.value=r),rows:"12",placeholder:'{"code": 200, "data": [], "message": "success"}',class:"w-full px-3 py-2 bg-gray-800/50 border border-purple-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 font-mono text-sm"},null,512),[[g,s.value]]),t("div",{class:"flex gap-2"},[t("button",{onClick:P,class:"px-3 py-1 bg-blue-600/30 hover:bg-blue-600/50 text-blue-300 rounded text-xs transition-colors duration-200"},"æ ¼å¼åŒ–JSON"),t("button",{onClick:U,class:"px-3 py-1 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200"},"éªŒè¯JSON")]),l.value?(n(),i("div",Se,h(l.value),1)):p("",!0)])])])):p("",!0)])])]),x.value?(n(),i("div",Ne,[t("div",Ce,[t("div",Je,[e[21]||(e[21]=t("h3",{class:"text-lg font-bold text-cyan-300"},"æ–°å¢æ•°æ®å¯¹è±¡",-1)),t("button",{onClick:e[5]||(e[5]=r=>x.value=!1),class:"text-gray-400 hover:text-white"},[...e[20]||(e[20]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",De,[t("div",Ie,[e[22]||(e[22]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡åç§°",-1)),f(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>d.name=r),type:"text",placeholder:"å¦‚: powerSourceData",class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[g,d.name]]),t("div",{class:S(["text-xs",w(d.name)?"text-gray-500":"text-red-400"])},"åç§°éœ€ä¸ºåˆæ³•æ ‡è¯†ç¬¦",2)]),t("div",Me,[e[23]||(e[23]=t("label",{class:"block text-xs text-gray-400"},"å¯¹è±¡æè¿°",-1)),f(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>d.description=r),type:"text",placeholder:"å¯¹è±¡ç”¨é€”æè¿°ï¼ˆå¯é€‰ï¼‰",class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[g,d.description]])])]),t("div",Ve,[t("button",{onClick:L,class:"flex-1 px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},"æ·»åŠ "),t("button",{onClick:e[8]||(e[8]=r=>x.value=!1),class:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-medium transition-all duration-200"},"å–æ¶ˆ")])])])):p("",!0),k.value?(n(),i("div",Ae,[...e[24]||(e[24]=[t("div",{class:"px-3 py-2 bg-emerald-600/90 text-white rounded-lg shadow-lg flex items-center gap-2"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),t("span",{class:"text-sm"},"ä¿å­˜æˆåŠŸ")],-1)])])):p("",!0)]))}}),Pe=K(Be,[["__scopeId","data-v-26995c94"]]);export{Pe as default};
