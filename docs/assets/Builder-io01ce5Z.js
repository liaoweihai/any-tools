import{i as Yl}from"./rolldown-runtime-CKFmjIRy.js";import{C as an,E as z,H as Xl,I as xe,L as Ll,O as dr,P as Tt,R as be,S as nn,_ as Kt,b as Xt,c as Xe,ct as Ct,d as K,f as B,g as vt,h as Or,i as no,l as r,lt as bt,m as en,n as lo,o as tr,r as oo,st as Be,t as so,u as rn,w as sn}from"./codemirror-B25QCqWr.js";import{d as Rl,f as Me,h as Kl,m as Zr,n as ao,o as io,p as uo,r as co,s as po,u as tn}from"./vendor-vue-C93_ecI2.js";import{t as dn}from"./index-CMaGPMgF.js";import{t as gt}from"./componentStorage-k4mRdpgu.js";import"./echarts-xBohgwka.js";import{t as go}from"./DraggableBox-CiHrYMbc.js";function jr(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function fo(y){var p,$;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((p=n.backgroundGradient.colors)!=null&&p.length)){const k=n.backgroundGradient.angle||0,P=n.backgroundGradient.colors[0]||"#000000",oe=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${k}deg, ${P}, ${oe})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"){n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textIndent&&e.push(`text-indent:${n.textIndent}`);const k=n.textOrientation;if(k==="vertical"?(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")):k==="horizontal"&&e.push("writing-mode:horizontal-tb"),n.textGradient&&(($=n.textGradient.colors)!=null&&$.length)){const P=n.textGradient.angle||0,oe=n.textGradient.colors[0]||"#000000",ke=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${P}deg, ${oe}, ${ke})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}}return y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),e.join(";")}function yo(y){var p;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),y.type!=="text"&&(n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((p=n.backgroundGradient.colors)!=null&&p.length))){const $=n.backgroundGradient.angle||0,k=n.backgroundGradient.colors[0]||"#000000",P=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${k}, ${P})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}return e.join(";")}function mo(y){const n=y.style||{},e=[];return n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.color&&e.push(`fill:${n.color}`),e.join(";")}function bo(y){var g,v,L,V;const n=Math.max(1,Math.round(y.width||1)),e=Math.max(1,Math.round(y.height||1)),p=n/2,$=e/2,k=((g=y.style)==null?void 0:g.arcText)||{},P=Math.max(1,Number((v=k.radius)!=null?v:Math.min(n,e)/2-4)),oe=Number((L=k.startAngle)!=null?L:0),ke=Math.max(0,Number((V=k.sweepAngle)!=null?V:180)),S=k.clockwise!==!1,de=oe*Math.PI/180,we=(oe+ke)*Math.PI/180,le=p+P*Math.cos(de),me=$+P*Math.sin(de),ae=p+P*Math.cos(we),A=$+P*Math.sin(we);return`M ${le} ${me} A ${P} ${P} 0 ${ke>180?1:0} ${S?1:0} ${ae} ${A}`}function xo(y){var e;const n=((e=y.style)==null?void 0:e.textAlign)||"center";return n==="left"?"0%":n==="right"?"100%":"50%"}function ho(y){var e;const n=((e=y.style)==null?void 0:e.textAlign)||"center";return n==="left"?"start":n==="right"?"end":"middle"}function Zl(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function vo(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Zl(e)} }`)}function $o(y){const n=[],e=p=>{p.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const k=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!k||!P)return;/\{[^}]*\}/.test(P)?n.push(vo(P)):n.push(`.${k} { ${Zl(P)} }`)}})};return e(y),n.join(`
`)}function wo(y){return y.replace(/[A-Z]/g,n=>`-${n.toLowerCase()}`)}function zt(y){return`\`
${Object.entries(y).map(([n,e])=>`      ${wo(n)}: ${e};`).join(`
`)}
    \``}function Vl(y,n,e,p,$){const k=y.replace(/[^A-Za-z0-9_]/g,"_");let P=0;const oe=`lc-${k}-root`,ke=`lc-${k}-bg`,S=`lc-${k}-flex-left`,de=`lc-${k}-flex-center`,we=`lc-${k}-flex-right`,le=[],me=[],ae=[],A=new Map,g=new Map,v=[],L=new Set;function V(s){if(!L.has(s))return L.add(s),s;let se=2;for(;L.has(`${s}_${se}`);)se++;const fe=`${s}_${se}`;return L.add(fe),fe}function U(s){var Rt;const se=s.style||{},fe=[],Fe=se.color,X=se.textGradient;if(X&&((Rt=X.colors)!=null&&Rt.length)){const nt=X.angle||0,lt=X.colors[0]||"#000000",Nt=X.colors[1]||"#000000";fe.push(`background-image:linear-gradient(${nt}deg, ${lt}, ${Nt})`),fe.push("-webkit-background-clip:text"),fe.push("background-clip:text"),fe.push("color:transparent")}else Fe&&fe.push(`color:${Fe}`);const te=se.fontWeight;te&&fe.push(`font-weight:${te}`);const Ue=se.fontStyle;Ue&&fe.push(`font-style:${Ue}`);const $t=se.textOrientation;$t==="vertical"?(fe.push("writing-mode:vertical-rl"),fe.push("text-orientation:upright")):$t==="horizontal"&&fe.push("writing-mode:horizontal-tb");const wt=fe.join(";"),Lt=fe.join(";");return{key:wt,css:Lt}}function q(){const s=[],se=Fe=>{Fe.forEach(X=>{if((X.type==="group"||X.type==="container")&&Array.isArray(X.children))se(X.children);else if(X.type==="text"){const te=((X.style||{}).fontFamily||"").trim();te&&!A.has(te)&&(s.push(te),A.set(te,`lc-${k}-f${s.length}`));const{key:Ue,css:$t}=U(X);if(Ue){const wt=g.get(Ue);wt?wt.count++:g.set(Ue,{count:1,css:$t})}}})};se(e);let fe=1;Array.from(g.entries()).forEach(([Fe,X])=>{X.count>=3&&(X.className=`lc-${k}-s${fe++}`)})}q();const je=n.backgroundUrl||"",Z=n.backgroundColor||"transparent",T=n.globalFontFamily||"",Q=n.globalFontSize||14,Ge=n.globalColor||"#000000",st=e.some(s=>s.type==="chart"),Y=p!=null&&p.backgroundFileName&&p.backgroundFileName.trim()?`require('./imgs/${p.backgroundFileName.replace(/'/g,"\\'")}')`:je?`'${je.replace(/'/g,"\\'")}'`:"''";function Te(s){const se=String(s||"").trim();if(!se)return"";let fe=se.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(fe[0]||"")||(fe="_"+fe),fe}function w(s){if(!s.hidden)return"";const se=Te(s.hiddenLabel);return se?` ${p&&p.hideDirective==="show"?"v-show":"v-if"}="${se}"`:""}function t(s,se){var wt,Lt,Rt,nt,lt,Nt,Zt,Ot,Vt,it,Qt,rr,nr,Pt,Wt,Ft,lr,or;const fe=s.type==="text"?yo(s):fo(s),Fe=s.zIndex||1,X=s.className&&s.className.trim()?` class="${s.className.trim()}"`:"",te=s.eventBinding,Ue=te&&te.enabled&&te.handlerName?` @click="${String(te.handlerName)}($event)"`:"";if(s.type==="group"&&Array.isArray(s.children)){const Ze=s.children.map((ut,Qe)=>t(ut,Qe)).join(`
        `),pe=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`group_${se}`,Ye=V(pe),Re={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(Re.width=`${Math.round(s.width)}px`),s.height&&(Re.height=`${Math.round(s.height)}px`)),v.push(`'${Ye.replace(/'/g,"\\'")}' : ${zt(Re)}`),`<div${X}${w(s)} :style="pos['${Ye.replace(/'/g,"\\'")}']" >
        ${Ze}
      </div>`}if(s.type==="text"){const Ze=(()=>{var tt;const et=((tt=s.style)==null?void 0:tt.textAlign)||"left";return et==="center"?de:et==="right"?we:S})(),pe=s.style||{},Ye=(pe.fontFamily||"").trim(),Re=Ye&&A.get(Ye)||"",ut=(()=>{const{key:et}=U(s),tt=et?g.get(et):void 0;return tt&&tt.className?tt.className:""})(),Qe=[(wt=s.className)==null?void 0:wt.trim(),Ze,Re,ut].filter(Boolean).join(" "),Le=Qe?` class="${Qe}"`:"",rt=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`text_${se}`,Ve=V(rt),Ie={};if(pe.fontSize!==void 0&&(Ie.fontSize=`${pe.fontSize}px`),pe.letterSpacing!==void 0&&pe.letterSpacing!==null&&(Ie.letterSpacing=`${pe.letterSpacing}px`),pe.lineHeight!==void 0&&(Ie.lineHeight=pe.lineHeight),pe.textIndent&&(Ie.textIndent=String(pe.textIndent)),pe.textGradient&&((Lt=pe.textGradient.colors)!=null&&Lt.length)){const et=pe.textGradient.angle||0,tt=pe.textGradient.colors[0]||"#000000",At=pe.textGradient.colors[1]||"#000000";Ie.backgroundImage=`linear-gradient(${et}deg, ${tt}, ${At})`,Ie["-webkit-background-clip"]="text",Ie.backgroundClip="text",Ie.color="transparent"}else pe.color&&(Ie.color=pe.color);pe.fontWeight&&(Ie.fontWeight=pe.fontWeight),pe.fontStyle&&(Ie.fontStyle=pe.fontStyle);const Bt=pe.textOrientation;Bt==="vertical"?(Ie.writingMode="vertical-rl",Ie.textOrientation="upright"):Bt==="horizontal"&&(Ie.writingMode="horizontal-tb");const at=s.elementId&&s.elementId.trim()?s.elementId.trim():`text_${se}`,dt=!!(pe.textWave&&pe.textWave.enabled),Et=!!pe.skewFlowEnabled;if(dt||Et){const et=s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath?{type:"dynamic",obj:s.dynamic.objectName,path:s.dynamic.propertyPath}:{type:"static",text:s.text||""};le.push(`'${at.replace(/'/g,"\\'")}' : ${JSON.stringify(et)}`);const tt={textWaveEnabled:dt,amplitude:(nt=(Rt=pe.textWave)==null?void 0:Rt.amplitude)!=null?nt:0,frequency:(Nt=(lt=pe.textWave)==null?void 0:lt.frequency)!=null?Nt:0,phase:(Ot=(Zt=pe.textWave)==null?void 0:Zt.phase)!=null?Ot:0,skewFlowEnabled:Et,skewAngle:(Vt=pe.skewAngle)!=null?Vt:0,textOrientation:pe.textOrientation||"horizontal",fontSize:(it=pe.fontSize)!=null?it:Q,letterSpacing:(Qt=pe.letterSpacing)!=null?Qt:0};if(me.push(`'${at.replace(/'/g,"\\'")}' : ${JSON.stringify(tt)}`),s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath){const Yt=String(s.dynamic.propertyPath),Dt=`${s.dynamic.objectName}.${Yt}`,Ht=V(Dt),kt={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(kt.width=`${Math.round(s.width)}px`),s.height&&(kt.height=`${Math.round(s.height)}px`)),Object.assign(kt,Ie),v.push(`'${Ht.replace(/'/g,"\\'")}' : ${zt(kt)}`),`<div${Le}${w(s)}${Ue} :style="pos['${Ht.replace(/'/g,"\\'")}']" >
        <span v-for="(p,pi) in getTextPieces('${at.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
      </div>`}const At={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(At.width=`${Math.round(s.width)}px`),s.height&&(At.height=`${Math.round(s.height)}px`)),Object.assign(At,Ie),v.push(`'${Ve.replace(/'/g,"\\'")}' : ${zt(At)}`),`<div${Le}${w(s)}${Ue} :style="pos['${Ve.replace(/'/g,"\\'")}']" >
        <span v-for="(p,pi) in getTextPieces('${at.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
      </div>`}if(s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath){const et=`${s.dynamic.objectName}.${s.dynamic.propertyPath}`,tt=String(s.dynamic.propertyPath),At=`${s.dynamic.objectName}.${tt}`,Yt=V(At),Dt={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(Dt.width=`${Math.round(s.width)}px`),s.height&&(Dt.height=`${Math.round(s.height)}px`)),Object.assign(Dt,Ie),v.push(`'${Yt.replace(/'/g,"\\'")}' : ${zt(Dt)}`),`<div${Le}${w(s)}${Ue} :style="pos['${Yt.replace(/'/g,"\\'")}']" >{{ ${et} }}</div>`}else{const et=jr(s.text||""),tt={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(tt.width=`${Math.round(s.width)}px`),s.height&&(tt.height=`${Math.round(s.height)}px`)),Object.assign(tt,Ie),v.push(`'${Ve.replace(/'/g,"\\'")}' : ${zt(tt)}`),`<div${Le}${w(s)}${Ue} :style="pos['${Ve.replace(/'/g,"\\'")}']" >${et}</div>`}}if(s.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[s.id]){const ut=p.imageFileMap[s.id],Qe=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`img_${se}`,Le=V(Qe),rt=s.elementId&&s.elementId.trim()?` id="${Le}"`:"",Ve=s.style||{},Ie={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(Ie.width=`${Math.round(s.width)}px`),s.height&&(Ie.height=`${Math.round(s.height)}px`)),Ve.objectFit&&(Ie.objectFit=String(Ve.objectFit)),v.push(`'${Le.replace(/'/g,"\\'")}' : ${zt(Ie)}`),`<img${X}${rt}${w(s)}${Ue} src="./imgs/${ut}" :style="pos['${Le.replace(/'/g,"\\'")}']" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[P]){const ut=p.imageFileNames[P++],Qe=s.elementId&&s.elementId.trim()?` id="${s.elementId.trim()}"`:"",Le=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`img_${se}`,rt=s.style||{},Ve={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(Ve.width=`${Math.round(s.width)}px`),s.height&&(Ve.height=`${Math.round(s.height)}px`)),rt.objectFit&&(Ve.objectFit=String(rt.objectFit)),v.push(`'${Le.replace(/'/g,"\\'")}' : ${zt(Ve)}`),`<img${X}${Qe}${w(s)}${Ue} src="./imgs/${ut}" :style="pos['${Le.replace(/'/g,"\\'")}']" alt="" />`}const Ze=s.elementId&&s.elementId.trim()?s.elementId.trim():`img_${se}`,pe=s.elementId&&s.elementId.trim()?` id="${s.elementId.trim()}"`:"",Ye=s.style||{},Re={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(Re.width=`${Math.round(s.width)}px`),s.height&&(Re.height=`${Math.round(s.height)}px`)),Ye.objectFit&&(Re.objectFit=String(Ye.objectFit)),v.push(`'${Ze.replace(/'/g,"\\'")}' : ${zt(Re)}`),`<img${X}${pe}${w(s)}${Ue} :src="images['${Ze}']" :style="pos['${Ze.replace(/'/g,"\\'")}']" alt="" />`}if(s.type==="chart"){const Ze=jr(s.text||"chart"),pe=s.elementId&&s.elementId.trim()?s.elementId.trim():`chart_${se}`,Ye=V(pe),Re={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};return s.autoSize||(s.width&&(Re.width=`${Math.round(s.width)}px`),s.height&&(Re.height=`${Math.round(s.height)}px`)),v.push(`'${Ye.replace(/'/g,"\\'")}' : ${zt(Re)}`),`<div${X}${w(s)}${Ue} id="${Ye}" :style="pos['${Ye.replace(/'/g,"\\'")}']">${Ze}</div>`}if(s.type==="container"){const Ze=s.comment?`<!-- ${s.comment.replace(/-->/g,"")} -->
      `:"";if(Array.isArray(s.children)){const rt=s.children.map((Et,et)=>t(Et,et)).join(`
        `),Ve=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`container_${se}`,Ie=V(Ve),Bt=s.elementId&&s.elementId.trim()?` id="${Ie}"`:"",at={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};s.autoSize||(s.width&&(at.width=`${Math.round(s.width)}px`),s.height&&(at.height=`${Math.round(s.height)}px`));const dt=s.style||{};if(dt.borderRadius&&(at.borderRadius=dt.borderRadius),dt.backgroundColor&&(at.backgroundColor=dt.backgroundColor),dt.backgroundGradient&&((rr=dt.backgroundGradient.colors)!=null&&rr.length)){const Et=dt.backgroundGradient.angle||0,et=dt.backgroundGradient.colors[0]||"#000000",tt=dt.backgroundGradient.colors[1]||"#000000";at.backgroundImage=`linear-gradient(${Et}deg, ${et}, ${tt})`,at.backgroundSize="cover",at.backgroundRepeat="no-repeat"}return v.push(`'${Ie.replace(/'/g,"\\'")}' : ${zt(at)}`),`${Ze}<div${X}${w(s)}${Ue}${Bt} :style="pos['${Ie.replace(/'/g,"\\'")}']" >
        ${rt}
      </div>`}const pe=jr(s.text||""),Ye=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`container_${se}`,Re=V(Ye),ut=s.elementId&&s.elementId.trim()?` id="${Re}"`:"",Qe={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,zIndex:Fe};s.autoSize||(s.width&&(Qe.width=`${Math.round(s.width)}px`),s.height&&(Qe.height=`${Math.round(s.height)}px`));const Le=s.style||{};if(Le.borderRadius&&(Qe.borderRadius=Le.borderRadius),Le.backgroundColor&&(Qe.backgroundColor=Le.backgroundColor),Le.backgroundGradient&&((nr=Le.backgroundGradient.colors)!=null&&nr.length)){const rt=Le.backgroundGradient.angle||0,Ve=Le.backgroundGradient.colors[0]||"#000000",Ie=Le.backgroundGradient.colors[1]||"#000000";Qe.backgroundImage=`linear-gradient(${rt}deg, ${Ve}, ${Ie})`,Qe.backgroundSize="cover",Qe.backgroundRepeat="no-repeat"}return v.push(`'${Re.replace(/'/g,"\\'")}' : ${zt(Qe)}`),`${Ze}<div${X}${w(s)}${Ue}${ut} :style="pos['${Re.replace(/'/g,"\\'")}']" >${pe}</div>`}if(s.type==="line"){const Ze=s.style||{},pe=Ze.lineColor||"#ffffff",Ye=(Pt=Ze.lineThickness)!=null?Pt:2,Re=Ze.lineOrientation||"horizontal",ut=Ze.lineStyle==="dashed",Qe=(Wt=Ze.lineDashLength)!=null?Wt:6,Le=(Ft=Ze.lineDashGap)!=null?Ft:4,rt=Math.max(1,Math.round((lr=s.width)!=null?lr:Re==="horizontal"?200:2)),Ve=Math.max(1,Math.round((or=s.height)!=null?or:Re==="horizontal"?2:200)),Ie=Math.round(Ve/2),Bt=Math.round(rt/2),at=ut?` stroke-dasharray="${Qe} ${Le}"`:"",dt=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`line_${se}`,Et=V(dt),et={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,width:`${rt}px`,height:`${Ve}px`,zIndex:Fe};return v.push(`'${Et.replace(/'/g,"\\'")}' : ${zt(et)}`),Re==="horizontal"?`<svg${X}${w(s)}${Ue} viewBox="0 0 ${rt} ${Ve}" preserveAspectRatio="none" :style="pos['${Et.replace(/'/g,"\\'")}']"><line x1="0" y1="${Ie}" x2="${rt}" y2="${Ie}" stroke="${pe}" stroke-width="${Ye}"${at} fill="none" /></svg>`:`<svg${X}${w(s)}${Ue} viewBox="0 0 ${rt} ${Ve}" preserveAspectRatio="none" :style="pos['${Et.replace(/'/g,"\\'")}']"><line x1="${Bt}" y1="0" x2="${Bt}" y2="${Ve}" stroke="${pe}" stroke-width="${Ye}"${at} fill="none" /></svg>`}if(s.type==="arc-text"){const Ze=Math.max(1,Math.round(s.width||1)),pe=Math.max(1,Math.round(s.height||1)),Ye=`arc_${s.id.replace(/"/g,"").replace(/'/g,"\\'")}`,Re=mo(s),ut=xo(s),Qe=ho(s),Le=s.elementId&&s.elementId.trim()?s.elementId.trim():s.className&&s.className.trim()?s.className.trim():`arc_${se}`,rt=V(Le),Ve={position:"absolute",left:`${Math.round(s.left||0)}px`,top:`${Math.round(s.top||0)}px`,width:`${Ze}px`,height:`${pe}px`,zIndex:Fe};v.push(`'${rt.replace(/'/g,"\\'")}' : ${zt(Ve)}`);const Ie=s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&s.dynamic.propertyPath?`{{ ${`${s.dynamic.objectName}.${s.dynamic.propertyPath}`} }}`:jr(s.text||"");return`<svg${X}${w(s)}${Ue} viewBox="0 0 ${Ze} ${pe}" preserveAspectRatio="none" :style="pos['${rt.replace(/'/g,"\\'")}']">
        <defs>
          <path id="${Ye}" d="${bo(s)}" fill="none" />
        </defs>
        <text style="${Re}">
          <textPath :href="'#${Ye}'" startOffset="${ut}" text-anchor="${Qe}">${Ie}</textPath>
        </text>
      </svg>`}const $t=jr(s.text||"element");return`<div${X}${w(s)}${Ue} style="${fe};z-index:${Fe}">${$t}</div>`}const ce=e.map((s,se)=>t(s,se)).join(`
      `),Se=$o(e);function Ke(s,se){s.forEach(fe=>{(fe.type==="group"||fe.type==="container")&&Array.isArray(fe.children)?(se(fe),Ke(fe.children,se)):se(fe)})}const De=new Set;Ke(e,s=>{(s.type==="text"||s.type==="arc-text")&&s.dynamic&&s.dynamic.enabled&&s.dynamic.objectName&&De.add(String(s.dynamic.objectName))});const Ne=Array.from(De),ft=!$||Ne.length===0?"":Ne.map(s=>{try{const se=$[s],fe=JSON.stringify(se!=null?se:{},null,2).split(`
`).map((Fe,X)=>X===0?Fe:`    ${Fe}`).join(`
`);return`    ${s}: ${fe},`}catch{return`    ${s}: {},`}}).join(`
`),yt=(()=>{const s=[];let se=0;return Ke(e,fe=>{if(fe.type==="chart"){const Fe=fe.elementId&&fe.elementId.trim()?fe.elementId.trim():`chart_${se}`;se++;const X=fe.chartOption||{};try{s.push(`'${Fe.replace(/'/g,"\\'")}' : ${JSON.stringify(X,null,2)}`)}catch{s.push(`'${Fe.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${s.join(", ")} }`})(),ot=(()=>{const s=new Set;return Ke(e,se=>{const fe=String(se.hiddenLabel||"").trim(),Fe=Te(fe),X=!!se.hidden;Fe&&X&&s.add(Fe)}),Array.from(s).map(se=>`      ${se}: false,`).join(`
`)})(),Ut=(()=>{const s=new Map;function se(Fe){Fe.forEach(X=>{const te=X.eventBinding;te&&te.enabled&&te.handlerName&&s.set(String(te.handlerName),String(te.code||"")),Array.isArray(X.children)&&se(X.children)})}se(e);const fe=Array.from(s.entries());return fe.length?fe.map(([Fe,X])=>`${Fe}(e) {
${X}
}`).join(`,
`):""})(),_t=`export default {
    ${v.join(`,
    `)}
  };`,qt=`
  ${st?`const chartOptions = ${yt};`:"const chartOptions = {};"}

  export const ${k}_data = {
    chartOptions,
    ${ft?`${ft}`:""}
    textSources: { ${le.join(", ")} },
    textEffects: { ${me.join(", ")} },
    elemStyles: { ${ae.join(", ")} },
    ${ot?ot.replace(/\n\s*/g,""):""}
  };
  `;return{indexVue:`<template>
  <div class="${oe}" :style="containerStyle">
    <img v-if="config.backgroundUrl" class="${ke}" :src="bgSrc" alt="" />
    ${ce}
    <div v-for="(opt, id) in chartOptions" :key="id" :id="id" :style="pos[id]"></div>
  </div>
</template>

<script>
import posEntries from './style/pos.js';
import { ${k}_data } from './data/index.js';
${st?"import * as echarts from 'echarts';":""}

function parseCss(css) {
  const style = {};
  if (!css) return style;
  css.split(';').forEach(line => {
    const part = line.trim();
    if (!part) return;
    const splitIdx = part.indexOf(':');
    if (splitIdx > 0) {
      const key = part.slice(0, splitIdx).trim();
      const val = part.slice(splitIdx + 1).trim();
      style[key] = val;
    }
  });
  return style;
}

const pos = {};
for (const key in posEntries) {
  pos[key] = parseCss(posEntries[key]);
}

export default {
  name: '${k}',
  data() {
    return {
      config: {
        width: ${n.width},
        height: ${n.height},
        backgroundColor: '${Z}',
        backgroundUrl: '${((p==null?void 0:p.backgroundFileName)||je).replace(/'/g,"\\'")}',
        globalFontFamily: '${T.replace(/'/g,"\\'")}',
        globalFontSize: ${Math.round(Q)},
        globalColor: '${Ge}',
      },
      ${p!=null&&p.imageFileNames?`// 使用本地资源路径，动态映射不再需要
      images: {},`:`// 图片 src 动态映射，初始写入 base64（若存在），blob 留空待替换
      images: {},`}
      // 引入分离的样式与数据
      pos,
      ...${k}_data
    };
  },
  computed: {
    containerStyle() {
      const base = {
        position: 'relative',
        width: this.config.width + 'px',
        height: this.config.height + 'px',
        fontFamily: this.config.globalFontFamily,
        fontSize: this.config.globalFontSize + 'px',
        color: this.config.globalColor,
        backgroundColor: this.config.backgroundColor || 'transparent',
      };
      return base;
    },
    bgSrc() {
       return ${Y};
    }
  },
  methods: {
    ${Ut?Ut+",":""}
    ${me.length?`
    getByPath(obj, path) {
      try {
        const segs = String(path).split('.');
        return segs.reduce((acc, k) => (acc ? acc[k] : undefined), obj);
      } catch(e) {
        return undefined;
      }
    },
    getTextValue(id) {
      const srcMap = this.textSources || {};
      const src = srcMap[id];
      if (!src) return '';
      if (src.type === 'static') return String(src.text || '');
      const root = this[src.obj] || {};
      const v = this.getByPath(root, src.path);
      return v != null ? String(v) : '';
    },
    getTextPieces(id) {
      const text = this.getTextValue(id);
      const effMap = this.textEffects || {};
      const eff = effMap[id] || {};
      const orientation = eff.textOrientation || 'horizontal';
      const fontSize = Number(eff.fontSize || (this.config && this.config.globalFontSize) || 14);
      const letterSpacing = Number(eff.letterSpacing || 0);
      const step = fontSize * 0.6 + letterSpacing;

      const amp = eff.textWaveEnabled ? Number(eff.amplitude || 0) : 0;
      const freq = eff.textWaveEnabled ? Number(eff.frequency || 0) : 0;
      const phase = eff.textWaveEnabled ? Number(eff.phase || 0) : 0;
      const skew = eff.skewFlowEnabled ? Number(eff.skewAngle || 0) : 0;
      
      return String(text).split('').map((char, i) => {
        const offset = i * step;
        const waveY = amp * Math.sin((offset * freq) + phase);
        // 简单模拟布局倾斜：每个字符垂直位移随水平位置线性变化
        // skewAngle 正切值 * offset
        const skewY = skew ? offset * Math.tan(skew * Math.PI / 180) : 0;
        
        const style = {
          display: 'inline-block',
          transform: \`translateY(\${waveY + skewY}px)\`,
          fontSize: fontSize + 'px',
          letterSpacing: letterSpacing + 'px'
        };
        if (orientation === 'vertical') {
          style.writingMode = 'vertical-rl';
          style.textOrientation = 'upright';
        }
        return { char, style: { ...style, whiteSpace: 'pre-wrap' } };
      });
    },
    `:""}
    ${st?`
    initCharts() {
      this.$nextTick(() => {
        const opts = this.chartOptions || {};
        Object.keys(opts).forEach((id) => {
          const dom = document.getElementById(id);
          if (dom) {
            const chart = echarts.init(dom);
            chart.setOption(opts[id]);
          }
        });
      });
    },
    `:""}
  },
  mounted() {
    ${st?"this.initCharts();":""}
  }
};
<\/script>

<style scoped>
.${oe} { overflow: hidden; }
.${ke} { position:absolute; left:0; top:0; width:100%; height:100%; object-fit:cover; z-index:0; pointer-events:none; }
.${S} { display:flex; align-items:center; justify-content:flex-start; }
.${de} { display:flex; align-items:center; justify-content:center; }
.${we} { display:flex; align-items:center; justify-content:flex-end; }
${Array.from(A.entries()).map(([s,se])=>`.${se}{ font-family:'${s.replace(/'/g,"\\'")}'; }`).join(`
`)}
${Array.from(g.values()).filter(s=>s.className&&s.css).map(s=>`.${s.className} { ${s.css} }`).join(`
`)}
${Se}
</style>
`,files:{"style/pos.js":_t,"data/index.js":qt}}}function ln(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Eo(y){var $,k;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&(($=n.backgroundGradient.colors)!=null&&$.length)){const P=n.backgroundGradient.angle||0,oe=n.backgroundGradient.colors[0]||"#000000",ke=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${P}deg, ${oe}, ${ke})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&((k=n.textGradient.colors)!=null&&k.length))){const P=n.textGradient.angle||0,oe=n.textGradient.colors[0]||"#000000",ke=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${P}deg, ${oe}, ${ke})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const p=y.eventBinding;return p&&p.enabled&&p.cursor&&e.push(`cursor:${p.cursor}`),e.join(";")}function Ql(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function ko(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${Ql(e)} }`)}function So(y){const n=[],e=p=>{p.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const k=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!k||!P)return;/\{[^}]*\}/.test(P)?n.push(ko(P)):n.push(`.${k} { ${Ql(P)} }`)}})};return e(y),n.join(`
`)}function eo(y){const n=String(y||"").trim();if(!n)return"";let e=n.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(e[0]||"")||(e="_"+e),e}function Mo(y,n){if(!y.hidden)return"";const e=eo(y.hiddenLabel);return e?` ${n!=null&&n.useShow?"v-show":"v-if"}="${e}"`:""}function Pl(y,n,e,p){const $=`lc-${y.replace(/[^A-Za-z0-9_]/g,"_")}-root`;let k=0;const P=e.some(v=>v.type==="chart");function oe(v,L){var Ge,st,Y,Te,w;const V=Eo(v),U=v.zIndex||1,q=v.className&&v.className.trim()?` class="${v.className.trim()}"`:"",je=Mo(v,{useShow:(p==null?void 0:p.hideDirective)==="show"}),Z=v.eventBinding,T=Z&&Z.enabled&&Z.handlerName?` @click="${String(Z.handlerName)}($event)"`:"",Q=v.elementId&&v.elementId.trim()?` id="${v.elementId.trim()}"`:"";if((v.type==="group"||v.type==="container")&&Array.isArray(v.children)){const t=v.children.map((ce,Se)=>oe(ce,Se)).join(`
        `);return`<div${q}${je}${T}${Q} style="${V};z-index:${U}">
        ${t}
      </div>`}if(v.type==="text"){const t=ln(v.text||"");return`<div${q}${je}${T} style="${V};z-index:${U}">${t}</div>`}if(v.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[v.id]){const t=p.imageFileMap[v.id],ce=v.elementId&&v.elementId.trim()?` id="${v.elementId.trim()}"`:"";return`<img${q}${ce}${je}${T} :src="assetUrl('./imgs/${t}')" style="${V};z-index:${U}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[k]){const t=p.imageFileNames[k++],ce=v.elementId&&v.elementId.trim()?` id="${v.elementId.trim()}"`:"";return`<img${q}${ce}${je}${T} :src="assetUrl('./imgs/${t}')" style="${V};z-index:${U}" alt="" />`}return`<div${q}${je}${T} style="${V};z-index:${U}"></div>`}if(v.type==="line"){const t=v.style||{},ce=t.lineColor||"#ffffff",Se=(Ge=t.lineThickness)!=null?Ge:2,Ke=t.lineOrientation||"horizontal",De=t.lineStyle==="dashed",Ne=(st=t.lineDashLength)!=null?st:6,ft=(Y=t.lineDashGap)!=null?Y:4,yt=Math.max(1,Math.round((Te=v.width)!=null?Te:Ke==="horizontal"?200:2)),ot=Math.max(1,Math.round((w=v.height)!=null?w:Ke==="horizontal"?2:200)),Ut=Math.round(ot/2),_t=Math.round(yt/2),qt=De?` stroke-dasharray="${Ne} ${ft}"`:"";return Ke==="horizontal"?`<svg${q}${je}${T} viewBox="0 0 ${yt} ${ot}" preserveAspectRatio="none" style="${V};z-index:${U}"><line x1="0" y1="${Ut}" x2="${yt}" y2="${Ut}" stroke="${ce}" stroke-width="${Se}"${qt} fill="none" /></svg>`:`<svg${q}${je}${T} viewBox="0 0 ${yt} ${ot}" preserveAspectRatio="none" style="${V};z-index:${U}"><line x1="${_t}" y1="0" x2="${_t}" y2="${ot}" stroke="${ce}" stroke-width="${Se}"${qt} fill="none" /></svg>`}if(v.type==="chart"){const t=v.elementId&&v.elementId.trim()?v.elementId.trim():`chart_${L}`,ce=ln(v.text||"chart");return`<div${q}${je}${T} id="${t}" style="${V};z-index:${U}">${ce}</div>`}return`<div${q}${je}${T} style="${V};z-index:${U}">${ln(v.text||"")}</div>`}const ke=e.map((v,L)=>oe(v,L)).join(`
      `),S=So(e),de=n.backgroundUrl||"",we=n.backgroundColor||"transparent",le=n.globalFontFamily||"",me=n.globalFontSize||14,ae=n.globalColor||"#000000",A=(()=>{const v=[];let L=0;return e.forEach(V=>{if(V.type==="chart"){const U=V.elementId&&V.elementId.trim()?V.elementId.trim():`chart_${L}`;L++;const q=V.chartOption||{};try{v.push(`'${U.replace(/'/g,"\\'")}' : ${JSON.stringify(q)}`)}catch{v.push(`'${U.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${v.join(", ")} }`})(),g=(()=>{const v=new Set;return e.forEach(L=>{const V=String(L.hiddenLabel||"").trim(),U=eo(V),q=!!L.hidden;U&&q&&v.add(U)}),Array.from(v).map(L=>`const ${L} = ref(false)`).join(`
`)})();return`
<template>
  <div class="${$}" :style="containerStyle">
    ${ke}
  </div>
</template>

<script setup lang="ts">
import { onMounted, ref, computed } from 'vue'
${P?`import * as echarts from 'echarts'
`:""}
function assetUrl(p: string): string { try { return new URL(p, import.meta.url).href } catch { return p } }
const config = {
  width: ${Math.round(n.width)},
  height: ${Math.round(n.height)},
  backgroundColor: '${we.replace(/'/g,"\\'")}',
  globalFontFamily: '${le.replace(/'/g,"\\'")}',
  globalFontSize: ${Math.round(me)},
  globalColor: '${ae}',
}
const backgroundUrl: string = ${p!=null&&p.backgroundFileName?`assetUrl('./imgs/${String(p.backgroundFileName).replace(/'/g,"\\'")}')`:`'${de.replace(/'/g,"\\'")}'`}
const images: Record<string, string> = {}
${P?`const chartOptions: Record<string, any> = ${A}`:""}
${g?`${g}
`:""}
const containerStyle = computed(() => {
  const base: Record<string, string> = {
    position: 'relative',
    width: config.width + 'px',
    height: config.height + 'px',
    fontFamily: config.globalFontFamily,
    fontSize: config.globalFontSize + 'px',
    color: config.globalColor,
    backgroundColor: (config.backgroundColor || 'transparent') as string,
  }
  if (backgroundUrl) {
    return Object.assign({}, base, {
      backgroundImage: 'url(' + backgroundUrl + ')',
      backgroundSize: 'cover',
      backgroundRepeat: 'no-repeat',
    }) as Record<string, string>
  }
  return base
})
// 事件处理函数
${(()=>{const v=new Map,L=V=>{V.forEach(U=>{const q=U.eventBinding;q&&q.enabled&&q.handlerName&&v.set(String(q.handlerName),String(q.code||"")),Array.isArray(U.children)&&L(U.children)})};return L(e),Array.from(v.entries()).map(([V,U])=>`function ${V}(e: MouseEvent){
${U}
}`).join(`
`)})()}
${P?`onMounted(() => {
  Object.keys(chartOptions || {}).forEach((id) => {
    const el = document.getElementById(id)
    if (el && (echarts as any)) { const inst = (echarts as any).init(el); inst.setOption((chartOptions as any)[id], true) }
  })
})`:""}
<\/script>

<style scoped>
.container { box-sizing: border-box; }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${S}
</style>
`}function zr(y){return String(y).replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Co(y){const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||y.x||0)}px`),e.push(`top:${Math.round(y.top||y.y||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&n.backgroundGradient.colors&&n.backgroundGradient.colors.length){const $=n.backgroundGradient.angle||0,k=n.backgroundGradient.colors[0]||"#000000",P=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${k}, ${P})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&n.textGradient.colors&&n.textGradient.colors.length)){const $=n.textGradient.angle||0,k=n.textGradient.colors[0]||"#000000",P=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${k}, ${P})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`);const p=y.eventBinding;return p&&p.enabled&&p.cursor&&e.push(`cursor:${p.cursor}`),y.hidden&&e.push("display:none"),e.join(";")}function to(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function No(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${to(e)} }`)}function Io(y){const n=[],e=p=>{p.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const k=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!k||!P)return;/\{[^}]*\}/.test(P)?n.push(No(P)):n.push(`.${k} { ${to(P)} }`)}})};return e(y),n.join(`
`)}function Wl(y,n,e,p){function $(g){for(const v of g)if((v.type==="group"||v.type==="container")&&Array.isArray(v.children)){if($(v.children))return!0}else if(v.type==="chart")return!0;return!1}const k=$(e),P=n.backgroundUrl||"",oe=p!=null&&p.backgroundFileName?`background-image:url('./imgs/${p.backgroundFileName}');background-size:cover;background-repeat:no-repeat;`:P?`background-image:url('${P}');background-size:cover;background-repeat:no-repeat;`:"";let ke=0;const S={};(function(v){let L=0;const V=U=>{U.forEach(q=>{if((q.type==="group"||q.type==="container")&&Array.isArray(q.children))V(q.children);else if(q.type==="chart"){const je=q.elementId&&String(q.elementId).trim()?String(q.elementId).trim():`chart_${L++}`;S[q.id]=je}})};V(v)})(e);function de(g){var Z,T,Q,Ge,st;const v=Co(g),L=g.zIndex||1,V=g.className&&g.className.trim()?` class="${g.className.trim()}"`:"",U=g.eventBinding,q=U&&U.enabled&&U.handlerName?` onclick="${String(U.handlerName)}(event)"`:"",je=g.elementId&&g.elementId.trim()?` id="${g.elementId.trim()}"`:"";if((g.type==="group"||g.type==="container")&&Array.isArray(g.children)&&g.children.length>0){const Y=g.children.map(Te=>de(Te)).join(`
        `);return`<div${V}${q}${je} style="${v};z-index:${L}">
        ${Y}
      </div>`}if(g.type==="text"){const Y=(g.style||{}).textAlign||"left",Te=Y==="center"?"text-flex-center":Y==="right"?"text-flex-right":"text-flex-left",w=[(g.className||"").trim(),Te].filter(Boolean).join(" ");return`<div${w?` class="${w}"`:""}${q} style="${v};z-index:${L}">${zr(g.text||"")}</div>`}if(g.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[g.id]){const Y=p.imageFileMap[g.id];return`<img${V}${q} src="./imgs/${Y}" style="${v};z-index:${L}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[ke]){const Y=p.imageFileNames[ke++];return`<img${V}${q} src="./imgs/${Y}" style="${v};z-index:${L}" alt="" />`}return`<div${V}${q} style="${v};z-index:${L}"></div>`}if(g.type==="line"){const Y=g.style||{},Te=Y.lineColor||"#ffffff",w=(Z=Y.lineThickness)!=null?Z:2,t=Y.lineOrientation||"horizontal",ce=Y.lineStyle==="dashed",Se=(T=Y.lineDashLength)!=null?T:6,Ke=(Q=Y.lineDashGap)!=null?Q:4,De=Math.max(1,Math.round((Ge=g.width)!=null?Ge:t==="horizontal"?200:2)),Ne=Math.max(1,Math.round((st=g.height)!=null?st:t==="horizontal"?2:200)),ft=Math.round(Ne/2),yt=Math.round(De/2),ot=ce?` stroke-dasharray="${Se} ${Ke}"`:"";return t==="horizontal"?`<svg${V}${q} viewBox="0 0 ${De} ${Ne}" preserveAspectRatio="none" style="${v};z-index:${L}"><line x1="0" y1="${ft}" x2="${De}" y2="${ft}" stroke="${Te}" stroke-width="${w}"${ot} fill="none" /></svg>`:`<svg${V}${q} viewBox="0 0 ${De} ${Ne}" preserveAspectRatio="none" style="${v};z-index:${L}"><line x1="${yt}" y1="0" x2="${yt}" y2="${Ne}" stroke="${Te}" stroke-width="${w}"${ot} fill="none" /></svg>`}if(g.type==="chart"){const Y=S[g.id]||String(g.elementId||"");return`<div${V}${q} id="${Y}" style="${v};z-index:${L}">${zr(g.text||"chart")}</div>`}return g.type==="container"?`<div${V}${q} style="${v};z-index:${L}">${zr(g.text||"")}</div>`:`<div${V}${q} style="${v};z-index:${L}">${zr(g.text||"")}</div>`}const we=e.map(g=>de(g)).join(`
      `),le=Io(e),me=p!=null&&p.fontFaces&&p.fontFaces.length>0?p.fontFaces.map(g=>`@font-face { font-family: '${String(g.family).replace(/'/g,"\\'")}'; src: url('./fonts/${String(g.file)}'); font-weight: normal; font-style: normal; }`).join(`
`):"";function ae(g,v){g.forEach(L=>{if((L.type==="group"||L.type==="container")&&Array.isArray(L.children))ae(L.children,v);else if(L.type==="chart"){const V=S[L.id]||String(L.elementId||"");try{v.push(`chartOptions['${V.replace(/'/g,"\\'")}'] = ${JSON.stringify(L.chartOption||{})};`)}catch{v.push(`chartOptions['${V.replace(/'/g,"\\'")}'] = {};`)}}})}const A=k?`
    (function(){
      var chartOptions = {};
      ${(()=>{const g=[];return ae(e,g),g.join(`
      `)})()}
      Object.keys(chartOptions).forEach(function(id){
        var el = document.getElementById(id);
        if (el && window.echarts) { var inst = window.echarts.init(el); inst.setOption(chartOptions[id], true); }
      });
    })();
  `:"";return`<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>${zr(y)}</title>
<style>
.container { position:relative; width:${Math.round(n.width)}px; height:${Math.round(n.height)}px; font-family:${String(n.globalFontFamily||"").replace(/'/g,"\\'")}; font-size:${Math.round(n.globalFontSize)}px; color:${String(n.globalColor)}; background-color:${String(n.backgroundColor||"transparent")}; ${oe} }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${me}
${le}
</style>
${k?'<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"><\/script>':""}
</head>
<body>
<div class="container">
  ${we}
</div>
<script>
${(()=>{const g=new Map,v=L=>{L.forEach(V=>{const U=V.eventBinding;U&&U.enabled&&U.handlerName&&g.set(String(U.handlerName),String(U.code||"")),Array.isArray(V.children)&&v(V.children)})};return v(e),Array.from(g.entries()).map(([L,V])=>`function ${L}(event){
${V}
}`).join(`
`)})()}
${A}
<\/script>
</body>
</html>`}function Qr(y){return y.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n]||n)}function Hl(y){var p,$;const n=y.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(y.left||0)}px`),e.push(`top:${Math.round(y.top||0)}px`),y.autoSize||(y.width&&e.push(`width:${Math.round(y.width)}px`),y.height&&e.push(`height:${Math.round(y.height)}px`)),n.opacity!==void 0&&e.push(`opacity:${n.opacity}`),n.border&&!(y.type==="container"&&n.border==="1px dashed rgba(148,163,184,0.6)")&&e.push(`border:${n.border}`),n.borderRadius&&e.push(`border-radius:${n.borderRadius}`),n.backgroundColor&&e.push(`background-color:${n.backgroundColor}`),n.boxShadow&&e.push(`box-shadow:${n.boxShadow}`),n.backgroundGradient&&((p=n.backgroundGradient.colors)!=null&&p.length)){const k=n.backgroundGradient.angle||0,P=n.backgroundGradient.colors[0]||"#000000",oe=n.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${k}deg, ${P}, ${oe})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(y.type==="text"&&(n.fontFamily&&e.push(`font-family:${n.fontFamily}`),n.fontSize!==void 0&&e.push(`font-size:${n.fontSize}px`),n.color&&e.push(`color:${n.color}`),n.fontWeight&&e.push(`font-weight:${n.fontWeight}`),n.letterSpacing!==void 0&&n.letterSpacing!==null&&e.push(`letter-spacing:${n.letterSpacing}px`),n.lineHeight!==void 0&&e.push(`line-height:${n.lineHeight}`),n.fontStyle&&e.push(`font-style:${n.fontStyle}`),n.textAlign&&e.push(`text-align:${n.textAlign}`),n.textDecoration&&e.push(`text-decoration:${n.textDecoration}`),n.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),n.textGradient&&(($=n.textGradient.colors)!=null&&$.length))){const k=n.textGradient.angle||0,P=n.textGradient.colors[0]||"#000000",oe=n.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${k}deg, ${P}, ${oe})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}return y.type==="image"&&n.objectFit&&e.push(`object-fit:${n.objectFit}`),y.hidden&&e.push("display:none"),e.join(";")}function ro(y){return String(y).split(";").map(n=>n.trim()).filter(Boolean).map(n=>n.includes("!important")?n:`${n} !important`).join("; ")}function Fo(y){return String(y).replace(/\{([^}]*)\}/g,(n,e)=>`{ ${ro(e)} }`)}function Ao(y){const n=[],e=p=>{p.forEach($=>{if(($.type==="group"||$.type==="container")&&Array.isArray($.children))e($.children);else{const k=($.className||"").trim(),P=$.customClassCss?String($.customClassCss).trim():"";if(!k||!P)return;/\{[^}]*\}/.test(P)?n.push(Fo(P)):n.push(`.${k} { ${ro(P)} }`)}})};return e(y),n.join(`
`)}function Jl(y,n,e,p){const $=y.replace(/[^A-Za-z0-9_]/g,"_"),k=`lc-${$}-root`,P=`lc-${$}-flex-left`,oe=`lc-${$}-flex-center`,ke=`lc-${$}-flex-right`,S=e.some(g=>g.type==="chart");let de=0;const we=e.map((g,v)=>{var q,je,Z,T,Q;const L=Hl(g),V=g.zIndex||1,U=g.className&&g.className.trim()?` class="${g.className.trim()}"`:"";if((g.type==="group"||g.type==="container")&&Array.isArray(g.children)){const Ge=g.children.map(Y=>{const Te=Hl(Y),w=Y.zIndex||1,t=Y.className&&Y.className.trim()?` class="${Y.className.trim()}"`:"",ce=Y.elementId&&Y.elementId.trim()?` id="${Y.elementId.trim()}"`:"";if(Y.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[Y.id]){const Se=p.imageFileMap[Y.id];return`<img${t}${ce} src="/imgs/${Se}" style="${Te};z-index:${w}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[de]){const Se=p.imageFileNames[de++];return`<img${t}${ce} src="/imgs/${Se}" style="${Te};z-index:${w}" alt="" />`}}return`<div${t}${ce} style="${Te};z-index:${w}">${Qr(Y.text||"")}</div>`}).join(`
        `),st=g.elementId&&g.elementId.trim()?` id="${g.elementId.trim()}"`:"";return`<div${U}${st} style="${L};z-index:${V}">${Ge}</div>`}if(g.type==="text")return`<div${U} style="${L};z-index:${V}">${Qr(g.text||"")}</div>`;if(g.type==="image"){if(p!=null&&p.imageFileMap&&p.imageFileMap[g.id]){const Ge=p.imageFileMap[g.id];return`<img${U} src="/imgs/${Ge}" style="${L};z-index:${V}" alt="" />`}if(p!=null&&p.imageFileNames&&p.imageFileNames[de]){const Ge=p.imageFileNames[de++];return`<img${U} src="/imgs/${Ge}" style="${L};z-index:${V}" alt="" />`}return`<div${U} style="${L};z-index:${V}"></div>`}if(g.type==="line"){const Ge=g.style||{},st=Ge.lineColor||"#ffffff",Y=(q=Ge.lineThickness)!=null?q:2,Te=Ge.lineOrientation||"horizontal",w=Ge.lineStyle==="dashed",t=(je=Ge.lineDashLength)!=null?je:6,ce=(Z=Ge.lineDashGap)!=null?Z:4,Se=Math.max(1,Math.round((T=g.width)!=null?T:Te==="horizontal"?200:2)),Ke=Math.max(1,Math.round((Q=g.height)!=null?Q:Te==="horizontal"?2:200)),De=Math.round(Ke/2),Ne=Math.round(Se/2),ft=w?` stroke-dasharray="${t} ${ce}"`:"";return Te==="horizontal"?`<svg${U} viewBox="0 0 ${Se} ${Ke}" preserveAspectRatio="none" style="${L};z-index:${V}"><line x1="0" y1="${De}" x2="${Se}" y2="${De}" stroke="${st}" stroke-width="${Y}"${ft} fill="none" /></svg>`:`<svg${U} viewBox="0 0 ${Se} ${Ke}" preserveAspectRatio="none" style="${L};z-index:${V}"><line x1="${Ne}" y1="0" x2="${Ne}" y2="${Ke}" stroke="${st}" stroke-width="${Y}"${ft} fill="none" /></svg>`}if(g.type==="chart"){const Ge=g.elementId&&g.elementId.trim()?g.elementId.trim():`chart_${v}`;return`<div${U} id="${Ge}" style="${L};z-index:${V}">${Qr(g.text||"chart")}</div>`}return`<div${U} style="${L};z-index:${V}">${Qr(g.text||"")}</div>`}).join(`
      `),le=Ao(e),me=p!=null&&p.fontFaces&&p.fontFaces.length>0?p.fontFaces.map(g=>`@font-face { font-family: '${g.family.replace(/'/g,"\\'")}'; src: url('/fonts/${g.file}'); font-weight: normal; font-style: normal; }`).join(`
`):"",ae=(()=>{const g=[];return e.forEach((v,L)=>{if(v.type==="chart"){const V=v.elementId&&v.elementId.trim()?v.elementId.trim():`chart_${L}`,U=v.chartOption||{};try{g.push(`'${V.replace(/'/g,"\\'")}' : ${JSON.stringify(U)}`)}catch{g.push(`'${V.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${g.join(", ")} }`})(),A=p!=null&&p.backgroundFileName?`'/imgs/${String(p.backgroundFileName).replace(/'/g,"\\'")}'`:`'${(n.backgroundUrl||"").replace(/'/g,"\\'")}'`;return`import React, { useEffect } from 'react';
${S?`import * as echarts from 'echarts';
`:""}
export default function ${y.replace(/[^A-Za-z0-9_]/g,"_")}() {
  const config = { width: ${Math.round(n.width)}, height: ${Math.round(n.height)}, backgroundColor: '${(n.backgroundColor||"transparent").replace(/'/g,"\\'")}', globalFontFamily: '${(n.globalFontFamily||"").replace(/'/g,"\\'")}', globalFontSize: ${Math.round(n.globalFontSize)}, globalColor: '${n.globalColor}' };
  const backgroundUrl = ${A};
  ${S?`const chartOptions = ${ae};
  useEffect(() => {
    Object.keys(chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) { const inst = echarts.init(el); inst.setOption(chartOptions[id], true); }
    });
  }, []);
`:""}  const containerStyle = { position:'relative', width: config.width + 'px', height: config.height + 'px', fontFamily: config.globalFontFamily, fontSize: config.globalFontSize + 'px', color: config.globalColor, backgroundColor: config.backgroundColor, ...(backgroundUrl ? { backgroundImage: 'url(' + backgroundUrl + ')', backgroundSize: 'cover', backgroundRepeat: 'no-repeat' } : {}) };
  return (
    <div className="${k}" style={containerStyle}>
      <style>{\`.${P}{display:flex;align-items:center;justify-content:flex-start}.${oe}{display:flex;align-items:center;justify-content:center}.${ke}{display:flex;align-items:center;justify-content:flex-end${me?"\\n"+me:""}${le?"\\n"+le:""}\`}</style>
      <div dangerouslySetInnerHTML={{ __html: \`${we.replace(/`/g,"\\`")}\` }} />
    </div>
  );
}
`}var _l=Yl(ao()),jo=["placeholder"],zo={key:0,class:"absolute z-10 bg-gray-900 border border-gray-700 rounded w-full mt-1 max-h-40 overflow-auto shadow custom-scrollbar"},Oo=["onMousedown"],Bo={key:0,class:"px-2 py-2 text-xs text-gray-400"},Go=Kt({__name:"SearchableSelect",props:{modelValue:{},options:{},placeholder:{},numeric:{type:Boolean}},emits:["update:modelValue"],setup(y,{emit:n}){const e=y,p=n,$=be(!1),k=be(""),P=be(null),oe=be("");let ke=null;const S=be(!1);Tt(()=>e.modelValue,U=>{U==null?k.value="":k.value=String(U)},{immediate:!0});const de=Xe(()=>e.options.map(U=>String(U))),we=Xe(()=>{const U=oe.value.trim().toLowerCase();return U?de.value.filter(q=>q.toLowerCase().includes(U)):de.value});function le(U){k.value=U;const q=e.numeric?Number(U):U;p("update:modelValue",q),$.value=!1}function me(){const U=k.value.trim();if(!U){p("update:modelValue",(e.numeric,null)),$.value=!1;return}const q=e.numeric?Number(U):U;p("update:modelValue",q),$.value=!1}function ae(){S.value=!1,$.value=!0,v(k.value)}function A(){}function g(U){U.key==="Enter"&&me()}function v(U){ke&&window.clearTimeout(ke),ke=window.setTimeout(()=>{oe.value=U},180)}function L(){S.value=!0,$.value=!0,v(k.value)}function V(U){P.value&&(P.value.contains(U.target)||($.value=!1))}return sn(()=>{window.addEventListener("click",V),oe.value=k.value}),an(()=>{window.removeEventListener("click",V),ke&&window.clearTimeout(ke)}),(U,q)=>(z(),B("div",{class:"relative",ref_key:"root",ref:P},[xe(r("input",{class:"border border-gray-700 bg-gray-900 text-gray-100 rounded w-full px-2 py-1",placeholder:y.placeholder||"搜索选择或直接输入","onUpdate:modelValue":q[0]||(q[0]=je=>k.value=je),onInput:L,onFocus:ae,onBlur:A,onKeydown:g},null,40,jo),[[Me,k.value]]),$.value?(z(),B("div",zo,[(z(!0),B(tr,null,dr(we.value,je=>(z(),B("div",{key:je,class:"px-2 py-1 hover:bg-gray-700 cursor-pointer text-sm text-gray-100",onMousedown:Kl(Z=>le(je),["prevent"])},bt(je),41,Oo))),128)),we.value.length===0?(z(),B("div",Bo,"无匹配项，回车使用当前输入")):K("",!0)])):K("",!0)],512))}}),Gt=Go,To={class:"space-y-3"},Do={class:"flex items-center justify-between"},Uo={class:"inline-flex items-center cursor-pointer"},Lo={class:"flex items-center justify-between"},Ro={class:"inline-flex items-center cursor-pointer"},Vo=Kt({__name:"CanvasSettingsPanel",props:{spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean}},emits:["update:spacingEnabled","update:alignmentEnabled"],setup(y,{emit:n}){const e=y,p=n,$=Xe({get:()=>e.spacingEnabled,set:P=>p("update:spacingEnabled",P)}),k=Xe({get:()=>e.alignmentEnabled,set:P=>p("update:alignmentEnabled",P)});return(P,oe)=>(z(),B("div",To,[oe[6]||(oe[6]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"辅助间距",-1)),r("div",Do,[oe[3]||(oe[3]=r("label",{class:"text-xs text-gray-400"},"显示间距标注",-1)),r("label",Uo,[xe(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":oe[0]||(oe[0]=ke=>$.value=ke)},null,512),[[tn,$.value]]),oe[2]||(oe[2]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Be(["ml-3 text-xs",$.value?"text-cyan-300":"text-gray-300"])},bt($.value?"已开启":"已关闭"),3)])]),r("div",Lo,[oe[5]||(oe[5]=r("label",{class:"text-xs text-gray-400"},"显示对齐参考线",-1)),r("label",Ro,[xe(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":oe[1]||(oe[1]=ke=>k.value=ke)},null,512),[[tn,k.value]]),oe[4]||(oe[4]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Be(["ml-3 text-xs",k.value?"text-cyan-300":"text-gray-300"])},bt(k.value?"已开启":"已关闭"),3)])])]))}}),Po=Vo,Wo={class:"space-y-3"},Ho={key:0,class:"text-sm text-gray-400"},Jo={key:1,class:"space-y-2"},_o=Kt({__name:"LayersList",props:{elements:{},selectedId:{}},emits:["select","reorderTop"],setup(y,{emit:n}){const e=y,p=n,$=Xe(()=>e.elements),k=be({});function P(ae){k.value[ae]=!k.value[ae]}function oe(ae){const A=ae.children;return Array.isArray(A)&&A.length>0}function ke(ae){const A=ae.children;return Array.isArray(A)?A:[]}const S=be(null),de=be(null);function we(ae){const A=(ae.elementId||"").trim(),g=(ae.className||"").trim(),v=(ae.text||"").trim();return A||g||v||ae.id}function le(ae){const A=String(ae.type||"").toLowerCase();return A==="text"?{label:"文本",cls:"bg-blue-600/30 text-blue-200"}:A==="arc-text"?{label:"环绕",cls:"bg-cyan-600/30 text-cyan-200"}:A==="image"?{label:"图片",cls:"bg-emerald-600/30 text-emerald-200"}:A==="chart"?{label:"图表",cls:"bg-orange-600/30 text-orange-200"}:A==="line"?{label:"线条",cls:"bg-slate-600/30 text-slate-200"}:A==="container"?{label:"容器",cls:"bg-cyan-600/30 text-cyan-200"}:A==="group"?{label:"分组",cls:"bg-purple-600/30 text-purple-200"}:{label:"元素",cls:"bg-gray-600/30 text-gray-200"}}const me=Kt({name:"LayerNode",props:{node:{type:Object,required:!0},selectedId:{type:String,default:null},depth:{type:Number,default:0},index:{type:Number,default:-1}},emits:["select","reorderTop"],setup(ae,{emit:A}){return()=>{const g=ae.node,v=ae.depth===0,L=g.id===ae.selectedId,V=le(g),U=Xt("div",{class:"flex items-center gap-2"},[v&&ae.index>=0?Xt("span",{class:"px-1.5 py-0.5 text-[10px] rounded bg-cyan-600/30 text-cyan-200"},String(ae.index+1)):null,oe(g)?Xt("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:Z=>{Z.stopPropagation(),P(g.id)},title:k.value[g.id]?"收起":"展开"},k.value[g.id]?"▼":"▶"):null,Xt("span",{class:`px-1.5 py-0.5 text-[10px] rounded ${V.cls}`},V.label),Xt("span",{class:"text-left text-sm text-gray-100 truncate whitespace-nowrap max-w-[180px]",title:we(g)},we(g))]),q=Xt("div",{class:["bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2 cursor-grab hover:bg-gray-700/60 transition-colors",L?"ring-2 ring-cyan-400/40 bg-gray-700/70":"",v&&de.value===ae.index?"border-purple-400":"",ae.depth>0?"ml-3":""].filter(Boolean).join(" "),onClick:()=>A("select",g.id),draggable:v?!0:void 0,onDragstart:Z=>{v&&(S.value=ae.index,Z.target.classList.add("cursor-grabbing"))},onDragover:Z=>{v&&(Z.preventDefault(),de.value=ae.index)},onDragenter:()=>{v&&(de.value=ae.index)},onDrop:Z=>{if(!v)return;Z.preventDefault();const T=S.value,Q=ae.index;S.value=null,de.value=null,typeof T=="number"&&typeof Q=="number"&&T!==Q&&A("reorderTop",{from:T,to:Q})},onDragend:Z=>{S.value=null,de.value=null,Z.target.classList.remove("cursor-grabbing")}},[U,null]),je=k.value[g.id]&&oe(g)?Xt("div",{class:"mt-2 space-y-2 pl-3"},[...ke(g)].map(Z=>Xt(me,{node:Z,selectedId:ae.selectedId,depth:ae.depth+1,index:-1,onSelect:T=>A("select",T)}))):null;return Xt("div",{},[q,je])}}});return(ae,A)=>(z(),B("div",Wo,[A[2]||(A[2]=r("div",{class:"text-xs text-gray-400"},"所有元素按层叠从上到下显示，支持展开分组/容器",-1)),$.value.length===0?(z(),B("div",Ho,"暂无元素")):(z(),B("div",Jo,[(z(!0),B(tr,null,dr($.value,(g,v)=>(z(),rn(Xl(me),{key:g.id,node:g,selectedId:y.selectedId,depth:0,index:v,onSelect:A[0]||(A[0]=L=>p("select",L)),onReorderTop:A[1]||(A[1]=L=>p("reorderTop",L))},null,8,["node","selectedId","index"]))),128))]))]))}}),qo=_o,Yo={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},Xo={class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Ko={class:"flex items-center gap-2"},Zo={key:0,class:"space-y-2"},Qo={key:1,class:"space-y-2"},es={class:"grid grid-cols-2 gap-2"},ts={key:2,class:"space-y-2"},rs={class:"flex gap-2"},ns={key:3,class:"space-y-2"},ls={class:"flex gap-2"},os=["value"],ss={key:4,class:"space-y-3"},as={class:"space-y-2"},is={class:"space-y-2"},ds={class:"space-y-2"},us={key:6,class:"space-y-2 pt-4 border-t border-cyan-500/30"},cs={class:"relative"},ps={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},gs={class:"relative w-[520px] max-w-[90vw] p-4 bg-gray-900/95 backdrop-blur-md border border-emerald-500/40 rounded-xl shadow-2xl"},fs={class:"flex items-center justify-between mb-3"},ys={class:"grid grid-cols-2 gap-2"},ms={key:7,class:"space-y-3"},bs=Kt({__name:"CanvasSidebar",props:{exportName:{},config:{},fontLibrary:{},spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean},elements:{},selectedId:{}},emits:["update:exportName","update:configWidth","update:configHeight","update:backgroundColor","update:globalFontFamily","update:globalFontSize","update:globalColor","update:spacingEnabled","update:alignmentEnabled","backgroundFileChange","openPreview","downloadByFormat","downloadAllFormats","resetCanvas","selectElement","moveElementUp","moveElementDown","moveElementTop","moveElementBottom","reorderTopElements"],setup(y,{emit:n}){const e=y,p=n,$=Xe({get:()=>e.exportName,set:Z=>p("update:exportName",Z)}),k=Xe({get:()=>e.config.width,set:Z=>p("update:configWidth",Z)}),P=Xe({get:()=>e.config.height,set:Z=>p("update:configHeight",Z)}),oe=Xe({get:()=>e.config.backgroundColor||"",set:Z=>p("update:backgroundColor",Z)}),ke=Xe({get:()=>e.config.globalFontFamily||"",set:Z=>p("update:globalFontFamily",Z)}),S=Xe({get:()=>e.config.globalFontSize||14,set:Z=>p("update:globalFontSize",Z)}),de=Xe({get:()=>e.config.globalColor||"#ffffff",set:Z=>p("update:globalColor",Z)}),we=Xe({get:()=>e.spacingEnabled,set:Z=>p("update:spacingEnabled",Z)}),le=Xe({get:()=>e.alignmentEnabled,set:Z=>p("update:alignmentEnabled",Z)});function me(Z){try{return String(Z||"#000000")}catch{return"#000000"}}const ae=Xe({get:()=>A.value,set:Z=>A.value=Z}),A=be(!1),g=be("settings");function v(Z){p("backgroundFileChange",Z)}function L(){p("openPreview")}function V(){A.value=!A.value}function U(Z){p("downloadByFormat",Z),A.value=!1}function q(){p("downloadAllFormats"),A.value=!1}function je(){p("resetCanvas")}return(Z,T)=>(z(),B("div",Yo,[T[31]||(T[31]=r("div",{class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),Or(" 画布设置 ")])],-1)),r("div",Xo,[r("div",Ko,[r("button",{class:Be(["px-3 py-1 text-xs rounded bg-gradient-to-r from-cyan-600 to-blue-600 text-white",g.value==="settings"?"":"opacity-50"]),onClick:T[0]||(T[0]=Q=>g.value="settings")},"设置",2),r("button",{class:Be(["px-3 py-1 text-xs rounded bg-gradient-to-r from-purple-600 to-pink-600 text-white",g.value==="layers"?"":"opacity-50"]),onClick:T[1]||(T[1]=Q=>g.value="layers")},"容器层级",2)]),g.value==="settings"?(z(),B("div",Zo,[T[21]||(T[21]=r("label",{class:"block text-sm font-medium text-cyan-300"},"组件名称",-1)),xe(r("input",{"onUpdate:modelValue":T[2]||(T[2]=Q=>$.value=Q),class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"GeneratedComponent"},null,512),[[Me,$.value]])])):K("",!0),g.value==="settings"?(z(),B("div",Qo,[T[22]||(T[22]=r("label",{class:"block text-sm font-medium text-cyan-300"},"画布尺寸",-1)),r("div",es,[xe(r("input",{"onUpdate:modelValue":T[3]||(T[3]=Q=>k.value=Q),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"宽度"},null,512),[[Me,k.value,void 0,{number:!0}]]),xe(r("input",{"onUpdate:modelValue":T[4]||(T[4]=Q=>P.value=Q),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"高度"},null,512),[[Me,P.value,void 0,{number:!0}]])])])):K("",!0),g.value==="settings"?(z(),B("div",ts,[T[23]||(T[23]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景图片",-1)),r("div",rs,[r("input",{type:"file",onChange:v,accept:"image/*",class:"flex-1 text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-cyan-600 file:text-white hover:file:bg-cyan-500 file:cursor-pointer"},null,32)])])):K("",!0),g.value==="settings"?(z(),B("div",ns,[T[24]||(T[24]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景颜色",-1)),r("div",ls,[r("input",{value:me(oe.value),type:"color",onInput:T[5]||(T[5]=Q=>p("update:backgroundColor",Q.target.value)),class:"w-16 h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,40,os),xe(r("input",{"onUpdate:modelValue":T[6]||(T[6]=Q=>oe.value=Q),type:"text",class:"flex-1 px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"#000000 或 rgba(...)"},null,512),[[Me,oe.value]])])])):K("",!0),g.value==="settings"?(z(),B("div",ss,[T[28]||(T[28]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"全局字体设置",-1)),r("div",as,[T[25]||(T[25]=r("label",{class:"block text-xs text-gray-400"},"字体族",-1)),vt(Gt,{options:y.fontLibrary,modelValue:ke.value,"onUpdate:modelValue":T[7]||(T[7]=Q=>ke.value=Q),placeholder:"选择字体"},null,8,["options","modelValue"])]),r("div",is,[T[26]||(T[26]=r("label",{class:"block text-xs text-gray-400"},"字号 (px)",-1)),xe(r("input",{"onUpdate:modelValue":T[8]||(T[8]=Q=>S.value=Q),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-cyan-500/30 rounded text-gray-100 text-sm focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[Me,S.value,void 0,{number:!0}]])]),r("div",ds,[T[27]||(T[27]=r("label",{class:"block text-xs text-gray-400"},"颜色",-1)),xe(r("input",{"onUpdate:modelValue":T[9]||(T[9]=Q=>de.value=Q),type:"color",class:"w-full h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,512),[[Me,de.value]])])])):K("",!0),g.value==="settings"?(z(),rn(Po,{key:5,spacingEnabled:we.value,alignmentEnabled:le.value,"onUpdate:spacingEnabled":T[10]||(T[10]=Q=>we.value=Q),"onUpdate:alignmentEnabled":T[11]||(T[11]=Q=>le.value=Q)},null,8,["spacingEnabled","alignmentEnabled"])):K("",!0),g.value==="settings"?(z(),B("div",us,[r("button",{onClick:L,class:"w-full px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"},"预览（新窗口）"),r("div",cs,[r("button",{onClick:V,class:"w-full px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},"导出"),ae.value?(z(),B("div",ps,[r("div",{class:"absolute inset-0 bg-black/60",onClick:T[12]||(T[12]=Q=>ae.value=!1)}),r("div",gs,[r("div",fs,[T[29]||(T[29]=r("h3",{class:"text-sm font-medium text-emerald-300"},"选择导出格式",-1)),r("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:T[13]||(T[13]=Q=>ae.value=!1)},"关闭")]),r("div",ys,[r("button",{onClick:T[14]||(T[14]=Q=>U("vue2")),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded"},"Vue2 组件"),r("button",{onClick:T[15]||(T[15]=Q=>U("vue3")),class:"px-3 py-2 text-xs bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-500 hover:to-cyan-500 text-white rounded"},"Vue3 组件"),r("button",{onClick:T[16]||(T[16]=Q=>U("react")),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"React 组件"),r("button",{onClick:T[17]||(T[17]=Q=>U("html")),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded"},"纯 HTML 页面"),r("button",{onClick:T[18]||(T[18]=Q=>q()),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded col-span-2"},"一键导出（全部）")])])])):K("",!0)]),r("button",{onClick:je,class:"w-full px-4 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"清空画布")])):K("",!0),g.value==="layers"?(z(),B("div",ms,[T[30]||(T[30]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器层级",-1)),vt(qo,{elements:e.elements||[],selectedId:e.selectedId||null,onSelect:T[19]||(T[19]=Q=>p("selectElement",Q)),onReorderTop:T[20]||(T[20]=Q=>p("reorderTopElements",Q))},null,8,["elements","selectedId"])])):K("",!0)])]))}}),xs=bs,ql=Yl(co()),hs={class:"relative w-full"},vs=Kt({__name:"CssEditor",props:{modelValue:{},height:{},debounceMs:{}},emits:["update:modelValue"],setup(y,{emit:n}){const e=y,p=n,$=be(e.modelValue||"");let k=null;const P=typeof e.debounceMs=="number"?Math.max(0,e.debounceMs):250;Tt(()=>e.modelValue,we=>{k&&(clearTimeout(k),k=null);const le=we||"";le!==$.value&&($.value=le)}),Tt($,we=>{k&&clearTimeout(k),k=window.setTimeout(()=>{p("update:modelValue",we),k=null},P)}),an(()=>{k&&(clearTimeout(k),k=null)});function oe(){const we=$.value||"";if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText(we).catch(()=>{try{const le=document.createElement("textarea");le.value=we,document.body.appendChild(le),le.select(),document.execCommand("copy"),document.body.removeChild(le)}catch{}});else try{const le=document.createElement("textarea");le.value=we,document.body.appendChild(le),le.select(),document.execCommand("copy"),document.body.removeChild(le)}catch{}}function ke(){k&&(clearTimeout(k),k=null),$.value="",p("update:modelValue","")}const S=[no,lo(),so],de=Xe(()=>{var we;return(we=e.height)!=null?we:"180px"});return(we,le)=>(z(),B("div",hs,[r("div",{class:"absolute right-2 top-2 z-10 flex gap-2"},[r("button",{type:"button",class:"px-2 py-1 text-xs bg-gray-700/70 hover:bg-gray-700 text-gray-100 rounded",onClick:oe},"复制"),r("button",{type:"button",class:"px-2 py-1 text-xs bg-red-600/70 hover:bg-red-600 text-white rounded",onClick:ke},"清空")]),vt(Xl(oo),{modelValue:$.value,"onUpdate:modelValue":le[0]||(le[0]=me=>$.value=me),extensions:S,style:Ct({height:de.value,width:"100%"}),class:"w-full rounded border border-purple-500/30 bg-gray-800/50"},null,8,["modelValue","style"])]))}}),$s=dn(vs,[["__scopeId","data-v-c1c6cbbe"]]);function ws(y,n,e,p,$,k){y&&(y.style=y.style||{},y.style.boxShadow=`${n}px ${e}px ${p}px ${$}px ${k}`)}function Es(y){y.style=y.style||{},y.style.textGradient=y.style.textGradient||{colors:["#00A3FF","#ffffff"],angle:0}}function ks(y){y.style=y.style||{},y.style.backgroundGradient=y.style.backgroundGradient||{colors:["#00A3FF","#ffffff"],angle:90}}function Ss(y,n){var de,we,le;const e=(de=n==null?void 0:n.maxDepth)!=null?de:6,p=(we=n==null?void 0:n.maxEntries)!=null?we:400,$=(le=n==null?void 0:n.includeIntermediate)!=null?le:!1,k=[],P=new WeakSet;function oe(me){return Object.prototype.toString.call(me)==="[object Object]"}function ke(me){k.length<p&&k.push(me)}function S(me,ae,A){if(!(A>e)&&me!=null){if(typeof me!="object"){ke(ae);return}if(!P.has(me)){if(P.add(me),Array.isArray(me)){ke(ae);const g=Math.min(me.length,20);for(let v=0;v<g;v++)S(me[v],`${ae}[${v}]`,A+1);return}if(oe(me)){$&&ke(ae);const g=Object.keys(me).slice(0,50);for(const v of g)S(me[v],ae?`${ae}.${v}`:v,A+1);return}ke(ae)}}}return S(y,"",0),k.filter(Boolean)}function Ms(y,n){try{if(!y||!n)return"";const e=n.replace(/\[(\d+)\]/g,".$1").replace(/\['([^']+)'\]/g,".$1").replace(/\["([^\"]+)"\]/g,".$1").split(".").filter(Boolean);let p=y;for(const $ of e){if(p==null)return"";p=p[$]}return typeof p=="object"?JSON.stringify(p):p!=null?p:""}catch{return""}}function Cs(y,n){var $;if(!n||!(($=n.dynamic)!=null&&$.enabled)||!n.dynamic.objectName||!n.dynamic.propertyPath)return"";const e=n.dynamic,p=y[e.objectName];return String(Ms(p,e.propertyPath))}var Ns={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20 flex flex-col"},Is={key:0,class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Fs={class:"space-y-3"},As={class:"grid grid-cols-2 gap-2"},js={class:"col-span-2"},zs={key:0,class:"space-y-3"},Os={class:"space-y-2"},Bs={class:"grid grid-cols-2 gap-2"},Gs={class:"grid grid-cols-2 gap-2"},Ts={class:"grid grid-cols-2 gap-2"},Ds=["value"],Us=["value"],Ls={class:"space-y-2"},Rs={class:"flex gap-1"},Vs=["value"],Ps=["value"],Ws={class:"space-y-2"},Hs={class:"grid grid-cols-3 gap-1"},Js={class:"space-y-2"},_s={class:"grid grid-cols-2 gap-2"},qs=["value"],Ys=["value"],Xs=["value"],Ks=["value"],Zs={class:"grid grid-cols-4 gap-1"},Qs={class:"space-y-3"},ea={class:"flex items-center justify-between"},ta={class:"inline-flex items-center cursor-pointer"},ra={key:0,class:"grid grid-cols-2 gap-2"},na={key:1},la={class:"space-y-3"},oa={class:"space-y-2"},sa={class:"flex items-center justify-between"},aa={key:0},ia={class:"flex gap-2"},da={key:1},ua={key:2},ca={key:3,class:"space-y-2 pt-2 border-t border-purple-500/20"},pa={class:"flex items-center justify-between"},ga={class:"inline-flex items-center cursor-pointer"},fa=["checked"],ya={key:0,class:"space-y-1"},ma=["value"],ba={key:1,class:"space-y-3"},xa={class:"flex items-center gap-2"},ha=["value"],va=["value"],$a={class:"space-y-2"},wa={class:"flex items-center justify-between"},Ea={class:"flex items-center gap-1 text-xs text-gray-300"},ka=["checked"],Sa={key:0,class:"grid grid-cols-3 gap-2 items-end"},Ma={class:"flex items-center gap-2"},Ca=["value"],Na=["value"],Ia={class:"flex items-center gap-2"},Fa=["value"],Aa=["value"],ja={class:"space-y-1"},za=["value"],Oa=["value"],Ba={class:"space-y-2"},Ga={class:"flex items-center justify-between"},Ta={class:"flex items-center gap-1 text-xs text-gray-300"},Da=["checked"],Ua={key:0,class:"space-y-1"},La={class:"flex items-center gap-2"},Ra={key:0,class:"space-y-1"},Va=["value"],Pa=["value"],Wa={key:1,class:"space-y-1"},Ha=["value"],Ja={class:"flex items-center gap-1"},_a=["value"],qa={class:"space-y-2"},Ya={class:"flex items-center justify-between"},Xa={class:"flex items-center gap-1 text-xs text-gray-300"},Ka=["checked"],Za={key:0,class:"space-y-2"},Qa=["value"],ei={class:"space-y-1"},ti={class:"flex items-center gap-2"},ri=["value"],ni=["value"],li={class:"space-y-1"},oi={class:"flex items-center gap-2"},si=["value"],ai=["value"],ii={class:"space-y-1"},di={class:"flex items-center gap-2"},ui=["value"],ci=["value"],pi={class:"space-y-1"},gi={class:"flex items-center gap-2"},fi=["value"],yi=["value"],mi={class:"space-y-1"},bi={key:0,class:"flex items-center gap-2"},xi=["value"],hi=["value"],vi={key:2,class:"space-y-3"},$i={class:"flex items-center gap-2"},wi={key:0,class:"space-y-2"},Ei=["value"],ki={class:"grid grid-cols-2 gap-2"},Si=["value"],Mi=["value"],Ci={key:0,class:"grid grid-cols-2 gap-2"},Ni=["value"],Ii=["value"],Fi={key:1,class:"grid grid-cols-2 gap-2"},Ai={key:2,class:"grid grid-cols-3 gap-2 items-end"},ji={key:1},zi={class:"flex items-center justify-between mt-2"},Oi={key:0,class:"text-xs text-red-400"},Bi={key:3,class:"space-y-3"},Gi={class:"space-y-2"},Ti={class:"flex gap-1"},Di=["value"],Ui=["value"],Li={class:"grid grid-cols-2 gap-2"},Ri={class:"grid grid-cols-2 gap-1"},Vi=["value"],Pi={class:"grid grid-cols-2 gap-2"},Wi=["value"],Hi={key:0},Ji=["value"],_i={key:0,class:"grid grid-cols-2 gap-2"},qi=["value"],Yi={key:4,class:"space-y-3"},Xi={class:"space-y-2"},Ki={class:"space-y-2 mt-2"},Zi={class:"flex items-center gap-2"},Qi=["checked"],ed={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},td={class:"text-xs text-gray-400"},rd={class:"space-y-2"},nd={class:"grid grid-cols-2 gap-1"},ld={class:"grid grid-cols-2 gap-2"},od={class:"grid grid-cols-2 gap-2"},sd={class:"grid grid-cols-2 gap-2"},ad=["value"],id=["value"],dd={class:"space-y-2"},ud=["value"],cd={class:"space-y-2"},pd={class:"flex gap-1"},gd=["value","disabled"],fd=["value","disabled"],yd={key:0,class:"text-xs text-yellow-400 mt-1"},md={class:"space-y-2"},bd={class:"flex gap-1"},xd=["value"],hd=["value"],vd={class:"space-y-2"},$d={class:"grid grid-cols-3 gap-1"},wd={class:"space-y-2"},Ed={class:"grid grid-cols-2 gap-1"},kd={class:"space-y-2"},Sd={class:"flex items-center gap-2"},Md={class:"flex items-center gap-2 mt-1"},Cd={class:"space-y-2"},Nd={class:"flex items-center justify-between"},Id={class:"flex gap-1"},Fd={key:0,class:"grid grid-cols-3 gap-2 items-center"},Ad={class:"col-span-1"},jd={class:"col-span-1"},zd={class:"col-span-1"},Od={class:"space-y-2"},Bd={class:"grid grid-cols-3 gap-1"},Gd={class:"space-y-2"},Td={class:"flex items-center justify-between"},Dd={class:"flex gap-1"},Ud={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Ld={class:"grid grid-cols-2 gap-2"},Rd={class:"flex gap-1"},Vd={class:"flex gap-1"},Pd={class:"block text-xs text-gray-400 mb-1"},Wd={class:"space-y-2"},Hd={class:"flex items-center justify-between"},Jd={class:"flex gap-1"},_d={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},qd={class:"grid grid-cols-2 gap-2"},Yd={class:"flex gap-1"},Xd={class:"flex gap-1"},Kd={class:"block text-xs text-gray-400 mb-1"},Zd={key:5,class:"space-y-3"},Qd={class:"space-y-2"},eu={key:0,class:"space-y-2"},tu={class:"max-h-32 overflow-y-auto custom-scrollbar bg-gray-800/30 rounded p-2"},ru={class:"grid grid-cols-4 gap-2"},nu=["onClick"],lu=["src","alt"],ou={key:0,class:"text-xs text-gray-500 text-center py-2"},su={class:"grid grid-cols-3 gap-2"},au={class:"space-y-2"},iu={class:"pt-4 border-t border-purple-500/30 space-y-2"},du={key:1,class:"p-4 text-center text-gray-400 flex-1 flex flex-col justify-center"},uu={},cu=Kt({...uu,__name:"ElementSettingsPanel",props:{selectedEl:{},config:{},fontLibrary:{},fontSizeLibrary:{},fontWeightOptions:{},fontStyleOptions:{},databaseObjects:{},dbMap:{},iconLibrary:{},defaultChartOption:{type:Function},safeHex:{type:Function},initCustomClassSkeleton:{type:Function},refreshAllCustomClassCss:{type:Function},removeCustomClassCssForElement:{type:Function},getIconDataUrlById:{type:Function}},emits:["duplicateSelected","removeSelected","saveSelectedAsComponent"],setup(y,{emit:n}){const e=y,p=n,$=be("visual"),k=be(""),P=be("");Tt(()=>{var w;return(w=e.selectedEl)==null?void 0:w.id},()=>{var t;const w=e.selectedEl;w&&w.type==="chart"&&($.value="visual",P.value="",k.value=JSON.stringify((t=w.chartOption)!=null?t:e.defaultChartOption(w.chartType||"line"),null,2))});const oe=Xe(()=>{var ce,Se;const w=(Se=(ce=e.selectedEl)==null?void 0:ce.dynamic)==null?void 0:Se.objectName;if(!w)return[];const t=e.dbMap[w];try{return Ss(t,{maxDepth:6,maxEntries:400})}catch{return[]}});function ke(w){return Cs(e.dbMap,w)}function S(w){return typeof w=="string"&&w.trim().endsWith("%")?"%":"px"}function de(w){if(w==null)return 0;if(typeof w=="number")return w;const t=String(w).trim();if(t.endsWith("%")){const Se=Number(t.replace("%",""));return Number.isFinite(Se)?Se:0}const ce=Number(t.replace("px",""));return Number.isFinite(ce)?ce:0}function we(w,t){const ce=e.selectedEl;ce&&(ce.style=ce.style||{},ce.style.borderRadius=`${w}${t}`)}function le(w){const t={x:0,y:8,blur:24,spread:0,color:"#000000"};if(!w||!w.trim())return t;const ce=w.split(/\s+/).filter(Boolean);if(ce.length<3)return t;const Se=ce.slice(0,4).map(ot=>Number(String(ot).replace("px",""))),Ke=ce.slice(4).join(" ")||t.color,[De=NaN,Ne=NaN,ft=NaN,yt=NaN]=Se;return{x:Number.isFinite(De)?De:t.x,y:Number.isFinite(Ne)?Ne:t.y,blur:Number.isFinite(ft)?ft:t.blur,spread:Number.isFinite(yt)?yt:t.spread,color:Ke}}function me(w,t,ce,Se,Ke){ws(e.selectedEl,w,t,ce,Se,Ke)}function ae(w){Es(w)}function A(w){ks(w)}function g(){P.value="";try{const w=JSON.parse(k.value);e.selectedEl&&e.selectedEl.type==="chart"&&(e.selectedEl.chartOption=w)}catch(w){P.value=`JSON 解析失败：${(w==null?void 0:w.message)||String(w)}`}}function v(w,t){if(!e.selectedEl||e.selectedEl.type!=="chart"||!e.selectedEl.chartOption)return;const ce=e.selectedEl.chartOption,Se=ce.series||[],Ke={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:w},{offset:1,color:t}],global:!1};Se.forEach(De=>{De.type==="bar"&&(De.itemStyle=De.itemStyle||{},De.itemStyle.color=Ke)}),k.value=JSON.stringify(ce,null,2)}function L(){const w=e.selectedEl;return!w||w.type!=="chart"?null:(w.chartOption||(w.chartOption=e.defaultChartOption(w.chartType||"line")),w.chartOption)}function V(w){const t=L();t&&(t.title=t.title||{},t.title.text=w,k.value=JSON.stringify(t,null,2))}function U(w){const t=L();t&&(t.color=w.split(",").map(ce=>ce.trim()).filter(Boolean),k.value=JSON.stringify(t,null,2))}function q(w){const t=L();t&&(t.legend=t.legend||{},t.legend.show=w==="1",k.value=JSON.stringify(t,null,2))}function je(w){var ce;const t=(ce=w.target.files)==null?void 0:ce[0];if(t&&e.selectedEl){const Se=new FileReader;Se.onload=()=>{e.selectedEl&&(e.selectedEl.src=String(Se.result),e.selectedEl.iconId=void 0)},Se.readAsDataURL(t)}}async function Z(w){const t=e.selectedEl;if(!t||t.type!=="image")return;const ce=await e.getIconDataUrlById(w.id);if(!ce)return;t.src=ce,t.iconId=w.id;const Se=new Image;Se.onload=()=>{e.selectedEl&&e.selectedEl.id===t.id&&(e.selectedEl.width=Se.naturalWidth,e.selectedEl.height=Se.naturalHeight)},Se.src=ce}function T(){const w=e.selectedEl;if(!w||w.type!=="image"||!w.src)return;const t=new Image;t.onload=()=>{e.selectedEl&&(e.selectedEl.width=t.naturalWidth,e.selectedEl.height=t.naturalHeight)},t.src=w.src}function Q(){}const Ge=Xe({get(){const w=e.selectedEl;return!!(w&&w.eventBinding&&w.eventBinding.enabled)},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!1,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.enabled=w,(t.eventBinding.handlerName==null||String(t.eventBinding.handlerName).trim()==="")&&(t.eventBinding.handlerName="handleClick"),(t.eventBinding.cursor==null||String(t.eventBinding.cursor).trim()==="")&&(t.eventBinding.cursor="pointer"),t.eventBinding.code==null&&(t.eventBinding.code=""))}}),st=Xe({get(){var w,t;return(t=(w=e.selectedEl)==null?void 0:w.eventBinding)==null?void 0:t.cursor},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.cursor=w)}}),Y=Xe({get(){var w,t;return(t=(w=e.selectedEl)==null?void 0:w.eventBinding)==null?void 0:t.handlerName},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.handlerName=w)}}),Te=Xe({get(){var w,t;return(t=(w=e.selectedEl)==null?void 0:w.eventBinding)==null?void 0:t.code},set(w){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.code=w)}});return(w,t)=>{var ce,Se,Ke,De,Ne,ft,yt,ot,Ut,_t,qt,s,se,fe,Fe,X,te,Ue,$t,wt,Lt,Rt,nt,lt,Nt,Zt,Ot,Vt,it,Qt,rr,nr,Pt,Wt,Ft,lr,or,Ze,pe,Ye,Re,ut,Qe,Le,rt,Ve,Ie,Bt,at,dt,Et,et,tt,At,Yt,Dt,Ht,kt,xr,sr,hr,Br,Gr,Tr,ct,er,Dr,Ur,vr,$r,wr,Lr,ar,ur,cr,pr,Er,kr,Rr,Sr,It,St,Vr,Pr,Wr,Hr,Jr,_r,Mr,gr,fr,Cr,yr,mr,qr,ir,Nr,Yr,Ir,Fr,Xr,Ar,l,o,i,c,m,f,C,F,M,N,d,u,G,H,ue,ye,ie,ve,he,ee,re,J,ne,ze,b,h,R,j,D,_,x,W,E,ge,Ae,$e,Ce,Oe,Pe,xt,mt,Mt,pt,jt,ht,Jt,br,Kr,un,cn,pn,gn,fn,yn,mn,bn,xn,hn,vn,$n,wn,En,kn,Sn,Mn,Cn,Nn,In,Fn,An,jn,zn,On,Bn,Gn,Tn,Dn,Un,Ln,Rn,Vn,Pn,Wn,Hn,Jn,_n,qn,Yn,Xn,Kn,Zn,Qn,el,tl,rl,nl,ll,ol,sl,al,il,dl,ul,cl,pl,gl,fl,yl,ml,bl,xl,hl,vl,$l,wl,El,kl,Sl,Ml,Cl,Nl,Il,Fl,Al,jl,zl,Ol,Bl,Gl,Tl,Dl,Ul;return z(),B("div",Ns,[t[272]||(t[272]=r("div",{class:"p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-purple-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),Or(" 元素设置 ")])],-1)),e.selectedEl?(z(),B("div",Is,[r("div",Fs,[t[149]||(t[149]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"位置和尺寸",-1)),r("div",As,[r("div",null,[t[144]||(t[144]=r("label",{class:"block text-xs text-gray-400 mb-1"},"X",-1)),xe(r("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.selectedEl.left=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.left,void 0,{number:!0}]])]),r("div",null,[t[145]||(t[145]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y",-1)),xe(r("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.selectedEl.top=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.top,void 0,{number:!0}]])]),r("div",null,[t[146]||(t[146]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度",-1)),xe(r("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>e.selectedEl.width=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[147]||(t[147]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度",-1)),xe(r("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>e.selectedEl.height=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.height,void 0,{number:!0}]])]),r("div",js,[t[148]||(t[148]=r("label",{class:"block text-xs text-gray-400 mb-1"},"层级（z-index）",-1)),xe(r("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>e.selectedEl.zIndex=a),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.zIndex,void 0,{number:!0}]])])])]),e.selectedEl&&e.selectedEl.type==="arc-text"?(z(),B("div",zs,[t[165]||(t[165]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"环绕文字设置",-1)),r("div",Os,[t[150]||(t[150]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),xe(r("textarea",{"onUpdate:modelValue":t[5]||(t[5]=a=>e.selectedEl.text=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[Me,e.selectedEl.text]])]),r("div",Bs,[r("div",null,[t[151]||(t[151]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),vt(Gt,{options:e.fontSizeLibrary,modelValue:((ce=e.selectedEl.style)==null?void 0:ce.fontSize)||e.config.globalFontSize,"onUpdate:modelValue":t[6]||(t[6]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=a)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[t[152]||(t[152]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),vt(Gt,{options:e.fontLibrary,modelValue:((Se=e.selectedEl.style)==null?void 0:Se.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[7]||(t[7]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=a)})},null,8,["options","modelValue"])])]),r("div",Gs,[r("div",null,[t[153]||(t[153]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),vt(Gt,{options:e.fontWeightOptions,modelValue:((Ke=e.selectedEl.style)==null?void 0:Ke.fontWeight)||"400","onUpdate:modelValue":t[8]||(t[8]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=a)})},null,8,["options","modelValue"])]),r("div",null,[t[154]||(t[154]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),vt(Gt,{options:e.fontStyleOptions,modelValue:((De=e.selectedEl.style)==null?void 0:De.fontStyle)||"normal","onUpdate:modelValue":t[9]||(t[9]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=a)})},null,8,["options","modelValue"])])]),r("div",Ts,[r("div",null,[t[155]||(t[155]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:(ft=(Ne=e.selectedEl.style)==null?void 0:Ne.letterSpacing)!=null?ft:0,onInput:t[10]||(t[10]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(a.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ds)]),r("div",null,[t[156]||(t[156]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:(ot=(yt=e.selectedEl.style)==null?void 0:yt.lineHeight)!=null?ot:1.5,onInput:t[11]||(t[11]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(a.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Us)])]),r("div",Ls,[t[157]||(t[157]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",Rs,[r("input",{value:((_t=(Ut=e.selectedEl)==null?void 0:Ut.style)==null?void 0:_t.color)||e.config.globalColor,onInput:t[12]||(t[12]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Vs),r("input",{value:(se=(s=(qt=e.selectedEl)==null?void 0:qt.style)==null?void 0:s.color)!=null?se:e.config.globalColor,onInput:t[13]||(t[13]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,40,Ps)])]),r("div",Ws,[t[158]||(t[158]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对齐方式",-1)),r("div",Hs,[r("button",{onClick:t[14]||(t[14]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((fe=e.selectedEl.style)==null?void 0:fe.textAlign)||"center")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左",2),r("button",{onClick:t[15]||(t[15]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Fe=e.selectedEl.style)==null?void 0:Fe.textAlign)||"center")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"中",2),r("button",{onClick:t[16]||(t[16]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((X=e.selectedEl.style)==null?void 0:X.textAlign)||"center")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右",2)])]),r("div",Js,[t[164]||(t[164]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆弧参数",-1)),r("div",_s,[r("div",null,[t[159]||(t[159]=r("label",{class:"block text-xs text-gray-400 mb-1"},"半径(px)",-1)),r("input",{value:(wt=($t=(Ue=(te=e.selectedEl)==null?void 0:te.style)==null?void 0:Ue.arcText)==null?void 0:$t.radius)!=null?wt:Math.min(e.selectedEl.width||0,e.selectedEl.height||0)/2,onInput:t[17]||(t[17]=a=>{if(e.selectedEl){const O=Number(a.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.radius=O}}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,qs)]),r("div",null,[t[160]||(t[160]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始角(°)",-1)),r("input",{value:(lt=(nt=(Rt=(Lt=e.selectedEl)==null?void 0:Lt.style)==null?void 0:Rt.arcText)==null?void 0:nt.startAngle)!=null?lt:0,onInput:t[18]||(t[18]=a=>{if(e.selectedEl){const O=Number(a.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=O}}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ys)]),r("div",null,[t[161]||(t[161]=r("label",{class:"block text-xs text-gray-400 mb-1"},"扫过角(°)",-1)),r("input",{value:(Vt=(Ot=(Zt=(Nt=e.selectedEl)==null?void 0:Nt.style)==null?void 0:Zt.arcText)==null?void 0:Ot.sweepAngle)!=null?Vt:180,onInput:t[19]||(t[19]=a=>{if(e.selectedEl){const O=Number(a.target.value)||0;e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.sweepAngle=O}}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Xs)]),r("div",null,[t[163]||(t[163]=r("label",{class:"block text-xs text-gray-400 mb-1"},"顺时针",-1)),r("select",{value:(nr=(rr=(Qt=(it=e.selectedEl)==null?void 0:it.style)==null?void 0:Qt.arcText)==null?void 0:rr.clockwise)==null||nr?"1":"0",onChange:t[20]||(t[20]=a=>{if(e.selectedEl){const O=a.target.value==="1";e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.clockwise=O}}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[162]||(t[162]=[r("option",{value:"1"},"是",-1),r("option",{value:"0"},"否",-1)])],40,Ks)])]),r("div",Zs,[r("button",{onClick:t[21]||(t[21]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=180,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"上"),r("button",{onClick:t[22]||(t[22]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=0,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下"),r("button",{onClick:t[23]||(t[23]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=90,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左"),r("button",{onClick:t[24]||(t[24]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.arcText=e.selectedEl.style.arcText||{},e.selectedEl.style.arcText.startAngle=270,e.selectedEl.style.arcText.sweepAngle=180,e.selectedEl.style.arcText.clockwise=!0)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200","bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右")])])])):K("",!0),r("div",Qs,[t[172]||(t[172]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"事件绑定",-1)),r("div",ea,[t[167]||(t[167]=r("label",{class:"text-xs text-gray-400"},"开启事件绑定",-1)),r("label",ta,[xe(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":t[25]||(t[25]=a=>Ge.value=a)},null,512),[[tn,Ge.value]]),t[166]||(t[166]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Be(["ml-3 text-xs",Ge.value?"text-cyan-300":"text-gray-300"])},bt(Ge.value?"已开启":"已关闭"),3)])]),Ge.value?(z(),B("div",ra,[r("div",null,[t[169]||(t[169]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Cursor",-1)),xe(r("select",{"onUpdate:modelValue":t[26]||(t[26]=a=>st.value=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[168]||(t[168]=[en('<option value="pointer" data-v-4b22c81b>pointer</option><option value="default" data-v-4b22c81b>default</option><option value="move" data-v-4b22c81b>move</option><option value="crosshair" data-v-4b22c81b>crosshair</option><option value="grab" data-v-4b22c81b>grab</option>',5)])],512),[[Rl,st.value]])]),r("div",null,[t[170]||(t[170]=r("label",{class:"block text-xs text-gray-400 mb-1"},"函数名",-1)),xe(r("input",{"onUpdate:modelValue":t[27]||(t[27]=a=>Y.value=a),type:"text",placeholder:"handleClick",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[Me,Y.value]])])])):K("",!0),Ge.value?(z(),B("div",na,[t[171]||(t[171]=r("label",{class:"block text-xs text-gray-400 mb-1"},"事件代码",-1)),xe(r("textarea",{"onUpdate:modelValue":t[28]||(t[28]=a=>Te.value=a),rows:"6",placeholder:"function body...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[Me,Te.value]])])):K("",!0)]),r("div",la,[t[182]||(t[182]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"元素属性",-1)),r("div",oa,[r("div",sa,[t[173]||(t[173]=r("label",{class:"text-xs text-gray-400"},"启用 Class 样式",-1)),xe(r("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=a=>e.selectedEl.enableClassStyle=a),onChange:t[30]||(t[30]=a=>{e.selectedEl&&a.target.checked?(e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss()):e.selectedEl&&!a.target.checked&&e.removeCustomClassCssForElement(e.selectedEl.id)}),class:"rounded border-purple-500/30 text-purple-400 focus:ring-purple-400"},null,544),[[tn,e.selectedEl.enableClassStyle]])]),(Pt=e.selectedEl)!=null&&Pt.enableClassStyle?(z(),B("div",aa,[t[174]||(t[174]=r("label",{class:"block text-xs text-gray-400 mb-1"},"CSS Class",-1)),r("div",ia,[xe(r("input",{"onUpdate:modelValue":t[31]||(t[31]=a=>e.selectedEl.className=a),type:"text",placeholder:"自动生成唯一类名，可修改",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.className]]),r("button",{type:"button",onClick:t[32]||(t[32]=()=>{e.selectedEl&&(e.selectedEl.className=`cls-${String(e.selectedEl.id).slice(0,8)}`,e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss())}),class:"px-2 py-1 text-xs bg-purple-600/60 hover:bg-purple-600 rounded text-white"},"生成默认")])])):K("",!0),(Wt=e.selectedEl)!=null&&Wt.enableClassStyle?(z(),B("div",da,[t[175]||(t[175]=r("label",{class:"block text-xs text-gray-400 mb-1"},"自定义样式（CSS 声明）",-1)),vt($s,{modelValue:String((Ft=e.selectedEl.customClassCss)!=null?Ft:""),"onUpdate:modelValue":t[33]||(t[33]=a=>{e.selectedEl.customClassCss=a,e.refreshAllCustomClassCss()}),height:"180px"},null,8,["modelValue"]),t[176]||(t[176]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"提示：已为当前类名生成 .className { } 模板；也可直接填写声明，系统会自动包裹并追加 !important。",-1))])):K("",!0),e.selectedEl&&(e.selectedEl.type==="chart"||e.selectedEl.type==="container")?(z(),B("div",ua,[t[177]||(t[177]=r("label",{class:"block text-xs text-gray-400 mb-1"},"元素ID",-1)),xe(r("input",{"onUpdate:modelValue":t[34]||(t[34]=a=>e.selectedEl.elementId=a),type:"text",placeholder:"输入元素ID",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.elementId]])])):K("",!0),e.selectedEl?(z(),B("div",ca,[t[181]||(t[181]=r("h3",{class:"text-sm font-medium text-purple-300"},"显示与隐藏",-1)),r("div",pa,[t[179]||(t[179]=r("label",{class:"text-xs text-gray-400"},"隐藏该元素",-1)),r("label",ga,[r("input",{type:"checkbox",class:"sr-only peer",checked:!!e.selectedEl.hidden,onChange:t[35]||(t[35]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.hidden=O,O&&!e.selectedEl.hiddenLabel&&(e.selectedEl.hiddenLabel=`hidden-${String(e.selectedEl.id).slice(0,8)}`))})},null,40,fa),t[178]||(t[178]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-purple-600 peer-checked:to-pink-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Be(["ml-3 text-xs",e.selectedEl.hidden?"text-purple-300":"text-gray-300"])},bt(e.selectedEl.hidden?"已隐藏":"显示中"),3)])]),e.selectedEl.hidden?(z(),B("div",ya,[t[180]||(t[180]=r("label",{class:"block text-xs text-gray-400"},"隐藏标识",-1)),r("input",{type:"text",value:e.selectedEl.hiddenLabel||"",onInput:t[36]||(t[36]=a=>{e.selectedEl&&(e.selectedEl.hiddenLabel=a.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1",placeholder:"hidden-xxxx"},null,40,ma)])):K("",!0)])):K("",!0)])]),e.selectedEl&&e.selectedEl.type==="container"?(z(),B("div",ba,[t[204]||(t[204]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器样式",-1)),r("div",null,[t[183]||(t[183]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色（HEX）",-1)),r("div",xa,[r("input",{type:"color",value:((or=(lr=e.selectedEl)==null?void 0:lr.style)==null?void 0:or.backgroundColor)||"#000000",onInput:t[37]||(t[37]=a=>{const O=a.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=O)}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,ha),r("input",{type:"text",value:((pe=(Ze=e.selectedEl)==null?void 0:Ze.style)==null?void 0:pe.backgroundColor)||"",placeholder:"#1e293b 或 transparent",onInput:t[38]||(t[38]=a=>{const O=a.target.value.trim();e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=O)}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,va)]),t[184]||(t[184]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"支持 #RGB/#RRGGBB 或 CSS 颜色名；启用渐变时该颜色被覆盖。",-1))]),r("div",null,[t[185]||(t[185]=r("label",{class:"block text-xs text-gray-400 mb-1"},"容器注释（导出可见）",-1)),xe(r("textarea",{"onUpdate:modelValue":t[39]||(t[39]=a=>e.selectedEl.comment=a),rows:"2",placeholder:"输入注释，方便代码维护...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.comment]])]),r("div",$a,[r("div",wa,[t[187]||(t[187]=r("label",{class:"block text-xs text-gray-400 mb-1"},"渐变背景",-1)),r("label",Ea,[r("input",{type:"checkbox",checked:!!((Re=(Ye=e.selectedEl)==null?void 0:Ye.style)!=null&&Re.backgroundGradient),onChange:t[40]||(t[40]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},O?e.selectedEl.style.backgroundGradient||(e.selectedEl.style.backgroundGradient={colors:["#42b883","#0ea5e9"],angle:90}):delete e.selectedEl.style.backgroundGradient)})},null,40,ka),t[186]||(t[186]=Or(" 启用 ",-1))])]),(Qe=(ut=e.selectedEl)==null?void 0:ut.style)!=null&&Qe.backgroundGradient?(z(),B("div",Sa,[r("div",null,[t[188]||(t[188]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"起始色（HEX）",-1)),r("div",Ma,[r("input",{type:"color",value:((Ie=(Ve=(rt=(Le=e.selectedEl)==null?void 0:Le.style)==null?void 0:rt.backgroundGradient)==null?void 0:Ve.colors)==null?void 0:Ie[0])||"#42b883",onInput:t[41]||(t[41]=a=>{var Ee;const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const I=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};I.colors=(Ee=I.colors)!=null&&Ee.length?I.colors:["","#"],I.colors[0]=O,e.selectedEl.style.backgroundGradient=I}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,Ca),r("input",{type:"text",value:((Et=(dt=(at=(Bt=e.selectedEl)==null?void 0:Bt.style)==null?void 0:at.backgroundGradient)==null?void 0:dt.colors)==null?void 0:Et[0])||"",placeholder:"#42b883",onInput:t[42]||(t[42]=a=>{var Ee;const O=a.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const I=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};I.colors=(Ee=I.colors)!=null&&Ee.length?I.colors:["","#"],I.colors[0]=O,e.selectedEl.style.backgroundGradient=I}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Na)])]),r("div",null,[t[189]||(t[189]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"结束色（HEX）",-1)),r("div",Ia,[r("input",{type:"color",value:((Yt=(At=(tt=(et=e.selectedEl)==null?void 0:et.style)==null?void 0:tt.backgroundGradient)==null?void 0:At.colors)==null?void 0:Yt[1])||"#0ea5e9",onInput:t[43]||(t[43]=a=>{var Ee;const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const I=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};I.colors=(Ee=I.colors)!=null&&Ee.length?I.colors:["","#"],I.colors[1]=O,e.selectedEl.style.backgroundGradient=I}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,Fa),r("input",{type:"text",value:((xr=(kt=(Ht=(Dt=e.selectedEl)==null?void 0:Dt.style)==null?void 0:Ht.backgroundGradient)==null?void 0:kt.colors)==null?void 0:xr[1])||"",placeholder:"#0ea5e9",onInput:t[44]||(t[44]=a=>{var Ee;const O=a.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const I=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};I.colors=(Ee=I.colors)!=null&&Ee.length?I.colors:["","#"],I.colors[1]=O,e.selectedEl.style.backgroundGradient=I}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Aa)])]),r("div",ja,[t[190]||(t[190]=r("label",{class:"block text-[11px] text-gray-400"},"角度（0-360）",-1)),r("input",{type:"range",min:"0",max:"360",step:"1",value:(Gr=(Br=(hr=(sr=e.selectedEl)==null?void 0:sr.style)==null?void 0:hr.backgroundGradient)==null?void 0:Br.angle)!=null?Gr:90,onInput:t[45]||(t[45]=a=>{const O=Number(a.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const I=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};I.angle=O,e.selectedEl.style.backgroundGradient=I}),class:"w-full"},null,40,za),r("input",{type:"number",value:(Dr=(er=(ct=(Tr=e.selectedEl)==null?void 0:Tr.style)==null?void 0:ct.backgroundGradient)==null?void 0:er.angle)!=null?Dr:90,onInput:t[46]||(t[46]=a=>{const O=Number(a.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const I=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};I.angle=O,e.selectedEl.style.backgroundGradient=I}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Oa)])])):K("",!0),t[191]||(t[191]=r("p",{class:"text-[11px] text-gray-500"},"提示：仅在启用后显示渐变设置；未启用时使用背景色。",-1))]),r("div",Ba,[r("div",Ga,[t[193]||(t[193]=r("label",{class:"block text-xs text-gray-400"},"圆角",-1)),r("label",Ta,[r("input",{type:"checkbox",checked:!!((vr=(Ur=e.selectedEl)==null?void 0:Ur.style)!=null&&vr.borderRadius)&&de((wr=($r=e.selectedEl)==null?void 0:$r.style)==null?void 0:wr.borderRadius)>0,onChange:t[47]||(t[47]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},O?e.selectedEl.style.borderRadius||(e.selectedEl.style.borderRadius="8px"):e.selectedEl.style.borderRadius="0")})},null,40,Da),t[192]||(t[192]=Or(" 启用 ",-1))])]),(ar=(Lr=e.selectedEl)==null?void 0:Lr.style)!=null&&ar.borderRadius&&de((cr=(ur=e.selectedEl)==null?void 0:ur.style)==null?void 0:cr.borderRadius)>=0?(z(),B("div",Ua,[r("div",La,[t[194]||(t[194]=r("span",{class:"text-[11px] text-gray-400"},"单位",-1)),r("button",{type:"button",class:Be(["px-2 py-0.5 rounded text-[11px]",S((Er=(pr=e.selectedEl)==null?void 0:pr.style)==null?void 0:Er.borderRadius)==="px"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[48]||(t[48]=()=>{var O,I;const a=de((I=(O=e.selectedEl)==null?void 0:O.style)==null?void 0:I.borderRadius);we(a,"px")})},"px",2),r("button",{type:"button",class:Be(["px-2 py-0.5 rounded text-[11px]",S((Rr=(kr=e.selectedEl)==null?void 0:kr.style)==null?void 0:Rr.borderRadius)==="%"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[49]||(t[49]=()=>{var O,I;const a=de((I=(O=e.selectedEl)==null?void 0:O.style)==null?void 0:I.borderRadius);we(a,"%")})},"%",2)]),S((It=(Sr=e.selectedEl)==null?void 0:Sr.style)==null?void 0:It.borderRadius)==="px"?(z(),B("div",Ra,[r("input",{type:"range",min:"0",max:"64",step:"1",value:de((Vr=(St=e.selectedEl)==null?void 0:St.style)==null?void 0:Vr.borderRadius),onInput:t[50]||(t[50]=a=>{const O=Number(a.target.value)||0;we(O,"px")}),class:"w-full"},null,40,Va),r("input",{type:"number",value:de((Wr=(Pr=e.selectedEl)==null?void 0:Pr.style)==null?void 0:Wr.borderRadius),onInput:t[51]||(t[51]=a=>{const O=Number(a.target.value)||0;we(O,"px")}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Pa)])):(z(),B("div",Wa,[r("input",{type:"range",min:"0",max:"100",step:"1",value:de((Jr=(Hr=e.selectedEl)==null?void 0:Hr.style)==null?void 0:Jr.borderRadius),onInput:t[52]||(t[52]=a=>{const O=Number(a.target.value)||0;we(O,"%")}),class:"w-full"},null,40,Ha),r("div",Ja,[r("input",{type:"number",value:de((Mr=(_r=e.selectedEl)==null?void 0:_r.style)==null?void 0:Mr.borderRadius),onInput:t[53]||(t[53]=a=>{const O=Number(a.target.value)||0;we(O,"%")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,_a),t[195]||(t[195]=r("span",{class:"text-xs text-gray-400"},"%",-1))])]))])):K("",!0)]),r("div",qa,[r("div",Ya,[t[197]||(t[197]=r("label",{class:"block text-xs text-gray-400"},"阴影（box-shadow）",-1)),r("label",Xa,[r("input",{type:"checkbox",checked:!!((fr=(gr=e.selectedEl)==null?void 0:gr.style)!=null&&fr.boxShadow),onChange:t[54]||(t[54]=a=>{const O=a.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},O?e.selectedEl.style.boxShadow||(e.selectedEl.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)"):delete e.selectedEl.style.boxShadow)})},null,40,Ka),t[196]||(t[196]=Or(" 启用 ",-1))])]),(yr=(Cr=e.selectedEl)==null?void 0:Cr.style)!=null&&yr.boxShadow?(z(),B("div",Za,[r("input",{type:"text",value:((qr=(mr=e.selectedEl)==null?void 0:mr.style)==null?void 0:qr.boxShadow)||"",placeholder:"例如: 0 8px 24px rgba(0,0,0,0.25)",onInput:t[55]||(t[55]=a=>{const O=a.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.boxShadow=O)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Qa),r("div",ei,[t[198]||(t[198]=r("label",{class:"block text-[11px] text-gray-400"},"X 偏移",-1)),r("div",ti,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:le((Nr=(ir=e.selectedEl)==null?void 0:ir.style)==null?void 0:Nr.boxShadow).x,onInput:t[56]||(t[56]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me(O!=null?O:0,(He=I.y)!=null?He:0,(Je=I.blur)!=null?Je:0,(_e=I.spread)!=null?_e:0,(qe=I.color)!=null?qe:"#000000")}),class:"flex-1"},null,40,ri),r("input",{type:"number",value:le((Ir=(Yr=e.selectedEl)==null?void 0:Yr.style)==null?void 0:Ir.boxShadow).x,onInput:t[57]||(t[57]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me(O!=null?O:0,(He=I.y)!=null?He:0,(Je=I.blur)!=null?Je:0,(_e=I.spread)!=null?_e:0,(qe=I.color)!=null?qe:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ni)])]),r("div",li,[t[199]||(t[199]=r("label",{class:"block text-[11px] text-gray-400"},"Y 偏移",-1)),r("div",oi,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:le((Xr=(Fr=e.selectedEl)==null?void 0:Fr.style)==null?void 0:Xr.boxShadow).y,onInput:t[58]||(t[58]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,O!=null?O:0,(Je=I.blur)!=null?Je:0,(_e=I.spread)!=null?_e:0,(qe=I.color)!=null?qe:"#000000")}),class:"flex-1"},null,40,si),r("input",{type:"number",value:le((l=(Ar=e.selectedEl)==null?void 0:Ar.style)==null?void 0:l.boxShadow).y,onInput:t[59]||(t[59]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,O!=null?O:0,(Je=I.blur)!=null?Je:0,(_e=I.spread)!=null?_e:0,(qe=I.color)!=null?qe:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ai)])]),r("div",ii,[t[200]||(t[200]=r("label",{class:"block text-[11px] text-gray-400"},"模糊",-1)),r("div",di,[r("input",{type:"range",min:"0",max:"128",step:"1",value:le((i=(o=e.selectedEl)==null?void 0:o.style)==null?void 0:i.boxShadow).blur,onInput:t[60]||(t[60]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,(Je=I.y)!=null?Je:0,O!=null?O:0,(_e=I.spread)!=null?_e:0,(qe=I.color)!=null?qe:"#000000")}),class:"flex-1"},null,40,ui),r("input",{type:"number",value:le((m=(c=e.selectedEl)==null?void 0:c.style)==null?void 0:m.boxShadow).blur,onInput:t[61]||(t[61]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,(Je=I.y)!=null?Je:0,O!=null?O:0,(_e=I.spread)!=null?_e:0,(qe=I.color)!=null?qe:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ci)])]),r("div",pi,[t[201]||(t[201]=r("label",{class:"block text-[11px] text-gray-400"},"扩散",-1)),r("div",gi,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:le((C=(f=e.selectedEl)==null?void 0:f.style)==null?void 0:C.boxShadow).spread,onInput:t[62]||(t[62]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,(Je=I.y)!=null?Je:0,(_e=I.blur)!=null?_e:0,O!=null?O:0,(qe=I.color)!=null?qe:"#000000")}),class:"flex-1"},null,40,fi),r("input",{type:"number",value:le((M=(F=e.selectedEl)==null?void 0:F.style)==null?void 0:M.boxShadow).spread,onInput:t[63]||(t[63]=a=>{var Ee,We,He,Je,_e,qe;const O=Number(a.target.value)||0,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,(Je=I.y)!=null?Je:0,(_e=I.blur)!=null?_e:0,O!=null?O:0,(qe=I.color)!=null?qe:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,yi)])])])):K("",!0),r("div",mi,[t[202]||(t[202]=r("label",{class:"block text-[11px] text-gray-400"},"阴影颜色",-1)),(d=(N=e.selectedEl)==null?void 0:N.style)!=null&&d.boxShadow?(z(),B("div",bi,[r("input",{type:"color",value:le((G=(u=e.selectedEl)==null?void 0:u.style)==null?void 0:G.boxShadow).color||"#000000",onInput:t[64]||(t[64]=a=>{var Ee,We,He,Je,_e,qe;const O=a.target.value,I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,(Je=I.y)!=null?Je:0,(_e=I.blur)!=null?_e:0,(qe=I.spread)!=null?qe:0,O||"#000000")}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,xi),r("input",{type:"text",value:le((ue=(H=e.selectedEl)==null?void 0:H.style)==null?void 0:ue.boxShadow).color||"",placeholder:"#000000 或 rgba(...)",onInput:t[65]||(t[65]=a=>{var Ee,We,He,Je,_e,qe;const O=a.target.value.trim(),I=le((We=(Ee=e.selectedEl)==null?void 0:Ee.style)==null?void 0:We.boxShadow);me((He=I.x)!=null?He:0,(Je=I.y)!=null?Je:0,(_e=I.blur)!=null?_e:0,(qe=I.spread)!=null?qe:0,O||"#000000")}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,hi)])):K("",!0)]),t[203]||(t[203]=r("p",{class:"text-[11px] text-gray-500"},"支持滑动或数字输入；颜色可选色块与 HEX 文本。",-1))])])):K("",!0),e.selectedEl&&e.selectedEl.type==="chart"?(z(),B("div",vi,[t[219]||(t[219]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"图表配置",-1)),r("div",$i,[r("button",{onClick:t[66]||(t[66]=a=>$.value="visual"),class:Be(["px-3 py-1 rounded text-sm",$.value==="visual"?"bg-purple-600/60":"bg-gray-700"])},"可视化",2),r("button",{onClick:t[67]||(t[67]=a=>$.value="json"),class:Be(["px-3 py-1 rounded text-sm",$.value==="json"?"bg-purple-600/60":"bg-gray-700"])},"JSON",2)]),$.value==="visual"?(z(),B("div",wi,[r("div",null,[t[205]||(t[205]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图表类型",-1)),vt(Gt,{options:["line","bar","pie","mix"],modelValue:e.selectedEl.chartType||"line","onUpdate:modelValue":t[68]||(t[68]=a=>{e.selectedEl&&(e.selectedEl.chartType=a,e.selectedEl.chartOption=e.defaultChartOption(a),k.value=JSON.stringify(e.selectedEl.chartOption,null,2))})},null,8,["modelValue"])]),r("div",null,[t[206]||(t[206]=r("label",{class:"block text-xs text-gray-400 mb-1"},"标题",-1)),r("input",{value:((ve=(ie=(ye=e.selectedEl)==null?void 0:ye.chartOption)==null?void 0:ie.title)==null?void 0:ve.text)||"",onInput:t[69]||(t[69]=a=>V(a.target.value)),type:"text",placeholder:"输入图表标题",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ei)]),r("div",ki,[r("div",null,[t[207]||(t[207]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色列表（逗号分隔）",-1)),r("input",{value:((re=(ee=(he=e.selectedEl)==null?void 0:he.chartOption)==null?void 0:ee.color)==null?void 0:re.join(","))||"",onInput:t[70]||(t[70]=a=>U(a.target.value)),type:"text",placeholder:"#42b883,#ff9800",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Si)]),r("div",null,[t[209]||(t[209]=r("label",{class:"block text-xs text-gray-400 mb-1"},"显示图例",-1)),r("select",{value:(b=(ze=(ne=(J=e.selectedEl)==null?void 0:J.chartOption)==null?void 0:ne.legend)==null?void 0:ze.show)==null||b?"1":"0",onChange:t[71]||(t[71]=a=>q(a.target.value)),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[208]||(t[208]=[r("option",{value:"1"},"显示",-1),r("option",{value:"0"},"隐藏",-1)])],40,Mi)])]),e.selectedEl&&e.selectedEl.chartType!=="pie"?(z(),B("div",Ci,[r("div",null,[t[210]||(t[210]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最小值",-1)),r("input",{value:Array.isArray((R=(h=e.selectedEl)==null?void 0:h.chartOption)==null?void 0:R.yAxis)?(W=(x=(_=(D=(j=e.selectedEl)==null?void 0:j.chartOption)==null?void 0:D.yAxis)==null?void 0:_[0])==null?void 0:x.min)!=null?W:"":($e=(Ae=(ge=(E=e.selectedEl)==null?void 0:E.chartOption)==null?void 0:ge.yAxis)==null?void 0:Ae.min)!=null?$e:"",onInput:t[72]||(t[72]=a=>{const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const I=e.selectedEl.chartOption.yAxis,Ee=O===""?null:Number(O);Array.isArray(I)?(I[0]=I[0]||{},I[0].min=Ee):(e.selectedEl.chartOption.yAxis=I||{},e.selectedEl.chartOption.yAxis.min=Ee),k.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ni)]),r("div",null,[t[211]||(t[211]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最大值",-1)),r("input",{value:Array.isArray((Oe=(Ce=e.selectedEl)==null?void 0:Ce.chartOption)==null?void 0:Oe.yAxis)?(pt=(Mt=(mt=(xt=(Pe=e.selectedEl)==null?void 0:Pe.chartOption)==null?void 0:xt.yAxis)==null?void 0:mt[0])==null?void 0:Mt.max)!=null?pt:"":(br=(Jt=(ht=(jt=e.selectedEl)==null?void 0:jt.chartOption)==null?void 0:ht.yAxis)==null?void 0:Jt.max)!=null?br:"",onInput:t[73]||(t[73]=a=>{const O=a.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const I=e.selectedEl.chartOption.yAxis,Ee=O===""?null:Number(O);Array.isArray(I)?(I[0]=I[0]||{},I[0].max=Ee):(e.selectedEl.chartOption.yAxis=I||{},e.selectedEl.chartOption.yAxis.max=Ee),k.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ii)])])):K("",!0),e.selectedEl&&(e.selectedEl.chartType==="line"||e.selectedEl.chartType==="mix")?(z(),B("div",Fi,[r("div",null,[t[213]||(t[213]=r("label",{class:"block text-xs text-gray-400 mb-1"},"折线平滑",-1)),r("select",{value:"1",onChange:t[74]||(t[74]=a=>{const O=a.target.value==="1";e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(I=>{I.type==="line"&&(I.smooth=O)}),k.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[212]||(t[212]=[r("option",{value:"1"},"平滑",-1),r("option",{value:"0"},"不平滑",-1)])],32)]),r("div",null,[t[214]||(t[214]=r("label",{class:"block text-xs text-gray-400 mb-1"},"线宽",-1)),r("input",{value:2,onInput:t[75]||(t[75]=a=>{const O=Number(a.target.value)||2;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(I=>{I.type==="line"&&(I.lineStyle=I.lineStyle||{},I.lineStyle.width=O)}),k.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):K("",!0),e.selectedEl&&(e.selectedEl.chartType==="bar"||e.selectedEl.chartType==="mix")?(z(),B("div",Ai,[r("div",null,[t[215]||(t[215]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变起始色",-1)),r("input",{type:"color",value:"#42b883",onInput:t[76]||(t[76]=a=>{const O=a.target.value;v(O,"#0ea5e9")}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[216]||(t[216]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变结束色",-1)),r("input",{type:"color",value:"#0ea5e9",onInput:t[77]||(t[77]=a=>{const O=a.target.value;v("#42b883",O)}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[217]||(t[217]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),r("input",{value:4,onInput:t[78]||(t[78]=a=>{const O=Number(a.target.value)||0;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(I=>{I.type==="bar"&&(I.itemStyle=I.itemStyle||{},I.itemStyle.borderRadius=[O,O,0,0])}),k.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):K("",!0)])):(z(),B("div",ji,[t[218]||(t[218]=r("label",{class:"block text-xs text-gray-400 mb-1"},"ECharts Option JSON",-1)),xe(r("textarea",{"onUpdate:modelValue":t[79]||(t[79]=a=>k.value=a),rows:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs font-mono"},null,512),[[Me,k.value]]),r("div",zi,[r("button",{onClick:t[80]||(t[80]=a=>g()),class:"px-3 py-1 bg-emerald-600 rounded text-sm"},"应用配置"),P.value?(z(),B("div",Oi,bt(P.value),1)):K("",!0)])]))])):K("",!0),e.selectedEl&&e.selectedEl.type==="line"?(z(),B("div",Bi,[t[227]||(t[227]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"线条设置",-1)),r("div",Gi,[t[220]||(t[220]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",Ti,[r("input",{value:e.safeHex(((un=(Kr=e.selectedEl)==null?void 0:Kr.style)==null?void 0:un.lineColor)||""),onInput:t[81]||(t[81]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Di),r("input",{value:(gn=(pn=(cn=e.selectedEl)==null?void 0:cn.style)==null?void 0:pn.lineColor)!=null?gn:"#ffffff",onInput:t[82]||(t[82]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,40,Ui)])]),r("div",Li,[r("div",null,[t[221]||(t[221]=r("label",{class:"block text-xs text-gray-400 mb-1"},"方向",-1)),r("div",Ri,[r("button",{onClick:t[83]||(t[83]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="horizontal")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((yn=(fn=e.selectedEl)==null?void 0:fn.style)==null?void 0:yn.lineOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[84]||(t[84]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="vertical")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((bn=(mn=e.selectedEl)==null?void 0:mn.style)==null?void 0:bn.lineOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)])]),r("div",null,[t[222]||(t[222]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细(px)",-1)),r("input",{value:(vn=(hn=(xn=e.selectedEl)==null?void 0:xn.style)==null?void 0:hn.lineThickness)!=null?vn:2,onInput:t[85]||(t[85]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineThickness=Number(a.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Vi)])]),r("div",Pi,[r("div",null,[t[224]||(t[224]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),r("select",{value:((wn=($n=e.selectedEl)==null?void 0:$n.style)==null?void 0:wn.lineStyle)||"solid",onChange:t[86]||(t[86]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineStyle=a.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[223]||(t[223]=[r("option",{value:"solid"},"实线",-1),r("option",{value:"dashed"},"虚线",-1)])],40,Wi)]),((kn=(En=e.selectedEl)==null?void 0:En.style)==null?void 0:kn.lineStyle)==="dashed"?(z(),B("div",Hi,[t[225]||(t[225]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线长度(px)",-1)),r("input",{value:(Cn=(Mn=(Sn=e.selectedEl)==null?void 0:Sn.style)==null?void 0:Mn.lineDashLength)!=null?Cn:6,onInput:t[87]||(t[87]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashLength=Number(a.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ji)])):K("",!0)]),((In=(Nn=e.selectedEl)==null?void 0:Nn.style)==null?void 0:In.lineStyle)==="dashed"?(z(),B("div",_i,[r("div",null,[t[226]||(t[226]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线间距(px)",-1)),r("input",{value:(jn=(An=(Fn=e.selectedEl)==null?void 0:Fn.style)==null?void 0:An.lineDashGap)!=null?jn:4,onInput:t[88]||(t[88]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashGap=Number(a.target.value))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,qi)])])):K("",!0)])):K("",!0),e.selectedEl&&e.selectedEl.type==="text"?(z(),B("div",Yi,[t[261]||(t[261]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"文本设置",-1)),r("div",Xi,[t[232]||(t[232]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),xe(r("textarea",{"onUpdate:modelValue":t[89]||(t[89]=a=>e.selectedEl.text=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[Me,e.selectedEl.text]]),r("div",Ki,[t[231]||(t[231]=r("label",{class:"block text-xs text-gray-400 mb-1"},"动态值",-1)),r("div",Zi,[r("input",{type:"checkbox",checked:!!((On=(zn=e.selectedEl)==null?void 0:zn.dynamic)!=null&&On.enabled),onChange:t[90]||(t[90]=a=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!1,objectName:"",propertyPath:""},e.selectedEl.dynamic.enabled=a.target.checked)}),class:"rounded accent-purple-600"},null,40,Qi),t[228]||(t[228]=r("span",{class:"text-xs text-gray-400"},"启用后从数据库对象绑定",-1))]),(Gn=(Bn=e.selectedEl)==null?void 0:Bn.dynamic)!=null&&Gn.enabled?(z(),B("div",ed,[r("div",null,[t[229]||(t[229]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择对象",-1)),vt(Gt,{options:e.databaseObjects.map(a=>a.name),modelValue:((Dn=(Tn=e.selectedEl)==null?void 0:Tn.dynamic)==null?void 0:Dn.objectName)||"","onUpdate:modelValue":t[91]||(t[91]=a=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.objectName=String(a||""))})},null,8,["options","modelValue"])]),r("div",null,[t[230]||(t[230]=r("label",{class:"block text-xs text-gray-400 mb-1"},"属性路径",-1)),vt(Gt,{options:oe.value,modelValue:((Ln=(Un=e.selectedEl)==null?void 0:Un.dynamic)==null?void 0:Ln.propertyPath)||"","onUpdate:modelValue":t[92]||(t[92]=a=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.propertyPath=String(a||""))})},null,8,["options","modelValue"])]),r("div",td,"预览值: "+bt(ke(e.selectedEl)),1)])):K("",!0)])]),r("div",rd,[t[233]||(t[233]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",nd,[r("button",{onClick:t[93]||(t[93]=()=>{const a=e.selectedEl;!a||a.type!=="text"||(a.autoSize=!0)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize!==!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"自适应",2),r("button",{onClick:t[94]||(t[94]=()=>{const a=e.selectedEl;!a||a.type!=="text"||(a.autoSize=!1)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize===!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"固定尺寸",2)])]),r("div",ld,[r("div",null,[t[234]||(t[234]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),vt(Gt,{options:e.fontSizeLibrary,modelValue:((Rn=e.selectedEl.style)==null?void 0:Rn.fontSize)||14,"onUpdate:modelValue":t[95]||(t[95]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=a)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[t[235]||(t[235]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),vt(Gt,{options:e.fontLibrary,modelValue:((Vn=e.selectedEl.style)==null?void 0:Vn.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[96]||(t[96]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=a)})},null,8,["options","modelValue"])])]),r("div",od,[r("div",null,[t[236]||(t[236]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),vt(Gt,{options:e.fontWeightOptions,modelValue:((Pn=e.selectedEl.style)==null?void 0:Pn.fontWeight)||"400","onUpdate:modelValue":t[97]||(t[97]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=a)})},null,8,["options","modelValue"])]),r("div",null,[t[237]||(t[237]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),vt(Gt,{options:e.fontStyleOptions,modelValue:((Wn=e.selectedEl.style)==null?void 0:Wn.fontStyle)||"normal","onUpdate:modelValue":t[98]||(t[98]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=a)})},null,8,["options","modelValue"])])]),r("div",sd,[r("div",null,[t[238]||(t[238]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:((Hn=e.selectedEl.style)==null?void 0:Hn.letterSpacing)||0,onInput:t[99]||(t[99]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(a.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,ad)]),r("div",null,[t[239]||(t[239]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:((Jn=e.selectedEl.style)==null?void 0:Jn.lineHeight)||1.5,onInput:t[100]||(t[100]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(a.target.value))}),type:"number",step:"0.1",min:"0.5",max:"3",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,id)])]),r("div",dd,[t[240]||(t[240]=r("label",{class:"block text-xs text-gray-400 mb-1"},"缩进",-1)),r("input",{value:((_n=e.selectedEl.style)==null?void 0:_n.textIndent)||"",onInput:t[101]||(t[101]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textIndent=a.target.value)}),type:"text",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"例如: 2em 或 24px"},null,40,ud)]),r("div",cd,[t[241]||(t[241]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",pd,[r("input",{value:(Yn=(qn=e.selectedEl)==null?void 0:qn.style)!=null&&Yn.textGradient?"#000000":((Kn=(Xn=e.selectedEl)==null?void 0:Xn.style)==null?void 0:Kn.color)||e.config.globalColor,onInput:t[102]||(t[102]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"color",disabled:!!((Qn=(Zn=e.selectedEl)==null?void 0:Zn.style)!=null&&Qn.textGradient),class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"},null,40,gd),r("input",{value:(tl=(el=e.selectedEl)==null?void 0:el.style)!=null&&tl.textGradient?"transparent":(ll=(nl=(rl=e.selectedEl)==null?void 0:rl.style)==null?void 0:nl.color)!=null?ll:e.config.globalColor,onInput:t[103]||(t[103]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=a.target.value)}),type:"text",disabled:!!((sl=(ol=e.selectedEl)==null?void 0:ol.style)!=null&&sl.textGradient),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"#000000"},null,40,fd)]),(il=(al=e.selectedEl)==null?void 0:al.style)!=null&&il.textGradient?(z(),B("div",yd,"文字渐变启用时，文字颜色自动设为透明")):K("",!0)]),r("div",md,[t[242]||(t[242]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色",-1)),r("div",bd,[r("input",{value:e.safeHex(((ul=(dl=e.selectedEl)==null?void 0:dl.style)==null?void 0:ul.backgroundColor)||""),onInput:t[104]||(t[104]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=a.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,xd),r("input",{value:(gl=(pl=(cl=e.selectedEl)==null?void 0:cl.style)==null?void 0:pl.backgroundColor)!=null?gl:"transparent",onInput:t[105]||(t[105]=a=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=a.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"transparent"},null,40,hd)])]),r("div",vd,[t[243]||(t[243]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本对齐",-1)),r("div",$d,[r("button",{onClick:t[106]||(t[106]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((fl=e.selectedEl.style)==null?void 0:fl.textAlign)||"left")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左对齐",2),r("button",{onClick:t[107]||(t[107]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((yl=e.selectedEl.style)==null?void 0:yl.textAlign)||"left")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"居中",2),r("button",{onClick:t[108]||(t[108]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((ml=e.selectedEl.style)==null?void 0:ml.textAlign)||"left")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右对齐",2)])]),r("div",wd,[t[244]||(t[244]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本方向",-1)),r("div",Ed,[r("button",{onClick:t[109]||(t[109]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="horizontal")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((xl=(bl=e.selectedEl)==null?void 0:bl.style)==null?void 0:xl.textOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[110]||(t[110]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="vertical")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((vl=(hl=e.selectedEl)==null?void 0:hl.style)==null?void 0:vl.textOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)]),t[245]||(t[245]=r("p",{class:"text-[11px] text-gray-400"},"纵向使用 CSS writing-mode 展示，适合竖排文本。",-1))]),r("div",kd,[t[247]||(t[247]=r("label",{class:"block text-xs text-gray-400 mb-1"},"布局倾斜",-1)),r("div",Sd,[xe(r("input",{"onUpdate:modelValue":t[111]||(t[111]=a=>e.selectedEl.style.skewAngle=a),type:"range",min:"-45",max:"45",class:"flex-1"},null,512),[[Me,e.selectedEl.style.skewAngle,void 0,{number:!0}]]),xe(r("input",{"onUpdate:modelValue":t[112]||(t[112]=a=>e.selectedEl.style.skewAngle=a),type:"number",min:"-45",max:"45",class:"w-16 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.style.skewAngle,void 0,{number:!0}]])]),r("div",Md,[t[246]||(t[246]=r("label",{class:"text-xs text-gray-400"},"布局倾斜跟随",-1)),r("button",{onClick:t[113]||(t[113]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!0)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(wl=($l=e.selectedEl)==null?void 0:$l.style)!=null&&wl.skewFlowEnabled?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"开",2),r("button",{onClick:t[114]||(t[114]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!1)}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(kl=(El=e.selectedEl)==null?void 0:El.style)!=null&&kl.skewFlowEnabled?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-purple-600 text-white"])},"关",2)]),t[248]||(t[248]=r("p",{class:"text-[11px] text-gray-400"},"调整整体容器的 X 轴倾斜角度（-45° ~ 45°）。启用“跟随”后，文本布局按父视图倾斜线性排布，字符保持正立，可与波形叠加。",-1))]),r("div",Cd,[r("div",Nd,[t[249]||(t[249]=r("label",{class:"text-xs text-gray-400"},"文本波形",-1)),r("div",Id,[(Cl=(Ml=(Sl=e.selectedEl)==null?void 0:Sl.style)==null?void 0:Ml.textWave)!=null&&Cl.enabled?(z(),B("button",{key:1,onClick:t[116]||(t[116]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!1})}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):(z(),B("button",{key:0,onClick:t[115]||(t[115]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!0,amplitude:8,frequency:.5,phase:0})}),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用"))])]),(Fl=(Il=(Nl=e.selectedEl)==null?void 0:Nl.style)==null?void 0:Il.textWave)!=null&&Fl.enabled?(z(),B("div",Fd,[r("div",Ad,[t[250]||(t[250]=r("label",{class:"block text-xs text-gray-400 mb-1"},"幅度(px)",-1)),xe(r("input",{"onUpdate:modelValue":t[117]||(t[117]=a=>e.selectedEl.style.textWave.amplitude=a),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.style.textWave.amplitude,void 0,{number:!0}]])]),r("div",jd,[t[251]||(t[251]=r("label",{class:"block text-xs text-gray-400 mb-1"},"频率(rad/字)",-1)),xe(r("input",{"onUpdate:modelValue":t[118]||(t[118]=a=>e.selectedEl.style.textWave.frequency=a),type:"number",step:"0.1",min:"0.1",max:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.style.textWave.frequency,void 0,{number:!0}]])]),r("div",zd,[t[252]||(t[252]=r("label",{class:"block text-xs text-gray-400 mb-1"},"相位(rad)",-1)),xe(r("input",{"onUpdate:modelValue":t[119]||(t[119]=a=>e.selectedEl.style.textWave.phase=a),type:"number",step:"0.1",min:"-100",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.style.textWave.phase,void 0,{number:!0}]])])])):K("",!0),t[253]||(t[253]=r("p",{class:"text-[11px] text-gray-400"},"每个字符沿 Y 轴按正弦位移，字符保持正立。",-1))]),r("div",Od,[t[254]||(t[254]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本装饰",-1)),r("div",Bd,[r("button",{onClick:t[120]||(t[120]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="underline"?"none":"underline")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Al=e.selectedEl.style)==null?void 0:Al.textDecoration)||"none")==="underline"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下划线",2),r("button",{onClick:t[121]||(t[121]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="line-through"?"none":"line-through")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((jl=e.selectedEl.style)==null?void 0:jl.textDecoration)||"none")==="line-through"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"删除线",2),r("button",{onClick:t[122]||(t[122]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration="none")}),class:Be(["px-2 py-1 text-xs rounded transition-colors duration-200",(((zl=e.selectedEl.style)==null?void 0:zl.textDecoration)||"none")==="none"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"无",2)])]),r("div",Gd,[r("div",Td,[t[255]||(t[255]=r("label",{class:"text-xs text-gray-400"},"文本渐变",-1)),r("div",Dd,[(Ol=e.selectedEl.style)!=null&&Ol.textGradient?K("",!0):(z(),B("button",{key:0,onClick:t[123]||(t[123]=a=>ae(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(Bl=e.selectedEl.style)!=null&&Bl.textGradient?(z(),B("button",{key:1,onClick:t[124]||(t[124]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.textGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):K("",!0)])]),(Gl=e.selectedEl.style)!=null&&Gl.textGradient?(z(),B("div",Ud,[r("div",Ld,[r("div",null,[t[256]||(t[256]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Rd,[xe(r("input",{"onUpdate:modelValue":t[125]||(t[125]=a=>e.selectedEl.style.textGradient.colors[0]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Me,e.selectedEl.style.textGradient.colors[0]]]),xe(r("input",{"onUpdate:modelValue":t[126]||(t[126]=a=>e.selectedEl.style.textGradient.colors[0]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#DFDD5A"},null,512),[[Me,e.selectedEl.style.textGradient.colors[0]]])])]),r("div",null,[t[257]||(t[257]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Vd,[xe(r("input",{"onUpdate:modelValue":t[127]||(t[127]=a=>e.selectedEl.style.textGradient.colors[1]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Me,e.selectedEl.style.textGradient.colors[1]]]),xe(r("input",{"onUpdate:modelValue":t[128]||(t[128]=a=>e.selectedEl.style.textGradient.colors[1]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,512),[[Me,e.selectedEl.style.textGradient.colors[1]]])])])]),r("div",null,[r("label",Pd,"角度: "+bt(e.selectedEl.style.textGradient.angle||0)+"°",1),xe(r("input",{"onUpdate:modelValue":t[129]||(t[129]=a=>e.selectedEl.style.textGradient.angle=a),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[Me,e.selectedEl.style.textGradient.angle,void 0,{number:!0}]])])])):K("",!0)]),r("div",Wd,[r("div",Hd,[t[258]||(t[258]=r("label",{class:"text-xs text-gray-400"},"背景渐变",-1)),r("div",Jd,[(Tl=e.selectedEl.style)!=null&&Tl.backgroundGradient?K("",!0):(z(),B("button",{key:0,onClick:t[130]||(t[130]=a=>A(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(Dl=e.selectedEl.style)!=null&&Dl.backgroundGradient?(z(),B("button",{key:1,onClick:t[131]||(t[131]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.backgroundGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):K("",!0)])]),(Ul=e.selectedEl.style)!=null&&Ul.backgroundGradient?(z(),B("div",_d,[r("div",qd,[r("div",null,[t[259]||(t[259]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Yd,[xe(r("input",{"onUpdate:modelValue":t[132]||(t[132]=a=>e.selectedEl.style.backgroundGradient.colors[0]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Me,e.selectedEl.style.backgroundGradient.colors[0]]]),xe(r("input",{"onUpdate:modelValue":t[133]||(t[133]=a=>e.selectedEl.style.backgroundGradient.colors[0]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#00A3FF"},null,512),[[Me,e.selectedEl.style.backgroundGradient.colors[0]]])])]),r("div",null,[t[260]||(t[260]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Xd,[xe(r("input",{"onUpdate:modelValue":t[134]||(t[134]=a=>e.selectedEl.style.backgroundGradient.colors[1]=a),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[Me,e.selectedEl.style.backgroundGradient.colors[1]]]),xe(r("input",{"onUpdate:modelValue":t[135]||(t[135]=a=>e.selectedEl.style.backgroundGradient.colors[1]=a),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,512),[[Me,e.selectedEl.style.backgroundGradient.colors[1]]])])])]),r("div",null,[r("label",Kd,"角度: "+bt(e.selectedEl.style.backgroundGradient.angle||0)+"°",1),xe(r("input",{"onUpdate:modelValue":t[136]||(t[136]=a=>e.selectedEl.style.backgroundGradient.angle=a),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[Me,e.selectedEl.style.backgroundGradient.angle,void 0,{number:!0}]])])])):K("",!0)])])):K("",!0),e.selectedEl&&e.selectedEl.type==="image"?(z(),B("div",Zd,[t[270]||(t[270]=en('<h3 class="text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1" data-v-4b22c81b>图片设置</h3><div class="space-y-2" data-v-4b22c81b><label class="block text-xs text-gray-400 mb-1" data-v-4b22c81b>图片来源</label><div class="grid grid-cols-2 gap-2" data-v-4b22c81b><button class="px-3 py-2 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200" data-v-4b22c81b>上传文件</button><button class="px-3 py-2 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200" data-v-4b22c81b>选择图标</button></div></div>',2)),r("div",Qd,[t[262]||(t[262]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图片文件",-1)),r("input",{type:"file",onChange:je,accept:"image/*",class:"w-full text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-purple-600 file:text-white hover:file:bg-purple-500 file:cursor-pointer"},null,32)]),e.iconLibrary.length>0?(z(),B("div",eu,[t[263]||(t[263]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择图标",-1)),r("div",tu,[r("div",ru,[(z(!0),B(tr,null,dr(e.iconLibrary,a=>(z(),B("div",{key:a.id,onClick:O=>Z(a),class:"aspect-square bg-gray-700/50 rounded cursor-pointer hover:bg-gray-600/50 transition-colors duration-200 flex items-center justify-center p-1 border border-transparent hover:border-green-400/50"},[r("img",{src:a.url,alt:a.name,class:"max-w-full max-h-full object-contain",loading:"lazy"},null,8,lu)],8,nu))),128))])]),e.iconLibrary.length===0?(z(),B("div",ou,"暂无图标，请先在图标库管理中上传图标")):K("",!0)])):K("",!0),r("div",{class:"space-y-2"},[t[264]||(t[264]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",{class:"grid grid-cols-2 gap-2"},[r("button",{onClick:T,class:Be(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-blue-600/30 hover:bg-blue-600/50 text-blue-300"])},"自适应（原始尺寸）"),r("button",{onClick:Q,class:Be(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-purple-600/30 hover:bg-purple-600/50 text-purple-300"])},"固定大小")])]),r("div",su,[r("div",null,[t[265]||(t[265]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度(px)",-1)),xe(r("input",{"onUpdate:modelValue":t[137]||(t[137]=a=>e.selectedEl.width=a),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[266]||(t[266]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度(px)",-1)),xe(r("input",{"onUpdate:modelValue":t[138]||(t[138]=a=>e.selectedEl.height=a),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.height,void 0,{number:!0}]])]),r("div",null,[t[268]||(t[268]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对象适配",-1)),xe(r("select",{"onUpdate:modelValue":t[139]||(t[139]=a=>e.selectedEl.style.objectFit=a),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[267]||(t[267]=[en('<option value="contain" data-v-4b22c81b>contain（完整显示）</option><option value="cover" data-v-4b22c81b>cover（填充裁剪）</option><option value="fill" data-v-4b22c81b>fill（拉伸填充）</option><option value="scale-down" data-v-4b22c81b>scale-down（缩小适配）</option><option value="none" data-v-4b22c81b>none（不适配）</option>',5)])],512),[[Rl,e.selectedEl.style.objectFit]])])]),r("div",au,[t[269]||(t[269]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),xe(r("input",{"onUpdate:modelValue":t[140]||(t[140]=a=>e.selectedEl.style.borderRadius=a),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[Me,e.selectedEl.style.borderRadius,void 0,{number:!0}]])])])):K("",!0),r("div",iu,[r("button",{onClick:t[141]||(t[141]=a=>p("saveSelectedAsComponent")),class:"w-full px-3 py-2 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"},"保存为组件"),r("button",{onClick:t[142]||(t[142]=a=>p("duplicateSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-blue-500/25"},"复制元素"),r("button",{onClick:t[143]||(t[143]=a=>p("removeSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"删除元素")])])):K("",!0),e.selectedEl?K("",!0):(z(),B("div",du,[...t[271]||(t[271]=[r("div",{class:"w-16 h-16 mx-auto mb-4 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center"},[r("span",{class:"text-2xl"},"📝")],-1),r("p",{class:"text-sm"},"选择一个元素来编辑其属性",-1)])]))])}}}),pu=dn(cu,[["__scopeId","data-v-4b22c81b"]]),gu={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},fu={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},yu={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},mu={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},bu={class:"flex gap-2"},xu={class:"relative"},hu={class:"grid grid-cols-2 gap-2"},vu={class:"flex items-center gap-2"},$u={class:"text-sm text-gray-400 min-w-[60px] text-center"},wu={key:0,class:"absolute inset-0 pointer-events-none z-50"},Eu={key:1,class:"absolute inset-0 z-[9999] select-none pointer-events-none"},ku={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Su={class:"relative w-[800px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-fuchsia-500/40 rounded-xl shadow-2xl"},Mu={class:"p-4 space-y-3"},Cu={class:"flex items-center gap-2"},Nu={key:0,class:"text-center text-sm text-gray-400 py-6"},Iu={key:1},Fu={key:0,class:"text-center text-sm text-gray-400 py-6"},Au={key:1,class:"grid grid-cols-3 gap-3"},ju={class:"aspect-video bg-gray-700/50 flex items-center justify-center"},zu=["src"],Ou={key:1,class:"text-gray-400 text-xs"},Bu={class:"p-3 space-y-1"},Gu={class:"flex items-center justify-between"},Tu=["title"],Du={class:"text-xs text-gray-500"},Uu={class:"flex flex-wrap gap-1 mt-1"},Lu={class:"pt-2"},Ru=["onClick"],Vu={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},Pu={class:"relative w-[600px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl"},Wu={class:"flex items-center justify-between p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20"},Hu={class:"p-4 space-y-3 max-h-[50vh] overflow-y-auto"},Ju={key:0,class:"text-center text-sm text-gray-400 py-6"},_u={key:1,class:"space-y-2"},qu=["title"],Yu=["onClick"],Xu=50,on=1,Ku=Kt({__name:"LowCodeBuilder",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(y){const n=y,e=io(),p=po(),$=Xe(()=>{var l;return(l=n.projectId)!=null?l:e.params.id?String(e.params.id):void 0}),k=be(null);async function P(){if($.value)try{const l=(await ke()).transaction(["projects"],"readonly").objectStore("projects").get($.value);l.onsuccess=()=>{k.value=l.result}}catch(l){console.error("加载项目信息失败:",l)}}function oe(){if(!$.value)return;const l=n.isComponent?{path:`/project/${$.value}/preview`,query:{type:"component"}}:{path:`/project/${$.value}/preview`},o=p.resolve(l).href;window.open(o,"_blank")}async function ke(){return new Promise((l,o)=>{const i="lowcode-projects",c="projects",m=indexedDB.open(i);m.onerror=()=>o(m.error),m.onupgradeneeded=()=>{const f=m.result;f.objectStoreNames.contains(c)||f.createObjectStore(c,{keyPath:"id"})},m.onsuccess=()=>{const f=m.result;if(f.objectStoreNames.contains(c))l(f);else{const C=f.version+1;f.close();const F=indexedDB.open(i,C);F.onerror=()=>o(F.error),F.onupgradeneeded=()=>{const M=F.result;M.objectStoreNames.contains(c)||M.createObjectStore(c,{keyPath:"id"})},F.onsuccess=()=>l(F.result)}}})}const S=Ll({width:1024,height:576,backgroundUrl:"",backgroundColor:"#000000",globalFontFamily:"Arial, Helvetica, sans-serif",globalFontSize:14,globalColor:"#FFFFFF"}),de=be("GeneratedComponent"),we=be(["Arial, Helvetica, sans-serif","PingFang SC","Microsoft YaHei","Roboto","Inter"]),le=be([8,9,10,11,12,14,16,18,20,24,28,32,36,48,64]),me=be(["100","200","300","400","500","600","700","800","900"]),ae=be(["normal","italic","oblique"]),A=be([]),g=be(null),v=be([]),L=be({}),V=be(null),U=be([]),q=be(!1),je=be(!1),Z=be({id:null,steps:[],cursor:0,stage:0,active:!1}),T=be(!1);function Q(){try{const l=JSON.parse(JSON.stringify(A.value));U.value.push(l),U.value.length>Xu&&U.value.shift()}catch(l){console.warn("pushHistory 序列化失败：",l)}}function Ge(){U.value.length!==0&&(A.value=U.value.pop(),g.value=null,De.value=!1)}function st(l){var f,C,F,M,N,d,u,G,H,ue,ye,ie,ve,he,ee;function o(re){var ne;if(!re)return!1;const J=(ne=re.tagName)==null?void 0:ne.toLowerCase();return re.isContentEditable||!!re.closest('[contenteditable="true"]')||J==="input"||J==="textarea"||J==="select"}const i=document.activeElement;if(o(i)||o(l.target))return;const c=l.metaKey||l.ctrlKey,m=l.key.toLowerCase();if(m==="arrowleft"||m==="arrowright"||m==="arrowup"||m==="arrowdown"){if(!g.value)return;const{el:re}=it(g.value);if(!re)return;je.value||(Q(),je.value=!0,Z.value={id:g.value,steps:[],cursor:0,stage:0,active:!0},T.value=!0),Y.shift=l.shiftKey,m==="arrowleft"&&(Y.left=!0),m==="arrowright"&&(Y.right=!0),m==="arrowup"&&(Y.up=!0),m==="arrowdown"&&(Y.down=!0);const J=l.shiftKey?10:1;ce(m==="arrowleft"?-J:m==="arrowright"?J:0,m==="arrowup"?-J:m==="arrowdown"?J:0),t!=null&&(clearTimeout(t),t=null),t=window.setTimeout(()=>{Se()},220),l.preventDefault();return}if(c&&m==="c"){if(Ft.value){try{V.value=JSON.parse(JSON.stringify(Ft.value))}catch{}l.preventDefault()}}else if(c&&m==="v"){if(V.value){const re=V.value,J=wr(re),{parentGroup:ne}=it(re.id);if(ne){const ze=Number((C=(f=ne.left)!=null?f:ne.x)!=null?C:0),b=Number((M=(F=ne.top)!=null?F:ne.y)!=null?M:0),h=Number((N=ne.width)!=null?N:0),R=Number((d=ne.height)!=null?d:0),j=ze+h,D=b+R,_=Number((u=re.width)!=null?u:0),x=Number((G=re.height)!=null?G:0);let W=_,E=x;if(!W||!E)if(re.type==="text"){const xt=Number((H=re.fontSize)!=null?H:16),mt=String((ye=(ue=re.text)!=null?ue:re.content)!=null?ye:"").trim();W=Math.max(_||50,Math.round((mt.length||2)*xt*.6)),E=Math.max(x||20,Math.round(xt*1.5))}else re.type==="image"?(W=_||200,E=x||150):re.type==="chart"?(W=_||240,E=x||160):re.type==="line"?(W=_||200,E=x||2):(W=_||100,E=x||60);const ge=10,Ae=ze+h/2,$e=b+R/2;let Ce=!1,Oe=j+ge,Pe=Math.round($e-E/2);if(!Ce&&Oe+W<=S.width&&(J.left=Math.max(0,Math.min(Oe,Math.max(0,S.width-W))),J.top=Math.max(0,Math.min(Pe,Math.max(0,S.height-E))),Ce=!0),Oe=ze-W-ge,Pe=Math.round($e-E/2),!Ce&&Oe>=0&&(J.left=Math.max(0,Math.min(Oe,Math.max(0,S.width-W))),J.top=Math.max(0,Math.min(Pe,Math.max(0,S.height-E))),Ce=!0),Oe=Math.round(Ae-W/2),Pe=D+ge,!Ce&&Pe+E<=S.height&&(J.left=Math.max(0,Math.min(Oe,Math.max(0,S.width-W))),J.top=Math.max(0,Math.min(Pe,Math.max(0,S.height-E))),Ce=!0),Oe=Math.round(Ae-W/2),Pe=b-E-ge,!Ce&&Pe>=0&&(J.left=Math.max(0,Math.min(Oe,Math.max(0,S.width-W))),J.top=Math.max(0,Math.min(Pe,Math.max(0,S.height-E))),Ce=!0),!Ce){const xt=Number((ve=(ie=re.left)!=null?ie:re.x)!=null?ve:0),mt=Number((ee=(he=re.top)!=null?he:re.y)!=null?ee:0),Mt=ze+xt+ge,pt=b+mt+ge;J.left=Math.max(0,Math.min(Math.round(Mt),Math.max(0,S.width-W))),J.top=Math.max(0,Math.min(Math.round(pt),Math.max(0,S.height-E)))}J.x=J.left,J.y=J.top}Q(),A.value.push(J),g.value=J.id,l.preventDefault()}}else if(m==="delete"||m==="backspace"){if(g.value){Q();const{el:re,parentGroup:J}=it(g.value);re&&J&&Array.isArray(J.children)?J.children=J.children.filter(ne=>ne.id!==re.id):(A.value=A.value.filter(ne=>ne.id!==g.value),re&&re.type==="group"&&ut(re.id)),g.value=null,l.preventDefault()}}else c&&m==="z"&&((()=>{var ze,b;const J=Z.value,ne=[20,15,10];if(T.value&&J.id&&J.cursor>0){const{el:h}=it(J.id);if(h){const R=Math.min(Math.max(J.stage,0),ne.length-1),j=ne[R],D=Math.min(j,J.cursor);let _=0,x=0;for(let W=J.cursor-D;W<J.cursor;W++){const E=J.steps[W];_+=E.dx,x+=E.dy}h.left=Math.round(((ze=h.left)!=null?ze:0)-_),h.top=Math.round(((b=h.top)!=null?b:0)-x),h.x=h.left,h.y=h.top,J.cursor-=D,J.stage=Math.min(J.stage+1,ne.length-1),g.value=h.id,fe();return}}Ge(),T.value=!1,Z.value.active=!1})(),l.preventDefault())}const Y=Ll({left:!1,right:!1,up:!1,down:!1,shift:!1});let Te=null,w=0,t=null;function ce(l,o){var ve,he,ee,re,J,ne,ze,b;const i=g.value;if(!i)return;const{el:c,parentGroup:m}=it(i);if(!c)return;je.value&&Z.value.active&&Z.value.id===i&&(Z.value.steps.push({dx:l,dy:o}),Z.value.cursor=Z.value.steps.length,T.value=!0);const f=(ee=(he=c.width)!=null?he:(ve=L.value[i])==null?void 0:ve.width)!=null?ee:0,C=(ne=(J=c.height)!=null?J:(re=L.value[i])==null?void 0:re.height)!=null?ne:0;let F=S.width,M=S.height;m&&m.width&&m.height&&(F=Number(m.width)||F,M=Number(m.height)||M);let N=((ze=c.left)!=null?ze:0)+l,d=((b=c.top)!=null?b:0)+o;N=Math.round(N),d=Math.round(d),N=Math.max(0,Math.min(N,F-(f||0))),d=Math.max(0,Math.min(d,M-(C||0))),c.left=N,c.top=d,c.x=c.left,c.y=c.top;const u=c.left,G=c.top,H=u+(f||0),ue=G+(C||0),ye=u+(f||0)/2,ie=G+(C||0)/2;Zt({left:u,top:G,right:H,bottom:ue,centerX:ye,centerY:ie})}function Se(){if(Te!=null)return;w=Date.now();const l=()=>{if(!Y.left&&!Y.right&&!Y.up&&!Y.down){Te!=null&&cancelAnimationFrame(Te),Te=null,Vt();return}const o=Date.now()-w,i=o>1500?8:o>800?4:o>300?2:1,c=(Y.shift?10:1)*i,m=(Y.left?-c:0)+(Y.right?c:0),f=(Y.up?-c:0)+(Y.down?c:0);ce(m,f),Te=requestAnimationFrame(l)};Te=requestAnimationFrame(l)}function Ke(l){const o=l.key.toLowerCase();o==="shift"&&(Y.shift=!1),o==="arrowleft"&&(Y.left=!1),o==="arrowright"&&(Y.right=!1),o==="arrowup"&&(Y.up=!1),o==="arrowdown"&&(Y.down=!1),t!=null&&(clearTimeout(t),t=null),!Y.left&&!Y.right&&!Y.up&&!Y.down&&Te==null&&(je.value=!1,Z.value.active=!1),!Y.left&&!Y.right&&!Y.up&&!Y.down&&Vt()}const De=be(!1),Ne=be({left:0,top:0,right:0,bottom:0,centerX:0,centerY:0});function ft(l){L.value[l.id]=l}function yt(l){return l==="pie"?{backgroundColor:"transparent",tooltip:{trigger:"item"},legend:{top:"5%",left:"center",textStyle:{color:"#fff"},show:!0},series:[{name:"分类占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#111",borderWidth:2},label:{show:!0,color:"#fff"},labelLine:{show:!0},data:[{value:1048,name:"A"},{value:735,name:"B"},{value:580,name:"C"},{value:484,name:"D"},{value:300,name:"E"}]}]}:l==="mix"?{backgroundColor:"transparent",color:["#00bcd4","#ff9800"],tooltip:{trigger:"axis"},legend:{textStyle:{color:"#fff"},show:!0},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"销量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}},{name:"均价",type:"line",smooth:!0,data:[30,40,45,50,49,60,70],lineStyle:{width:2}}]}:l==="bar"?{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"数量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}}]}:{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"趋势",type:"line",smooth:!0,data:[150,230,224,218,135,147,260],lineStyle:{width:2}}]}}function ot(l){var re,J;const o=`${l}-${Date.now()}`,i=er.value,c=ct.value||1,m=(re=i==null?void 0:i.clientWidth)!=null?re:0,f=(J=i==null?void 0:i.clientHeight)!=null?J:0,C=i?(i.scrollLeft+m/2)/c:20,F=i?(i.scrollTop+f/2)/c:20,M=l==="chart"?240:l==="image"||l==="line"?200:l==="container"?240:void 0,N=l==="chart"?160:l==="image"?150:l==="line"?2:l==="container"?160:void 0,d=Math.round(C-(M?M/2:10)),u=Math.round(F-(N?N/2:10)),G=Math.max(0,Math.min(d,Math.max(0,S.width-(M!=null?M:0)))),H=Math.max(0,Math.min(u,Math.max(0,S.height-(N!=null?N:0)))),ue=(ne,ze,b,h)=>{const R=Math.max(0,Math.min(ne,Math.max(0,S.width-(b!=null?b:0)))),j=Math.max(0,Math.min(ze,Math.max(0,S.height-(h!=null?h:0))));return{cl:R,ct:j}},ye=A.value.map(ne=>{var j,D,_,x,W,E;const ze=(j=ne.width)!=null?j:0,b=(D=ne.height)!=null?D:0,h=Number((x=(_=ne.left)!=null?_:ne.x)!=null?x:0),R=Number((E=(W=ne.top)!=null?W:ne.y)!=null?E:0);return{l:h,t:R,r:h+ze,b:R+b}}),ie=(ne,ze,b,h)=>{const R=ne+(b!=null?b:0),j=ze+(h!=null?h:0);for(const D of ye)if(!(b===void 0||h===void 0)&&!(R<=D.l||j<=D.t||ne>=D.r||ze>=D.b))return!0;return!1},ve=24;let he={cl:G,ct:H};if(M&&N&&ie(he.cl,he.ct,M,N)){let ne=!1;for(let ze=1;ze<=20&&!ne;ze++)for(const b of[[ze,0],[0,ze],[-ze,0],[0,-ze]]){const[h,R]=b,j=d+h*ve,D=u+R*ve,_=ue(j,D,M,N);if(!ie(_.cl,_.ct,M,N)){he=_,ne=!0;break}}}const ee={id:o,type:l,left:he.cl,top:he.ct,autoSize:l==="text",width:M,height:N,text:l==="text"?"文字":l==="image"||l==="line"?"":"图表",className:"",zIndex:1,style:{}};if(l==="text"?Object.assign(ee,{content:"文字",fontSize:16,fontWeight:"400",fontFamily:"Arial, Helvetica, sans-serif",color:"#ffffff",letterSpacing:"0px",lineHeight:"1.5",fontStyle:"normal",useGradient:!1,gradientStart:"#00A3FF",gradientEnd:"#ffffff",gradientDirection:"to right",x:he.cl,y:he.ct}):l==="image"&&(Object.assign(ee,{src:"",borderRadius:0,x:he.cl,y:he.ct}),ee.style={...ee.style||{},objectFit:"contain"}),l==="chart"&&Object.assign(ee,{elementId:`chart-${Date.now()}`,chartType:"line",chartOption:yt("line")}),l==="line"&&(ee.autoSize=!1,ee.style={...ee.style||{},lineColor:"#ffffff",lineThickness:2,lineOrientation:"horizontal",lineStyle:"solid",lineDashLength:6,lineDashGap:4}),l==="arc-text"){ee.autoSize=!1,ee.text="环绕文字";const ne=60;ee.width=ee.width||ne*2+20,ee.height=ee.height||ne*2+20,ee.style={...ee.style||{},fontFamily:S.globalFontFamily,fontSize:Math.max(12,S.globalFontSize),color:S.globalColor,textAlign:"center",arcText:{radius:ne,startAngle:0,sweepAngle:180,clockwise:!0}}}l==="container"&&(ee.autoSize=!1,ee.text="",ee.elementId=`container-${Date.now()}`,ee.style={...ee.style||{},backgroundColor:"transparent",borderRadius:"6px"}),Q(),A.value.push(ee),g.value=o}function Ut(l){const{el:o}=it(l.id);o&&(q.value||(Q(),q.value=!0),o.left=l.left,o.top=l.top,o.x=l.left,o.y=l.top)}function _t(l){const{el:o}=it(l.id);o&&(q.value||(Q(),q.value=!0),o.width=l.width,o.height=l.height,l.left!==void 0&&(o.left=l.left,o.x=l.left),l.top!==void 0&&(o.top=l.top,o.y=l.top))}function qt(l){g.value=l,fe()}function s(l){g.value=l,fe(),nn(()=>{const o=document.querySelector(`[data-el-id="${l}"]`);o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})}function se(l,o){if(l===o||l<0||o<0||l>=A.value.length||o>=A.value.length)return;Q();const[i]=A.value.splice(l,1);i&&(A.value.splice(o,0,i),g.value=i.id)}function fe(){if(Ot(),!$t.value)return;const l=g.value;if(!l)return;const o=Nt.value.find(f=>f.id===l);if(!o)return;const i=Nt.value.filter(f=>f.id!==l),c={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY};Ne.value={left:c.left,top:c.top,right:c.right,bottom:c.bottom,centerX:c.centerX,centerY:c.centerY},X.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1};const m=4;for(const f of i)Math.abs(c.centerX-f.centerX)<=m&&f.w>0&&(X.value.centerV=!0,Ne.value.centerX=f.centerX),Math.abs(c.centerY-f.centerY)<=m&&f.h>0&&(X.value.centerH=!0,Ne.value.centerY=f.centerY),Math.abs(c.left-f.left)<=m&&(X.value.left=!0,Ne.value.left=f.left),Math.abs(c.right-f.right)<=m&&f.w>0&&(X.value.right=!0,Ne.value.right=f.right),Math.abs(c.top-f.top)<=m&&(X.value.top=!0,Ne.value.top=f.top),Math.abs(c.bottom-f.bottom)<=m&&f.h>0&&(X.value.bottom=!0,Ne.value.bottom=f.bottom);De.value=Object.values(X.value).some(Boolean)}function Fe(){g.value=null,Vt()}const X=be({centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1}),te=be({left:null,right:null,up:null,down:null}),Ue=be(!0),$t=be(!0),wt=be(!1),Lt=Xe(()=>A.value.filter(l=>l.hidden));function Rt(l){const o=A.value.find(i=>i.id===l);o&&(o.hidden=!1,g.value=l,nn(()=>{const i=document.querySelector(`[data-el-id="${l}"]`);i&&i.scrollIntoView({behavior:"smooth",block:"center"}),wt.value=!1}))}const nt=be(null),lt=be(null),Nt=Xe(()=>{const l=[];function o(i,c,m,f){var C,F,M,N;for(const d of i){const u=L.value[d.id],G=u?u.left:(C=d.left)!=null?C:0,H=u?u.top:(F=d.top)!=null?F:0,ue=u?u.width:(M=d.width)!=null?M:0,ye=u?u.height:(N=d.height)!=null?N:0,ie=c+G,ve=m+H;l.push({id:d.id,left:ie,top:ve,right:ie+ue,bottom:ve+ye,centerX:ie+ue/2,centerY:ve+ye/2,w:ue,h:ye,type:d.type,parentId:f}),(d.type==="group"||d.type==="container")&&Array.isArray(d.children)&&o(d.children,ie,ve,d.id)}}return o(A.value,0,0,null),l});function Zt(l){q.value||(Q(),q.value=!0),Ne.value={left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.centerX,centerY:l.centerY},X.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},te.value={left:null,right:null,up:null,down:null};const o=.5,i=g.value,c=Nt.value.find(u=>u.id===i),m=c?c.parentId:null,f=Nt.value.filter(u=>u.parentId===m);function C(u,G,H,ue){const ye=Math.max(u,H);return Math.min(G,ue)-ye}let F=null,M=null,N=null,d=null;for(const u of f)if(!(!i||u.id===i)){if(Math.abs(l.centerX-u.centerX)<=o&&u.w>0&&(X.value.centerV=!0,Ne.value.centerX=u.centerX),Math.abs(l.centerY-u.centerY)<=o&&u.h>0&&(X.value.centerH=!0,Ne.value.centerY=u.centerY),Math.abs(l.left-u.left)<=o&&(X.value.left=!0,Ne.value.left=u.left),Math.abs(l.right-u.right)<=o&&u.w>0&&(X.value.right=!0,Ne.value.right=u.right),Math.abs(l.top-u.top)<=o&&(X.value.top=!0,Ne.value.top=u.top),Math.abs(l.bottom-u.bottom)<=o&&u.h>0&&(X.value.bottom=!0,Ne.value.bottom=u.bottom),C(l.top,l.bottom,u.top,u.bottom)>0){const G=l.left-u.right;G>=0&&(!F||G<F.gap)&&(F={gap:G,m:u});const H=u.left-l.right;H>=0&&(!M||H<M.gap)&&(M={gap:H,m:u})}if(C(l.left,l.right,u.left,u.right)>0){const G=l.top-u.bottom;G>=0&&(!N||G<N.gap)&&(N={gap:G,m:u});const H=u.top-l.bottom;H>=0&&(!d||H<d.gap)&&(d={gap:H,m:u})}}if(De.value=Object.values(X.value).some(Boolean),!Ue.value){te.value={left:null,right:null,up:null,down:null};return}if(F){const u=F.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(Math.max(l.top,u.top)+Math.min(l.bottom,u.bottom))/2;te.value.left={gap:Math.floor(F.gap),exact:F.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(M){const u=M.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(Math.max(l.top,u.top)+Math.min(l.bottom,u.bottom))/2;te.value.right={gap:Math.floor(M.gap),exact:M.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(N){const u=N.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(u.bottom+l.top)/2;te.value.up={gap:Math.floor(N.gap),exact:N.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(d){const u=d.m,G=(Math.max(l.left,u.left)+Math.min(l.right,u.right))/2,H=(l.bottom+u.top)/2;te.value.down={gap:Math.floor(d.gap),exact:d.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}$t.value||(X.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},De.value=!1)}function Ot(){if(!Ue.value){te.value={left:null,right:null,up:null,down:null};return}const l=g.value;if(!l){te.value={left:null,right:null,up:null,down:null};return}const o=Nt.value.find(u=>u.id===l);if(!o){te.value={left:null,right:null,up:null,down:null};return}const i={left:o.left,top:o.top,right:o.right,bottom:o.bottom,centerX:o.centerX,centerY:o.centerY},c=o.parentId,m=Nt.value.filter(u=>u.id!==l&&u.parentId===c);function f(u,G,H,ue){const ye=Math.max(u,H);return Math.min(G,ue)-ye}let C=null,F=null,M=null,N=null;for(const u of m){if(f(i.top,i.bottom,u.top,u.bottom)>0){const G=i.left-u.right;G>=0&&(!C||G<C.gap)&&(C={gap:G,m:u});const H=u.left-i.right;H>=0&&(!F||H<F.gap)&&(F={gap:H,m:u})}if(f(i.left,i.right,u.left,u.right)>0){const G=i.top-u.bottom;G>=0&&(!M||G<M.gap)&&(M={gap:G,m:u});const H=u.top-i.bottom;H>=0&&(!N||H<N.gap)&&(N={gap:H,m:u})}}const d={left:null,right:null,up:null,down:null};if(C){const u=C.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(Math.max(i.top,u.top)+Math.min(i.bottom,u.bottom))/2;d.left={gap:Math.floor(C.gap),exact:C.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(F){const u=F.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(Math.max(i.top,u.top)+Math.min(i.bottom,u.bottom))/2;d.right={gap:Math.floor(F.gap),exact:F.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(M){const u=M.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(u.bottom+i.top)/2;d.up={gap:Math.floor(M.gap),exact:M.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}if(N){const u=N.m,G=(Math.max(i.left,u.left)+Math.min(i.right,u.right))/2,H=(i.bottom+u.top)/2;d.down={gap:Math.floor(N.gap),exact:N.gap,refId:u.id,x:Math.round(G),y:Math.round(H)}}te.value=d}function Vt(){q.value=!1,$t.value&&g.value?fe():De.value=!1,Ot()}function it(l){if(!l)return{el:null,parentGroup:null};const o=(i,c)=>{for(const m of i){if(m.id===l)return{el:m,parentGroup:c};if((m.type==="group"||m.type==="container")&&Array.isArray(m.children)){const f=o(m.children,m);if(f)return f}}return null};return o(A.value,null)||{el:null,parentGroup:null}}const Qt=be(null);function rr(l,o){if(!l.children||!Array.isArray(l.children))return!1;const i=[...l.children];for(;i.length;){const c=i.pop();if((c==null?void 0:c.id)===o.id)return!0;c!=null&&c.children&&Array.isArray(c.children)&&i.push(...c.children)}return!1}function nr(l){var G,H,ue,ye;const{id:o,globalLeft:i,globalTop:c}=l;if(!o)return;const m=(G=Qt.value)==null?void 0:G.getBoundingClientRect();if(!m)return;const{el:f,parentGroup:C}=it(o);if(!f)return;const F=(((H=L.value[o])==null?void 0:H.width)||Number(f.width)||0)*ct.value,M=(((ue=L.value[o])==null?void 0:ue.height)||Number(f.height)||0)*ct.value,N={left:i,top:c,right:i+F,bottom:c+M};function d(){const ie=N.left+1,ve=N.top+1,he=N.right-1,ee=N.bottom-1;return[{x:(N.left+N.right)/2,y:(N.top+N.bottom)/2},{x:ie,y:ve},{x:he,y:ve},{x:ie,y:ee},{x:he,y:ee}]}let u=null;for(const ie of d()){const ve=document.elementsFromPoint(ie.x,ie.y);for(const he of ve){const ee=(ye=he.closest("[data-box-id]"))==null?void 0:ye.getAttribute("data-box-id");if(!ee||ee===o)continue;const{el:re}=it(ee);if(re&&!(re.type!=="container"&&re.type!=="group")&&re.id!==f.id&&!rr(f,re)){u=ee;break}}if(u)break}if(C?Array.isArray(C.children)&&(C.children=C.children.filter(ie=>ie.id!==o)):A.value=A.value.filter(ie=>ie.id!==o),u){const{el:ie}=it(u);if(ie){const ve=document.querySelector(`[data-box-id="${u}"]`);if(ve){const he=ve.getBoundingClientRect(),ee=(i-he.left)/ct.value,re=(c-he.top)/ct.value;f.left=Math.round(ee),f.top=Math.round(re),f.x=f.left,f.y=f.top,ie.children||(ie.children=[]),ie.children.push(f)}}}else{const ie=(i-m.left)/ct.value,ve=(c-m.top)/ct.value;f.left=Math.round(ie),f.top=Math.round(ve),f.x=f.left,f.y=f.top,A.value.push(f)}Q(),nn(()=>{g.value=o})}function Pt(l){const o=te.value[l];o&&(nt.value=l,lt.value=o.gap)}function Wt(){var F,M,N,d,u;if(!nt.value||lt.value==null){nt.value=null,lt.value=null;return}const l=nt.value,o=te.value[l];if(!o){nt.value=null,lt.value=null;return}const i=Nt.value.find(G=>G.id===o.refId),c=lt.value,m=Ft.value;if(!i||!m){nt.value=null,lt.value=null;return}Q();const f=(F=o.exact)!=null?F:o.gap,C=c-f;l==="left"?m.left=Math.round(((M=m.left)!=null?M:0)+C):l==="right"?m.left=Math.round(((N=m.left)!=null?N:0)-C):l==="up"?m.top=Math.round(((d=m.top)!=null?d:0)+C):l==="down"&&(m.top=Math.round(((u=m.top)!=null?u:0)-C)),nt.value=null,lt.value=null,Ot()}Tt(g,()=>{q.value||Ot()}),Tt(L,()=>{q.value||Ot()},{deep:!0}),Tt(Ue,l=>{l?Ot():(nt.value=null,lt.value=null,te.value={left:null,right:null,up:null,down:null})}),Tt($t,l=>{l?fe():(X.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},De.value=!1)});const Ft=Xe(()=>g.value?it(g.value).el:null);async function lr(){return new Promise((l,o)=>{const i=indexedDB.open("lowcode-db",1);i.onupgradeneeded=()=>{const c=i.result;if(!c.objectStoreNames.contains("objects")){const m=c.createObjectStore("objects",{keyPath:"id"});try{m.createIndex("projectId","projectId",{unique:!1}),m.createIndex("name","name",{unique:!1})}catch{}}},i.onsuccess=()=>l(i.result),i.onerror=()=>o(i.error)})}async function or(){try{const l=(await lr()).transaction(["objects"],"readonly").objectStore("objects").getAll();l.onsuccess=()=>{v.value=(l.result||[]).filter(o=>!o.projectId||o.projectId===(n.projectId||void 0))},l.onerror=()=>{console.warn("loadDatabaseObjects error",l.error)}}catch(l){console.warn("openDatabaseDB error",l)}}const Ze=Xe(()=>{const l={};for(const o of v.value)o&&o.name&&(l[o.name]=o.content);return l}),pe=be({}),Ye=Xe(()=>{const l={...Ze.value};for(const o in pe.value)Object.assign(l,pe.value[o]);return l});function Re(l,o){const i={};for(const c of o)c&&c.name&&(i[c.name]=c.content);pe.value[l]=i}function ut(l){pe.value[l]&&delete pe.value[l];const o=`component-fonts-${l}`,i=document.getElementById(o);i&&i.parentNode&&i.parentNode.removeChild(i)}function Qe(l,o="#000000"){try{const i=String(l||"").trim();return/^#([0-9a-fA-F]{6})$/.test(i)?i:o}catch{return o}}function Le(){if(!g.value)return;Q();const{el:l,parentGroup:o}=it(g.value);l&&o&&Array.isArray(o.children)?o.children=o.children.filter(i=>i.id!==l.id):(A.value=A.value.filter(i=>i.id!==g.value),l&&l.type==="group"&&ut(l.id)),g.value=null}function rt(l){(!l.className||!l.className.trim())&&(l.className=`cls-${String(l.id).slice(0,8)}`)}function Ve(l){try{rt(l);const o=String(l.className||"").trim();String(l.customClassCss||"").trim()||(l.customClassCss=`.${o} {
  
}`)}catch{}}function Ie(l){const o=String(l||"").trim();return o?o.split(";").map(i=>{const c=i.trim();return c?/!important\s*$/.test(c)?c+";":c+" !important;":""}).filter(Boolean).join(`
`):""}function Bt(l){return String(l||"").replace(/\{([^}]*)\}/g,(o,i)=>`{
`+String(i||"").split(";").map(c=>{const m=c.trim();return m?m.startsWith("@")||!/:/.test(m)||/!important\s*$/.test(m)?m+";":m+" !important;":""}).filter(Boolean).join(`
`)+`
}`)}function at(l){try{if(!l.enableClassStyle)return;rt(l);const o=String(l.customClassCss||"").trim();if(!o)return;const i=`custom-class-${l.id}`;let c=document.getElementById(i);if(c||(c=document.createElement("style"),c.id=i,document.head.appendChild(c)),/{[^}]*}/.test(o)){c.textContent=Bt(o);return}const m=Ie(o);c.textContent=`.${String(l.className).trim()} {
${m}
}`}catch(o){console.warn("注入自定义类样式失败：",o)}}function dt(l){try{const o=`custom-class-${l}`,i=document.getElementById(o);i&&i.remove()}catch{}}function Et(l,o){for(const i of l)o(i),(i.type==="group"||i.type==="container")&&Array.isArray(i.children)&&Et(i.children,o)}let et=null;function tt(){et&&clearTimeout(et),et=setTimeout(()=>{try{Et(A.value,l=>{l.enableClassStyle&&l.customClassCss&&l.className?at(l):dt(l.id)})}catch(l){console.warn("刷新自定义类样式失败：",l)}},50)}async function At(){var l,o,i,c,m,f,C,F,M,N;try{const d=Ft.value;if(!d){alert("请先选中要保存的元素或分组");return}const u=de.value||(d.type==="group"?"分组组件":"元素组件"),G=prompt("请输入组件名称",u);if(G===null)return;const H=(G||u).trim()||"未命名组件";let ue=[];if(d.type==="group"&&Array.isArray(d.children)){const b=Number((o=(l=d.left)!=null?l:d.x)!=null?o:0),h=Number((c=(i=d.top)!=null?i:d.y)!=null?c:0);ue=d.children.map(R=>{var ge,Ae,$e,Ce,Oe,Pe;const j=JSON.parse(JSON.stringify(R)),D=Number((Ae=(ge=j.left)!=null?ge:j.x)!=null?Ae:0),_=Number((Ce=($e=j.top)!=null?$e:j.y)!=null?Ce:0);j.left=b+D,j.top=h+_,j.x=j.left,j.y=j.top;const x=L.value[R.id],W=Number(j.width||0),E=Number(j.height||0);if(!(W>0)){const xt=(()=>{var mt,Mt,pt,jt,ht;if(j.type==="text"){const Jt=Number((mt=j.fontSize)!=null?mt:16),br=String((Mt=j.text)!=null?Mt:"").trim();return Math.max(50,Math.round((br.length||2)*Jt*.6))}if(j.type==="image")return 100;if(j.type==="chart")return 240;if(j.type==="line"){const Jt=Number((jt=(pt=j.style)==null?void 0:pt.lineThickness)!=null?jt:2);return(((ht=j.style)==null?void 0:ht.lineOrientation)||"horizontal")==="vertical"?Jt:100}return 50})();j.width=Math.max(1,Math.round((Oe=x==null?void 0:x.width)!=null?Oe:xt))}if(!(E>0)){const xt=(()=>{var mt,Mt,pt,jt;if(j.type==="text"){const ht=Number((mt=j.fontSize)!=null?mt:16);return Math.max(20,Math.round(ht*1.5))}if(j.type==="image")return 100;if(j.type==="chart")return 160;if(j.type==="line"){const ht=Number((pt=(Mt=j.style)==null?void 0:Mt.lineThickness)!=null?pt:2);return(((jt=j.style)==null?void 0:jt.lineOrientation)||"horizontal")==="vertical"?100:ht}return 20})();j.height=Math.max(1,Math.round((Pe=x==null?void 0:x.height)!=null?Pe:xt))}return j.id=`${j.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,j})}else{const b=JSON.parse(JSON.stringify(d)),h=Number((f=(m=b.left)!=null?m:b.x)!=null?f:0),R=Number((F=(C=b.top)!=null?C:b.y)!=null?F:0);b.left=h,b.top=R,b.x=b.left,b.y=b.top;const j=L.value[d.id],D=Number(b.width||0),_=Number(b.height||0);if(!(D>0)){const x=(()=>{var W,E,ge,Ae,$e;if(b.type==="text"){const Ce=Number((W=b.fontSize)!=null?W:16),Oe=String((E=b.text)!=null?E:"").trim();return Math.max(50,Math.round((Oe.length||2)*Ce*.6))}if(b.type==="image")return 100;if(b.type==="chart")return 240;if(b.type==="line"){const Ce=Number((Ae=(ge=b.style)==null?void 0:ge.lineThickness)!=null?Ae:2);return((($e=b.style)==null?void 0:$e.lineOrientation)||"horizontal")==="vertical"?Ce:100}return 50})();b.width=Math.max(1,Math.round((M=j==null?void 0:j.width)!=null?M:x))}if(!(_>0)){const x=(()=>{var W,E,ge,Ae;if(b.type==="text"){const $e=Number((W=b.fontSize)!=null?W:16);return Math.max(20,Math.round($e*1.5))}if(b.type==="image")return 100;if(b.type==="chart")return 160;if(b.type==="line"){const $e=Number((ge=(E=b.style)==null?void 0:E.lineThickness)!=null?ge:2);return(((Ae=b.style)==null?void 0:Ae.lineOrientation)||"horizontal")==="vertical"?100:$e}return 20})();b.height=Math.max(1,Math.round((N=j==null?void 0:j.height)!=null?N:x))}b.id=`${b.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,ue=[b]}const ye=Math.min(...ue.map(b=>{var h,R;return Number((R=(h=b.left)!=null?h:b.x)!=null?R:0)})),ie=Math.min(...ue.map(b=>{var h,R;return Number((R=(h=b.top)!=null?h:b.y)!=null?R:0)})),ve=Math.max(...ue.map(b=>{var h,R,j;return Number((R=(h=b.left)!=null?h:b.x)!=null?R:0)+Number((j=b.width)!=null?j:0)})),he=Math.max(...ue.map(b=>{var h,R,j;return Number((R=(h=b.top)!=null?h:b.y)!=null?R:0)+Number((j=b.height)!=null?j:0)})),ee=Math.max(1,Math.round(ve-ye)),re=Math.max(1,Math.round(he-ie));ue=ue.map(b=>{var D,_,x,W;const h=JSON.parse(JSON.stringify(b)),R=Number((_=(D=h.left)!=null?D:h.x)!=null?_:0)-ye,j=Number((W=(x=h.top)!=null?x:h.y)!=null?W:0)-ie;return h.left=Math.max(0,Math.round(R)),h.top=Math.max(0,Math.round(j)),h.x=h.left,h.y=h.top,h});const J={width:ee,height:re,backgroundUrl:"",backgroundColor:"transparent",globalFontFamily:S.globalFontFamily,globalFontSize:S.globalFontSize,globalColor:S.globalColor},ne=`${Date.now()}${Math.random().toString(36).slice(2,9)}`,ze={id:ne,name:H,description:"",tags:[],elements:ue,config:J,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await gt.init(),await gt.saveComponent(JSON.parse(JSON.stringify(ze))),await fr(`component-${ne}`,{config:J,elements:ue,exportName:H}),alert("组件已保存到组件库")}catch(d){console.warn("保存组件失败：",d),alert("保存组件失败，请稍后重试")}}const Yt=be(null);function Dt(l){var c;const o=(c=l.target.files)==null?void 0:c[0];if(!o)return;const i=new FileReader;i.onload=()=>{const m=String(i.result);S.backgroundUrl=m;const f=new Image;f.onload=()=>{Yt.value={width:f.naturalWidth,height:f.naturalHeight},S.width=f.naturalWidth,S.height=f.naturalHeight},f.src=m},i.readAsDataURL(o)}function Ht(l){var o;return l&&((o=l.split(",")[0])!=null?o:"").trim().replace(/^['"]|['"]$/g,"")||null}function kt(l){return{"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","image/avif":"avif","image/apng":"apng","image/x-icon":"ico","image/vnd.microsoft.icon":"ico","font/ttf":"ttf","font/otf":"otf","font/woff":"woff","font/woff2":"woff2","application/font-ttf":"ttf","application/font-otf":"otf","application/font-woff":"woff","application/font-woff2":"woff2","application/x-font-ttf":"ttf","application/x-font-otf":"otf","application/x-font-woff":"woff","application/x-font-woff2":"woff2","application/vnd.ms-fontobject":"eot","application/octet-stream":"bin"}[l]||"bin"}function xr(l){var c;const o=/\.([A-Za-z0-9]+)$/.exec(l||"");if(!o)return null;const i=((c=o[1])!=null?c:"").toLowerCase();return i?["png","jpg","jpeg","gif","svg","webp","avif","apng","ico"].includes(i)?i==="jpeg"?"jpg":i:["ttf","otf","woff","woff2","eot"].includes(i)?i:null:null}async function sr(l){try{const o="lowcode-icons",i="icons",c=await new Promise((m,f)=>{const C=indexedDB.open(o);C.onsuccess=()=>{const F=C.result;if(F.objectStoreNames.contains(i))m(F);else{const M=F.version+1;F.close();const N=indexedDB.open(o,M);N.onupgradeneeded=()=>{const d=N.result;d.objectStoreNames.contains(i)||d.createObjectStore(i,{keyPath:"id"})},N.onsuccess=()=>m(N.result),N.onerror=()=>f(N.error)}},C.onerror=()=>f(C.error)});return await new Promise((m,f)=>{const C=c.transaction(i,"readonly").objectStore(i).get(l);C.onsuccess=()=>m(C.result||null),C.onerror=()=>f(C.error)})}catch{return null}}function hr(l){var o,i,c,m,f,C,F,M;try{const N=new Uint8Array(l),d=String.fromCharCode((o=N[0])!=null?o:0,(i=N[1])!=null?i:0,(c=N[2])!=null?c:0,(m=N[3])!=null?m:0);return d==="wOFF"?"woff":d==="wOF2"?"woff2":d==="OTTO"?"otf":(((f=N[0])!=null?f:0)===0&&((C=N[1])!=null?C:0)===1&&((F=N[2])!=null?F:0)===0&&((M=N[3])!=null?M:0)===0||d==="true"||d==="typ1","ttf")}catch{return"ttf"}}async function Br(l){const o=prompt("请输入导出名称",de.value||"GeneratedComponent");if(o===null)return;const i=o.trim()||"GeneratedComponent";de.value=i;function c(b){const h=new Set,R={};function j(_){let x=Date.now(),W=`${_}-${x}`;for(;h.has(W);)x+=1,W=`${_}-${x}`;return W}function D(_){const x=JSON.parse(JSON.stringify(_)),W=String(x.id);let E=W;return h.has(E)&&(E=j(String(x.type||"el"))),h.add(E),R[W]=E,x.id=E,(x.type==="group"||x.type==="container")&&Array.isArray(x.children)&&(x.children=x.children.map(ge=>D(ge))),x}return{normalized:b.map(_=>D(_)),remap:R}}const{normalized:m}=c(A.value),f=[],C=b=>{for(const h of b)(h.type==="group"||h.type==="container")&&Array.isArray(h.children)?C(h.children):h.type==="image"&&(h.src||h.iconId)&&f.push(h)};C(m);const F={},M=new Map;let N=0;for(const b of f)try{let h;if(b.src)h=await(await fetch(String(b.src))).blob();else if(b.iconId){const x=b.iconId,W=await sr(x);if(!W)throw new Error("icon record missing: "+x);h=new Blob([W.buffer],{type:String(W.mime||"image/png")})}else continue;let R=kt(h.type);if(R==="bin"&&b.iconId){const x=b.iconId,W=await sr(x);if(W){const E=kt(String(W.mime||"")),ge=xr(String(W.originalName||""));R=E!=="bin"?E:ge||R}R==="bin"&&(R="png")}const j=await h.arrayBuffer(),D=await crypto.subtle.digest("SHA-256",j),_=Array.from(new Uint8Array(D)).map(x=>x.toString(16).padStart(2,"0")).join("");if(M.has(_)){const{fileName:x}=M.get(_);F[b.id]=x}else{const x=`${i}_img_${N}.${R}`;M.set(_,{fileName:x,blob:h}),N++,F[b.id]=x}}catch(h){console.warn("导出图片失败：",h)}const d=Array.from(M.values());let u=null,G=null;if(S.backgroundUrl)try{const b=await(await fetch(String(S.backgroundUrl))).blob(),h=kt(b.type);u=`${i}_bg.${h}`,G=b}catch(b){console.warn("导出背景图片失败：",b)}const H=new Set,ue=Ht(S.globalFontFamily);ue&&H.add(ue);const ye=b=>{var h;for(const R of b)if((R.type==="group"||R.type==="container")&&Array.isArray(R.children))ye(R.children);else if(R.type==="text"){const j=Ht((h=R.style)==null?void 0:h.fontFamily);j&&H.add(j)}};ye(A.value);const ie=[],ve=[];if(H.size>0)try{const b="lowcode-fonts",h="fonts",R=await new Promise((x,W)=>{const E=indexedDB.open(b);E.onsuccess=()=>{const ge=E.result;if(ge.objectStoreNames.contains(h))x(ge);else{const Ae=ge.version+1;ge.close();const $e=indexedDB.open(b,Ae);$e.onupgradeneeded=()=>{const Ce=$e.result;Ce.objectStoreNames.contains(h)||Ce.createObjectStore(h,{keyPath:"id"})},$e.onsuccess=()=>x($e.result),$e.onerror=()=>W($e.error)}},E.onerror=()=>W(E.error)}),j=await new Promise((x,W)=>{const E=R.transaction(h,"readonly").objectStore(h).getAll();E.onsuccess=()=>x(E.result),E.onerror=()=>W(E.error)}),D=$.value,_=D?j.filter(x=>x.projectId===D):j.filter(x=>!x.projectId);for(const x of _)if(H.has(x.name)){const W=new Blob([x.buffer],{type:x.mime});let E=kt(x.mime);if(E==="bin")try{E=hr(x.buffer)}catch{E="ttf"}const ge=x.name.replace(/[^A-Za-z0-9_\-]/g,"_"),Ae=`${i}_${ge}.${E}`;ie.push({family:x.name,file:Ae}),ve.push({file:Ae,blob:W})}}catch(b){console.warn("读取字体库失败：",b)}const he=new ql.default,ee=he.folder(i),re=ee.folder("imgs");for(const b of d)re.file(b.fileName,b.blob);G&&u&&re.file(u,G);const J=ee.folder("fonts");for(const b of ve)J.file(b.file,b.blob);let ne="";if(l==="vue2"){const b=Vl(i,S,m,{imageFileNames:d.map(h=>h.fileName),imageFileMap:F,backgroundFileName:G&&u?u:null,fontFaces:ie,hideDirective:"if"},Ye.value);ne=b.indexVue,ee.file("index.vue",ne),b.files&&Object.entries(b.files).forEach(([h,R])=>{ee.file(h,R)})}else l==="vue3"?(ne=Pl(i,S,m,{imageFileNames:d.map(b=>b.fileName),imageFileMap:F,backgroundFileName:G&&u?u:null,fontFaces:ie,hideDirective:"if"}),ee.file("index.vue",ne)):l==="react"?(ne=Jl(i,S,m,{imageFileNames:d.map(b=>b.fileName),imageFileMap:F,backgroundFileName:G&&u?u:null,fontFaces:ie}),ee.file("index.jsx",ne),ee.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。")):(ne=Wl(i,S,m,{imageFileNames:d.map(b=>b.fileName),imageFileMap:F,backgroundFileName:G&&u?u:null,fontFaces:ie}),ee.file("index.html",ne));const ze=await he.generateAsync({type:"blob"});(0,_l.saveAs)(ze,`${i}.zip`)}async function Gr(){const l=prompt("请输入导出名称",de.value||"GeneratedComponent");if(l===null)return;const o=l.trim()||"GeneratedComponent";de.value=o;const i=[],c=b=>{for(const h of b)(h.type==="group"||h.type==="container")&&Array.isArray(h.children)?c(h.children):h.type==="image"&&h.src&&i.push(h)};c(A.value);const m={},f=new Map;let C=0;for(const b of i)try{let h;if(b.src)h=await(await fetch(String(b.src))).blob();else if(b.iconId){const x=b.iconId,W=await sr(x);if(!W)throw new Error("icon record missing: "+x);h=new Blob([W.buffer],{type:String(W.mime||"image/png")})}else continue;let R=kt(h.type);if(R==="bin"&&b.iconId){const x=b.iconId,W=await sr(x);if(W){const E=kt(String(W.mime||"")),ge=xr(String(W.originalName||""));R=E!=="bin"?E:ge||R}R==="bin"&&(R="png")}const j=await h.arrayBuffer(),D=await crypto.subtle.digest("SHA-256",j),_=Array.from(new Uint8Array(D)).map(x=>x.toString(16).padStart(2,"0")).join("");if(f.has(_)){const{fileName:x}=f.get(_);m[b.id]=x}else{const x=`${o}_img_${C}.${R}`;f.set(_,{fileName:x,blob:h}),C++,m[b.id]=x}}catch(h){console.warn("导出图片失败：",h)}const F=Array.from(f.values());let M=null,N=null;if(S.backgroundUrl)try{const b=await(await fetch(String(S.backgroundUrl))).blob(),h=kt(b.type);M=`${o}_bg.${h}`,N=b}catch(b){console.warn("导出背景图片失败：",b)}const d=new Set,u=Ht(S.globalFontFamily);u&&d.add(u);const G=b=>{var h;for(const R of b)if((R.type==="group"||R.type==="container")&&Array.isArray(R.children))G(R.children);else if(R.type==="text"){const j=Ht((h=R.style)==null?void 0:h.fontFamily);j&&d.add(j)}};G(A.value);const H=[],ue=[];if(d.size>0)try{const b="lowcode-fonts",h="fonts",R=await new Promise((x,W)=>{const E=indexedDB.open(b);E.onsuccess=()=>{const ge=E.result;if(ge.objectStoreNames.contains(h))x(ge);else{const Ae=ge.version+1;ge.close();const $e=indexedDB.open(b,Ae);$e.onupgradeneeded=()=>{const Ce=$e.result;Ce.objectStoreNames.contains(h)||Ce.createObjectStore(h,{keyPath:"id"})},$e.onsuccess=()=>x($e.result),$e.onerror=()=>W($e.error)}},E.onerror=()=>W(E.error)}),j=await new Promise((x,W)=>{const E=R.transaction(h,"readonly").objectStore(h).getAll();E.onsuccess=()=>x(E.result),E.onerror=()=>W(E.error)}),D=$.value,_=D?j.filter(x=>x.projectId===D):j.filter(x=>!x.projectId);for(const x of _)if(d.has(x.name)){const W=new Blob([x.buffer],{type:x.mime});let E=kt(x.mime);if(E==="bin")try{E=hr(x.buffer)}catch{E="ttf"}const ge=x.name.replace(/[^A-Za-z0-9_\-]/g,"_"),Ae=`${o}_${ge}.${E}`;H.push({family:x.name,file:Ae}),ue.push({file:Ae,blob:W})}}catch(b){console.warn("读取字体库失败：",b)}const ye=new ql.default,ie=ye.folder(`${o}_all`),ve=[],he={imageFileNames:F.map(b=>b.fileName),imageFileMap:m,backgroundFileName:N&&M?M:null,fontFaces:H,hideDirective:"if"},ee=Vl(o,S,A.value,he,Ye.value);ve.push({key:"vue2",file:"index.vue",content:ee.indexVue,files:ee.files});const re=Pl(o,S,A.value,he);ve.push({key:"vue3",file:"index.vue",content:re});const J=Jl(o,S,A.value,he);ve.push({key:"react",file:"index.jsx",content:J});const ne=Wl(o,S,A.value,he);ve.push({key:"html",file:"index.html",content:ne});for(const b of ve){const h=ie.folder(b.key);h.file(b.file,b.content),b.files&&Object.entries(b.files).forEach(([D,_])=>{h.file(D,_)}),b.key==="react"&&h.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。");const R=h.folder("imgs");for(const D of F)R.file(D.fileName,D.blob);N&&M&&R.file(M,N);const j=h.folder("fonts");for(const D of ue)j.file(D.file,D.blob)}const ze=await ye.generateAsync({type:"blob"});(0,_l.saveAs)(ze,`${o}-all.zip`)}function Tr(){confirm("确认清空当前画布与元素吗？")&&(A.value=[],g.value=null)}const ct=be(1),er=be(null);function Dr(){ct.value=Math.min(2,+(ct.value+.1).toFixed(2))}function Ur(){ct.value=Math.max(.2,+(ct.value-.1).toFixed(2))}function vr(){const l=er.value;if(!l)return;const o=l.clientWidth-16,i=l.clientHeight-16,c=o/S.width,m=i/S.height;ct.value=+Math.max(.2,Math.min(2,Math.min(c,m))).toFixed(2)}sn(async()=>{vr(),await or()});const $r=be([]);function wr(l){const o=JSON.parse(JSON.stringify(l));let i=Date.now();function c(f){return i+=1,`${f}-${i}`}function m(f){f.id=c(String(f.type||"el")),f.elementId&&(f.elementId=String(f.elementId)+"_"+String(i%1e3)),(f.type==="group"||f.type==="container")&&Array.isArray(f.children)&&f.children.forEach(C=>m(C))}return m(o),o.left=(l.left||0)+10,o.top=(l.top||0)+10,o.x=o.left,o.y=o.top,o.zIndex=(l.zIndex||1)+1,o}function Lr(){var m,f,C,F,M,N,d,u,G,H,ue,ye,ie,ve,he;if(!Ft.value)return;let l=Ft.value;const o=it(l.id);o.parentGroup&&(l=o.parentGroup);const i=wr(l),{parentGroup:c}=it(l.id);if(c){const ee=Number((f=(m=c.left)!=null?m:c.x)!=null?f:0),re=Number((F=(C=c.top)!=null?C:c.y)!=null?F:0),J=Number((M=c.width)!=null?M:0),ne=Number((N=c.height)!=null?N:0),ze=ee+J,b=re+ne,h=Number((d=l.width)!=null?d:0),R=Number((u=l.height)!=null?u:0);let j=h,D=R;if(!j||!D)if(l.type==="text"){const $e=Number((G=l.fontSize)!=null?G:16),Ce=String((ue=(H=l.text)!=null?H:l.content)!=null?ue:"").trim();j=Math.max(h||50,Math.round((Ce.length||2)*$e*.6)),D=Math.max(R||20,Math.round($e*1.5))}else l.type==="image"?(j=h||200,D=R||150):l.type==="chart"?(j=h||240,D=R||160):l.type==="line"?(j=h||200,D=R||2):(j=h||100,D=R||60);const _=10,x=ee+J/2,W=re+ne/2;let E=!1,ge=ze+_,Ae=Math.round(W-D/2);if(!E&&ge+j<=S.width&&(i.left=Math.max(0,Math.min(ge,Math.max(0,S.width-j))),i.top=Math.max(0,Math.min(Ae,Math.max(0,S.height-D))),E=!0),ge=ee-j-_,Ae=Math.round(W-D/2),!E&&ge>=0&&(i.left=Math.max(0,Math.min(ge,Math.max(0,S.width-j))),i.top=Math.max(0,Math.min(Ae,Math.max(0,S.height-D))),E=!0),ge=Math.round(x-j/2),Ae=b+_,!E&&Ae+D<=S.height&&(i.left=Math.max(0,Math.min(ge,Math.max(0,S.width-j))),i.top=Math.max(0,Math.min(Ae,Math.max(0,S.height-D))),E=!0),ge=Math.round(x-j/2),Ae=re-D-_,!E&&Ae>=0&&(i.left=Math.max(0,Math.min(ge,Math.max(0,S.width-j))),i.top=Math.max(0,Math.min(Ae,Math.max(0,S.height-D))),E=!0),!E){const $e=Number((ie=(ye=l.left)!=null?ye:l.x)!=null?ie:0),Ce=Number((he=(ve=l.top)!=null?ve:l.y)!=null?he:0),Oe=ee+$e+_,Pe=re+Ce+_;i.left=Math.max(0,Math.min(Math.round(Oe),Math.max(0,S.width-j))),i.top=Math.max(0,Math.min(Math.round(Pe),Math.max(0,S.height-D)))}i.x=i.left,i.y=i.top}Q(),A.value.push(i),g.value=i.id}const ar=be(!1),ur=be([]),cr=be(""),pr=be(!1),Er=Xe(()=>{const l=cr.value.trim().toLowerCase();return l?ur.value.filter(o=>o.name.toLowerCase().includes(l)||(o.description||"").toLowerCase().includes(l)||Array.isArray(o.tags)&&o.tags.some(i=>i.toLowerCase().includes(l))):ur.value});async function kr(){try{pr.value=!0,await gt.init(),ur.value=(await gt.getAllComponents()||[]).sort((l,o)=>(o.updatedAt||0)-(l.updatedAt||0))}catch(l){console.warn("加载组件缓存失败：",l)}finally{pr.value=!1}}async function Rr(){await kr(),ar.value=!0}function Sr(){ar.value=!1}const It=be(!1);let St=null;function Vr(){It.value=!0,St&&(clearTimeout(St),St=null)}function Pr(){St&&clearTimeout(St),St=setTimeout(()=>{It.value=!1,St=null},120)}function Wr(){It.value=!0,St&&(clearTimeout(St),St=null)}function Hr(){It.value=!1,St&&(clearTimeout(St),St=null)}function Jr(l){const o=[],i=[],c=[],m=[];function f(d){var H,ue,ye,ie,ve;const u=Number(d.width||0),G=Number(d.height||0);if(u>0&&G>0)return{w:u,h:G};if(d.type==="text"){const he=Number((H=d.fontSize)!=null?H:16),ee=String((ue=d.text)!=null?ue:"").trim(),re=Math.max(50,Math.round((ee.length||2)*he*.6)),J=Math.max(20,Math.round(he*1.5));return{w:u||re,h:G||J}}if(d.type==="image")return{w:u||100,h:G||100};if(d.type==="chart")return{w:u||240,h:G||160};if(d.type==="line"){const he=Number((ie=(ye=d.style)==null?void 0:ye.lineThickness)!=null?ie:2);return(((ve=d.style)==null?void 0:ve.lineOrientation)||"horizontal")==="vertical"?{w:u||he,h:G||100}:{w:u||100,h:G||he}}return{w:u||50,h:G||20}}for(const d of l){const u=Number(d.left||d.x||0),G=Number(d.top||d.y||0),{w:H,h:ue}=f(d);o.push(u),i.push(G),c.push(u+(H||0)),m.push(G+(ue||0))}const C=o.length?Math.min(...o):0,F=i.length?Math.min(...i):0,M=c.length?Math.max(...c):C,N=m.length?Math.max(...m):F;return{minX:C,minY:F,maxX:M,maxY:N,width:Math.max(0,M-C),height:Math.max(0,N-F)}}async function _r(l){var o,i,c,m,f,C,F,M,N,d;try{const u=await Cr(`component-${l.id}`),G=JSON.parse(JSON.stringify((u==null?void 0:u.elements)||l.elements||[]));if(!G||G.length===0){console.warn("该组件没有可插入的元素");return}let H=Date.now();const ue=D=>{D.id=`${D.type||"el"}-${H++}-${Math.random().toString(36).slice(2,8)}`,(D.type==="chart"||D.type==="container")&&D.elementId&&(D.elementId=String(D.elementId)+"_"+String(H%1e3)),(D.type==="group"||D.type==="container")&&Array.isArray(D.children)&&D.children.forEach(_=>ue(_))},ye=er.value,ie=ct.value||1,ve=(o=ye==null?void 0:ye.clientWidth)!=null?o:0,he=(i=ye==null?void 0:ye.clientHeight)!=null?i:0,ee=ye?(ye.scrollLeft+ve/2)/ie:20,re=ye?(ye.scrollTop+he/2)/ie:20,J=Jr(G),ne=J.minX+J.width/2,ze=J.minY+J.height/2,b=Math.round(ee-ne),h=Math.round(re-ze),R=A.value.reduce((D,_)=>Math.max(D,Number(_.zIndex||0)),0);let j=null;if(G.length===1){const D=G[0];if(!D){console.warn("单元素组件插入失败：源元素不存在");return}const x=JSON.parse(JSON.stringify(D));ue(x);const W=Number((m=(c=x.left)!=null?c:x.x)!=null?m:0),E=Number((C=(f=x.top)!=null?f:x.y)!=null?C:0);x.left=Math.round(W+b),x.top=Math.round(E+h),x.x=x.left,x.y=x.top;const{w:ge,h:Ae}=(function(){var Oe,Pe,xt,mt,Mt;const $e=Number(x.width||0),Ce=Number(x.height||0);if($e>0&&Ce>0)return{w:$e,h:Ce};if(x.type==="text"){const pt=Number((Oe=x.fontSize)!=null?Oe:16),jt=String((Pe=x.text)!=null?Pe:"").trim(),ht=Math.max(50,Math.round((jt.length||2)*pt*.6)),Jt=Math.max(20,Math.round(pt*1.5));return{w:$e||ht,h:Ce||Jt}}if(x.type==="image")return{w:$e||100,h:Ce||100};if(x.type==="chart")return{w:$e||240,h:Ce||160};if(x.type==="line"){const pt=Number((mt=(xt=x.style)==null?void 0:xt.lineThickness)!=null?mt:2);return(((Mt=x.style)==null?void 0:Mt.lineOrientation)||"horizontal")==="vertical"?{w:$e||pt,h:Ce||100}:{w:$e||100,h:Ce||pt}}return{w:$e||50,h:Ce||20}})();if(x.width=ge,x.height=Ae,x.type==="image"&&!(x.src||"").startsWith("data:")&&x.iconId)try{ir(x.iconId).then($e=>{$e&&(x.src=$e)}).catch(()=>{})}catch{}x.zIndex=Math.max(1,R+1),Q(),A.value=A.value.concat(x),g.value=x.id,j=x.id}else{const D=`group-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,_=[];for(const W of G){const E=JSON.parse(JSON.stringify(W));ue(E);const ge=Number((M=(F=E.left)!=null?F:E.x)!=null?M:0),Ae=Number((d=(N=E.top)!=null?N:E.y)!=null?d:0);E.left=Math.round(ge-J.minX),E.top=Math.round(Ae-J.minY),E.x=E.left,E.y=E.top;const{w:$e,h:Ce}=(function(){var xt,mt,Mt,pt,jt;const Oe=Number(E.width||0),Pe=Number(E.height||0);if(Oe>0&&Pe>0)return{w:Oe,h:Pe};if(E.type==="text"){const ht=Number((xt=E.fontSize)!=null?xt:16),Jt=String((mt=E.text)!=null?mt:"").trim(),br=Math.max(50,Math.round((Jt.length||2)*ht*.6)),Kr=Math.max(20,Math.round(ht*1.5));return{w:Oe||br,h:Pe||Kr}}if(E.type==="image")return{w:Oe||100,h:Pe||100};if(E.type==="chart")return{w:Oe||240,h:Pe||160};if(E.type==="line"){const ht=Number((pt=(Mt=E.style)==null?void 0:Mt.lineThickness)!=null?pt:2);return(((jt=E.style)==null?void 0:jt.lineOrientation)||"horizontal")==="vertical"?{w:Oe||ht,h:Pe||100}:{w:Oe||100,h:Pe||ht}}return{w:Oe||50,h:Pe||20}})();if(E.width=$e,E.height=Ce,E.type==="image"&&!(E.src||"").startsWith("data:")&&E.iconId)try{ir(E.iconId).then(Oe=>{Oe&&(E.src=Oe)}).catch(()=>{})}catch{}_.push(E)}const x={id:D,type:"group",left:Math.round(J.minX+b),top:Math.round(J.minY+h),width:Math.max(1,Math.round(J.width)),height:Math.max(1,Math.round(J.height)),zIndex:Math.max(1,R+1),className:l.name?`component-${l.name.replace(/[^A-Za-z0-9_-]/g,"-")}`:void 0,children:_,componentId:l.id,editable:!0,style:{backgroundColor:"transparent"}};Q(),A.value=A.value.concat(x),g.value=x.id,j=D}try{if(j){const D=await gt.getFontsByComponentId(l.id);if(Array.isArray(D)&&D.length>0){let _=document.getElementById(`component-fonts-${j}`);_||(_=document.createElement("style"),_.id=`component-fonts-${j}`,document.head.appendChild(_));const x=[];for(const W of D){const E=String(W.name||"").replace(/[^A-Za-z0-9_\-]/g,"_"),ge=W.bufferBase64;ge&&x.push(`@font-face { font-family: '${E}'; src: url('${ge}'); font-weight: normal; font-style: normal; font-display: swap; }`)}_.textContent=x.join(`
`)}}}catch(D){console.warn("注入组件字体失败：",D)}try{if(j){const D=await gt.getDatabaseObjectsByComponentId(l.id);Array.isArray(D)&&D.length>0&&Re(j,D.map(_=>({name:_.name,content:_.content})))}}catch(D){console.warn("注入组件数据库对象失败：",D)}await gt.incrementUsageCount(l.id),ar.value=!1}catch(u){console.warn("插入组件失败：",u)}}const Mr=()=>$.value?`lowcode-builder-state-${$.value}`:"lowcode-builder-state-v1",gr=()=>$.value?n.isComponent?`component-${$.value}`:`project-${$.value}`:"default";async function fr(l,o){try{const i=JSON.parse(JSON.stringify(o));if(l.startsWith("component-")){const c=l.replace(/^component-/,"");await gt.saveBuilderStateForComponent(c,i)}else if(l.startsWith("project-")){const c=l.replace(/^project-/,"");await gt.saveBuilderStateForProject(c,i)}else await gt.saveBuilderStateForProject(l,i)}catch(i){console.warn("保存构建器状态失败：",i)}}async function Cr(l){try{if(l.startsWith("component-")){const o=l.replace(/^component-/,"");return await gt.getBuilderStateForComponent(o)}else if(l.startsWith("project-")){const o=l.replace(/^project-/,"");return await gt.getBuilderStateForProject(o)}return await gt.getBuilderStateForProject(l)}catch(o){return console.warn("恢复构建器状态失败：",o),null}}let yr=null;function mr(){yr&&clearTimeout(yr),yr=setTimeout(()=>{const l={config:S,elements:A.value,exportName:de.value,version:on};try{const o=async()=>{if(await fr(gr(),l),n.isComponent&&$.value)try{const i=String($.value),c=await gt.getComponent(i),m={id:i,name:de.value||(c==null?void 0:c.name)||"未命名组件",description:(c==null?void 0:c.description)||"",tags:(c==null?void 0:c.tags)||[],elements:A.value,config:S,usageCount:(c==null?void 0:c.usageCount)||0,createdAt:(c==null?void 0:c.createdAt)||Date.now(),updatedAt:Date.now()};await gt.saveComponent(JSON.parse(JSON.stringify(m))),Ar()}catch(i){console.warn("同步保存组件记录失败：",i)}};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{o()}):o()}catch(o){console.warn("保存失败：",o)}},400)}Tt(S,mr,{deep:!0}),Tt(A,mr,{deep:!0}),Tt(de,mr),Tt(A,()=>{tt()},{deep:!0});async function qr(){try{const l="lowcode-icons",o="icons",i=await new Promise((f,C)=>{const F=indexedDB.open(l);F.onsuccess=()=>{const M=F.result;if(M.objectStoreNames.contains(o))f(M);else{const N=M.version+1;M.close();const d=indexedDB.open(l,N);d.onupgradeneeded=()=>{const u=d.result;u.objectStoreNames.contains(o)||u.createObjectStore(o,{keyPath:"id"})},d.onsuccess=()=>f(d.result),d.onerror=()=>C(d.error)}},F.onerror=()=>C(F.error)}),c=await new Promise((f,C)=>{const F=i.transaction(o,"readonly").objectStore(o).getAll();F.onsuccess=()=>f(F.result),F.onerror=()=>C(F.error)}),m=$.value;$r.value=(m?c.filter(f=>f.projectId===m):c.filter(f=>!f.projectId)).map(f=>{const C=new Blob([f.buffer],{type:f.mime}),F=URL.createObjectURL(C);return{id:f.id,url:F,name:f.name}})}catch(l){console.warn("图标库初始化失败：",l)}}async function ir(l){try{const o="lowcode-icons",i="icons",c=await new Promise((C,F)=>{const M=indexedDB.open(o);M.onsuccess=()=>{const N=M.result;if(N.objectStoreNames.contains(i))C(N);else{const d=N.version+1;N.close();const u=indexedDB.open(o,d);u.onupgradeneeded=()=>{const G=u.result;G.objectStoreNames.contains(i)||G.createObjectStore(i,{keyPath:"id"})},u.onsuccess=()=>C(u.result),u.onerror=()=>F(u.error)}},M.onerror=()=>F(M.error)}),m=await new Promise((C,F)=>{const M=c.transaction(i,"readonly").objectStore(i).get(l);M.onsuccess=()=>C(M.result),M.onerror=()=>F(M.error)});if(!m||!m.buffer)return null;const f=new Blob([m.buffer],{type:m.mime||"application/octet-stream"});return await new Promise((C,F)=>{const M=new FileReader;M.onload=()=>C(String(M.result)),M.onerror=()=>F(M.error),M.readAsDataURL(f)})}catch(o){return console.warn("读取图标数据失败：",o),null}}async function Nr(){const l=A.value.filter(o=>o.type==="image");for(const o of l){if((o.src||"").startsWith("data:")||!o.iconId)continue;const i=await ir(o.iconId);i&&(o.src=i)}}async function Yr(){try{const l="lowcode-fonts",o="fonts",i=await new Promise((m,f)=>{const C=indexedDB.open(l);C.onsuccess=()=>{const F=C.result;if(F.objectStoreNames.contains(o))m(F);else{const M=F.version+1;F.close();const N=indexedDB.open(l,M);N.onupgradeneeded=()=>{const d=N.result;d.objectStoreNames.contains(o)||d.createObjectStore(o,{keyPath:"id"})},N.onsuccess=()=>m(N.result),N.onerror=()=>f(N.error)}},C.onerror=()=>f(C.error)}),c=await new Promise((m,f)=>{const C=i.transaction(o,"readonly").objectStore(o).getAll();C.onsuccess=()=>m(C.result),C.onerror=()=>f(C.error)});if(c.length>0){let m=document.querySelector("style[data-font-lib]");m||(m=document.createElement("style"),m.setAttribute("data-font-lib",""),document.head.appendChild(m));const f=[],C=[],F=$.value,M=F?c.filter(d=>d.projectId===F):c.filter(d=>!d.projectId);for(const d of M){const u=new Blob([d.buffer],{type:d.mime}),G=URL.createObjectURL(u),H=d.name;C.push(H),f.push(`@font-face { font-family: '${H}'; src: url('${G}'); font-weight: normal; font-style: normal; }`)}m.textContent=f.join(`
`);const N=new Set([...we.value,...C]);we.value=Array.from(N)}}catch(l){console.warn("字体库初始化失败：",l)}}function Ir(l){const o=new Set,i=new Set,c=m=>{m.forEach(f=>{if((!f.id||o.has(f.id))&&(f.id=`${f.type||"el"}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`),o.add(f.id),f.elementId){const C=f.elementId.trim();if(i.has(C)){let F=2,M=`${C}_${F}`;for(;i.has(M);)F++,M=`${C}_${F}`;f.elementId=M}i.add(f.elementId)}(f.type==="group"||f.type==="container")&&Array.isArray(f.children)&&c(f.children)})};c(l)}sn(async()=>{await P(),await Yr(),await qr();try{if(n.isComponent&&$.value){const l=String($.value);if(!await gt.getComponent(l)){const o={id:l,name:de.value||"未命名组件",description:"",tags:[],elements:[],config:S,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await gt.saveComponent(JSON.parse(JSON.stringify(o)))}}}catch(l){console.warn("预创建组件记录失败：",l)}try{const l=await Cr(gr());if(l){l.config&&Object.assign(S,l.config),Array.isArray(l.elements)&&(A.value=l.elements),typeof l.exportName=="string"&&l.exportName&&(de.value=l.exportName),await Nr();try{A.value=A.value.map(o=>{if(o.type==="chart"&&o.style&&typeof o.style.border=="string"&&o.style.border.includes("dashed")){const i={...o,style:{...o.style}};return delete i.style.border,i}return o})}catch{}l.version!==on&&Ir(A.value)}else{const o=localStorage.getItem(Mr());if(o){const i=JSON.parse(o);i&&i.config&&Object.assign(S,i.config),Array.isArray(i==null?void 0:i.elements)&&(A.value=i.elements),typeof(i==null?void 0:i.exportName)=="string"&&i.exportName&&(de.value=i.exportName),await Nr();try{A.value=A.value.map(c=>{if(c.type==="chart"&&c.style&&typeof c.style.border=="string"&&c.style.border.includes("dashed")){const m={...c,style:{...c.style}};return delete m.style.border,m}return c})}catch{}Ir(A.value),await fr(gr(),{config:S,elements:A.value,exportName:de.value,version:on});try{localStorage.removeItem(Mr())}catch{}}}}catch(l){console.warn("恢复失败：",l)}tt(),window.addEventListener("keydown",st),window.addEventListener("keyup",Ke)}),an(()=>{window.removeEventListener("keydown",st),window.removeEventListener("keyup",Ke),Ar()});let Fr=0;async function Xr(l,o){var i,c,m;try{const f=S.width||l.clientWidth||800,C=S.height||l.clientHeight||600,F=(i=o==null?void 0:o.maxWidth)!=null?i:420,M=(c=o==null?void 0:o.scale)!=null?c:Math.min(1,F/f),N=(m=o==null?void 0:o.quality)!=null?m:.85,d=l.cloneNode(!0);d.style.transform="none",d.style.transformOrigin="top left",d.style.width=`${f}px`,d.style.height=`${C}px`;const u=new XMLSerializer().serializeToString(d),G=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${Math.round(f*M)}" height="${Math.round(C*M)}">
  <foreignObject width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml" style="transform: scale(${M}); transform-origin: top left;">${u}</div>
  </foreignObject>
</svg>`,H="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(G),ue=new Image;return await new Promise(ye=>{ue.onload=()=>{try{const ie=document.createElement("canvas");ie.width=ue.width,ie.height=ue.height;const ve=ie.getContext("2d");if(!ve)return ye(null);ve.drawImage(ue,0,0);const he=ie.toDataURL("image/jpeg",N);ye(he)}catch{ye(null)}},ue.onerror=()=>ye(null),ue.src=H})}catch{return null}}async function Ar(){try{const l=Date.now();if(l-Fr<5e3||(Fr=l,!n.isComponent||!$.value))return;const o=er.value;if(!o)return;const i=o.firstElementChild;if(!i)return;const c=await Xr(i,{maxWidth:420,quality:.8});if(!c)return;const m=String($.value),f=await gt.getComponent(m);if(!f)return;const C={...f,previewDataUrl:c,updatedAt:Date.now()};await gt.saveComponent(JSON.parse(JSON.stringify(C)))}catch(l){console.warn("生成缩略图失败：",l)}}return(l,o)=>{var i,c,m,f,C,F,M,N;return z(),B(tr,null,[r("div",gu,[o[33]||(o[33]=en('<div class="absolute inset-0 opacity-10" data-v-bf1a5e3a><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-bf1a5e3a></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-bf1a5e3a></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-bf1a5e3a></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-bf1a5e3a></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-bf1a5e3a></div>',2)),r("div",fu,[vt(xs,{exportName:de.value,config:S,fontLibrary:we.value,spacingEnabled:Ue.value,alignmentEnabled:$t.value,"onUpdate:exportName":o[0]||(o[0]=d=>de.value=d),"onUpdate:configWidth":o[1]||(o[1]=d=>S.width=d),"onUpdate:configHeight":o[2]||(o[2]=d=>S.height=d),"onUpdate:backgroundColor":o[3]||(o[3]=d=>S.backgroundColor=d),"onUpdate:globalFontFamily":o[4]||(o[4]=d=>S.globalFontFamily=d),"onUpdate:globalFontSize":o[5]||(o[5]=d=>S.globalFontSize=d),"onUpdate:globalColor":o[6]||(o[6]=d=>S.globalColor=d),"onUpdate:spacingEnabled":o[7]||(o[7]=d=>Ue.value=d),"onUpdate:alignmentEnabled":o[8]||(o[8]=d=>$t.value=d),onBackgroundFileChange:Dt,onOpenPreview:oe,onDownloadByFormat:o[9]||(o[9]=d=>Br(d)),onDownloadAllFormats:Gr,onResetCanvas:Tr,elements:A.value,selectedId:g.value,onSelectElement:o[10]||(o[10]=d=>s(d)),onReorderTopElements:o[11]||(o[11]=d=>se(d.from,d.to))},null,8,["exportName","config","fontLibrary","spacingEnabled","alignmentEnabled","elements","selectedId"]),r("div",yu,[r("div",mu,[r("div",bu,[r("div",xu,[r("button",{onMouseenter:Vr,onMouseleave:Pr,onClick:o[12]||(o[12]=d=>It.value=!0),class:"px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"}," 插入元素 ",32),xe(r("div",{onMouseenter:Wr,onMouseleave:Hr,class:"absolute left-0 top-full w-72 p-3 bg-gray-900/95 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl z-50"},[r("div",hu,[r("button",{onClick:o[13]||(o[13]=d=>{ot("text"),It.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded"},"文本"),r("button",{onClick:o[14]||(o[14]=d=>{ot("arc-text"),It.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-indigo-600 hover:from-cyan-500 hover:to-indigo-500 text-white rounded"},"环绕文字"),r("button",{onClick:o[15]||(o[15]=d=>{ot("image"),It.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500 text-white rounded"},"图片"),r("button",{onClick:o[16]||(o[16]=d=>{ot("chart"),It.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-500 hover:to-red-500 text-white rounded"},"图表"),r("button",{onClick:o[17]||(o[17]=d=>{ot("line"),It.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"线条"),r("button",{onClick:o[18]||(o[18]=d=>{ot("container"),It.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded col-span-2"},"容器")])],544),[[uo,It.value]])]),r("button",{onClick:o[19]||(o[19]=d=>wt.value=!0),class:"px-4 py-2 bg-gradient-to-r from-gray-600 to-slate-700 hover:from-gray-500 hover:to-slate-600 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-gray-500/25"}," 隐藏元素 "),r("button",{onClick:Rr,class:"px-4 py-2 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-pink-500/25"}," 插入组件 ")]),r("div",vu,[r("button",{onClick:Ur,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[31]||(o[31]=[r("span",{class:"text-gray-300"},"-",-1)])]),r("span",$u,bt(Math.round(ct.value*100))+"%",1),r("button",{onClick:Dr,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...o[32]||(o[32]=[r("span",{class:"text-gray-300"},"+",-1)])]),r("button",{onClick:vr,class:"px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg text-xs text-gray-300 transition-colors duration-200"}," 适应 ")])]),r("div",{ref_key:"canvasScrollRef",ref:er,class:"flex-1 overflow-auto bg-gray-800/30 p-4 min-h-0 custom-scrollbar"},[r("div",{ref_key:"canvasContentRef",ref:Qt,class:"relative border border-gray-600/50 bg-gray-100 shadow-2xl mx-auto",onMousedown:Kl(Fe,["self"]),style:Ct({width:`${S.width}px`,height:`${S.height}px`,backgroundColor:S.backgroundColor||"transparent",backgroundImage:S.backgroundUrl?`url(${S.backgroundUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`scale(${ct.value})`,transformOrigin:"top left"})},[De.value?(z(),B("div",wu,[X.value.left?(z(),B("div",{key:0,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:Ct([{"border-width":"0.5px"},{left:`${Ne.value.left}px`}])},null,4)):K("",!0),X.value.right?(z(),B("div",{key:1,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:Ct([{"border-width":"0.5px"},{left:`${Ne.value.right}px`}])},null,4)):K("",!0),X.value.top?(z(),B("div",{key:2,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:Ct([{"border-width":"0.5px"},{top:`${Ne.value.top}px`}])},null,4)):K("",!0),X.value.bottom?(z(),B("div",{key:3,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:Ct([{"border-width":"0.5px"},{top:`${Ne.value.bottom}px`}])},null,4)):K("",!0),X.value.centerV?(z(),B("div",{key:4,class:"absolute top-0 bottom-0 border-l border-dashed border-blue-400/60",style:Ct([{"border-width":"0.5px"},{left:`${Ne.value.centerX}px`}])},null,4)):K("",!0),X.value.centerH?(z(),B("div",{key:5,class:"absolute left-0 right-0 border-t border-dashed border-blue-400/60",style:Ct([{"border-width":"0.5px"},{top:`${Ne.value.centerY}px`}])},null,4)):K("",!0)])):K("",!0),Ue.value&&(te.value.left||te.value.right||te.value.up||te.value.down)?(z(),B("div",Eu,[te.value.left&&nt.value!=="left"?(z(),B("div",{key:0,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Ct({left:`${te.value.left.x-14}px`,top:`${te.value.left.y-14}px`}),onDblclick:o[20]||(o[20]=d=>Pt("left"))},bt(te.value.left.gap)+"px ",37)):K("",!0),te.value.right&&nt.value!=="right"?(z(),B("div",{key:1,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Ct({left:`${te.value.right.x-14}px`,top:`${te.value.right.y-14}px`}),onDblclick:o[21]||(o[21]=d=>Pt("right"))},bt(te.value.right.gap)+"px ",37)):K("",!0),te.value.up&&nt.value!=="up"?(z(),B("div",{key:2,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Ct({left:`${te.value.up.x-14}px`,top:`${te.value.up.y-18}px`}),onDblclick:o[22]||(o[22]=d=>Pt("up"))},bt(te.value.up.gap)+"px ",37)):K("",!0),te.value.down&&nt.value!=="down"?(z(),B("div",{key:3,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:Ct({left:`${te.value.down.x-14}px`,top:`${te.value.down.y-18}px`}),onDblclick:o[23]||(o[23]=d=>Pt("down"))},bt(te.value.down.gap)+"px ",37)):K("",!0),nt.value==="left"?xe((z(),B("input",{key:4,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Ct({left:`${(((i=te.value.left)==null?void 0:i.x)||0)-28}px`,top:`${(((c=te.value.left)==null?void 0:c.y)||0)-14}px`}),"onUpdate:modelValue":o[24]||(o[24]=d=>lt.value=d),onKeydown:Zr(Wt,["enter"])},null,36)),[[Me,lt.value,void 0,{number:!0}]]):K("",!0),nt.value==="right"?xe((z(),B("input",{key:5,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Ct({left:`${(((m=te.value.right)==null?void 0:m.x)||0)-28}px`,top:`${(((f=te.value.right)==null?void 0:f.y)||0)-14}px`}),"onUpdate:modelValue":o[25]||(o[25]=d=>lt.value=d),onKeydown:Zr(Wt,["enter"])},null,36)),[[Me,lt.value,void 0,{number:!0}]]):K("",!0),nt.value==="up"?xe((z(),B("input",{key:6,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Ct({left:`${(((C=te.value.up)==null?void 0:C.x)||0)-28}px`,top:`${(((F=te.value.up)==null?void 0:F.y)||0)-18}px`}),"onUpdate:modelValue":o[26]||(o[26]=d=>lt.value=d),onKeydown:Zr(Wt,["enter"])},null,36)),[[Me,lt.value,void 0,{number:!0}]]):K("",!0),nt.value==="down"?xe((z(),B("input",{key:7,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:Ct({left:`${(((M=te.value.down)==null?void 0:M.x)||0)-28}px`,top:`${(((N=te.value.down)==null?void 0:N.y)||0)-18}px`}),"onUpdate:modelValue":o[27]||(o[27]=d=>lt.value=d),onKeydown:Zr(Wt,["enter"])},null,36)),[[Me,lt.value,void 0,{number:!0}]]):K("",!0)])):K("",!0),(z(!0),B(tr,null,dr(A.value,d=>(z(),rn(go,{key:d.id,element:d,selected:d.id===g.value,"selected-id":g.value,config:S,zoom:ct.value,dbMap:Ye.value,"metrics-map":L.value,onSelect:qt,"onUpdate:position":Ut,"onUpdate:size":_t,onShowGuidelines:Zt,onHideGuidelines:Vt,onReportMetrics:ft,onDragEnd:nr},null,8,["element","selected","selected-id","config","zoom","dbMap","metrics-map"]))),128))],36)],512)]),vt(pu,{selectedEl:Ft.value,config:S,fontLibrary:we.value,fontSizeLibrary:le.value,fontWeightOptions:me.value,fontStyleOptions:ae.value,databaseObjects:v.value,dbMap:Ye.value,iconLibrary:$r.value,defaultChartOption:yt,safeHex:Qe,initCustomClassSkeleton:Ve,refreshAllCustomClassCss:tt,removeCustomClassCssForElement:dt,getIconDataUrlById:ir,onDuplicateSelected:Lr,onRemoveSelected:Le,onSaveSelectedAsComponent:At},null,8,["selectedEl","config","fontLibrary","fontSizeLibrary","fontWeightOptions","fontStyleOptions","databaseObjects","dbMap","iconLibrary"])])]),ar.value?(z(),B("div",ku,[r("div",{class:"absolute inset-0 bg-black/60",onClick:Sr}),r("div",Su,[r("div",{class:"flex items-center justify-between p-4 border-b border-fuchsia-500/30 bg-gradient-to-r from-fuchsia-600/20 to-pink-600/20"},[o[34]||(o[34]=r("h3",{class:"text-lg font-bold text-pink-300"},"插入组件",-1)),r("button",{onClick:Sr,class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",Mu,[r("div",Cu,[xe(r("input",{"onUpdate:modelValue":o[28]||(o[28]=d=>cr.value=d),type:"text",placeholder:"搜索名称、描述或标签",class:"flex-1 px-3 py-2 bg-gray-800/60 border border-fuchsia-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-fuchsia-400 focus:ring-1 focus:ring-fuchsia-400 focus:outline-none transition-all duration-200"},null,512),[[Me,cr.value]]),r("button",{onClick:kr,class:"px-3 py-2 bg-pink-600/70 hover:bg-pink-600 text-white rounded"},"刷新")]),pr.value?(z(),B("div",Nu,"正在加载组件...")):(z(),B("div",Iu,[Er.value.length===0?(z(),B("div",Fu,"暂无匹配的组件")):(z(),B("div",Au,[(z(!0),B(tr,null,dr(Er.value,d=>(z(),B("div",{key:d.id,class:"bg-gray-800/60 border border-pink-500/20 rounded-lg overflow-hidden"},[r("div",ju,[d.previewDataUrl?(z(),B("img",{key:0,src:d.previewDataUrl,alt:"预览",class:"max-w-full max-h-full object-contain"},null,8,zu)):(z(),B("div",Ou,"无预览"))]),r("div",Bu,[r("div",Gu,[r("div",{class:"text-sm text-gray-100 font-medium truncate",title:d.name},bt(d.name),9,Tu),r("div",Du,bt(d.usageCount||0)+" 次",1)]),r("div",Uu,[(z(!0),B(tr,null,dr(d.tags||[],u=>(z(),B("span",{key:u,class:"px-1.5 py-0.5 text-[10px] rounded bg-pink-600/30 text-pink-200"},bt(u),1))),128))]),r("div",Lu,[r("button",{onClick:u=>_r(d),class:"w-full px-3 py-1.5 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded text-sm transition"}," 插入到画布 ",8,Ru)])])]))),128))]))]))])])])):K("",!0),wt.value?(z(),B("div",Vu,[r("div",{class:"absolute inset-0 bg-black/60",onClick:o[29]||(o[29]=d=>wt.value=!1)}),r("div",Pu,[r("div",Wu,[o[35]||(o[35]=r("h3",{class:"text-lg font-bold text-cyan-300"},"隐藏元素列表",-1)),r("button",{onClick:o[30]||(o[30]=d=>wt.value=!1),class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",Hu,[Lt.value.length===0?(z(),B("div",Ju,"暂无隐藏元素")):(z(),B("div",_u,[(z(!0),B(tr,null,dr(Lt.value,d=>(z(),B("div",{key:d.id,class:"flex items-center justify-between bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2"},[r("div",{class:"text-sm text-gray-100 truncate",title:d.hiddenLabel||d.className||d.id},bt(d.hiddenLabel||d.className||d.id),9,qu),r("button",{onClick:u=>Rt(d.id),class:"px-3 py-1 bg-cyan-600/70 hover:bg-cyan-600 text-white rounded text-sm"},"取消隐藏并定位",8,Yu)]))),128))]))])])])):K("",!0)],64)}}}),Zu=dn(Ku,[["__scopeId","data-v-bf1a5e3a"]]),Qu=Kt({__name:"index",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(y){const n=y;return(e,p)=>(z(),rn(Zu,{"project-id":n.projectId,"current-project":n.currentProject,"is-component":n.isComponent},null,8,["project-id","current-project","is-component"]))}}),ac=Qu;export{ac as default};
