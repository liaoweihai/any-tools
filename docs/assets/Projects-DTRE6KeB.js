import{E as m,H as V,I as $,O as Q,R as k,_ as R,c as G,d as N,f as g,h as I,l as e,lt as b,m as J,o as X,u as Y,w as Z}from"./codemirror-B25QCqWr.js";import{f as F,h as ee,m as te,s as T}from"./vendor-vue-C93_ecI2.js";import{t as re}from"./index-FzRHQyb9.js";import{t as u}from"./componentStorage-DB4dbTb9.js";var O="lowcode-projects",p="projects";async function H(){return new Promise((x,c)=>{const s=indexedDB.open(O);s.onsuccess=()=>{const i=s.result;if(i.objectStoreNames.contains(p))x(i);else{const f=i.version+1;i.close();const d=indexedDB.open(O,f);d.onupgradeneeded=()=>{const h=d.result;h.objectStoreNames.contains(p)||h.createObjectStore(p,{keyPath:"id"})},d.onsuccess=()=>x(d.result),d.onerror=()=>c(d.error)}},s.onerror=()=>c(s.error)})}function oe(){const x=T(),c=k([]);async function s(){try{const r=(await H()).transaction(p,"readonly").objectStore(p).getAll();return await new Promise(o=>{r.onsuccess=()=>{c.value=(r.result||[]).sort((l,w)=>w.updatedAt-l.updatedAt),o(c.value)}})}catch(r){return console.warn("加载项目失败：",r),[]}}async function i(r){try{await(await H()).transaction(p,"readwrite").objectStore(p).put(r),await s()}catch(o){console.warn("保存项目失败：",o)}}async function f(r){try{await(await H()).transaction(p,"readwrite").objectStore(p).delete(r),await s()}catch(o){console.warn("删除项目失败：",o)}}async function d(r){if(confirm("确认删除此项目吗？这将清空项目相关的所有数据（图标、字体、画布等）。")){await f(r);try{await u.clearProjectResources(r),await u.clearBuilderStateForProject(r)}catch(o){console.warn("清空项目相关资源失败：",o)}await s()}}function h(r,o){const l={id:`project-${Date.now()}`,name:r.trim(),description:(o==null?void 0:o.trim())||"",createdAt:Date.now(),updatedAt:Date.now()};return i(l)}function _(r,o){var w,j;const l={...r,name:((w=o.name)!=null?w:r.name).trim(),description:(((j=o.description)!=null?j:r.description)||"").trim(),updatedAt:Date.now()};return i(l)}async function v(r){await _(r,{}),x.push(`/project/${r.id}/builder`)}function y(r){return new Date(r).toLocaleString("zh-CN")}return{projects:c,loadProjects:s,saveProject:i,deleteProject:f,deleteProjectWithResources:d,createProject:h,updateProject:_,enterProject:v,formatDate:y}}var ae={class:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden"},ne={class:"relative z-10 container mx-auto px-6 py-8"},se={class:"flex flex-col md:flex-row gap-4 mb-8"},le={class:"flex-1"},ie={class:"relative"},de={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ue={class:"flex items-start justify-between mb-4"},ce={class:"flex-1"},ve={class:"text-xl font-semibold text-cyan-300 mb-2"},me={key:0,class:"text-gray-400 text-sm mb-3 clamp-2"},pe={class:"flex gap-2"},fe=["onClick"],ge=["onClick"],be=["onClick"],ye={class:"text-xs text-gray-500 mb-4"},we=["onClick"],xe={key:1,class:"text-center py-16"},he={class:"text-xl font-semibold text-gray-400 mb-2"},ke={class:"text-gray-500 mb-6"},_e={class:"bg-gray-800 border border-purple-500/30 rounded-xl p-6 w-full max-w-md"},je={class:"text-xl font-semibold text-cyan-300 mb-4"},Ce={class:"space-y-4"},Pe={class:"flex gap-3 mt-6"},De=["disabled"],Ae=R({__name:"ProjectManager",setup(x){const c=T(),{projects:s,loadProjects:i,saveProject:f,deleteProjectWithResources:d,enterProject:h,formatDate:_}=oe(),v=k(""),y=k(!1),r=k(null),o=k(""),l=k("");function w(){if(!o.value.trim())return;const n={id:`project-${Date.now()}`,name:o.value.trim(),description:l.value.trim(),createdAt:Date.now(),updatedAt:Date.now()};f(n),P()}function j(){if(!r.value||!o.value.trim())return;const n={...r.value,name:o.value.trim(),description:l.value.trim(),updatedAt:Date.now()};f(n),P()}function U(n){r.value=n,o.value=n.name,l.value=n.description||"",y.value=!0}function P(){y.value=!1,r.value=null,o.value="",l.value=""}async function q(n){try{const t=`${n.name} 副本`,a=prompt("请输入新项目名称",t);if(a==null)return;const C=a.trim()||t,z={id:`project-${Date.now()}`,name:C,description:n.description||"",createdAt:Date.now(),updatedAt:Date.now()};await f(z);const D=n.id,A=z.id,[E,B,M,S]=await Promise.all([u.getBuilderStateForProject(D),u.getFontsByComponentId(D),u.getIconsForComponent(D),u.getDatabaseObjectsByComponentId(D)]);E&&await u.saveBuilderStateForProject(A,E),Array.isArray(B)&&B.length>0&&await u.saveFontsForComponent(A,B),Array.isArray(M)&&M.length>0&&await u.saveIconsForComponent(A,M),Array.isArray(S)&&S.length>0&&await u.saveDatabaseObjectsForComponent(A,S),await i(),alert("项目复制成功")}catch(t){console.warn("复制项目失败：",t),alert("复制项目失败，请重试")}}const L=G(()=>{if(!v.value.trim())return s.value;const n=v.value.toLowerCase();return s.value.filter(t=>t.name.toLowerCase().includes(n)||t.description&&t.description.toLowerCase().includes(n))});function K(n){d(n)}Z(()=>{i()});function W(){c.push("/low-code")}return(n,t)=>(m(),g("div",ae,[t[17]||(t[17]=J('<div class="absolute inset-0 opacity-10" data-v-75e9c3b4><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-75e9c3b4></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-75e9c3b4></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-75e9c3b4></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-75e9c3b4></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-75e9c3b4></div>',2)),e("div",ne,[e("div",{class:"flex items-center justify-between mb-12"},[e("button",{onClick:W,class:"flex items-center gap-2 px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg border border-cyan-500/30 text-gray-300 hover:text-white transition-all duration-200"},[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M19 12H5M12 19L5 12L12 5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),I(" 返回 ",-1)])]),t[8]||(t[8]=e("h1",{class:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent"}," 项目管理 ",-1))]),e("div",se,[e("div",le,[e("div",ie,[$(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a),type:"text",placeholder:"搜索项目...",class:"w-full px-4 py-3 pl-12 bg-gray-800/50 border border-cyan-500/30 rounded-xl text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-2 focus:ring-cyan-400/20 focus:outline-none transition-all duration-200"},null,512),[[F,v.value]]),t[9]||(t[9]=e("div",{class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),e("button",{onClick:t[1]||(t[1]=a=>y.value=!0),class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-xl font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},[...t[10]||(t[10]=[e("span",{class:"flex items-center gap-2"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),I(" 新建项目 ")],-1)])])]),L.value.length>0?(m(),g("div",de,[(m(!0),g(X,null,Q(L.value,a=>(m(),g("div",{key:a.id,class:"pm-card bg-gray-800/50 backdrop-blur-sm border border-purple-500/30 rounded-xl p-6 hover:border-purple-400/50 transition-all duration-200 transform hover:scale-105 hover:shadow-lg hover:shadow-purple-500/20 flex flex-col"},[e("div",ue,[e("div",ce,[e("h3",ve,b(a.name),1),a.description?(m(),g("p",me,b(a.description),1)):N("",!0)]),e("div",pe,[e("button",{onClick:C=>q(a),class:"p-2 text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/20 rounded-lg transition-colors duration-200",title:"复制项目"},[...t[11]||(t[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h8a2 2 0 012 2v8M16 17H8a2 2 0 01-2-2V7m3 0V5a2 2 0 012-2h6a2 2 0 012 2v2"})],-1)])],8,fe),e("button",{onClick:C=>U(a),class:"p-2 text-blue-400 hover:text-blue-300 hover:bg-blue-500/20 rounded-lg transition-colors duration-200",title:"编辑项目"},[...t[12]||(t[12]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ge),e("button",{onClick:C=>K(a.id),class:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded-lg transition-colors duration-200",title:"删除项目"},[...t[13]||(t[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,be)])]),e("div",ye,[e("div",null,"创建时间: "+b(V(_)(a.createdAt)),1),e("div",null,"更新时间: "+b(V(_)(a.updatedAt)),1)]),e("button",{onClick:C=>V(h)(a),class:"mt-auto w-full px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"}," 进入编辑 ",8,we)]))),128))])):(m(),g("div",xe,[t[14]||(t[14]=e("div",{class:"w-24 h-24 mx-auto mb-6 bg-gray-800/50 rounded-full flex items-center justify-center"},[e("svg",{class:"w-12 h-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),e("h3",he,b(v.value?"未找到匹配的项目":"还没有项目"),1),e("p",ke,b(v.value?"尝试使用其他关键词搜索":"创建您的第一个可视化组件项目"),1),v.value?N("",!0):(m(),g("button",{key:0,onClick:t[2]||(t[2]=a=>y.value=!0),class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-xl font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"}," 创建项目 "))]))]),y.value?(m(),g("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:ee(P,["self"])},[e("div",_e,[e("h3",je,b(r.value?"编辑项目":"创建新项目"),1),e("div",Ce,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"项目名称",-1)),$(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>o.value=a),type:"text",placeholder:"输入项目名称...",class:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",onKeyup:t[4]||(t[4]=te(a=>r.value?j():w(),["enter"]))},null,544),[[F,o.value]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"项目描述（可选）",-1)),$(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value=a),placeholder:"输入项目描述...",rows:"3",class:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200 resize-none"},null,512),[[F,l.value]])])]),e("div",Pe,[e("button",{onClick:P,class:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-medium transition-colors duration-200"}," 取消 "),e("button",{onClick:t[6]||(t[6]=a=>r.value?j():w()),disabled:!o.value.trim(),class:"flex-1 px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 disabled:from-gray-600 disabled:to-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-all duration-200"},b(r.value?"保存":"创建"),9,De)])])])):N("",!0)]))}}),Be=re(Ae,[["__scopeId","data-v-75e9c3b4"]]),Me=R({__name:"index",setup(x){return(c,s)=>(m(),Y(Be))}}),Fe=Me;export{Fe as default};
