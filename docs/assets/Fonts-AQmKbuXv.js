import{E as c,O as T,R as $,_ as j,ct as w,f as p,h as E,l as t,lt as m,m as _,o as V,st as D,u as q,w as P}from"./codemirror-B25QCqWr.js";var U={class:"p-6 space-y-6 bg-gray-900 text-gray-100 min-h-full"},R={class:"relative group"},W={class:"relative bg-gray-800/50 backdrop-blur-sm border border-emerald-500/20 rounded-lg p-6 hover:border-emerald-400/40 transition-all duration-300"},H={class:"block cursor-pointer"},G={class:"relative"},K={class:"relative bg-gray-800/50 backdrop-blur-sm border border-purple-500/20 rounded-lg overflow-hidden"},J={class:"p-4 border-b border-gray-700/50"},Q={class:"font-bold text-lg bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent flex items-center"},X={key:0,class:"p-8 text-center"},Y={key:1,class:"divide-y divide-gray-700/50"},Z={class:"flex items-center justify-between"},ee={class:"flex-1"},te={class:"flex items-center space-x-3"},re={class:"w-10 h-10 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-lg flex items-center justify-center text-white font-bold text-sm"},oe={class:"font-semibold text-gray-100 group-hover:text-cyan-400 transition-colors duration-200"},ae={class:"text-xs text-gray-500 flex items-center space-x-2"},se=["onClick"],ne={class:"mt-3 p-3 bg-gray-900/50 rounded-lg border border-gray-700/30"},k="lowcode-fonts",i="fonts",le=j({__name:"FontLibraryManager",props:{projectId:{}},emits:["library:update"],setup(f,{emit:b}){const v=f;let d=null;function g(){return new Promise((a,e)=>{const r=indexedDB.open(k);r.onsuccess=()=>{const o=r.result;if(o.objectStoreNames.contains(i))a(o);else{const s=o.version+1;o.close();const n=indexedDB.open(k,s);n.onupgradeneeded=()=>{const l=n.result;l.objectStoreNames.contains(i)||l.createObjectStore(i,{keyPath:"id"})},n.onsuccess=()=>a(n.result),n.onerror=()=>e(n.error)}},r.onerror=()=>e(r.error)})}async function h(){const a=d||(d=await g());return new Promise((e,r)=>{const o=a.transaction(i,"readonly").objectStore(i).getAll();o.onsuccess=()=>{const s=o.result,n=v.projectId?s.filter(l=>l.projectId===v.projectId):s.filter(l=>!l.projectId);e(n)},o.onerror=()=>r(o.error)})}async function F(a){const e=d||(d=await g());return new Promise((r,o)=>{const s=e.transaction(i,"readwrite").objectStore(i).add(a);s.onsuccess=()=>r(),s.onerror=()=>o(s.error)})}async function M(a){const e=d||(d=await g());return new Promise((r,o)=>{const s=e.transaction(i,"readwrite").objectStore(i).delete(a);s.onsuccess=()=>r(),s.onerror=()=>o(s.error)})}const u=$([]),x=document.createElement("style");x.setAttribute("data-font-lib",""),document.head.appendChild(x);const B=b;function C(a,e){const r=a.trim();let o=r,s=2;for(;e.has(o.toLowerCase());)o=`${r}-${s}`,s++;return e.add(o.toLowerCase()),o}function L(a){const e=[],r=[];for(const o of a){const s=new Blob([o.buffer],{type:o.mime}),n=URL.createObjectURL(s),l=o.name;r.push(l),e.push(`@font-face { font-family: '${l}'; src: url('${n}'); font-weight: normal; font-style: normal; }`)}x.textContent=e.join(`
`),B("library:update",r)}async function y(){const a=await h();u.value=a,L(a)}async function S(a){const e=a.target,r=e.files;if(!r||r.length===0)return;const o=await h(),s=new Set(o.map(n=>n.name.toLowerCase()));for(const n of Array.from(r)){const l=await n.arrayBuffer(),I=n.name.replace(/\.(ttf|otf|woff2?|TTF|OTF|WOFF2?)$/,""),N=C(I,s),O={id:`${Date.now()}-${n.name}`,name:N,mime:n.type||"application/octet-stream",buffer:l,projectId:v.projectId};await F(O)}await y(),e.value=""}async function A(a){await M(a),await y()}function z(a){if(a===0)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,o)).toFixed(2))+" "+r[o]}return P(()=>{y()}),(a,e)=>(c(),p("div",U,[e[8]||(e[8]=_('<div class="relative"><div class="absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-blue-500/10 rounded-lg blur-xl"></div><div class="relative bg-gray-800/50 backdrop-blur-sm border border-cyan-500/20 rounded-lg p-4"><h2 class="font-bold text-xl bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent flex items-center"><svg class="w-6 h-6 mr-3 text-cyan-400" fill="currentColor" viewBox="0 0 20 20"><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path></svg> 字体库管理 </h2><p class="text-sm text-gray-400 mt-2 leading-relaxed"> 上传字体文件（ttf/otf/woff/woff2），将保存到本地并可在构建器中搜索选择。 <span class="text-cyan-400">默认已可搜索系统常用字体，无需手动设置。</span></p></div></div>',1)),t("div",R,[e[2]||(e[2]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-emerald-500/10 to-cyan-500/10 rounded-lg blur-xl group-hover:blur-2xl transition-all duration-300"},null,-1)),t("div",W,[t("label",H,[e[0]||(e[0]=_('<div class="flex items-center justify-center space-x-3 mb-4"><svg class="w-8 h-8 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg><span class="text-lg font-semibold text-emerald-400">上传字体文件</span></div><div class="text-center text-gray-400 text-sm mb-4"> 支持 TTF、OTF、WOFF、WOFF2 格式，可多选上传 </div>',2)),t("input",{type:"file",accept:".ttf,.otf,.woff,.woff2",multiple:"",onChange:S,class:"hidden"},null,32),e[1]||(e[1]=t("div",{class:"border-2 border-dashed border-emerald-500/30 rounded-lg p-8 text-center hover:border-emerald-400/50 transition-colors duration-300"},[t("div",{class:"text-emerald-400 font-medium"},"点击选择文件或拖拽到此处")],-1))])])]),t("div",G,[e[7]||(e[7]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg blur-xl"},null,-1)),t("div",K,[t("div",J,[t("h3",Q,[e[3]||(e[3]=t("svg",{class:"w-5 h-5 mr-2 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),E(" 已导入字体 ("+m(u.value.length)+") ",1)])]),u.value.length===0?(c(),p("div",X,[...e[4]||(e[4]=[t("svg",{class:"w-16 h-16 mx-auto text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})],-1),t("div",{class:"text-gray-500 text-lg font-medium mb-2"},"暂无导入字体",-1),t("div",{class:"text-gray-600 text-sm"},"上传字体文件开始使用",-1)])])):(c(),p("div",Y,[(c(!0),p(V,null,T(u.value,(r,o)=>(c(),p("div",{key:r.id,class:D(["p-4 hover:bg-gray-700/30 transition-all duration-200 group",{"animate-pulse":o===u.value.length-1}])},[t("div",Z,[t("div",ee,[t("div",te,[t("div",re,m(r.name.charAt(0).toUpperCase()),1),t("div",null,[t("div",oe,m(r.name),1),t("div",ae,[t("span",null,m(r.mime),1),e[5]||(e[5]=t("span",{class:"w-1 h-1 bg-gray-500 rounded-full"},null,-1)),t("span",null,m(z(r.buffer.byteLength)),1)])])])]),t("button",{onClick:s=>A(r.id),class:"px-4 py-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 hover:border-red-400/50 rounded-lg text-red-400 hover:text-red-300 transition-all duration-200 flex items-center space-x-2 group/btn"},[...e[6]||(e[6]=[t("svg",{class:"w-4 h-4 group-hover/btn:scale-110 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),t("span",{class:"text-sm font-medium"},"删除",-1)])],8,se)]),t("div",ne,[t("div",{class:"text-gray-300 text-lg",style:w({fontFamily:r.name})}," The quick brown fox jumps over the lazy dog ",4),t("div",{class:"text-gray-400 text-sm mt-1",style:w({fontFamily:r.name})}," 快速的棕色狐狸跳过懒狗 1234567890 ",4)])],2))),128))]))])])]))}}),ie=le,de=j({__name:"index",props:{projectId:{}},setup(f){const b=f;return(v,d)=>(c(),q(ie,{"project-id":b.projectId},null,8,["project-id"]))}}),ue=de;export{ue as default};
