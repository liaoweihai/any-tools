import{E as v,I as C,O as H,R as f,_ as M,c as T,d as J,f as g,h as W,l as e,lt as i,m as K,o as Q,u as X,w as Y}from"./codemirror-B25QCqWr.js";import{f as I}from"./vendor-vue-C93_ecI2.js";import{n as Z,t as ee}from"./index-Cl0CrogP.js";import"./componentStorage-DB4dbTb9.js";import{t as te}from"./useProjectResources-T0rK66Sv.js";var re={class:"p-6 space-y-6 bg-gray-900 text-gray-100 min-h-full"},ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},le={class:"relative"},oe={class:"relative bg-gray-800/50 backdrop-blur-sm border border-blue-500/20 rounded-lg p-4"},se={class:"flex items-center space-x-3"},ne={class:"relative group"},ie={class:"relative bg-gray-800/50 backdrop-blur-sm border border-emerald-500/20 rounded-lg p-4 hover:border-emerald-400/40 transition-all duration-300"},de={class:"block cursor-pointer"},ue={class:"relative"},ve={class:"relative bg-gray-800/50 backdrop-blur-sm border border-purple-500/20 rounded-lg overflow-hidden"},ce={class:"p-4 border-b border-gray-700/50"},ge={class:"font-bold text-lg bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent flex items-center"},pe={key:0,class:"p-8 text-center"},me={class:"text-gray-500 text-lg font-medium mb-2"},be={class:"text-gray-600 text-sm"},fe={key:1,class:"max-h-96 overflow-y-auto custom-scrollbar"},he={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 p-4"},xe={class:"aspect-square bg-gray-800/50 rounded-lg mb-3 flex items-center justify-center overflow-hidden"},ye=["src","alt"],_e={class:"space-y-1"},we=["title"],ke={class:"text-xs text-gray-500 space-y-0.5"},Be={class:"flex space-x-1 mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200"},je=["onClick"],Ce=["onClick"],Ie={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Me={class:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4 border border-gray-600"},Le={class:"space-y-4"},ze={class:"text-sm text-gray-500"},Ne=M({__name:"IconLibraryManager",props:{projectId:{}},emits:["library:update"],setup(h,{emit:x}){const _=h,{icons:w,refreshIcons:L,saveIcons:z,updateIconName:N,deleteIcon:U}=te(String(_.projectId||"")),u=f([]),c=f(""),n=f(null),m=f(!1),E=x,y=T(()=>{if(!c.value.trim())return u.value;const r=c.value.toLowerCase();return u.value.filter(t=>t.name.toLowerCase().includes(r)||t.originalName.toLowerCase().includes(r))});function $(r,t){let o=r,l=1;for(;t.includes(o);)o=`${r}${l}`,l++;return o}function V(r){return new Promise((t,o)=>{const l=new Image,a=URL.createObjectURL(r);l.onload=()=>{URL.revokeObjectURL(a),t({width:l.width,height:l.height})},l.onerror=()=>{URL.revokeObjectURL(a),o(new Error("无法加载图片"))},l.src=a})}function R(){u.value=w.value.map(r=>{const t=r.bufferBase64||"",o=t.startsWith("data:")?t:`data:${r.mime};base64,${t}`;return{id:r.id,name:r.name,originalName:r.originalName,mime:r.mime,width:r.width,height:r.height,size:r.size,url:o}})}async function b(){await L(),R(),E("library:update",u.value)}async function S(r){const t=r.target,o=t.files;if(!o||o.length===0)return;const l=u.value.map(a=>a.name);for(const a of Array.from(o))try{const d=await a.arrayBuffer(),s=await V(a),p=a.name.replace(/\.(png|jpg|jpeg|gif|svg|webp|PNG|JPG|JPEG|GIF|SVG|WEBP)$/,""),B=$(p,l);l.push(B);const D=A(d),j=a.type||"application/octet-stream",O=`data:${j};base64,${D}`;await z([{name:B,originalName:a.name,mime:j,width:s.width,height:s.height,size:a.size,bufferBase64:O}])}catch(d){console.error(`上传图标 ${a.name} 失败:`,d)}await b(),t.value=""}async function G(r){await U(r),await b()}function P(r){n.value={...r},m.value=!0}async function F(){if(n.value){if(u.value.filter(r=>r.id!==n.value.id).map(r=>r.name).includes(n.value.name)){Z("图标名称已存在，请使用其他名称","warning");return}await N(n.value.id,n.value.name),await b(),m.value=!1,n.value=null}}function q(){m.value=!1,n.value=null}function k(r){if(r===0)return"0 Bytes";const t=1024,o=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(r)/Math.log(t));return parseFloat((r/Math.pow(t,l)).toFixed(2))+" "+o[l]}Y(()=>{b()});function A(r){const t=new Uint8Array(r);let o="";const l=32768;for(let a=0;a<t.length;a+=l){const d=t.subarray(a,a+l);o+=String.fromCharCode.apply(null,Array.from(d))}return btoa(o)}return(r,t)=>{var o,l,a,d;return v(),g("div",re,[t[12]||(t[12]=K('<div class="relative" data-v-348aa10f><div class="absolute inset-0 bg-gradient-to-r from-orange-500/10 to-red-500/10 rounded-lg blur-xl" data-v-348aa10f></div><div class="relative bg-gray-800/50 backdrop-blur-sm border border-orange-500/20 rounded-lg p-4" data-v-348aa10f><h2 class="font-bold text-xl bg-gradient-to-r from-orange-400 to-red-400 bg-clip-text text-transparent flex items-center" data-v-348aa10f><svg class="w-6 h-6 mr-3 text-orange-400" fill="currentColor" viewBox="0 0 20 20" data-v-348aa10f><path d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" data-v-348aa10f></path></svg> 图标库管理 </h2><p class="text-sm text-gray-400 mt-2 leading-relaxed" data-v-348aa10f> 上传图标文件（png/jpg/gif/svg/webp），将保存到本地并可在构建器中使用。 <span class="text-orange-400" data-v-348aa10f>支持自动命名和重复处理。</span></p></div></div>',1)),e("div",ae,[e("div",le,[t[4]||(t[4]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg blur-xl"},null,-1)),e("div",oe,[e("div",se,[t[3]||(t[3]=e("svg",{class:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),C(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),type:"text",placeholder:"搜索图标...",class:"flex-1 bg-transparent border-none outline-none text-gray-100 placeholder-gray-500"},null,512),[[I,c.value]])])])]),e("div",ne,[t[6]||(t[6]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-emerald-500/10 to-cyan-500/10 rounded-lg blur-xl group-hover:blur-2xl transition-all duration-300"},null,-1)),e("div",ie,[e("label",de,[t[5]||(t[5]=e("div",{class:"flex items-center justify-center space-x-3"},[e("svg",{class:"w-6 h-6 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})]),e("span",{class:"font-semibold text-emerald-400"},"上传图标")],-1)),e("input",{type:"file",accept:"image/*",multiple:"",onChange:S,class:"hidden"},null,32)])])])]),e("div",ue,[t[9]||(t[9]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg blur-xl"},null,-1)),e("div",ve,[e("div",ce,[e("h3",ge,[t[7]||(t[7]=e("svg",{class:"w-5 h-5 mr-2 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),W(" 图标库 ("+i(y.value.length)+"/"+i(u.value.length)+") ",1)])]),y.value.length===0?(v(),g("div",pe,[t[8]||(t[8]=e("svg",{class:"w-16 h-16 mx-auto text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("div",me,i(c.value?"未找到匹配的图标":"暂无图标"),1),e("div",be,i(c.value?"尝试其他搜索关键词":"上传图标文件开始使用"),1)])):(v(),g("div",fe,[e("div",he,[(v(!0),g(Q,null,H(y.value,s=>(v(),g("div",{key:s.id,class:"bg-gray-700/30 rounded-lg p-3 hover:bg-gray-700/50 transition-all duration-200 group border border-gray-600/30 hover:border-purple-400/50"},[e("div",xe,[e("img",{src:s.url,alt:s.name,class:"max-w-full max-h-full object-contain",loading:"lazy",onError:t[1]||(t[1]=p=>{p.target.style.display="none"})},null,40,ye)]),e("div",_e,[e("div",{class:"font-medium text-gray-100 text-sm truncate",title:s.name},i(s.name),9,we),e("div",ke,[e("div",null,i(s.width)+"×"+i(s.height),1),e("div",null,i(k(s.size)),1)])]),e("div",Be,[e("button",{onClick:p=>P(s),class:"flex-1 px-2 py-1 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 hover:border-blue-400/50 rounded text-blue-400 hover:text-blue-300 transition-all duration-200 text-xs"}," 编辑 ",8,je),e("button",{onClick:p=>G(s.id),class:"flex-1 px-2 py-1 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 hover:border-red-400/50 rounded text-red-400 hover:text-red-300 transition-all duration-200 text-xs"}," 删除 ",8,Ce)])]))),128))])]))])]),m.value?(v(),g("div",Ie,[e("div",Me,[t[11]||(t[11]=e("h3",{class:"text-lg font-bold text-gray-100 mb-4"},"编辑图标",-1)),e("div",Le,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm text-gray-400 mb-2"},"图标名称",-1)),C(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.name=s),type:"text",class:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:border-blue-400 focus:outline-none",placeholder:"输入图标名称"},null,512),[[I,n.value.name]])]),e("div",ze,[e("div",null,"原始文件名: "+i((o=n.value)==null?void 0:o.originalName),1),e("div",null,"尺寸: "+i((l=n.value)==null?void 0:l.width)+"×"+i((a=n.value)==null?void 0:a.height),1),e("div",null,"大小: "+i(k(((d=n.value)==null?void 0:d.size)||0)),1)])]),e("div",{class:"flex space-x-3 mt-6"},[e("button",{onClick:F,class:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors duration-200"}," 保存 "),e("button",{onClick:q,class:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors duration-200"}," 取消 ")])])])):J("",!0)])}}}),Ue=ee(Ne,[["__scopeId","data-v-348aa10f"]]),Ee=M({__name:"index",props:{projectId:{}},setup(h){const x=h;return(_,w)=>(v(),X(Ue,{"project-id":x.projectId},null,8,["project-id"]))}}),Pe=Ee;export{Pe as default};
