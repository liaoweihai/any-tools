import{i as cl}from"./rolldown-runtime-CKFmjIRy.js";import{C as _r,E as z,H as hl,I as ue,L as rl,O as _t,P as yt,R as xe,S as vl,_ as Dt,c as Ge,ct as lt,d as ee,f as O,g as dt,h as cr,i as wl,l as r,lt as et,m as Tr,n as $l,o as Bt,r as El,st as Ve,t as kl,u as pl,w as Wr}from"./codemirror-B25QCqWr.js";import{d as nl,f as $e,h as fl,m as Vr,n as Sl,o as Ml,p as Cl,r as Nl,s as Il,u as Pr}from"./vendor-vue-C93_ecI2.js";import{t as Jr}from"./index-Cl0CrogP.js";import{t as Xe}from"./componentStorage-DB4dbTb9.js";import"./echarts-xBohgwka.js";import{t as Fl}from"./DraggableBox-DHO7vz0U.js";function Lr(x){return x.replace(/[&<>"']/g,o=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[o]||o)}function jl(x){var d,$;const o=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||0)}px`),e.push(`top:${Math.round(x.top||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),o.opacity!==void 0&&e.push(`opacity:${o.opacity}`),o.border&&e.push(`border:${o.border}`),o.borderRadius&&e.push(`border-radius:${o.borderRadius}`),o.backgroundColor&&e.push(`background-color:${o.backgroundColor}`),o.boxShadow&&e.push(`box-shadow:${o.boxShadow}`),o.backgroundGradient&&((d=o.backgroundGradient.colors)!=null&&d.length)){const I=o.backgroundGradient.angle||0,H=o.backgroundGradient.colors[0]||"#000000",ne=o.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${I}deg, ${H}, ${ne})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"){o.fontFamily&&e.push(`font-family:${o.fontFamily}`),o.fontSize!==void 0&&e.push(`font-size:${o.fontSize}px`),o.color&&e.push(`color:${o.color}`),o.fontWeight&&e.push(`font-weight:${o.fontWeight}`),o.letterSpacing!==void 0&&o.letterSpacing!==null&&e.push(`letter-spacing:${o.letterSpacing}px`),o.lineHeight!==void 0&&e.push(`line-height:${o.lineHeight}`),o.fontStyle&&e.push(`font-style:${o.fontStyle}`),o.textAlign&&e.push(`text-align:${o.textAlign}`),o.textDecoration&&e.push(`text-decoration:${o.textDecoration}`);const I=o.textOrientation;if(I==="vertical"?(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")):I==="horizontal"&&e.push("writing-mode:horizontal-tb"),o.textGradient&&(($=o.textGradient.colors)!=null&&$.length)){const H=o.textGradient.angle||0,ne=o.textGradient.colors[0]||"#000000",he=o.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${H}deg, ${ne}, ${he})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}}return x.type==="image"&&o.objectFit&&e.push(`object-fit:${o.objectFit}`),e.join(";")}function gl(x){return String(x).split(";").map(o=>o.trim()).filter(Boolean).map(o=>o.includes("!important")?o:`${o} !important`).join("; ")}function Al(x){return String(x).replace(/\{([^}]*)\}/g,(o,e)=>`{ ${gl(e)} }`)}function zl(x){const o=[],e=d=>{d.forEach($=>{if($.type==="group"&&Array.isArray($.children))e($.children);else{const I=($.className||"").trim(),H=$.customClassCss?String($.customClassCss).trim():"";if(!I||!H)return;/\{[^}]*\}/.test(H)?o.push(Al(H)):o.push(`.${I} { ${gl(H)} }`)}})};return e(x),o.join(`
`)}function ll(x,o,e,d,$){const I=x.replace(/[^A-Za-z0-9_]/g,"_");let H=0;const ne=[],he=[],C=o.backgroundUrl||"",ye=o.backgroundColor||"transparent",W=o.globalFontFamily||"",X=o.globalFontSize||14,ae=o.globalColor||"#000000",Ee=e.some(y=>y.type==="chart");function U(y){const Q=String(y||"").trim();if(!Q)return"";let J=Q.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(J[0]||"")||(J="_"+J),J}function p(y){if(!y.hidden)return"";const Q=U(y.hiddenLabel);return Q?` ${d&&d.hideDirective==="show"?"v-show":"v-if"}="${Q}"`:""}function P(y,Q){var Le,Pe,Ye,rt,ut,ct,St,Ie,pe,pt,ft,bt,vt,Mt,He;const J=jl(y),h=y.zIndex||1,t=y.className&&y.className.trim()?` class="${y.className.trim()}"`:"",K=y.eventBinding,Y=K&&K.enabled&&K.handlerName?` @click="${String(K.handlerName)}($event)"`:"";if(y.type==="group"&&Array.isArray(y.children)){const ke=y.children.map((Re,Ke)=>P(Re,Ke)).join(`
        `);return`<div${t}${p(y)} style="${J};z-index:${h}">
        ${ke}
      </div>`}if(y.type==="text"){const ke=(()=>{var Je;const We=((Je=y.style)==null?void 0:Je.textAlign)||"left";return We==="center"?"text-flex-center":We==="right"?"text-flex-right":"text-flex-left"})(),Re=[(Le=y.className)==null?void 0:Le.trim(),ke].filter(Boolean).join(" "),Ke=Re?` class="${Re}"`:"",De=y.style||{},at=y.elementId&&y.elementId.trim()?y.elementId.trim():`text_${Q}`,Ze=!!(De.textWave&&De.textWave.enabled),gt=!!De.skewFlowEnabled;if(Ze||gt){const We=y.dynamic&&y.dynamic.enabled&&y.dynamic.objectName&&y.dynamic.propertyPath?{type:"dynamic",obj:y.dynamic.objectName,path:y.dynamic.propertyPath}:{type:"static",text:y.text||""};ne.push(`'${at.replace(/'/g,"\\'")}' : ${JSON.stringify(We)}`);const Je={textWaveEnabled:Ze,amplitude:(Ye=(Pe=De.textWave)==null?void 0:Pe.amplitude)!=null?Ye:0,frequency:(ut=(rt=De.textWave)==null?void 0:rt.frequency)!=null?ut:0,phase:(St=(ct=De.textWave)==null?void 0:ct.phase)!=null?St:0,skewFlowEnabled:gt,skewAngle:(Ie=De.skewAngle)!=null?Ie:0,textOrientation:De.textOrientation||"horizontal",fontSize:(pe=De.fontSize)!=null?pe:X,letterSpacing:(pt=De.letterSpacing)!=null?pt:0};return he.push(`'${at.replace(/'/g,"\\'")}' : ${JSON.stringify(Je)}`),`<div${Ke}${p(y)}${Y} style="${J};z-index:${h}">
        <span v-for="(p,pi) in getTextPieces('${at.replace(/'/g,"\\'")}')" :key="pi" :style="p.style">{{ p.char }}</span>
      </div>`}if(y.dynamic&&y.dynamic.enabled&&y.dynamic.objectName&&y.dynamic.propertyPath){const We=`${y.dynamic.objectName}.${y.dynamic.propertyPath}`;return`<div${Ke}${p(y)}${Y} style="${J};z-index:${h}">{{ ${We} }}</div>`}else{const We=Lr(y.text||"");return`<div${Ke}${p(y)}${Y} style="${J};z-index:${h}">${We}</div>`}}if(y.type==="image"){if(d!=null&&d.imageFileMap&&d.imageFileMap[y.id]){const Ke=d.imageFileMap[y.id],De=y.elementId&&y.elementId.trim()?` id="${y.elementId.trim()}"`:"";return`<img${t}${De}${p(y)}${Y} src="./imgs/${Ke}" style="${J};z-index:${h}" alt="" />`}if(d!=null&&d.imageFileNames&&d.imageFileNames[H]){const Ke=d.imageFileNames[H++],De=y.elementId&&y.elementId.trim()?` id="${y.elementId.trim()}"`:"";return`<img${t}${De}${p(y)}${Y} src="./imgs/${Ke}" style="${J};z-index:${h}" alt="" />`}const ke=y.elementId&&y.elementId.trim()?y.elementId.trim():`img_${Q}`,Re=y.elementId&&y.elementId.trim()?` id="${y.elementId.trim()}"`:"";return`<img${t}${Re}${p(y)}${Y} :src="images['${ke}']" style="${J};z-index:${h}" alt="" />`}if(y.type==="chart"){const ke=Lr(y.text||"chart"),Re=y.elementId&&y.elementId.trim()?y.elementId.trim():`chart_${Q}`;return`<div${t}${p(y)}${Y} id="${Re}" style="${J};z-index:${h}">${ke}</div>`}if(y.type==="container"){const ke=y.elementId&&y.elementId.trim()?` id="${y.elementId.trim()}"`:"",Re=Lr(y.text||"");return`<div${t}${p(y)}${Y}${ke} style="${J};z-index:${h}">${Re}</div>`}if(y.type==="line"){const ke=y.style||{},Re=ke.lineColor||"#ffffff",Ke=(ft=ke.lineThickness)!=null?ft:2,De=ke.lineOrientation||"horizontal",at=ke.lineStyle==="dashed",Ze=(bt=ke.lineDashLength)!=null?bt:6,gt=(vt=ke.lineDashGap)!=null?vt:4,We=Math.max(1,Math.round((Mt=y.width)!=null?Mt:De==="horizontal"?200:2)),Je=Math.max(1,Math.round((He=y.height)!=null?He:De==="horizontal"?2:200)),Ct=Math.round(Je/2),Nt=Math.round(We/2),It=at?` stroke-dasharray="${Ze} ${gt}"`:"";return De==="horizontal"?`<svg${t}${p(y)}${Y} viewBox="0 0 ${We} ${Je}" preserveAspectRatio="none" style="${J};z-index:${h}"><line x1="0" y1="${Ct}" x2="${We}" y2="${Ct}" stroke="${Re}" stroke-width="${Ke}"${It} fill="none" /></svg>`:`<svg${t}${p(y)}${Y} viewBox="0 0 ${We} ${Je}" preserveAspectRatio="none" style="${J};z-index:${h}"><line x1="${Nt}" y1="0" x2="${Nt}" y2="${Je}" stroke="${Re}" stroke-width="${Ke}"${It} fill="none" /></svg>`}const qe=Lr(y.text||"element");return`<div${t}${p(y)}${Y} style="${J};z-index:${h}">${qe}</div>`}const V=e.map((y,Q)=>P(y,Q)).join(`
      `),re=zl(e);function R(y,Q){y.forEach(J=>{J.type==="group"&&Array.isArray(J.children)?(Q(J),R(J.children,Q)):Q(J)})}const _=new Set;R(e,y=>{y.type==="text"&&y.dynamic&&y.dynamic.enabled&&y.dynamic.objectName&&_.add(String(y.dynamic.objectName))});const T=Array.from(_),D=!$||T.length===0?"":T.map(y=>{try{const Q=$[y],J=JSON.stringify(Q!=null?Q:{});return`      ${y}: ${J},`}catch{return`      ${y}: {},`}}).join(`
`),ce=(()=>{const y=[];let Q=0;return R(e,J=>{if(J.type==="chart"){const h=J.elementId&&J.elementId.trim()?J.elementId.trim():`chart_${Q}`;Q++;const t=J.chartOption||{};try{y.push(`'${h.replace(/'/g,"\\'")}' : ${JSON.stringify(t)}`)}catch{y.push(`'${h.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${y.join(", ")} }`})(),be=(()=>{const y=new Set;return R(e,Q=>{const J=String(Q.hiddenLabel||"").trim(),h=U(J),t=!!Q.hidden;h&&t&&y.add(h)}),Array.from(y).map(Q=>`      ${Q}: false,`).join(`
`)})(),Fe=(()=>{const y=new Map;function Q(h){h.forEach(t=>{const K=t.eventBinding;K&&K.enabled&&K.handlerName&&y.set(String(K.handlerName),String(K.code||"")),Array.isArray(t.children)&&Q(t.children)})}Q(e);const J=Array.from(y.entries());return J.length?J.map(([h,t])=>`${h}(e) {
${t}
}`).join(`,
`):""})();return`
<template>
  <div class="container" :style="containerStyle">
    ${V}
  </div>
</template>

<script>
${Ee?`import * as echarts from 'echarts';
`:""}
export default {
  name: '${I}',
  data() {
    return {
      config: {
        width: ${Math.round(o.width)},
        height: ${Math.round(o.height)},
        backgroundColor: '${ye.replace(/'/g,"\\'")}',
        globalFontFamily: '${W.replace(/'/g,"\\'")}',
        globalFontSize: ${Math.round(X)},
        globalColor: '${ae}',
      },
      backgroundUrl: ${d!=null&&d.backgroundFileName?`(() => { try { return require('./imgs/${d.backgroundFileName.replace(/'/g,"\\'")}'); } catch(e) { return './imgs/${d.backgroundFileName.replace(/'/g,"\\'")}'; } })()`:`'${C.replace(/'/g,"\\'")}'`},
      ${d!=null&&d.imageFileNames?`// 使用本地资源路径，动态映射不再需要
      images: {},`:`// 图片 src 动态映射，初始写入 base64（若存在），blob 留空待替换
      images: {},`}
      // 图表配置导出，键为元素ID或序号
      chartOptions: ${ce},
      ${D?`// 数据库对象（按页面引用注入到 data）
${D}`:""}
      ${ne.length?`// 文本数据源映射（支持静态/动态）
      textSources: { ${ne.join(", ")} },`:""}
      ${he.length?`// 文本效果参数映射（波形与倾斜跟随）
      textEffects: { ${he.join(", ")} },`:""}
      ${be}
    };
  },
  computed: {
    containerStyle() {
      const base = {
        position: 'relative',
        width: this.config.width + 'px',
        height: this.config.height + 'px',
        fontFamily: this.config.globalFontFamily,
        fontSize: this.config.globalFontSize + 'px',
        color: this.config.globalColor,
        backgroundColor: this.config.backgroundColor || 'transparent',
      };
      if (this.backgroundUrl) {
        return Object.assign({}, base, {
          backgroundImage: 'url(' + this.backgroundUrl + ')',
          backgroundSize: 'cover',
          backgroundRepeat: 'no-repeat',
        });
      }
      return base;
    }
  },
  methods: {
    getByPath(obj, path) {
      try {
        const segs = String(path).split('.');
        return segs.reduce((acc, k) => (acc ? acc[k] : undefined), obj);
      } catch(e) {
        return undefined;
      }
    },
    getTextValue(id) {
      const srcMap = this.textSources || {};
      const src = srcMap[id];
      if (!src) return '';
      if (src.type === 'static') return String(src.text || '');
      const root = this[src.obj] || {};
      const v = this.getByPath(root, src.path);
      return v != null ? String(v) : '';
    },
    getTextPieces(id) {
      const text = this.getTextValue(id);
      const effMap = this.textEffects || {};
      const eff = effMap[id] || {};
      const orientation = eff.textOrientation || 'horizontal';
      const fontSize = Number(eff.fontSize || (this.config && this.config.globalFontSize) || 14);
      const letterSpacing = Number(eff.letterSpacing || 0);
      const step = fontSize * 0.6 + letterSpacing;

      const amp = eff.textWaveEnabled ? Number(eff.amplitude || 0) : 0;
      const freq = eff.textWaveEnabled ? Number(eff.frequency || 0) : 0;
      const phase = eff.textWaveEnabled ? Number(eff.phase || 0) : 0;

      const skewAngle = eff.skewFlowEnabled ? Number(eff.skewAngle || 0) : 0;
      const tan = Math.tan(skewAngle * Math.PI / 180);

      const pieces = [];
      for (let i = 0; i < text.length; i++) {
        const ch = text[i];
        const wave = amp ? amp * Math.sin(i * freq + phase) : 0;
        let dx = 0, dy = 0;
        if (orientation === 'horizontal') {
          dy += wave;
          dy += tan * step * i;
        } else {
          dx += wave;
          dx += tan * step * i;
        }
        const style = 'display:inline-block;white-space:pre;transform: translate(' + Math.round(dx) + 'px, ' + Math.round(dy) + 'px);';
        pieces.push({ char: ch, style });
      }
      return pieces;
    }${Fe?`,
${Fe}`:""}
  },
  mounted() {
    // 使用 npm 依赖的 echarts 初始化图表实例
    Object.keys(this.chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) {
        const inst = echarts.init(el);
        inst.setOption(this.chartOptions[id], true);
      }
    });
  }
};
<\/script>

${d!=null&&d.fontFaces&&d.fontFaces.length>0?`
<style>
${d.fontFaces.map(y=>`@font-face { font-family: '${y.family.replace(/'/g,"\\'")}'; src: url('./fonts/${y.file}'); font-weight: normal; font-style: normal; }`).join(`
`)}
</style>
`:""}
<style scoped>
.container { box-sizing: border-box; }
/* 文本对齐公共样式，减少重复的内联 CSS */
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${re}
</style>
`}function Hr(x){return x.replace(/[&<>"']/g,o=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[o]||o)}function Ol(x){var $,I;const o=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||0)}px`),e.push(`top:${Math.round(x.top||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),o.opacity!==void 0&&e.push(`opacity:${o.opacity}`),o.border&&e.push(`border:${o.border}`),o.borderRadius&&e.push(`border-radius:${o.borderRadius}`),o.backgroundColor&&e.push(`background-color:${o.backgroundColor}`),o.boxShadow&&e.push(`box-shadow:${o.boxShadow}`),o.backgroundGradient&&(($=o.backgroundGradient.colors)!=null&&$.length)){const H=o.backgroundGradient.angle||0,ne=o.backgroundGradient.colors[0]||"#000000",he=o.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${H}deg, ${ne}, ${he})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"&&(o.fontFamily&&e.push(`font-family:${o.fontFamily}`),o.fontSize!==void 0&&e.push(`font-size:${o.fontSize}px`),o.color&&e.push(`color:${o.color}`),o.fontWeight&&e.push(`font-weight:${o.fontWeight}`),o.letterSpacing!==void 0&&o.letterSpacing!==null&&e.push(`letter-spacing:${o.letterSpacing}px`),o.lineHeight!==void 0&&e.push(`line-height:${o.lineHeight}`),o.fontStyle&&e.push(`font-style:${o.fontStyle}`),o.textAlign&&e.push(`text-align:${o.textAlign}`),o.textDecoration&&e.push(`text-decoration:${o.textDecoration}`),o.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),o.textGradient&&((I=o.textGradient.colors)!=null&&I.length))){const H=o.textGradient.angle||0,ne=o.textGradient.colors[0]||"#000000",he=o.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${H}deg, ${ne}, ${he})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}x.type==="image"&&o.objectFit&&e.push(`object-fit:${o.objectFit}`);const d=x.eventBinding;return d&&d.enabled&&d.cursor&&e.push(`cursor:${d.cursor}`),e.join(";")}function ml(x){return String(x).split(";").map(o=>o.trim()).filter(Boolean).map(o=>o.includes("!important")?o:`${o} !important`).join("; ")}function Bl(x){return String(x).replace(/\{([^}]*)\}/g,(o,e)=>`{ ${ml(e)} }`)}function Dl(x){const o=[],e=d=>{d.forEach($=>{if($.type==="group"&&Array.isArray($.children))e($.children);else{const I=($.className||"").trim(),H=$.customClassCss?String($.customClassCss).trim():"";if(!I||!H)return;/\{[^}]*\}/.test(H)?o.push(Bl(H)):o.push(`.${I} { ${ml(H)} }`)}})};return e(x),o.join(`
`)}function yl(x){const o=String(x||"").trim();if(!o)return"";let e=o.replace(/[^A-Za-z0-9_]/g,"_");return/[A-Za-z_]/.test(e[0]||"")||(e="_"+e),e}function Gl(x,o){if(!x.hidden)return"";const e=yl(x.hiddenLabel);return e?` ${o!=null&&o.useShow?"v-show":"v-if"}="${e}"`:""}function ol(x,o,e,d){let $=0;const I=e.some(p=>p.type==="chart");function H(p,P){var ce,be,Fe,y,Q;const V=Ol(p),re=p.zIndex||1,R=p.className&&p.className.trim()?` class="${p.className.trim()}"`:"",_=Gl(p,{useShow:(d==null?void 0:d.hideDirective)==="show"}),T=p.eventBinding,D=T&&T.enabled&&T.handlerName?` @click="${String(T.handlerName)}($event)"`:"";if(p.type==="group"&&Array.isArray(p.children)){const J=p.children.map((h,t)=>H(h,t)).join(`
        `);return`<div${R}${_}${D} style="${V};z-index:${re}">
        ${J}
      </div>`}if(p.type==="text"){const J=Hr(p.text||"");return`<div${R}${_}${D} style="${V};z-index:${re}">${J}</div>`}if(p.type==="image"){if(d!=null&&d.imageFileMap&&d.imageFileMap[p.id]){const J=d.imageFileMap[p.id],h=p.elementId&&p.elementId.trim()?` id="${p.elementId.trim()}"`:"";return`<img${R}${h}${_}${D} :src="assetUrl('./imgs/${J}')" style="${V};z-index:${re}" alt="" />`}if(d!=null&&d.imageFileNames&&d.imageFileNames[$]){const J=d.imageFileNames[$++],h=p.elementId&&p.elementId.trim()?` id="${p.elementId.trim()}"`:"";return`<img${R}${h}${_}${D} :src="assetUrl('./imgs/${J}')" style="${V};z-index:${re}" alt="" />`}return`<div${R}${_}${D} style="${V};z-index:${re}"></div>`}if(p.type==="line"){const J=p.style||{},h=J.lineColor||"#ffffff",t=(ce=J.lineThickness)!=null?ce:2,K=J.lineOrientation||"horizontal",Y=J.lineStyle==="dashed",qe=(be=J.lineDashLength)!=null?be:6,Le=(Fe=J.lineDashGap)!=null?Fe:4,Pe=Math.max(1,Math.round((y=p.width)!=null?y:K==="horizontal"?200:2)),Ye=Math.max(1,Math.round((Q=p.height)!=null?Q:K==="horizontal"?2:200)),rt=Math.round(Ye/2),ut=Math.round(Pe/2),ct=Y?` stroke-dasharray="${qe} ${Le}"`:"";return K==="horizontal"?`<svg${R}${_}${D} viewBox="0 0 ${Pe} ${Ye}" preserveAspectRatio="none" style="${V};z-index:${re}"><line x1="0" y1="${rt}" x2="${Pe}" y2="${rt}" stroke="${h}" stroke-width="${t}"${ct} fill="none" /></svg>`:`<svg${R}${_}${D} viewBox="0 0 ${Pe} ${Ye}" preserveAspectRatio="none" style="${V};z-index:${re}"><line x1="${ut}" y1="0" x2="${ut}" y2="${Ye}" stroke="${h}" stroke-width="${t}"${ct} fill="none" /></svg>`}if(p.type==="chart"){const J=p.elementId&&p.elementId.trim()?p.elementId.trim():`chart_${P}`,h=Hr(p.text||"chart");return`<div${R}${_}${D} id="${J}" style="${V};z-index:${re}">${h}</div>`}return`<div${R}${_}${D} style="${V};z-index:${re}">${Hr(p.text||"")}</div>`}const ne=e.map((p,P)=>H(p,P)).join(`
      `),he=Dl(e),C=o.backgroundUrl||"",ye=o.backgroundColor||"transparent",W=o.globalFontFamily||"",X=o.globalFontSize||14,ae=o.globalColor||"#000000",Ee=(()=>{const p=[];let P=0;return e.forEach(V=>{if(V.type==="chart"){const re=V.elementId&&V.elementId.trim()?V.elementId.trim():`chart_${P}`;P++;const R=V.chartOption||{};try{p.push(`'${re.replace(/'/g,"\\'")}' : ${JSON.stringify(R)}`)}catch{p.push(`'${re.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${p.join(", ")} }`})(),U=(()=>{const p=new Set;return e.forEach(P=>{const V=String(P.hiddenLabel||"").trim(),re=yl(V),R=!!P.hidden;re&&R&&p.add(re)}),Array.from(p).map(P=>`const ${P} = ref(false)`).join(`
`)})();return`
<template>
  <div class="container" :style="containerStyle">
    ${ne}
  </div>
</template>

<script setup lang="ts">
import { onMounted, ref, computed } from 'vue'
${I?`import * as echarts from 'echarts'
`:""}
function assetUrl(p: string): string { try { return new URL(p, import.meta.url).href } catch { return p } }
const config = {
  width: ${Math.round(o.width)},
  height: ${Math.round(o.height)},
  backgroundColor: '${ye.replace(/'/g,"\\'")}',
  globalFontFamily: '${W.replace(/'/g,"\\'")}',
  globalFontSize: ${Math.round(X)},
  globalColor: '${ae}',
}
const backgroundUrl: string = ${d!=null&&d.backgroundFileName?`assetUrl('./imgs/${String(d.backgroundFileName).replace(/'/g,"\\'")}')`:`'${C.replace(/'/g,"\\'")}'`}
const images: Record<string, string> = {}
${I?`const chartOptions: Record<string, any> = ${Ee}`:""}
${U?`${U}
`:""}
const containerStyle = computed(() => {
  const base: Record<string, string> = {
    position: 'relative',
    width: config.width + 'px',
    height: config.height + 'px',
    fontFamily: config.globalFontFamily,
    fontSize: config.globalFontSize + 'px',
    color: config.globalColor,
    backgroundColor: (config.backgroundColor || 'transparent') as string,
  }
  if (backgroundUrl) {
    return Object.assign({}, base, {
      backgroundImage: 'url(' + backgroundUrl + ')',
      backgroundSize: 'cover',
      backgroundRepeat: 'no-repeat',
    }) as Record<string, string>
  }
  return base
})
// 事件处理函数
${(()=>{const p=new Map;return e.forEach(P=>{const V=P.eventBinding;V&&V.enabled&&V.handlerName&&p.set(String(V.handlerName),String(V.code||"")),Array.isArray(P.children)&&P.children.forEach(re=>{const R=re.eventBinding;R&&R.enabled&&R.handlerName&&p.set(String(R.handlerName),String(R.code||""))})}),Array.from(p.entries()).map(([P,V])=>`function ${P}(e: MouseEvent){
${V}
}`).join(`
`)})()}
${I?`onMounted(() => {
  Object.keys(chartOptions || {}).forEach((id) => {
    const el = document.getElementById(id)
    if (el && (echarts as any)) { const inst = (echarts as any).init(el); inst.setOption((chartOptions as any)[id], true) }
  })
})`:""}
<\/script>

<style scoped>
.container { box-sizing: border-box; }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${he}
</style>
`}function ur(x){return String(x).replace(/[&<>"']/g,o=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[o]||o)}function Ul(x){const o=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||x.x||0)}px`),e.push(`top:${Math.round(x.top||x.y||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),o.opacity!==void 0&&e.push(`opacity:${o.opacity}`),o.border&&e.push(`border:${o.border}`),o.borderRadius&&e.push(`border-radius:${o.borderRadius}`),o.backgroundColor&&e.push(`background-color:${o.backgroundColor}`),o.boxShadow&&e.push(`box-shadow:${o.boxShadow}`),o.backgroundGradient&&o.backgroundGradient.colors&&o.backgroundGradient.colors.length){const $=o.backgroundGradient.angle||0,I=o.backgroundGradient.colors[0]||"#000000",H=o.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${I}, ${H})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"&&(o.fontFamily&&e.push(`font-family:${o.fontFamily}`),o.fontSize!==void 0&&e.push(`font-size:${o.fontSize}px`),o.color&&e.push(`color:${o.color}`),o.fontWeight&&e.push(`font-weight:${o.fontWeight}`),o.letterSpacing!==void 0&&o.letterSpacing!==null&&e.push(`letter-spacing:${o.letterSpacing}px`),o.lineHeight!==void 0&&e.push(`line-height:${o.lineHeight}`),o.fontStyle&&e.push(`font-style:${o.fontStyle}`),o.textAlign&&e.push(`text-align:${o.textAlign}`),o.textDecoration&&e.push(`text-decoration:${o.textDecoration}`),o.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),o.textGradient&&o.textGradient.colors&&o.textGradient.colors.length)){const $=o.textGradient.angle||0,I=o.textGradient.colors[0]||"#000000",H=o.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${$}deg, ${I}, ${H})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}x.type==="image"&&o.objectFit&&e.push(`object-fit:${o.objectFit}`);const d=x.eventBinding;return d&&d.enabled&&d.cursor&&e.push(`cursor:${d.cursor}`),x.hidden&&e.push("display:none"),e.join(";")}function bl(x){return String(x).split(";").map(o=>o.trim()).filter(Boolean).map(o=>o.includes("!important")?o:`${o} !important`).join("; ")}function Vl(x){return String(x).replace(/\{([^}]*)\}/g,(o,e)=>`{ ${bl(e)} }`)}function Ll(x){const o=[],e=d=>{d.forEach($=>{if($.type==="group"&&Array.isArray($.children))e($.children);else{const I=($.className||"").trim(),H=$.customClassCss?String($.customClassCss).trim():"";if(!I||!H)return;/\{[^}]*\}/.test(H)?o.push(Vl(H)):o.push(`.${I} { ${bl(H)} }`)}})};return e(x),o.join(`
`)}function sl(x,o,e,d){function $(p){for(const P of p)if(P.type==="group"&&Array.isArray(P.children)){if($(P.children))return!0}else if(P.type==="chart")return!0;return!1}const I=$(e),H=o.backgroundUrl||"",ne=d!=null&&d.backgroundFileName?`background-image:url('./imgs/${d.backgroundFileName}');background-size:cover;background-repeat:no-repeat;`:H?`background-image:url('${H}');background-size:cover;background-repeat:no-repeat;`:"";let he=0;const C={};(function(P){let V=0;const re=R=>{R.forEach(_=>{if(_.type==="group"&&Array.isArray(_.children))re(_.children);else if(_.type==="chart"){const T=_.elementId&&String(_.elementId).trim()?String(_.elementId).trim():`chart_${V++}`;C[_.id]=T}})};re(P)})(e);function ye(p){var T,D,ce,be,Fe;const P=Ul(p),V=p.zIndex||1,re=p.className&&p.className.trim()?` class="${p.className.trim()}"`:"",R=p.eventBinding,_=R&&R.enabled&&R.handlerName?` onclick="${String(R.handlerName)}(event)"`:"";if(p.type==="group"&&Array.isArray(p.children)){const y=p.children.map(Q=>ye(Q)).join(`
        `);return`<div${re}${_} style="${P};z-index:${V}">
        ${y}
      </div>`}if(p.type==="text"){const y=(p.style||{}).textAlign||"left",Q=y==="center"?"text-flex-center":y==="right"?"text-flex-right":"text-flex-left",J=[(p.className||"").trim(),Q].filter(Boolean).join(" ");return`<div${J?` class="${J}"`:""}${_} style="${P};z-index:${V}">${ur(p.text||"")}</div>`}if(p.type==="image"){if(d!=null&&d.imageFileMap&&d.imageFileMap[p.id]){const y=d.imageFileMap[p.id];return`<img${re}${_} src="./imgs/${y}" style="${P};z-index:${V}" alt="" />`}if(d!=null&&d.imageFileNames&&d.imageFileNames[he]){const y=d.imageFileNames[he++];return`<img${re}${_} src="./imgs/${y}" style="${P};z-index:${V}" alt="" />`}return`<div${re}${_} style="${P};z-index:${V}"></div>`}if(p.type==="line"){const y=p.style||{},Q=y.lineColor||"#ffffff",J=(T=y.lineThickness)!=null?T:2,h=y.lineOrientation||"horizontal",t=y.lineStyle==="dashed",K=(D=y.lineDashLength)!=null?D:6,Y=(ce=y.lineDashGap)!=null?ce:4,qe=Math.max(1,Math.round((be=p.width)!=null?be:h==="horizontal"?200:2)),Le=Math.max(1,Math.round((Fe=p.height)!=null?Fe:h==="horizontal"?2:200)),Pe=Math.round(Le/2),Ye=Math.round(qe/2),rt=t?` stroke-dasharray="${K} ${Y}"`:"";return h==="horizontal"?`<svg${re}${_} viewBox="0 0 ${qe} ${Le}" preserveAspectRatio="none" style="${P};z-index:${V}"><line x1="0" y1="${Pe}" x2="${qe}" y2="${Pe}" stroke="${Q}" stroke-width="${J}"${rt} fill="none" /></svg>`:`<svg${re}${_} viewBox="0 0 ${qe} ${Le}" preserveAspectRatio="none" style="${P};z-index:${V}"><line x1="${Ye}" y1="0" x2="${Ye}" y2="${Le}" stroke="${Q}" stroke-width="${J}"${rt} fill="none" /></svg>`}if(p.type==="chart"){const y=C[p.id]||String(p.elementId||"");return`<div${re}${_} id="${y}" style="${P};z-index:${V}">${ur(p.text||"chart")}</div>`}return p.type==="container"?`<div${re}${_} style="${P};z-index:${V}">${ur(p.text||"")}</div>`:`<div${re}${_} style="${P};z-index:${V}">${ur(p.text||"")}</div>`}const W=e.map(p=>ye(p)).join(`
      `),X=Ll(e),ae=d!=null&&d.fontFaces&&d.fontFaces.length>0?d.fontFaces.map(p=>`@font-face { font-family: '${String(p.family).replace(/'/g,"\\'")}'; src: url('./fonts/${String(p.file)}'); font-weight: normal; font-style: normal; }`).join(`
`):"";function Ee(p,P){p.forEach(V=>{if(V.type==="group"&&Array.isArray(V.children))Ee(V.children,P);else if(V.type==="chart"){const re=C[V.id]||String(V.elementId||"");try{P.push(`chartOptions['${re.replace(/'/g,"\\'")}'] = ${JSON.stringify(V.chartOption||{})};`)}catch{P.push(`chartOptions['${re.replace(/'/g,"\\'")}'] = {};`)}}})}const U=I?`
    (function(){
      var chartOptions = {};
      ${(()=>{const p=[];return Ee(e,p),p.join(`
      `)})()}
      Object.keys(chartOptions).forEach(function(id){
        var el = document.getElementById(id);
        if (el && window.echarts) { var inst = window.echarts.init(el); inst.setOption(chartOptions[id], true); }
      });
    })();
  `:"";return`<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>${ur(x)}</title>
<style>
.container { position:relative; width:${Math.round(o.width)}px; height:${Math.round(o.height)}px; font-family:${String(o.globalFontFamily||"").replace(/'/g,"\\'")}; font-size:${Math.round(o.globalFontSize)}px; color:${String(o.globalColor)}; background-color:${String(o.backgroundColor||"transparent")}; ${ne} }
.text-flex-left { display:flex; align-items:center; justify-content:flex-start; }
.text-flex-center { display:flex; align-items:center; justify-content:center; }
.text-flex-right { display:flex; align-items:center; justify-content:flex-end; }
${ae}
${X}
</style>
${I?'<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"><\/script>':""}
</head>
<body>
<div class="container">
  ${W}
</div>
<script>
${(()=>{const p=new Map;return e.forEach(P=>{const V=P.eventBinding;V&&V.enabled&&V.handlerName&&p.set(String(V.handlerName),String(V.code||"")),Array.isArray(P.children)&&P.children.forEach(re=>{const R=re.eventBinding;R&&R.enabled&&R.handlerName&&p.set(String(R.handlerName),String(R.code||""))})}),Array.from(p.entries()).map(([P,V])=>`function ${P}(event){
${V}
}`).join(`
`)})()}
${U}
<\/script>
</body>
</html>`}function Rr(x){return x.replace(/[&<>"']/g,o=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[o]||o)}function al(x){var d,$;const o=x.style||{},e=[];if(e.push("position:absolute"),e.push(`left:${Math.round(x.left||0)}px`),e.push(`top:${Math.round(x.top||0)}px`),x.autoSize||(x.width&&e.push(`width:${Math.round(x.width)}px`),x.height&&e.push(`height:${Math.round(x.height)}px`)),o.opacity!==void 0&&e.push(`opacity:${o.opacity}`),o.border&&e.push(`border:${o.border}`),o.borderRadius&&e.push(`border-radius:${o.borderRadius}`),o.backgroundColor&&e.push(`background-color:${o.backgroundColor}`),o.boxShadow&&e.push(`box-shadow:${o.boxShadow}`),o.backgroundGradient&&((d=o.backgroundGradient.colors)!=null&&d.length)){const I=o.backgroundGradient.angle||0,H=o.backgroundGradient.colors[0]||"#000000",ne=o.backgroundGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${I}deg, ${H}, ${ne})`),e.push("background-size:cover"),e.push("background-repeat:no-repeat")}if(x.type==="text"&&(o.fontFamily&&e.push(`font-family:${o.fontFamily}`),o.fontSize!==void 0&&e.push(`font-size:${o.fontSize}px`),o.color&&e.push(`color:${o.color}`),o.fontWeight&&e.push(`font-weight:${o.fontWeight}`),o.letterSpacing!==void 0&&o.letterSpacing!==null&&e.push(`letter-spacing:${o.letterSpacing}px`),o.lineHeight!==void 0&&e.push(`line-height:${o.lineHeight}`),o.fontStyle&&e.push(`font-style:${o.fontStyle}`),o.textAlign&&e.push(`text-align:${o.textAlign}`),o.textDecoration&&e.push(`text-decoration:${o.textDecoration}`),o.textOrientation==="vertical"&&(e.push("writing-mode:vertical-rl"),e.push("text-orientation:upright")),o.textGradient&&(($=o.textGradient.colors)!=null&&$.length))){const I=o.textGradient.angle||0,H=o.textGradient.colors[0]||"#000000",ne=o.textGradient.colors[1]||"#000000";e.push(`background-image:linear-gradient(${I}deg, ${H}, ${ne})`),e.push("-webkit-background-clip:text"),e.push("background-clip:text"),e.push("color:transparent")}return x.type==="image"&&o.objectFit&&e.push(`object-fit:${o.objectFit}`),x.hidden&&e.push("display:none"),e.join(";")}function xl(x){return String(x).split(";").map(o=>o.trim()).filter(Boolean).map(o=>o.includes("!important")?o:`${o} !important`).join("; ")}function Rl(x){return String(x).replace(/\{([^}]*)\}/g,(o,e)=>`{ ${xl(e)} }`)}function Tl(x){const o=[],e=d=>{d.forEach($=>{if($.type==="group"&&Array.isArray($.children))e($.children);else{const I=($.className||"").trim(),H=$.customClassCss?String($.customClassCss).trim():"";if(!I||!H)return;/\{[^}]*\}/.test(H)?o.push(Rl(H)):o.push(`.${I} { ${xl(H)} }`)}})};return e(x),o.join(`
`)}function il(x,o,e,d){const $=e.some(W=>W.type==="chart");let I=0;const H=e.map((W,X)=>{var p,P,V,re,R;const ae=al(W),Ee=W.zIndex||1,U=W.className&&W.className.trim()?` class="${W.className.trim()}"`:"";if(W.type==="group"&&Array.isArray(W.children)){const _=W.children.map(T=>{const D=al(T),ce=T.zIndex||1,be=T.className&&T.className.trim()?` class="${T.className.trim()}"`:"";if(T.type==="image"){if(d!=null&&d.imageFileMap&&d.imageFileMap[T.id]){const Fe=d.imageFileMap[T.id];return`<img${be} src="/imgs/${Fe}" style="${D};z-index:${ce}" alt="" />`}if(d!=null&&d.imageFileNames&&d.imageFileNames[I]){const Fe=d.imageFileNames[I++];return`<img${be} src="/imgs/${Fe}" style="${D};z-index:${ce}" alt="" />`}}return`<div${be} style="${D};z-index:${ce}">${Rr(T.text||"")}</div>`}).join(`
        `);return`<div${U} style="${ae};z-index:${Ee}">${_}</div>`}if(W.type==="text")return`<div${U} style="${ae};z-index:${Ee}">${Rr(W.text||"")}</div>`;if(W.type==="image"){if(d!=null&&d.imageFileMap&&d.imageFileMap[W.id]){const _=d.imageFileMap[W.id];return`<img${U} src="/imgs/${_}" style="${ae};z-index:${Ee}" alt="" />`}if(d!=null&&d.imageFileNames&&d.imageFileNames[I]){const _=d.imageFileNames[I++];return`<img${U} src="/imgs/${_}" style="${ae};z-index:${Ee}" alt="" />`}return`<div${U} style="${ae};z-index:${Ee}"></div>`}if(W.type==="line"){const _=W.style||{},T=_.lineColor||"#ffffff",D=(p=_.lineThickness)!=null?p:2,ce=_.lineOrientation||"horizontal",be=_.lineStyle==="dashed",Fe=(P=_.lineDashLength)!=null?P:6,y=(V=_.lineDashGap)!=null?V:4,Q=Math.max(1,Math.round((re=W.width)!=null?re:ce==="horizontal"?200:2)),J=Math.max(1,Math.round((R=W.height)!=null?R:ce==="horizontal"?2:200)),h=Math.round(J/2),t=Math.round(Q/2),K=be?` stroke-dasharray="${Fe} ${y}"`:"";return ce==="horizontal"?`<svg${U} viewBox="0 0 ${Q} ${J}" preserveAspectRatio="none" style="${ae};z-index:${Ee}"><line x1="0" y1="${h}" x2="${Q}" y2="${h}" stroke="${T}" stroke-width="${D}"${K} fill="none" /></svg>`:`<svg${U} viewBox="0 0 ${Q} ${J}" preserveAspectRatio="none" style="${ae};z-index:${Ee}"><line x1="${t}" y1="0" x2="${t}" y2="${J}" stroke="${T}" stroke-width="${D}"${K} fill="none" /></svg>`}if(W.type==="chart"){const _=W.elementId&&W.elementId.trim()?W.elementId.trim():`chart_${X}`;return`<div${U} id="${_}" style="${ae};z-index:${Ee}">${Rr(W.text||"chart")}</div>`}return`<div${U} style="${ae};z-index:${Ee}">${Rr(W.text||"")}</div>`}).join(`
      `),ne=Tl(e),he=d!=null&&d.fontFaces&&d.fontFaces.length>0?d.fontFaces.map(W=>`@font-face { font-family: '${W.family.replace(/'/g,"\\'")}'; src: url('/fonts/${W.file}'); font-weight: normal; font-style: normal; }`).join(`
`):"",C=(()=>{const W=[];return e.forEach((X,ae)=>{if(X.type==="chart"){const Ee=X.elementId&&X.elementId.trim()?X.elementId.trim():`chart_${ae}`,U=X.chartOption||{};try{W.push(`'${Ee.replace(/'/g,"\\'")}' : ${JSON.stringify(U)}`)}catch{W.push(`'${Ee.replace(/'/g,"\\'")}' : {}`)}}}),`{ ${W.join(", ")} }`})(),ye=d!=null&&d.backgroundFileName?`'/imgs/${String(d.backgroundFileName).replace(/'/g,"\\'")}'`:`'${(o.backgroundUrl||"").replace(/'/g,"\\'")}'`;return`import React, { useEffect } from 'react';
${$?`import * as echarts from 'echarts';
`:""}
export default function ${x.replace(/[^A-Za-z0-9_]/g,"_")}() {
  const config = { width: ${Math.round(o.width)}, height: ${Math.round(o.height)}, backgroundColor: '${(o.backgroundColor||"transparent").replace(/'/g,"\\'")}', globalFontFamily: '${(o.globalFontFamily||"").replace(/'/g,"\\'")}', globalFontSize: ${Math.round(o.globalFontSize)}, globalColor: '${o.globalColor}' };
  const backgroundUrl = ${ye};
  ${$?`const chartOptions = ${C};
  useEffect(() => {
    Object.keys(chartOptions || {}).forEach((id) => {
      const el = document.getElementById(id);
      if (el) { const inst = echarts.init(el); inst.setOption(chartOptions[id], true); }
    });
  }, []);
`:""}  const containerStyle = { position:'relative', width: config.width + 'px', height: config.height + 'px', fontFamily: config.globalFontFamily, fontSize: config.globalFontSize + 'px', color: config.globalColor, backgroundColor: config.backgroundColor, ...(backgroundUrl ? { backgroundImage: 'url(' + backgroundUrl + ')', backgroundSize: 'cover', backgroundRepeat: 'no-repeat' } : {}) };
  return (
    <div className="container" style={containerStyle}>
      <style>{\`.text-flex-left{display:flex;align-items:center;justify-content:flex-start}.text-flex-center{display:flex;align-items:center;justify-content:center}.text-flex-right{display:flex;align-items:center;justify-content:flex-end${he?"\\n"+he:""}${ne?"\\n"+ne:""}\`}</style>
      <div dangerouslySetInnerHTML={{ __html: \`${H.replace(/`/g,"\\`")}\` }} />
    </div>
  );
}
`}var dl=cl(Sl()),Pl=["placeholder"],Hl={key:0,class:"absolute z-10 bg-gray-900 border border-gray-700 rounded w-full mt-1 max-h-40 overflow-auto shadow custom-scrollbar"},Wl=["onMousedown"],_l={key:0,class:"px-2 py-2 text-xs text-gray-400"},Jl=Dt({__name:"SearchableSelect",props:{modelValue:{},options:{},placeholder:{},numeric:{type:Boolean}},emits:["update:modelValue"],setup(x,{emit:o}){const e=x,d=o,$=xe(!1),I=xe(""),H=xe(null),ne=xe("");let he=null;const C=xe(!1);yt(()=>e.modelValue,R=>{R==null?I.value="":I.value=String(R)},{immediate:!0});const ye=Ge(()=>e.options.map(R=>String(R))),W=Ge(()=>{const R=ne.value.trim().toLowerCase();return R?ye.value.filter(_=>_.toLowerCase().includes(R)):ye.value});function X(R){I.value=R;const _=e.numeric?Number(R):R;d("update:modelValue",_),$.value=!1}function ae(){const R=I.value.trim();if(!R){d("update:modelValue",(e.numeric,null)),$.value=!1;return}const _=e.numeric?Number(R):R;d("update:modelValue",_),$.value=!1}function Ee(){C.value=!1,$.value=!0,P(I.value)}function U(){}function p(R){R.key==="Enter"&&ae()}function P(R){he&&window.clearTimeout(he),he=window.setTimeout(()=>{ne.value=R},180)}function V(){C.value=!0,$.value=!0,P(I.value)}function re(R){H.value&&(H.value.contains(R.target)||($.value=!1))}return Wr(()=>{window.addEventListener("click",re),ne.value=I.value}),_r(()=>{window.removeEventListener("click",re),he&&window.clearTimeout(he)}),(R,_)=>(z(),O("div",{class:"relative",ref_key:"root",ref:H},[ue(r("input",{class:"border border-gray-700 bg-gray-900 text-gray-100 rounded w-full px-2 py-1",placeholder:x.placeholder||"搜索选择或直接输入","onUpdate:modelValue":_[0]||(_[0]=T=>I.value=T),onInput:V,onFocus:Ee,onBlur:U,onKeydown:p},null,40,Pl),[[$e,I.value]]),$.value?(z(),O("div",Hl,[(z(!0),O(Bt,null,_t(W.value,T=>(z(),O("div",{key:T,class:"px-2 py-1 hover:bg-gray-700 cursor-pointer text-sm text-gray-100",onMousedown:fl(D=>X(T),["prevent"])},et(T),41,Wl))),128)),W.value.length===0?(z(),O("div",_l,"无匹配项，回车使用当前输入")):ee("",!0)])):ee("",!0)],512))}}),kt=Jl,ql={class:"space-y-3"},Xl={class:"flex items-center justify-between"},Yl={class:"inline-flex items-center cursor-pointer"},Kl={class:"flex items-center justify-between"},Zl={class:"inline-flex items-center cursor-pointer"},Ql=Dt({__name:"CanvasSettingsPanel",props:{spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean}},emits:["update:spacingEnabled","update:alignmentEnabled"],setup(x,{emit:o}){const e=x,d=o,$=Ge({get:()=>e.spacingEnabled,set:H=>d("update:spacingEnabled",H)}),I=Ge({get:()=>e.alignmentEnabled,set:H=>d("update:alignmentEnabled",H)});return(H,ne)=>(z(),O("div",ql,[ne[6]||(ne[6]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"辅助间距",-1)),r("div",Xl,[ne[3]||(ne[3]=r("label",{class:"text-xs text-gray-400"},"显示间距标注",-1)),r("label",Yl,[ue(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":ne[0]||(ne[0]=he=>$.value=he)},null,512),[[Pr,$.value]]),ne[2]||(ne[2]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ve(["ml-3 text-xs",$.value?"text-cyan-300":"text-gray-300"])},et($.value?"已开启":"已关闭"),3)])]),r("div",Kl,[ne[5]||(ne[5]=r("label",{class:"text-xs text-gray-400"},"显示对齐参考线",-1)),r("label",Zl,[ue(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":ne[1]||(ne[1]=he=>I.value=he)},null,512),[[Pr,I.value]]),ne[4]||(ne[4]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ve(["ml-3 text-xs",I.value?"text-cyan-300":"text-gray-300"])},et(I.value?"已开启":"已关闭"),3)])])]))}}),eo=Ql,to={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl shadow-2xl shadow-cyan-500/20 flex flex-col"},ro={class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},no={class:"space-y-2"},lo={class:"space-y-2"},oo={class:"grid grid-cols-2 gap-2"},so={class:"space-y-2"},ao={class:"flex gap-2"},io={class:"space-y-2"},uo={class:"flex gap-2"},co=["value"],po={class:"space-y-3"},fo={class:"space-y-2"},go={class:"space-y-2"},mo={class:"space-y-2"},yo={class:"space-y-2 pt-4 border-t border-cyan-500/30"},bo={class:"relative"},xo={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},ho={class:"relative w-[520px] max-w-[90vw] p-4 bg-gray-900/95 backdrop-blur-md border border-emerald-500/40 rounded-xl shadow-2xl"},vo={class:"flex items-center justify-between mb-3"},wo={class:"grid grid-cols-2 gap-2"},$o=Dt({__name:"CanvasSidebar",props:{exportName:{},config:{},fontLibrary:{},spacingEnabled:{type:Boolean},alignmentEnabled:{type:Boolean}},emits:["update:exportName","update:configWidth","update:configHeight","update:backgroundColor","update:globalFontFamily","update:globalFontSize","update:globalColor","update:spacingEnabled","update:alignmentEnabled","backgroundFileChange","openPreview","downloadByFormat","downloadAllFormats","resetCanvas"],setup(x,{emit:o}){const e=x,d=o,$=Ge({get:()=>e.exportName,set:T=>d("update:exportName",T)}),I=Ge({get:()=>e.config.width,set:T=>d("update:configWidth",T)}),H=Ge({get:()=>e.config.height,set:T=>d("update:configHeight",T)}),ne=Ge({get:()=>e.config.backgroundColor||"",set:T=>d("update:backgroundColor",T)}),he=Ge({get:()=>e.config.globalFontFamily||"",set:T=>d("update:globalFontFamily",T)}),C=Ge({get:()=>e.config.globalFontSize||14,set:T=>d("update:globalFontSize",T)}),ye=Ge({get:()=>e.config.globalColor||"#ffffff",set:T=>d("update:globalColor",T)}),W=Ge({get:()=>e.spacingEnabled,set:T=>d("update:spacingEnabled",T)}),X=Ge({get:()=>e.alignmentEnabled,set:T=>d("update:alignmentEnabled",T)});function ae(T){try{return String(T||"#000000")}catch{return"#000000"}}const Ee=Ge({get:()=>U.value,set:T=>U.value=T}),U=xe(!1);function p(T){d("backgroundFileChange",T)}function P(){d("openPreview")}function V(){U.value=!U.value}function re(T){d("downloadByFormat",T),U.value=!1}function R(){d("downloadAllFormats"),U.value=!1}function _(){d("resetCanvas")}return(T,D)=>(z(),O("div",to,[D[26]||(D[26]=r("div",{class:"p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-cyan-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),cr(" 画布设置 ")])],-1)),r("div",ro,[r("div",no,[D[17]||(D[17]=r("label",{class:"block text-sm font-medium text-cyan-300"},"组件名称",-1)),ue(r("input",{"onUpdate:modelValue":D[0]||(D[0]=ce=>$.value=ce),class:"w-full px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"GeneratedComponent"},null,512),[[$e,$.value]])]),r("div",lo,[D[18]||(D[18]=r("label",{class:"block text-sm font-medium text-cyan-300"},"画布尺寸",-1)),r("div",oo,[ue(r("input",{"onUpdate:modelValue":D[1]||(D[1]=ce=>I.value=ce),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"宽度"},null,512),[[$e,I.value,void 0,{number:!0}]]),ue(r("input",{"onUpdate:modelValue":D[2]||(D[2]=ce=>H.value=ce),type:"number",class:"px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"高度"},null,512),[[$e,H.value,void 0,{number:!0}]])])]),r("div",so,[D[19]||(D[19]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景图片",-1)),r("div",ao,[r("input",{type:"file",onChange:p,accept:"image/*",class:"flex-1 text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-cyan-600 file:text-white hover:file:bg-cyan-500 file:cursor-pointer"},null,32)])]),r("div",io,[D[20]||(D[20]=r("label",{class:"block text-sm font-medium text-cyan-300"},"背景颜色",-1)),r("div",uo,[r("input",{value:ae(ne.value),type:"color",onInput:D[3]||(D[3]=ce=>d("update:backgroundColor",ce.target.value)),class:"w-16 h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,40,co),ue(r("input",{"onUpdate:modelValue":D[4]||(D[4]=ce=>ne.value=ce),type:"text",class:"flex-1 px-3 py-2 bg-gray-800/50 border border-cyan-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200",placeholder:"#000000 或 rgba(...)"},null,512),[[$e,ne.value]])])]),r("div",po,[D[24]||(D[24]=r("h3",{class:"text-sm font-medium text-cyan-300 border-b border-cyan-500/30 pb-1"},"全局字体设置",-1)),r("div",fo,[D[21]||(D[21]=r("label",{class:"block text-xs text-gray-400"},"字体族",-1)),dt(kt,{options:x.fontLibrary,modelValue:he.value,"onUpdate:modelValue":D[5]||(D[5]=ce=>he.value=ce),placeholder:"选择字体"},null,8,["options","modelValue"])]),r("div",go,[D[22]||(D[22]=r("label",{class:"block text-xs text-gray-400"},"字号 (px)",-1)),ue(r("input",{"onUpdate:modelValue":D[6]||(D[6]=ce=>C.value=ce),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-cyan-500/30 rounded text-gray-100 text-sm focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400 focus:outline-none transition-all duration-200"},null,512),[[$e,C.value,void 0,{number:!0}]])]),r("div",mo,[D[23]||(D[23]=r("label",{class:"block text-xs text-gray-400"},"颜色",-1)),ue(r("input",{"onUpdate:modelValue":D[7]||(D[7]=ce=>ye.value=ce),type:"color",class:"w-full h-8 bg-gray-800/50 border border-cyan-500/30 rounded cursor-pointer"},null,512),[[$e,ye.value]])])]),dt(eo,{spacingEnabled:W.value,alignmentEnabled:X.value,"onUpdate:spacingEnabled":D[8]||(D[8]=ce=>W.value=ce),"onUpdate:alignmentEnabled":D[9]||(D[9]=ce=>X.value=ce)},null,8,["spacingEnabled","alignmentEnabled"]),r("div",yo,[r("button",{onClick:P,class:"w-full px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"},"预览（新窗口）"),r("div",bo,[r("button",{onClick:V,class:"w-full px-4 py-2 bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-emerald-500/25"},"导出"),Ee.value?(z(),O("div",xo,[r("div",{class:"absolute inset-0 bg-black/60",onClick:D[10]||(D[10]=ce=>Ee.value=!1)}),r("div",ho,[r("div",vo,[D[25]||(D[25]=r("h3",{class:"text-sm font-medium text-emerald-300"},"选择导出格式",-1)),r("button",{class:"px-2 py-1 text-xs bg-gray-700/60 hover:bg-gray-600/60 rounded text-gray-200",onClick:D[11]||(D[11]=ce=>Ee.value=!1)},"关闭")]),r("div",wo,[r("button",{onClick:D[12]||(D[12]=ce=>re("vue2")),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 text-white rounded"},"Vue2 组件"),r("button",{onClick:D[13]||(D[13]=ce=>re("vue3")),class:"px-3 py-2 text-xs bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-500 hover:to-cyan-500 text-white rounded"},"Vue3 组件"),r("button",{onClick:D[14]||(D[14]=ce=>re("react")),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"React 组件"),r("button",{onClick:D[15]||(D[15]=ce=>re("html")),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded"},"纯 HTML 页面"),r("button",{onClick:D[16]||(D[16]=ce=>R()),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded col-span-2"},"一键导出（全部）")])])])):ee("",!0)]),r("button",{onClick:_,class:"w-full px-4 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"清空画布")])])]))}}),Eo=$o,ul=cl(Nl()),ko={class:"relative w-full"},So=Dt({__name:"CssEditor",props:{modelValue:{},height:{},debounceMs:{}},emits:["update:modelValue"],setup(x,{emit:o}){const e=x,d=o,$=xe(e.modelValue||"");let I=null;const H=typeof e.debounceMs=="number"?Math.max(0,e.debounceMs):250;yt(()=>e.modelValue,W=>{I&&(clearTimeout(I),I=null);const X=W||"";X!==$.value&&($.value=X)}),yt($,W=>{I&&clearTimeout(I),I=window.setTimeout(()=>{d("update:modelValue",W),I=null},H)}),_r(()=>{I&&(clearTimeout(I),I=null)});function ne(){const W=$.value||"";if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText(W).catch(()=>{try{const X=document.createElement("textarea");X.value=W,document.body.appendChild(X),X.select(),document.execCommand("copy"),document.body.removeChild(X)}catch{}});else try{const X=document.createElement("textarea");X.value=W,document.body.appendChild(X),X.select(),document.execCommand("copy"),document.body.removeChild(X)}catch{}}function he(){I&&(clearTimeout(I),I=null),$.value="",d("update:modelValue","")}const C=[wl,$l(),kl],ye=Ge(()=>{var W;return(W=e.height)!=null?W:"180px"});return(W,X)=>(z(),O("div",ko,[r("div",{class:"absolute right-2 top-2 z-10 flex gap-2"},[r("button",{type:"button",class:"px-2 py-1 text-xs bg-gray-700/70 hover:bg-gray-700 text-gray-100 rounded",onClick:ne},"复制"),r("button",{type:"button",class:"px-2 py-1 text-xs bg-red-600/70 hover:bg-red-600 text-white rounded",onClick:he},"清空")]),dt(hl(El),{modelValue:$.value,"onUpdate:modelValue":X[0]||(X[0]=ae=>$.value=ae),extensions:C,style:lt({height:ye.value,width:"100%"}),class:"w-full rounded border border-purple-500/30 bg-gray-800/50"},null,8,["modelValue","style"])]))}}),Mo=Jr(So,[["__scopeId","data-v-c1c6cbbe"]]);function Co(x,o,e,d,$,I){x&&(x.style=x.style||{},x.style.boxShadow=`${o}px ${e}px ${d}px ${$}px ${I}`)}function No(x){x.style=x.style||{},x.style.textGradient=x.style.textGradient||{colors:["#00A3FF","#ffffff"],angle:0}}function Io(x){x.style=x.style||{},x.style.backgroundGradient=x.style.backgroundGradient||{colors:["#00A3FF","#ffffff"],angle:90}}function Fo(x,o){var ye,W,X;const e=(ye=o==null?void 0:o.maxDepth)!=null?ye:6,d=(W=o==null?void 0:o.maxEntries)!=null?W:400,$=(X=o==null?void 0:o.includeIntermediate)!=null?X:!1,I=[],H=new WeakSet;function ne(ae){return Object.prototype.toString.call(ae)==="[object Object]"}function he(ae){I.length<d&&I.push(ae)}function C(ae,Ee,U){if(!(U>e)&&ae!=null){if(typeof ae!="object"){he(Ee);return}if(!H.has(ae)){if(H.add(ae),Array.isArray(ae)){he(Ee);const p=Math.min(ae.length,20);for(let P=0;P<p;P++)C(ae[P],`${Ee}[${P}]`,U+1);return}if(ne(ae)){$&&he(Ee);const p=Object.keys(ae).slice(0,50);for(const P of p)C(ae[P],Ee?`${Ee}.${P}`:P,U+1);return}he(Ee)}}}return C(x,"",0),I.filter(Boolean)}function jo(x,o){try{if(!x||!o)return"";const e=o.replace(/\[(\d+)\]/g,".$1").replace(/\['([^']+)'\]/g,".$1").replace(/\["([^\"]+)"\]/g,".$1").split(".").filter(Boolean);let d=x;for(const $ of e){if(d==null)return"";d=d[$]}return typeof d=="object"?JSON.stringify(d):d!=null?d:""}catch{return""}}function Ao(x,o){var $;if(!o||!(($=o.dynamic)!=null&&$.enabled)||!o.dynamic.objectName||!o.dynamic.propertyPath)return"";const e=o.dynamic,d=x[e.objectName];return String(jo(d,e.propertyPath))}var zo={class:"w-80 min-w-[300px] bg-gray-900/80 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20 flex flex-col"},Oo={key:0,class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Bo={class:"space-y-3"},Do={class:"grid grid-cols-2 gap-2"},Go={class:"col-span-2"},Uo={class:"space-y-3"},Vo={class:"flex items-center justify-between"},Lo={class:"inline-flex items-center cursor-pointer"},Ro={key:0,class:"grid grid-cols-2 gap-2"},To={key:1},Po={class:"space-y-3"},Ho={class:"space-y-2"},Wo={class:"flex items-center justify-between"},_o={key:0},Jo={class:"flex gap-2"},qo={key:1},Xo={key:2},Yo={key:3,class:"space-y-2 pt-2 border-t border-purple-500/20"},Ko={class:"flex items-center justify-between"},Zo={class:"inline-flex items-center cursor-pointer"},Qo=["checked"],es={key:0,class:"space-y-1"},ts=["value"],rs={key:0,class:"space-y-3"},ns={class:"flex items-center gap-2"},ls=["value"],os=["value"],ss={class:"space-y-2"},as={class:"flex items-center justify-between"},is={class:"flex items-center gap-1 text-xs text-gray-300"},ds=["checked"],us={key:0,class:"grid grid-cols-3 gap-2 items-end"},cs={class:"flex items-center gap-2"},ps=["value"],fs=["value"],gs={class:"flex items-center gap-2"},ms=["value"],ys=["value"],bs={class:"space-y-1"},xs=["value"],hs=["value"],vs={class:"space-y-2"},ws={class:"flex items-center justify-between"},$s={class:"flex items-center gap-1 text-xs text-gray-300"},Es=["checked"],ks={key:0,class:"space-y-1"},Ss={class:"flex items-center gap-2"},Ms={key:0,class:"space-y-1"},Cs=["value"],Ns=["value"],Is={key:1,class:"space-y-1"},Fs=["value"],js={class:"flex items-center gap-1"},As=["value"],zs={class:"space-y-2"},Os={class:"flex items-center justify-between"},Bs={class:"flex items-center gap-1 text-xs text-gray-300"},Ds=["checked"],Gs={key:0,class:"space-y-2"},Us=["value"],Vs={class:"space-y-1"},Ls={class:"flex items-center gap-2"},Rs=["value"],Ts=["value"],Ps={class:"space-y-1"},Hs={class:"flex items-center gap-2"},Ws=["value"],_s=["value"],Js={class:"space-y-1"},qs={class:"flex items-center gap-2"},Xs=["value"],Ys=["value"],Ks={class:"space-y-1"},Zs={class:"flex items-center gap-2"},Qs=["value"],ea=["value"],ta={class:"space-y-1"},ra={key:0,class:"flex items-center gap-2"},na=["value"],la=["value"],oa={key:1,class:"space-y-3"},sa={class:"flex items-center gap-2"},aa={key:0,class:"space-y-2"},ia=["value"],da={class:"grid grid-cols-2 gap-2"},ua=["value"],ca=["value"],pa={key:0,class:"grid grid-cols-2 gap-2"},fa=["value"],ga=["value"],ma={key:1,class:"grid grid-cols-2 gap-2"},ya={key:2,class:"grid grid-cols-3 gap-2 items-end"},ba={key:1},xa={class:"flex items-center justify-between mt-2"},ha={key:0,class:"text-xs text-red-400"},va={key:2,class:"space-y-3"},wa={class:"space-y-2"},$a={class:"flex gap-1"},Ea=["value"],ka=["value"],Sa={class:"grid grid-cols-2 gap-2"},Ma={class:"grid grid-cols-2 gap-1"},Ca=["value"],Na={class:"grid grid-cols-2 gap-2"},Ia=["value"],Fa={key:0},ja=["value"],Aa={key:0,class:"grid grid-cols-2 gap-2"},za=["value"],Oa={key:3,class:"space-y-3"},Ba={class:"space-y-2"},Da={class:"space-y-2 mt-2"},Ga={class:"flex items-center gap-2"},Ua=["checked"],Va={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},La={class:"text-xs text-gray-400"},Ra={class:"space-y-2"},Ta={class:"grid grid-cols-2 gap-1"},Pa={class:"grid grid-cols-2 gap-2"},Ha={class:"grid grid-cols-2 gap-2"},Wa={class:"grid grid-cols-2 gap-2"},_a=["value"],Ja=["value"],qa={class:"space-y-2"},Xa={class:"flex gap-1"},Ya=["value","disabled"],Ka=["value","disabled"],Za={key:0,class:"text-xs text-yellow-400 mt-1"},Qa={class:"space-y-2"},ei={class:"flex gap-1"},ti=["value"],ri=["value"],ni={class:"space-y-2"},li={class:"grid grid-cols-3 gap-1"},oi={class:"space-y-2"},si={class:"grid grid-cols-2 gap-1"},ai={class:"space-y-2"},ii={class:"flex items-center gap-2"},di={class:"flex items-center gap-2 mt-1"},ui={class:"space-y-2"},ci={class:"flex items-center justify-between"},pi={class:"flex gap-1"},fi={key:0,class:"grid grid-cols-3 gap-2 items-center"},gi={class:"col-span-1"},mi={class:"col-span-1"},yi={class:"col-span-1"},bi={class:"space-y-2"},xi={class:"grid grid-cols-3 gap-1"},hi={class:"space-y-2"},vi={class:"flex items-center justify-between"},wi={class:"flex gap-1"},$i={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},Ei={class:"grid grid-cols-2 gap-2"},ki={class:"flex gap-1"},Si={class:"flex gap-1"},Mi={class:"block text-xs text-gray-400 mb-1"},Ci={class:"space-y-2"},Ni={class:"flex items-center justify-between"},Ii={class:"flex gap-1"},Fi={key:0,class:"space-y-2 p-2 bg-gray-800/30 rounded"},ji={class:"grid grid-cols-2 gap-2"},Ai={class:"flex gap-1"},zi={class:"flex gap-1"},Oi={class:"block text-xs text-gray-400 mb-1"},Bi={key:4,class:"space-y-3"},Di={class:"space-y-2"},Gi={key:0,class:"space-y-2"},Ui={class:"max-h-32 overflow-y-auto custom-scrollbar bg-gray-800/30 rounded p-2"},Vi={class:"grid grid-cols-4 gap-2"},Li=["onClick"],Ri=["src","alt"],Ti={key:0,class:"text-xs text-gray-500 text-center py-2"},Pi={class:"grid grid-cols-3 gap-2"},Hi={class:"space-y-2"},Wi={class:"pt-4 border-t border-purple-500/30 space-y-2"},_i={key:1,class:"p-4 text-center text-gray-400 flex-1 flex flex-col justify-center"},Ji={},qi=Dt({...Ji,__name:"ElementSettingsPanel",props:{selectedEl:{},config:{},fontLibrary:{},fontSizeLibrary:{},fontWeightOptions:{},fontStyleOptions:{},databaseObjects:{},dbMap:{},iconLibrary:{},defaultChartOption:{type:Function},safeHex:{type:Function},initCustomClassSkeleton:{type:Function},refreshAllCustomClassCss:{type:Function},removeCustomClassCssForElement:{type:Function},getIconDataUrlById:{type:Function}},emits:["duplicateSelected","removeSelected","saveSelectedAsComponent"],setup(x,{emit:o}){const e=x,d=o,$=xe("visual"),I=xe(""),H=xe("");yt(()=>{var h;return(h=e.selectedEl)==null?void 0:h.id},()=>{var t;const h=e.selectedEl;h&&h.type==="chart"&&($.value="visual",H.value="",I.value=JSON.stringify((t=h.chartOption)!=null?t:e.defaultChartOption(h.chartType||"line"),null,2))});const ne=Ge(()=>{var K,Y;const h=(Y=(K=e.selectedEl)==null?void 0:K.dynamic)==null?void 0:Y.objectName;if(!h)return[];const t=e.dbMap[h];try{return Fo(t,{maxDepth:6,maxEntries:400})}catch{return[]}});function he(h){return Ao(e.dbMap,h)}function C(h){return typeof h=="string"&&h.trim().endsWith("%")?"%":"px"}function ye(h){if(h==null)return 0;if(typeof h=="number")return h;const t=String(h).trim();if(t.endsWith("%")){const Y=Number(t.replace("%",""));return Number.isFinite(Y)?Y:0}const K=Number(t.replace("px",""));return Number.isFinite(K)?K:0}function W(h,t){const K=e.selectedEl;K&&(K.style=K.style||{},K.style.borderRadius=`${h}${t}`)}function X(h){const t={x:0,y:8,blur:24,spread:0,color:"#000000"};if(!h||!h.trim())return t;const K=h.split(/\s+/).filter(Boolean);if(K.length<3)return t;const Y=K.slice(0,4).map(ut=>Number(String(ut).replace("px",""))),qe=K.slice(4).join(" ")||t.color,[Le=NaN,Pe=NaN,Ye=NaN,rt=NaN]=Y;return{x:Number.isFinite(Le)?Le:t.x,y:Number.isFinite(Pe)?Pe:t.y,blur:Number.isFinite(Ye)?Ye:t.blur,spread:Number.isFinite(rt)?rt:t.spread,color:qe}}function ae(h,t,K,Y,qe){Co(e.selectedEl,h,t,K,Y,qe)}function Ee(h){No(h)}function U(h){Io(h)}function p(){H.value="";try{const h=JSON.parse(I.value);e.selectedEl&&e.selectedEl.type==="chart"&&(e.selectedEl.chartOption=h)}catch(h){H.value=`JSON 解析失败：${(h==null?void 0:h.message)||String(h)}`}}function P(h,t){if(!e.selectedEl||e.selectedEl.type!=="chart"||!e.selectedEl.chartOption)return;const K=e.selectedEl.chartOption,Y=K.series||[],qe={type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:h},{offset:1,color:t}],global:!1};Y.forEach(Le=>{Le.type==="bar"&&(Le.itemStyle=Le.itemStyle||{},Le.itemStyle.color=qe)}),I.value=JSON.stringify(K,null,2)}function V(){const h=e.selectedEl;return!h||h.type!=="chart"?null:(h.chartOption||(h.chartOption=e.defaultChartOption(h.chartType||"line")),h.chartOption)}function re(h){const t=V();t&&(t.title=t.title||{},t.title.text=h,I.value=JSON.stringify(t,null,2))}function R(h){const t=V();t&&(t.color=h.split(",").map(K=>K.trim()).filter(Boolean),I.value=JSON.stringify(t,null,2))}function _(h){const t=V();t&&(t.legend=t.legend||{},t.legend.show=h==="1",I.value=JSON.stringify(t,null,2))}function T(h){var K;const t=(K=h.target.files)==null?void 0:K[0];if(t&&e.selectedEl){const Y=new FileReader;Y.onload=()=>{e.selectedEl&&(e.selectedEl.src=String(Y.result),e.selectedEl.iconId=void 0)},Y.readAsDataURL(t)}}async function D(h){const t=e.selectedEl;if(!t||t.type!=="image")return;const K=await e.getIconDataUrlById(h.id);if(!K)return;t.src=K,t.iconId=h.id;const Y=new Image;Y.onload=()=>{e.selectedEl&&e.selectedEl.id===t.id&&(e.selectedEl.width=Y.naturalWidth,e.selectedEl.height=Y.naturalHeight)},Y.src=K}function ce(){const h=e.selectedEl;if(!h||h.type!=="image"||!h.src)return;const t=new Image;t.onload=()=>{e.selectedEl&&(e.selectedEl.width=t.naturalWidth,e.selectedEl.height=t.naturalHeight)},t.src=h.src}function be(){}const Fe=Ge({get(){const h=e.selectedEl;return!!(h&&h.eventBinding&&h.eventBinding.enabled)},set(h){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!1,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.enabled=h,(t.eventBinding.handlerName==null||String(t.eventBinding.handlerName).trim()==="")&&(t.eventBinding.handlerName="handleClick"),(t.eventBinding.cursor==null||String(t.eventBinding.cursor).trim()==="")&&(t.eventBinding.cursor="pointer"),t.eventBinding.code==null&&(t.eventBinding.code=""))}}),y=Ge({get(){var h,t;return(t=(h=e.selectedEl)==null?void 0:h.eventBinding)==null?void 0:t.cursor},set(h){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.cursor=h)}}),Q=Ge({get(){var h,t;return(t=(h=e.selectedEl)==null?void 0:h.eventBinding)==null?void 0:t.handlerName},set(h){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.handlerName=h)}}),J=Ge({get(){var h,t;return(t=(h=e.selectedEl)==null?void 0:h.eventBinding)==null?void 0:t.code},set(h){const t=e.selectedEl;t&&(t.eventBinding=t.eventBinding||{enabled:!0,cursor:"pointer",handlerName:"handleClick",code:""},t.eventBinding.code=h)}});return(h,t)=>{var K,Y,qe,Le,Pe,Ye,rt,ut,ct,St,Ie,pe,pt,ft,bt,vt,Mt,He,ke,Re,Ke,De,at,Ze,gt,We,Je,Ct,Nt,It,wt,Ft,pr,Jt,fr,gr,qt,mr,yr,br,xr,Xt,Yt,Gt,Ut,hr,vr,wr,jt,xt,Kt,At,Zt,$r,Er,kr,it,$t,Sr,Mr,Qt,er,tr,Cr,zt,Vt,Lt,Rt,rr,nr,Nr,lr,st,nt,Ir,Fr,jr,Ar,zr,Or,or,Tt,Pt,sr,Ht,Wt,Br,Ot,ar,Dr,ir,Gr,dr,n,l,a,u,c,g,S,N,M,m,s,k,L,de,ge,Ne,Me,Ce,ve,le,oe,se,te,Se,f,v,F,w,j,Z,b,G,B,q,me,ie,we,Ue,Te,tt,_e,ot,Qe,mt,ht,Et,Ur,qr,Xr,Yr,Kr,Zr,Qr,en,tn,rn,nn,ln,on,sn,an,dn,un,cn,pn,fn,gn,mn,yn,bn,xn,hn,vn,wn,$n,En,kn,Sn,Mn,Cn,Nn,In,Fn,jn,An,zn,On,Bn,Dn,Gn,Un,Vn,Ln,Rn,Tn,Pn,Hn,Wn,_n,Jn,qn,Xn,Yn,Kn,Zn,Qn,el,tl;return z(),O("div",zo,[t[232]||(t[232]=r("div",{class:"p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},[r("h2",{class:"text-lg font-bold text-purple-300 flex items-center gap-2"},[r("span",{class:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),cr(" 元素设置 ")])],-1)),e.selectedEl?(z(),O("div",Oo,[r("div",Bo,[t[127]||(t[127]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"位置和尺寸",-1)),r("div",Do,[r("div",null,[t[122]||(t[122]=r("label",{class:"block text-xs text-gray-400 mb-1"},"X",-1)),ue(r("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.selectedEl.left=i),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.left,void 0,{number:!0}]])]),r("div",null,[t[123]||(t[123]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y",-1)),ue(r("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>e.selectedEl.top=i),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.top,void 0,{number:!0}]])]),r("div",null,[t[124]||(t[124]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度",-1)),ue(r("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>e.selectedEl.width=i),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[125]||(t[125]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度",-1)),ue(r("input",{"onUpdate:modelValue":t[3]||(t[3]=i=>e.selectedEl.height=i),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.height,void 0,{number:!0}]])]),r("div",Go,[t[126]||(t[126]=r("label",{class:"block text-xs text-gray-400 mb-1"},"层级（z-index）",-1)),ue(r("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>e.selectedEl.zIndex=i),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.zIndex,void 0,{number:!0}]])])])]),r("div",Uo,[t[134]||(t[134]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"事件绑定",-1)),r("div",Vo,[t[129]||(t[129]=r("label",{class:"text-xs text-gray-400"},"开启事件绑定",-1)),r("label",Lo,[ue(r("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":t[5]||(t[5]=i=>Fe.value=i)},null,512),[[Pr,Fe.value]]),t[128]||(t[128]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-cyan-600 peer-checked:to-blue-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ve(["ml-3 text-xs",Fe.value?"text-cyan-300":"text-gray-300"])},et(Fe.value?"已开启":"已关闭"),3)])]),Fe.value?(z(),O("div",Ro,[r("div",null,[t[131]||(t[131]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Cursor",-1)),ue(r("select",{"onUpdate:modelValue":t[6]||(t[6]=i=>y.value=i),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[130]||(t[130]=[Tr('<option value="pointer" data-v-2c06aabe>pointer</option><option value="default" data-v-2c06aabe>default</option><option value="move" data-v-2c06aabe>move</option><option value="crosshair" data-v-2c06aabe>crosshair</option><option value="grab" data-v-2c06aabe>grab</option>',5)])],512),[[nl,y.value]])]),r("div",null,[t[132]||(t[132]=r("label",{class:"block text-xs text-gray-400 mb-1"},"函数名",-1)),ue(r("input",{"onUpdate:modelValue":t[7]||(t[7]=i=>Q.value=i),type:"text",placeholder:"handleClick",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[$e,Q.value]])])])):ee("",!0),Fe.value?(z(),O("div",To,[t[133]||(t[133]=r("label",{class:"block text-xs text-gray-400 mb-1"},"事件代码",-1)),ue(r("textarea",{"onUpdate:modelValue":t[8]||(t[8]=i=>J.value=i),rows:"6",placeholder:"function body...",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,512),[[$e,J.value]])])):ee("",!0)]),r("div",Po,[t[144]||(t[144]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"元素属性",-1)),r("div",Ho,[r("div",Wo,[t[135]||(t[135]=r("label",{class:"text-xs text-gray-400"},"启用 Class 样式",-1)),ue(r("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=i=>e.selectedEl.enableClassStyle=i),onChange:t[10]||(t[10]=i=>{e.selectedEl&&i.target.checked?(e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss()):e.selectedEl&&!i.target.checked&&e.removeCustomClassCssForElement(e.selectedEl.id)}),class:"rounded border-purple-500/30 text-purple-400 focus:ring-purple-400"},null,544),[[Pr,e.selectedEl.enableClassStyle]])]),(K=e.selectedEl)!=null&&K.enableClassStyle?(z(),O("div",_o,[t[136]||(t[136]=r("label",{class:"block text-xs text-gray-400 mb-1"},"CSS Class",-1)),r("div",Jo,[ue(r("input",{"onUpdate:modelValue":t[11]||(t[11]=i=>e.selectedEl.className=i),type:"text",placeholder:"自动生成唯一类名，可修改",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.className]]),r("button",{type:"button",onClick:t[12]||(t[12]=()=>{e.selectedEl&&(e.selectedEl.className=`cls-${String(e.selectedEl.id).slice(0,8)}`,e.initCustomClassSkeleton(e.selectedEl),e.refreshAllCustomClassCss())}),class:"px-2 py-1 text-xs bg-purple-600/60 hover:bg-purple-600 rounded text-white"},"生成默认")])])):ee("",!0),(Y=e.selectedEl)!=null&&Y.enableClassStyle?(z(),O("div",qo,[t[137]||(t[137]=r("label",{class:"block text-xs text-gray-400 mb-1"},"自定义样式（CSS 声明）",-1)),dt(Mo,{modelValue:String((qe=e.selectedEl.customClassCss)!=null?qe:""),"onUpdate:modelValue":t[13]||(t[13]=i=>{e.selectedEl.customClassCss=i,e.refreshAllCustomClassCss()}),height:"180px"},null,8,["modelValue"]),t[138]||(t[138]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"提示：已为当前类名生成 .className { } 模板；也可直接填写声明，系统会自动包裹并追加 !important。",-1))])):ee("",!0),e.selectedEl&&(e.selectedEl.type==="chart"||e.selectedEl.type==="container")?(z(),O("div",Xo,[t[139]||(t[139]=r("label",{class:"block text-xs text-gray-400 mb-1"},"元素ID",-1)),ue(r("input",{"onUpdate:modelValue":t[14]||(t[14]=i=>e.selectedEl.elementId=i),type:"text",placeholder:"输入元素ID",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.elementId]])])):ee("",!0),e.selectedEl?(z(),O("div",Yo,[t[143]||(t[143]=r("h3",{class:"text-sm font-medium text-purple-300"},"显示与隐藏",-1)),r("div",Ko,[t[141]||(t[141]=r("label",{class:"text-xs text-gray-400"},"隐藏该元素",-1)),r("label",Zo,[r("input",{type:"checkbox",class:"sr-only peer",checked:!!e.selectedEl.hidden,onChange:t[15]||(t[15]=i=>{const A=i.target.checked;e.selectedEl&&(e.selectedEl.hidden=A,A&&!e.selectedEl.hiddenLabel&&(e.selectedEl.hiddenLabel=`hidden-${String(e.selectedEl.id).slice(0,8)}`))})},null,40,Qo),t[140]||(t[140]=r("div",{class:"relative w-12 h-6 rounded-full bg-gray-700/60 transition-all duration-200 shadow-inner peer-checked:bg-gradient-to-r peer-checked:from-purple-600 peer-checked:to-pink-600"},[r("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 peer-checked:translate-x-6"})],-1)),r("span",{class:Ve(["ml-3 text-xs",e.selectedEl.hidden?"text-purple-300":"text-gray-300"])},et(e.selectedEl.hidden?"已隐藏":"显示中"),3)])]),e.selectedEl.hidden?(z(),O("div",es,[t[142]||(t[142]=r("label",{class:"block text-xs text-gray-400"},"隐藏标识",-1)),r("input",{type:"text",value:e.selectedEl.hiddenLabel||"",onInput:t[16]||(t[16]=i=>{e.selectedEl&&(e.selectedEl.hiddenLabel=i.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1",placeholder:"hidden-xxxx"},null,40,ts)])):ee("",!0)])):ee("",!0)])]),e.selectedEl&&e.selectedEl.type==="container"?(z(),O("div",rs,[t[165]||(t[165]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"容器样式",-1)),r("div",null,[t[145]||(t[145]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色（HEX）",-1)),r("div",ns,[r("input",{type:"color",value:((Pe=(Le=e.selectedEl)==null?void 0:Le.style)==null?void 0:Pe.backgroundColor)||"#000000",onInput:t[17]||(t[17]=i=>{const A=i.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=A)}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,ls),r("input",{type:"text",value:((rt=(Ye=e.selectedEl)==null?void 0:Ye.style)==null?void 0:rt.backgroundColor)||"",placeholder:"#1e293b 或 transparent",onInput:t[18]||(t[18]=i=>{const A=i.target.value.trim();e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=A)}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,os)]),t[146]||(t[146]=r("p",{class:"text-[11px] text-gray-500 mt-1"},"支持 #RGB/#RRGGBB 或 CSS 颜色名；启用渐变时该颜色被覆盖。",-1))]),r("div",ss,[r("div",as,[t[148]||(t[148]=r("label",{class:"block text-xs text-gray-400 mb-1"},"渐变背景",-1)),r("label",is,[r("input",{type:"checkbox",checked:!!((ct=(ut=e.selectedEl)==null?void 0:ut.style)!=null&&ct.backgroundGradient),onChange:t[19]||(t[19]=i=>{const A=i.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},A?e.selectedEl.style.backgroundGradient||(e.selectedEl.style.backgroundGradient={colors:["#42b883","#0ea5e9"],angle:90}):delete e.selectedEl.style.backgroundGradient)})},null,40,ds),t[147]||(t[147]=cr(" 启用 ",-1))])]),(Ie=(St=e.selectedEl)==null?void 0:St.style)!=null&&Ie.backgroundGradient?(z(),O("div",us,[r("div",null,[t[149]||(t[149]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"起始色（HEX）",-1)),r("div",cs,[r("input",{type:"color",value:((bt=(ft=(pt=(pe=e.selectedEl)==null?void 0:pe.style)==null?void 0:pt.backgroundGradient)==null?void 0:ft.colors)==null?void 0:bt[0])||"#42b883",onInput:t[20]||(t[20]=i=>{var fe;const A=i.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const E=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};E.colors=(fe=E.colors)!=null&&fe.length?E.colors:["","#"],E.colors[0]=A,e.selectedEl.style.backgroundGradient=E}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,ps),r("input",{type:"text",value:((ke=(He=(Mt=(vt=e.selectedEl)==null?void 0:vt.style)==null?void 0:Mt.backgroundGradient)==null?void 0:He.colors)==null?void 0:ke[0])||"",placeholder:"#42b883",onInput:t[21]||(t[21]=i=>{var fe;const A=i.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const E=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};E.colors=(fe=E.colors)!=null&&fe.length?E.colors:["","#"],E.colors[0]=A,e.selectedEl.style.backgroundGradient=E}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,fs)])]),r("div",null,[t[150]||(t[150]=r("label",{class:"block text-[11px] text-gray-400 mb-1"},"结束色（HEX）",-1)),r("div",gs,[r("input",{type:"color",value:((at=(De=(Ke=(Re=e.selectedEl)==null?void 0:Re.style)==null?void 0:Ke.backgroundGradient)==null?void 0:De.colors)==null?void 0:at[1])||"#0ea5e9",onInput:t[22]||(t[22]=i=>{var fe;const A=i.target.value;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const E=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};E.colors=(fe=E.colors)!=null&&fe.length?E.colors:["","#"],E.colors[1]=A,e.selectedEl.style.backgroundGradient=E}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,ms),r("input",{type:"text",value:((Je=(We=(gt=(Ze=e.selectedEl)==null?void 0:Ze.style)==null?void 0:gt.backgroundGradient)==null?void 0:We.colors)==null?void 0:Je[1])||"",placeholder:"#0ea5e9",onInput:t[23]||(t[23]=i=>{var fe;const A=i.target.value.trim();if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const E=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};E.colors=(fe=E.colors)!=null&&fe.length?E.colors:["","#"],E.colors[1]=A,e.selectedEl.style.backgroundGradient=E}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ys)])]),r("div",bs,[t[151]||(t[151]=r("label",{class:"block text-[11px] text-gray-400"},"角度（0-360）",-1)),r("input",{type:"range",min:"0",max:"360",step:"1",value:(wt=(It=(Nt=(Ct=e.selectedEl)==null?void 0:Ct.style)==null?void 0:Nt.backgroundGradient)==null?void 0:It.angle)!=null?wt:90,onInput:t[24]||(t[24]=i=>{const A=Number(i.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const E=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};E.angle=A,e.selectedEl.style.backgroundGradient=E}),class:"w-full"},null,40,xs),r("input",{type:"number",value:(fr=(Jt=(pr=(Ft=e.selectedEl)==null?void 0:Ft.style)==null?void 0:pr.backgroundGradient)==null?void 0:Jt.angle)!=null?fr:90,onInput:t[25]||(t[25]=i=>{const A=Number(i.target.value)||0;if(!e.selectedEl)return;e.selectedEl.style=e.selectedEl.style||{};const E=e.selectedEl.style.backgroundGradient||{colors:["","#"],angle:90};E.angle=A,e.selectedEl.style.backgroundGradient=E}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,hs)])])):ee("",!0),t[152]||(t[152]=r("p",{class:"text-[11px] text-gray-500"},"提示：仅在启用后显示渐变设置；未启用时使用背景色。",-1))]),r("div",vs,[r("div",ws,[t[154]||(t[154]=r("label",{class:"block text-xs text-gray-400"},"圆角",-1)),r("label",$s,[r("input",{type:"checkbox",checked:!!((qt=(gr=e.selectedEl)==null?void 0:gr.style)!=null&&qt.borderRadius)&&ye((yr=(mr=e.selectedEl)==null?void 0:mr.style)==null?void 0:yr.borderRadius)>0,onChange:t[26]||(t[26]=i=>{const A=i.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},A?e.selectedEl.style.borderRadius||(e.selectedEl.style.borderRadius="8px"):e.selectedEl.style.borderRadius="0")})},null,40,Es),t[153]||(t[153]=cr(" 启用 ",-1))])]),(xr=(br=e.selectedEl)==null?void 0:br.style)!=null&&xr.borderRadius&&ye((Yt=(Xt=e.selectedEl)==null?void 0:Xt.style)==null?void 0:Yt.borderRadius)>=0?(z(),O("div",ks,[r("div",Ss,[t[155]||(t[155]=r("span",{class:"text-[11px] text-gray-400"},"单位",-1)),r("button",{type:"button",class:Ve(["px-2 py-0.5 rounded text-[11px]",C((Ut=(Gt=e.selectedEl)==null?void 0:Gt.style)==null?void 0:Ut.borderRadius)==="px"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[27]||(t[27]=()=>{var A,E;const i=ye((E=(A=e.selectedEl)==null?void 0:A.style)==null?void 0:E.borderRadius);W(i,"px")})},"px",2),r("button",{type:"button",class:Ve(["px-2 py-0.5 rounded text-[11px]",C((vr=(hr=e.selectedEl)==null?void 0:hr.style)==null?void 0:vr.borderRadius)==="%"?"bg-purple-600/60":"bg-gray-700"]),onClick:t[28]||(t[28]=()=>{var A,E;const i=ye((E=(A=e.selectedEl)==null?void 0:A.style)==null?void 0:E.borderRadius);W(i,"%")})},"%",2)]),C((jt=(wr=e.selectedEl)==null?void 0:wr.style)==null?void 0:jt.borderRadius)==="px"?(z(),O("div",Ms,[r("input",{type:"range",min:"0",max:"64",step:"1",value:ye((Kt=(xt=e.selectedEl)==null?void 0:xt.style)==null?void 0:Kt.borderRadius),onInput:t[29]||(t[29]=i=>{const A=Number(i.target.value)||0;W(A,"px")}),class:"w-full"},null,40,Cs),r("input",{type:"number",value:ye((Zt=(At=e.selectedEl)==null?void 0:At.style)==null?void 0:Zt.borderRadius),onInput:t[30]||(t[30]=i=>{const A=Number(i.target.value)||0;W(A,"px")}),class:"w-24 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Ns)])):(z(),O("div",Is,[r("input",{type:"range",min:"0",max:"100",step:"1",value:ye((Er=($r=e.selectedEl)==null?void 0:$r.style)==null?void 0:Er.borderRadius),onInput:t[31]||(t[31]=i=>{const A=Number(i.target.value)||0;W(A,"%")}),class:"w-full"},null,40,Fs),r("div",js,[r("input",{type:"number",value:ye((it=(kr=e.selectedEl)==null?void 0:kr.style)==null?void 0:it.borderRadius),onInput:t[32]||(t[32]=i=>{const A=Number(i.target.value)||0;W(A,"%")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,As),t[156]||(t[156]=r("span",{class:"text-xs text-gray-400"},"%",-1))])]))])):ee("",!0)]),r("div",zs,[r("div",Os,[t[158]||(t[158]=r("label",{class:"block text-xs text-gray-400"},"阴影（box-shadow）",-1)),r("label",Bs,[r("input",{type:"checkbox",checked:!!((Sr=($t=e.selectedEl)==null?void 0:$t.style)!=null&&Sr.boxShadow),onChange:t[33]||(t[33]=i=>{const A=i.target.checked;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},A?e.selectedEl.style.boxShadow||(e.selectedEl.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)"):delete e.selectedEl.style.boxShadow)})},null,40,Ds),t[157]||(t[157]=cr(" 启用 ",-1))])]),(Qt=(Mr=e.selectedEl)==null?void 0:Mr.style)!=null&&Qt.boxShadow?(z(),O("div",Gs,[r("input",{type:"text",value:((tr=(er=e.selectedEl)==null?void 0:er.style)==null?void 0:tr.boxShadow)||"",placeholder:"例如: 0 8px 24px rgba(0,0,0,0.25)",onInput:t[34]||(t[34]=i=>{const A=i.target.value;e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.boxShadow=A)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,Us),r("div",Vs,[t[159]||(t[159]=r("label",{class:"block text-[11px] text-gray-400"},"X 偏移",-1)),r("div",Ls,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:X((zt=(Cr=e.selectedEl)==null?void 0:Cr.style)==null?void 0:zt.boxShadow).x,onInput:t[35]||(t[35]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae(A!=null?A:0,(Ae=E.y)!=null?Ae:0,(ze=E.blur)!=null?ze:0,(Oe=E.spread)!=null?Oe:0,(Be=E.color)!=null?Be:"#000000")}),class:"flex-1"},null,40,Rs),r("input",{type:"number",value:X((Lt=(Vt=e.selectedEl)==null?void 0:Vt.style)==null?void 0:Lt.boxShadow).x,onInput:t[36]||(t[36]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae(A!=null?A:0,(Ae=E.y)!=null?Ae:0,(ze=E.blur)!=null?ze:0,(Oe=E.spread)!=null?Oe:0,(Be=E.color)!=null?Be:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ts)])]),r("div",Ps,[t[160]||(t[160]=r("label",{class:"block text-[11px] text-gray-400"},"Y 偏移",-1)),r("div",Hs,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:X((rr=(Rt=e.selectedEl)==null?void 0:Rt.style)==null?void 0:rr.boxShadow).y,onInput:t[37]||(t[37]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,A!=null?A:0,(ze=E.blur)!=null?ze:0,(Oe=E.spread)!=null?Oe:0,(Be=E.color)!=null?Be:"#000000")}),class:"flex-1"},null,40,Ws),r("input",{type:"number",value:X((Nr=(nr=e.selectedEl)==null?void 0:nr.style)==null?void 0:Nr.boxShadow).y,onInput:t[38]||(t[38]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,A!=null?A:0,(ze=E.blur)!=null?ze:0,(Oe=E.spread)!=null?Oe:0,(Be=E.color)!=null?Be:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,_s)])]),r("div",Js,[t[161]||(t[161]=r("label",{class:"block text-[11px] text-gray-400"},"模糊",-1)),r("div",qs,[r("input",{type:"range",min:"0",max:"128",step:"1",value:X((st=(lr=e.selectedEl)==null?void 0:lr.style)==null?void 0:st.boxShadow).blur,onInput:t[39]||(t[39]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,(ze=E.y)!=null?ze:0,A!=null?A:0,(Oe=E.spread)!=null?Oe:0,(Be=E.color)!=null?Be:"#000000")}),class:"flex-1"},null,40,Xs),r("input",{type:"number",value:X((Ir=(nt=e.selectedEl)==null?void 0:nt.style)==null?void 0:Ir.boxShadow).blur,onInput:t[40]||(t[40]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,(ze=E.y)!=null?ze:0,A!=null?A:0,(Oe=E.spread)!=null?Oe:0,(Be=E.color)!=null?Be:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,Ys)])]),r("div",Ks,[t[162]||(t[162]=r("label",{class:"block text-[11px] text-gray-400"},"扩散",-1)),r("div",Zs,[r("input",{type:"range",min:"-64",max:"64",step:"1",value:X((jr=(Fr=e.selectedEl)==null?void 0:Fr.style)==null?void 0:jr.boxShadow).spread,onInput:t[41]||(t[41]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,(ze=E.y)!=null?ze:0,(Oe=E.blur)!=null?Oe:0,A!=null?A:0,(Be=E.color)!=null?Be:"#000000")}),class:"flex-1"},null,40,Qs),r("input",{type:"number",value:X((zr=(Ar=e.selectedEl)==null?void 0:Ar.style)==null?void 0:zr.boxShadow).spread,onInput:t[42]||(t[42]=i=>{var fe,je,Ae,ze,Oe,Be;const A=Number(i.target.value)||0,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,(ze=E.y)!=null?ze:0,(Oe=E.blur)!=null?Oe:0,A!=null?A:0,(Be=E.color)!=null?Be:"#000000")}),class:"w-20 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs"},null,40,ea)])])])):ee("",!0),r("div",ta,[t[163]||(t[163]=r("label",{class:"block text-[11px] text-gray-400"},"阴影颜色",-1)),(or=(Or=e.selectedEl)==null?void 0:Or.style)!=null&&or.boxShadow?(z(),O("div",ra,[r("input",{type:"color",value:X((Pt=(Tt=e.selectedEl)==null?void 0:Tt.style)==null?void 0:Pt.boxShadow).color||"#000000",onInput:t[43]||(t[43]=i=>{var fe,je,Ae,ze,Oe,Be;const A=i.target.value,E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,(ze=E.y)!=null?ze:0,(Oe=E.blur)!=null?Oe:0,(Be=E.spread)!=null?Be:0,A||"#000000")}),class:"w-10 h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,40,na),r("input",{type:"text",value:X((Ht=(sr=e.selectedEl)==null?void 0:sr.style)==null?void 0:Ht.boxShadow).color||"",placeholder:"#000000 或 rgba(...)",onInput:t[44]||(t[44]=i=>{var fe,je,Ae,ze,Oe,Be;const A=i.target.value.trim(),E=X((je=(fe=e.selectedEl)==null?void 0:fe.style)==null?void 0:je.boxShadow);ae((Ae=E.x)!=null?Ae:0,(ze=E.y)!=null?ze:0,(Oe=E.blur)!=null?Oe:0,(Be=E.spread)!=null?Be:0,A||"#000000")}),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,la)])):ee("",!0)]),t[164]||(t[164]=r("p",{class:"text-[11px] text-gray-500"},"支持滑动或数字输入；颜色可选色块与 HEX 文本。",-1))])])):ee("",!0),e.selectedEl&&e.selectedEl.type==="chart"?(z(),O("div",oa,[t[180]||(t[180]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"图表配置",-1)),r("div",sa,[r("button",{onClick:t[45]||(t[45]=i=>$.value="visual"),class:Ve(["px-3 py-1 rounded text-sm",$.value==="visual"?"bg-purple-600/60":"bg-gray-700"])},"可视化",2),r("button",{onClick:t[46]||(t[46]=i=>$.value="json"),class:Ve(["px-3 py-1 rounded text-sm",$.value==="json"?"bg-purple-600/60":"bg-gray-700"])},"JSON",2)]),$.value==="visual"?(z(),O("div",aa,[r("div",null,[t[166]||(t[166]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图表类型",-1)),dt(kt,{options:["line","bar","pie","mix"],modelValue:e.selectedEl.chartType||"line","onUpdate:modelValue":t[47]||(t[47]=i=>{e.selectedEl&&(e.selectedEl.chartType=i,e.selectedEl.chartOption=e.defaultChartOption(i),I.value=JSON.stringify(e.selectedEl.chartOption,null,2))})},null,8,["modelValue"])]),r("div",null,[t[167]||(t[167]=r("label",{class:"block text-xs text-gray-400 mb-1"},"标题",-1)),r("input",{value:((Ot=(Br=(Wt=e.selectedEl)==null?void 0:Wt.chartOption)==null?void 0:Br.title)==null?void 0:Ot.text)||"",onInput:t[48]||(t[48]=i=>re(i.target.value)),type:"text",placeholder:"输入图表标题",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,ia)]),r("div",da,[r("div",null,[t[168]||(t[168]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色列表（逗号分隔）",-1)),r("input",{value:((ir=(Dr=(ar=e.selectedEl)==null?void 0:ar.chartOption)==null?void 0:Dr.color)==null?void 0:ir.join(","))||"",onInput:t[49]||(t[49]=i=>R(i.target.value)),type:"text",placeholder:"#42b883,#ff9800",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,ua)]),r("div",null,[t[170]||(t[170]=r("label",{class:"block text-xs text-gray-400 mb-1"},"显示图例",-1)),r("select",{value:(l=(n=(dr=(Gr=e.selectedEl)==null?void 0:Gr.chartOption)==null?void 0:dr.legend)==null?void 0:n.show)==null||l?"1":"0",onChange:t[50]||(t[50]=i=>_(i.target.value)),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[169]||(t[169]=[r("option",{value:"1"},"显示",-1),r("option",{value:"0"},"隐藏",-1)])],40,ca)])]),e.selectedEl&&e.selectedEl.chartType!=="pie"?(z(),O("div",pa,[r("div",null,[t[171]||(t[171]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最小值",-1)),r("input",{value:Array.isArray((u=(a=e.selectedEl)==null?void 0:a.chartOption)==null?void 0:u.yAxis)?(M=(N=(S=(g=(c=e.selectedEl)==null?void 0:c.chartOption)==null?void 0:g.yAxis)==null?void 0:S[0])==null?void 0:N.min)!=null?M:"":(L=(k=(s=(m=e.selectedEl)==null?void 0:m.chartOption)==null?void 0:s.yAxis)==null?void 0:k.min)!=null?L:"",onInput:t[51]||(t[51]=i=>{const A=i.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const E=e.selectedEl.chartOption.yAxis,fe=A===""?null:Number(A);Array.isArray(E)?(E[0]=E[0]||{},E[0].min=fe):(e.selectedEl.chartOption.yAxis=E||{},e.selectedEl.chartOption.yAxis.min=fe),I.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,fa)]),r("div",null,[t[172]||(t[172]=r("label",{class:"block text-xs text-gray-400 mb-1"},"Y轴最大值",-1)),r("input",{value:Array.isArray((ge=(de=e.selectedEl)==null?void 0:de.chartOption)==null?void 0:ge.yAxis)?(le=(ve=(Ce=(Me=(Ne=e.selectedEl)==null?void 0:Ne.chartOption)==null?void 0:Me.yAxis)==null?void 0:Ce[0])==null?void 0:ve.max)!=null?le:"":(Se=(te=(se=(oe=e.selectedEl)==null?void 0:oe.chartOption)==null?void 0:se.yAxis)==null?void 0:te.max)!=null?Se:"",onInput:t[52]||(t[52]=i=>{const A=i.target.value;if(!e.selectedEl)return;e.selectedEl.chartOption||(e.selectedEl.chartOption=e.defaultChartOption(e.selectedEl.chartType||"line"));const E=e.selectedEl.chartOption.yAxis,fe=A===""?null:Number(A);Array.isArray(E)?(E[0]=E[0]||{},E[0].max=fe):(e.selectedEl.chartOption.yAxis=E||{},e.selectedEl.chartOption.yAxis.max=fe),I.value=JSON.stringify(e.selectedEl.chartOption,null,2)}),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,40,ga)])])):ee("",!0),e.selectedEl&&(e.selectedEl.chartType==="line"||e.selectedEl.chartType==="mix")?(z(),O("div",ma,[r("div",null,[t[174]||(t[174]=r("label",{class:"block text-xs text-gray-400 mb-1"},"折线平滑",-1)),r("select",{value:"1",onChange:t[53]||(t[53]=i=>{const A=i.target.value==="1";e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(E=>{E.type==="line"&&(E.smooth=A)}),I.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},[...t[173]||(t[173]=[r("option",{value:"1"},"平滑",-1),r("option",{value:"0"},"不平滑",-1)])],32)]),r("div",null,[t[175]||(t[175]=r("label",{class:"block text-xs text-gray-400 mb-1"},"线宽",-1)),r("input",{value:2,onInput:t[54]||(t[54]=i=>{const A=Number(i.target.value)||2;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(E=>{E.type==="line"&&(E.lineStyle=E.lineStyle||{},E.lineStyle.width=A)}),I.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):ee("",!0),e.selectedEl&&(e.selectedEl.chartType==="bar"||e.selectedEl.chartType==="mix")?(z(),O("div",ya,[r("div",null,[t[176]||(t[176]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变起始色",-1)),r("input",{type:"color",value:"#42b883",onInput:t[55]||(t[55]=i=>{const A=i.target.value;P(A,"#0ea5e9")}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[177]||(t[177]=r("label",{class:"block text-xs text-gray-400 mb-1"},"柱状渐变结束色",-1)),r("input",{type:"color",value:"#0ea5e9",onInput:t[56]||(t[56]=i=>{const A=i.target.value;P("#42b883",A)}),class:"w-full h-8 bg-gray-800/50 border border-purple-500/30 rounded"},null,32)]),r("div",null,[t[178]||(t[178]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),r("input",{value:4,onInput:t[57]||(t[57]=i=>{const A=Number(i.target.value)||0;e.selectedEl&&e.selectedEl.chartOption&&((e.selectedEl.chartOption.series||[]).forEach(E=>{E.type==="bar"&&(E.itemStyle=E.itemStyle||{},E.itemStyle.borderRadius=[A,A,0,0])}),I.value=JSON.stringify(e.selectedEl.chartOption,null,2))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm"},null,32)])])):ee("",!0)])):(z(),O("div",ba,[t[179]||(t[179]=r("label",{class:"block text-xs text-gray-400 mb-1"},"ECharts Option JSON",-1)),ue(r("textarea",{"onUpdate:modelValue":t[58]||(t[58]=i=>I.value=i),rows:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs font-mono"},null,512),[[$e,I.value]]),r("div",xa,[r("button",{onClick:t[59]||(t[59]=i=>p()),class:"px-3 py-1 bg-emerald-600 rounded text-sm"},"应用配置"),H.value?(z(),O("div",ha,et(H.value),1)):ee("",!0)])]))])):ee("",!0),e.selectedEl&&e.selectedEl.type==="line"?(z(),O("div",va,[t[188]||(t[188]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"线条设置",-1)),r("div",wa,[t[181]||(t[181]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",$a,[r("input",{value:e.safeHex(((v=(f=e.selectedEl)==null?void 0:f.style)==null?void 0:v.lineColor)||""),onInput:t[60]||(t[60]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=i.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,Ea),r("input",{value:(j=(w=(F=e.selectedEl)==null?void 0:F.style)==null?void 0:w.lineColor)!=null?j:"#ffffff",onInput:t[61]||(t[61]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineColor=i.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,40,ka)])]),r("div",Sa,[r("div",null,[t[182]||(t[182]=r("label",{class:"block text-xs text-gray-400 mb-1"},"方向",-1)),r("div",Ma,[r("button",{onClick:t[62]||(t[62]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="horizontal")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((b=(Z=e.selectedEl)==null?void 0:Z.style)==null?void 0:b.lineOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[63]||(t[63]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineOrientation="vertical")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((B=(G=e.selectedEl)==null?void 0:G.style)==null?void 0:B.lineOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)])]),r("div",null,[t[183]||(t[183]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细(px)",-1)),r("input",{value:(ie=(me=(q=e.selectedEl)==null?void 0:q.style)==null?void 0:me.lineThickness)!=null?ie:2,onInput:t[64]||(t[64]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineThickness=Number(i.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ca)])]),r("div",Na,[r("div",null,[t[185]||(t[185]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),r("select",{value:((Ue=(we=e.selectedEl)==null?void 0:we.style)==null?void 0:Ue.lineStyle)||"solid",onChange:t[65]||(t[65]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineStyle=i.target.value)}),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[184]||(t[184]=[r("option",{value:"solid"},"实线",-1),r("option",{value:"dashed"},"虚线",-1)])],40,Ia)]),((tt=(Te=e.selectedEl)==null?void 0:Te.style)==null?void 0:tt.lineStyle)==="dashed"?(z(),O("div",Fa,[t[186]||(t[186]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线长度(px)",-1)),r("input",{value:(Qe=(ot=(_e=e.selectedEl)==null?void 0:_e.style)==null?void 0:ot.lineDashLength)!=null?Qe:6,onInput:t[66]||(t[66]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashLength=Number(i.target.value))}),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,ja)])):ee("",!0)]),((ht=(mt=e.selectedEl)==null?void 0:mt.style)==null?void 0:ht.lineStyle)==="dashed"?(z(),O("div",Aa,[r("div",null,[t[187]||(t[187]=r("label",{class:"block text-xs text-gray-400 mb-1"},"虚线间距(px)",-1)),r("input",{value:(qr=(Ur=(Et=e.selectedEl)==null?void 0:Et.style)==null?void 0:Ur.lineDashGap)!=null?qr:4,onInput:t[67]||(t[67]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineDashGap=Number(i.target.value))}),type:"number",min:"0",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,za)])])):ee("",!0)])):ee("",!0),e.selectedEl&&e.selectedEl.type==="text"?(z(),O("div",Oa,[t[221]||(t[221]=r("h3",{class:"text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1"},"文本设置",-1)),r("div",Ba,[t[193]||(t[193]=r("label",{class:"block text-xs text-gray-400 mb-1"},"内容",-1)),ue(r("textarea",{"onUpdate:modelValue":t[68]||(t[68]=i=>e.selectedEl.text=i),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 resize-none",rows:"2"},null,512),[[$e,e.selectedEl.text]]),r("div",Da,[t[192]||(t[192]=r("label",{class:"block text-xs text-gray-400 mb-1"},"动态值",-1)),r("div",Ga,[r("input",{type:"checkbox",checked:!!((Yr=(Xr=e.selectedEl)==null?void 0:Xr.dynamic)!=null&&Yr.enabled),onChange:t[69]||(t[69]=i=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!1,objectName:"",propertyPath:""},e.selectedEl.dynamic.enabled=i.target.checked)}),class:"rounded accent-purple-600"},null,40,Ua),t[189]||(t[189]=r("span",{class:"text-xs text-gray-400"},"启用后从数据库对象绑定",-1))]),(Zr=(Kr=e.selectedEl)==null?void 0:Kr.dynamic)!=null&&Zr.enabled?(z(),O("div",Va,[r("div",null,[t[190]||(t[190]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择对象",-1)),dt(kt,{options:e.databaseObjects.map(i=>i.name),modelValue:((en=(Qr=e.selectedEl)==null?void 0:Qr.dynamic)==null?void 0:en.objectName)||"","onUpdate:modelValue":t[70]||(t[70]=i=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.objectName=String(i||""))})},null,8,["options","modelValue"])]),r("div",null,[t[191]||(t[191]=r("label",{class:"block text-xs text-gray-400 mb-1"},"属性路径",-1)),dt(kt,{options:ne.value,modelValue:((rn=(tn=e.selectedEl)==null?void 0:tn.dynamic)==null?void 0:rn.propertyPath)||"","onUpdate:modelValue":t[71]||(t[71]=i=>{e.selectedEl&&(e.selectedEl.dynamic=e.selectedEl.dynamic||{enabled:!0,objectName:"",propertyPath:""},e.selectedEl.dynamic.propertyPath=String(i||""))})},null,8,["options","modelValue"])]),r("div",La,"预览值: "+et(he(e.selectedEl)),1)])):ee("",!0)])]),r("div",Ra,[t[194]||(t[194]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",Ta,[r("button",{onClick:t[72]||(t[72]=()=>{const i=e.selectedEl;!i||i.type!=="text"||(i.autoSize=!0)}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize!==!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"自适应",2),r("button",{onClick:t[73]||(t[73]=()=>{const i=e.selectedEl;!i||i.type!=="text"||(i.autoSize=!1)}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",e.selectedEl.autoSize===!1?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"固定尺寸",2)])]),r("div",Pa,[r("div",null,[t[195]||(t[195]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字号",-1)),dt(kt,{options:e.fontSizeLibrary,modelValue:((nn=e.selectedEl.style)==null?void 0:nn.fontSize)||14,"onUpdate:modelValue":t[74]||(t[74]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontSize=i)}),numeric:!0},null,8,["options","modelValue"])]),r("div",null,[t[196]||(t[196]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字体",-1)),dt(kt,{options:e.fontLibrary,modelValue:((ln=e.selectedEl.style)==null?void 0:ln.fontFamily)||e.config.globalFontFamily,"onUpdate:modelValue":t[75]||(t[75]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontFamily=i)})},null,8,["options","modelValue"])])]),r("div",Ha,[r("div",null,[t[197]||(t[197]=r("label",{class:"block text-xs text-gray-400 mb-1"},"粗细",-1)),dt(kt,{options:e.fontWeightOptions,modelValue:((on=e.selectedEl.style)==null?void 0:on.fontWeight)||"400","onUpdate:modelValue":t[76]||(t[76]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontWeight=i)})},null,8,["options","modelValue"])]),r("div",null,[t[198]||(t[198]=r("label",{class:"block text-xs text-gray-400 mb-1"},"样式",-1)),dt(kt,{options:e.fontStyleOptions,modelValue:((sn=e.selectedEl.style)==null?void 0:sn.fontStyle)||"normal","onUpdate:modelValue":t[77]||(t[77]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.fontStyle=i)})},null,8,["options","modelValue"])])]),r("div",Wa,[r("div",null,[t[199]||(t[199]=r("label",{class:"block text-xs text-gray-400 mb-1"},"字间距",-1)),r("input",{value:((an=e.selectedEl.style)==null?void 0:an.letterSpacing)||0,onInput:t[78]||(t[78]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.letterSpacing=Number(i.target.value))}),type:"number",step:"0.1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,_a)]),r("div",null,[t[200]||(t[200]=r("label",{class:"block text-xs text-gray-400 mb-1"},"行高",-1)),r("input",{value:((dn=e.selectedEl.style)==null?void 0:dn.lineHeight)||1.5,onInput:t[79]||(t[79]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.lineHeight=Number(i.target.value))}),type:"number",step:"0.1",min:"0.5",max:"3",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,40,Ja)])]),r("div",qa,[t[201]||(t[201]=r("label",{class:"block text-xs text-gray-400 mb-1"},"颜色",-1)),r("div",Xa,[r("input",{value:(cn=(un=e.selectedEl)==null?void 0:un.style)!=null&&cn.textGradient?"#000000":((fn=(pn=e.selectedEl)==null?void 0:pn.style)==null?void 0:fn.color)||e.config.globalColor,onInput:t[80]||(t[80]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=i.target.value)}),type:"color",disabled:!!((mn=(gn=e.selectedEl)==null?void 0:gn.style)!=null&&mn.textGradient),class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"},null,40,Ya),r("input",{value:(bn=(yn=e.selectedEl)==null?void 0:yn.style)!=null&&bn.textGradient?"transparent":(vn=(hn=(xn=e.selectedEl)==null?void 0:xn.style)==null?void 0:hn.color)!=null?vn:e.config.globalColor,onInput:t[81]||(t[81]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.color=i.target.value)}),type:"text",disabled:!!(($n=(wn=e.selectedEl)==null?void 0:wn.style)!=null&&$n.textGradient),class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"#000000"},null,40,Ka)]),(kn=(En=e.selectedEl)==null?void 0:En.style)!=null&&kn.textGradient?(z(),O("div",Za,"文字渐变启用时，文字颜色自动设为透明")):ee("",!0)]),r("div",Qa,[t[202]||(t[202]=r("label",{class:"block text-xs text-gray-400 mb-1"},"背景色",-1)),r("div",ei,[r("input",{value:e.safeHex(((Mn=(Sn=e.selectedEl)==null?void 0:Sn.style)==null?void 0:Mn.backgroundColor)||""),onInput:t[82]||(t[82]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=i.target.value)}),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,40,ti),r("input",{value:(In=(Nn=(Cn=e.selectedEl)==null?void 0:Cn.style)==null?void 0:Nn.backgroundColor)!=null?In:"transparent",onInput:t[83]||(t[83]=i=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.backgroundColor=i.target.value)}),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"transparent"},null,40,ri)])]),r("div",ni,[t[203]||(t[203]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本对齐",-1)),r("div",li,[r("button",{onClick:t[84]||(t[84]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="left")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Fn=e.selectedEl.style)==null?void 0:Fn.textAlign)||"left")==="left"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"左对齐",2),r("button",{onClick:t[85]||(t[85]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="center")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((jn=e.selectedEl.style)==null?void 0:jn.textAlign)||"left")==="center"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"居中",2),r("button",{onClick:t[86]||(t[86]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textAlign="right")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((An=e.selectedEl.style)==null?void 0:An.textAlign)||"left")==="right"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"右对齐",2)])]),r("div",oi,[t[204]||(t[204]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本方向",-1)),r("div",si,[r("button",{onClick:t[87]||(t[87]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="horizontal")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((On=(zn=e.selectedEl)==null?void 0:zn.style)==null?void 0:On.textOrientation)||"horizontal")==="horizontal"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"横向",2),r("button",{onClick:t[88]||(t[88]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textOrientation="vertical")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Dn=(Bn=e.selectedEl)==null?void 0:Bn.style)==null?void 0:Dn.textOrientation)||"horizontal")==="vertical"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"纵向",2)]),t[205]||(t[205]=r("p",{class:"text-[11px] text-gray-400"},"纵向使用 CSS writing-mode 展示，适合竖排文本。",-1))]),r("div",ai,[t[207]||(t[207]=r("label",{class:"block text-xs text-gray-400 mb-1"},"布局倾斜",-1)),r("div",ii,[ue(r("input",{"onUpdate:modelValue":t[89]||(t[89]=i=>e.selectedEl.style.skewAngle=i),type:"range",min:"-45",max:"45",class:"flex-1"},null,512),[[$e,e.selectedEl.style.skewAngle,void 0,{number:!0}]]),ue(r("input",{"onUpdate:modelValue":t[90]||(t[90]=i=>e.selectedEl.style.skewAngle=i),type:"number",min:"-45",max:"45",class:"w-16 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.style.skewAngle,void 0,{number:!0}]])]),r("div",di,[t[206]||(t[206]=r("label",{class:"text-xs text-gray-400"},"布局倾斜跟随",-1)),r("button",{onClick:t[91]||(t[91]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!0)}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(Un=(Gn=e.selectedEl)==null?void 0:Gn.style)!=null&&Un.skewFlowEnabled?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"开",2),r("button",{onClick:t[92]||(t[92]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.skewFlowEnabled=!1)}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(Ln=(Vn=e.selectedEl)==null?void 0:Vn.style)!=null&&Ln.skewFlowEnabled?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-purple-600 text-white"])},"关",2)]),t[208]||(t[208]=r("p",{class:"text-[11px] text-gray-400"},"调整整体容器的 X 轴倾斜角度（-45° ~ 45°）。启用“跟随”后，文本布局按父视图倾斜线性排布，字符保持正立，可与波形叠加。",-1))]),r("div",ui,[r("div",ci,[t[209]||(t[209]=r("label",{class:"text-xs text-gray-400"},"文本波形",-1)),r("div",pi,[(Pn=(Tn=(Rn=e.selectedEl)==null?void 0:Rn.style)==null?void 0:Tn.textWave)!=null&&Pn.enabled?(z(),O("button",{key:1,onClick:t[94]||(t[94]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!1})}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):(z(),O("button",{key:0,onClick:t[93]||(t[93]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textWave={enabled:!0,amplitude:8,frequency:.5,phase:0})}),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用"))])]),(_n=(Wn=(Hn=e.selectedEl)==null?void 0:Hn.style)==null?void 0:Wn.textWave)!=null&&_n.enabled?(z(),O("div",fi,[r("div",gi,[t[210]||(t[210]=r("label",{class:"block text-xs text-gray-400 mb-1"},"幅度(px)",-1)),ue(r("input",{"onUpdate:modelValue":t[95]||(t[95]=i=>e.selectedEl.style.textWave.amplitude=i),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.style.textWave.amplitude,void 0,{number:!0}]])]),r("div",mi,[t[211]||(t[211]=r("label",{class:"block text-xs text-gray-400 mb-1"},"频率(rad/字)",-1)),ue(r("input",{"onUpdate:modelValue":t[96]||(t[96]=i=>e.selectedEl.style.textWave.frequency=i),type:"number",step:"0.1",min:"0.1",max:"10",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.style.textWave.frequency,void 0,{number:!0}]])]),r("div",yi,[t[212]||(t[212]=r("label",{class:"block text-xs text-gray-400 mb-1"},"相位(rad)",-1)),ue(r("input",{"onUpdate:modelValue":t[97]||(t[97]=i=>e.selectedEl.style.textWave.phase=i),type:"number",step:"0.1",min:"-100",max:"100",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.style.textWave.phase,void 0,{number:!0}]])])])):ee("",!0),t[213]||(t[213]=r("p",{class:"text-[11px] text-gray-400"},"每个字符沿 Y 轴按正弦位移，字符保持正立。",-1))]),r("div",bi,[t[214]||(t[214]=r("label",{class:"block text-xs text-gray-400 mb-1"},"文本装饰",-1)),r("div",xi,[r("button",{onClick:t[98]||(t[98]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="underline"?"none":"underline")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Jn=e.selectedEl.style)==null?void 0:Jn.textDecoration)||"none")==="underline"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"下划线",2),r("button",{onClick:t[99]||(t[99]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration=e.selectedEl.style.textDecoration==="line-through"?"none":"line-through")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((qn=e.selectedEl.style)==null?void 0:qn.textDecoration)||"none")==="line-through"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"删除线",2),r("button",{onClick:t[100]||(t[100]=()=>{e.selectedEl&&(e.selectedEl.style=e.selectedEl.style||{},e.selectedEl.style.textDecoration="none")}),class:Ve(["px-2 py-1 text-xs rounded transition-colors duration-200",(((Xn=e.selectedEl.style)==null?void 0:Xn.textDecoration)||"none")==="none"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},"无",2)])]),r("div",hi,[r("div",vi,[t[215]||(t[215]=r("label",{class:"text-xs text-gray-400"},"文本渐变",-1)),r("div",wi,[(Yn=e.selectedEl.style)!=null&&Yn.textGradient?ee("",!0):(z(),O("button",{key:0,onClick:t[101]||(t[101]=i=>Ee(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(Kn=e.selectedEl.style)!=null&&Kn.textGradient?(z(),O("button",{key:1,onClick:t[102]||(t[102]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.textGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):ee("",!0)])]),(Zn=e.selectedEl.style)!=null&&Zn.textGradient?(z(),O("div",$i,[r("div",Ei,[r("div",null,[t[216]||(t[216]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",ki,[ue(r("input",{"onUpdate:modelValue":t[103]||(t[103]=i=>e.selectedEl.style.textGradient.colors[0]=i),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[$e,e.selectedEl.style.textGradient.colors[0]]]),ue(r("input",{"onUpdate:modelValue":t[104]||(t[104]=i=>e.selectedEl.style.textGradient.colors[0]=i),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#DFDD5A"},null,512),[[$e,e.selectedEl.style.textGradient.colors[0]]])])]),r("div",null,[t[217]||(t[217]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",Si,[ue(r("input",{"onUpdate:modelValue":t[105]||(t[105]=i=>e.selectedEl.style.textGradient.colors[1]=i),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[$e,e.selectedEl.style.textGradient.colors[1]]]),ue(r("input",{"onUpdate:modelValue":t[106]||(t[106]=i=>e.selectedEl.style.textGradient.colors[1]=i),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#FFFFFF"},null,512),[[$e,e.selectedEl.style.textGradient.colors[1]]])])])]),r("div",null,[r("label",Mi,"角度: "+et(e.selectedEl.style.textGradient.angle||0)+"°",1),ue(r("input",{"onUpdate:modelValue":t[107]||(t[107]=i=>e.selectedEl.style.textGradient.angle=i),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[$e,e.selectedEl.style.textGradient.angle,void 0,{number:!0}]])])])):ee("",!0)]),r("div",Ci,[r("div",Ni,[t[218]||(t[218]=r("label",{class:"text-xs text-gray-400"},"背景渐变",-1)),r("div",Ii,[(Qn=e.selectedEl.style)!=null&&Qn.backgroundGradient?ee("",!0):(z(),O("button",{key:0,onClick:t[108]||(t[108]=i=>U(e.selectedEl)),class:"px-2 py-1 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200"},"启用")),(el=e.selectedEl.style)!=null&&el.backgroundGradient?(z(),O("button",{key:1,onClick:t[109]||(t[109]=()=>{e.selectedEl&&e.selectedEl.style&&(e.selectedEl.style.backgroundGradient=void 0)}),class:"px-2 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded text-xs transition-colors duration-200"},"关闭")):ee("",!0)])]),(tl=e.selectedEl.style)!=null&&tl.backgroundGradient?(z(),O("div",Fi,[r("div",ji,[r("div",null,[t[219]||(t[219]=r("label",{class:"block text-xs text-gray-400 mb-1"},"起始色",-1)),r("div",Ai,[ue(r("input",{"onUpdate:modelValue":t[110]||(t[110]=i=>e.selectedEl.style.backgroundGradient.colors[0]=i),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[$e,e.selectedEl.style.backgroundGradient.colors[0]]]),ue(r("input",{"onUpdate:modelValue":t[111]||(t[111]=i=>e.selectedEl.style.backgroundGradient.colors[0]=i),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#00A3FF"},null,512),[[$e,e.selectedEl.style.backgroundGradient.colors[0]]])])]),r("div",null,[t[220]||(t[220]=r("label",{class:"block text-xs text-gray-400 mb-1"},"结束色",-1)),r("div",zi,[ue(r("input",{"onUpdate:modelValue":t[112]||(t[112]=i=>e.selectedEl.style.backgroundGradient.colors[1]=i),type:"color",class:"w-8 h-6 bg-gray-800/50 border border-purple-500/30 rounded cursor-pointer"},null,512),[[$e,e.selectedEl.style.backgroundGradient.colors[1]]]),ue(r("input",{"onUpdate:modelValue":t[113]||(t[113]=i=>e.selectedEl.style.backgroundGradient.colors[1]=i),type:"text",class:"flex-1 px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-xs focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200",placeholder:"#ffffff"},null,512),[[$e,e.selectedEl.style.backgroundGradient.colors[1]]])])])]),r("div",null,[r("label",Oi,"角度: "+et(e.selectedEl.style.backgroundGradient.angle||0)+"°",1),ue(r("input",{"onUpdate:modelValue":t[114]||(t[114]=i=>e.selectedEl.style.backgroundGradient.angle=i),type:"range",min:"0",max:"360",class:"w-full"},null,512),[[$e,e.selectedEl.style.backgroundGradient.angle,void 0,{number:!0}]])])])):ee("",!0)])])):ee("",!0),e.selectedEl&&e.selectedEl.type==="image"?(z(),O("div",Bi,[t[230]||(t[230]=Tr('<h3 class="text-sm font-medium text-purple-300 border-b border-purple-500/30 pb-1" data-v-2c06aabe>图片设置</h3><div class="space-y-2" data-v-2c06aabe><label class="block text-xs text-gray-400 mb-1" data-v-2c06aabe>图片来源</label><div class="grid grid-cols-2 gap-2" data-v-2c06aabe><button class="px-3 py-2 bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 rounded text-xs transition-colors duration-200" data-v-2c06aabe>上传文件</button><button class="px-3 py-2 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded text-xs transition-colors duration-200" data-v-2c06aabe>选择图标</button></div></div>',2)),r("div",Di,[t[222]||(t[222]=r("label",{class:"block text-xs text-gray-400 mb-1"},"图片文件",-1)),r("input",{type:"file",onChange:T,accept:"image/*",class:"w-full text-xs text-gray-300 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-purple-600 file:text-white hover:file:bg-purple-500 file:cursor-pointer"},null,32)]),e.iconLibrary.length>0?(z(),O("div",Gi,[t[223]||(t[223]=r("label",{class:"block text-xs text-gray-400 mb-1"},"选择图标",-1)),r("div",Ui,[r("div",Vi,[(z(!0),O(Bt,null,_t(e.iconLibrary,i=>(z(),O("div",{key:i.id,onClick:A=>D(i),class:"aspect-square bg-gray-700/50 rounded cursor-pointer hover:bg-gray-600/50 transition-colors duration-200 flex items-center justify-center p-1 border border-transparent hover:border-green-400/50"},[r("img",{src:i.url,alt:i.name,class:"max-w-full max-h-full object-contain",loading:"lazy"},null,8,Ri)],8,Li))),128))])]),e.iconLibrary.length===0?(z(),O("div",Ti,"暂无图标，请先在图标库管理中上传图标")):ee("",!0)])):ee("",!0),r("div",{class:"space-y-2"},[t[224]||(t[224]=r("label",{class:"block text-xs text-gray-400 mb-1"},"尺寸模式",-1)),r("div",{class:"grid grid-cols-2 gap-2"},[r("button",{onClick:ce,class:Ve(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-blue-600/30 hover:bg-blue-600/50 text-blue-300"])},"自适应（原始尺寸）"),r("button",{onClick:be,class:Ve(["px-3 py-2 rounded text-xs transition-colors duration-200","bg-purple-600/30 hover:bg-purple-600/50 text-purple-300"])},"固定大小")])]),r("div",Pi,[r("div",null,[t[225]||(t[225]=r("label",{class:"block text-xs text-gray-400 mb-1"},"宽度(px)",-1)),ue(r("input",{"onUpdate:modelValue":t[115]||(t[115]=i=>e.selectedEl.width=i),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.width,void 0,{number:!0}]])]),r("div",null,[t[226]||(t[226]=r("label",{class:"block text-xs text-gray-400 mb-1"},"高度(px)",-1)),ue(r("input",{"onUpdate:modelValue":t[116]||(t[116]=i=>e.selectedEl.height=i),type:"number",min:"1",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.height,void 0,{number:!0}]])]),r("div",null,[t[228]||(t[228]=r("label",{class:"block text-xs text-gray-400 mb-1"},"对象适配",-1)),ue(r("select",{"onUpdate:modelValue":t[117]||(t[117]=i=>e.selectedEl.style.objectFit=i),class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},[...t[227]||(t[227]=[Tr('<option value="contain" data-v-2c06aabe>contain（完整显示）</option><option value="cover" data-v-2c06aabe>cover（填充裁剪）</option><option value="fill" data-v-2c06aabe>fill（拉伸填充）</option><option value="scale-down" data-v-2c06aabe>scale-down（缩小适配）</option><option value="none" data-v-2c06aabe>none（不适配）</option>',5)])],512),[[nl,e.selectedEl.style.objectFit]])])]),r("div",Hi,[t[229]||(t[229]=r("label",{class:"block text-xs text-gray-400 mb-1"},"圆角",-1)),ue(r("input",{"onUpdate:modelValue":t[118]||(t[118]=i=>e.selectedEl.style.borderRadius=i),type:"number",class:"w-full px-2 py-1 bg-gray-800/50 border border-purple-500/30 rounded text-gray-100 text-sm focus:border-purple-400 focus:ring-1 focus:ring-purple-400 focus:outline-none transition-all duration-200"},null,512),[[$e,e.selectedEl.style.borderRadius,void 0,{number:!0}]])])])):ee("",!0),r("div",Wi,[r("button",{onClick:t[119]||(t[119]=i=>d("saveSelectedAsComponent")),class:"w-full px-3 py-2 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-purple-500/25"},"保存为组件"),r("button",{onClick:t[120]||(t[120]=i=>d("duplicateSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-blue-500/25"},"复制元素"),r("button",{onClick:t[121]||(t[121]=i=>d("removeSelected")),class:"w-full px-3 py-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-red-500/25"},"删除元素")])])):ee("",!0),e.selectedEl?ee("",!0):(z(),O("div",_i,[...t[231]||(t[231]=[r("div",{class:"w-16 h-16 mx-auto mb-4 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center"},[r("span",{class:"text-2xl"},"📝")],-1),r("p",{class:"text-sm"},"选择一个元素来编辑其属性",-1)])]))])}}}),Xi=Jr(qi,[["__scopeId","data-v-2c06aabe"]]),Yi={class:"h-full bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white relative overflow-hidden min-w-[1200px]"},Ki={class:"relative z-10 flex h-full min-h-[600px] gap-4 p-4"},Zi={class:"flex-1 min-w-0 flex flex-col bg-gray-900/60 backdrop-blur-sm border border-purple-500/30 rounded-xl shadow-2xl shadow-purple-500/20"},Qi={class:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-gradient-to-r from-purple-600/20 to-pink-600/20 flex-shrink-0"},ed={class:"flex gap-2"},td={class:"relative"},rd={class:"grid grid-cols-2 gap-2"},nd={class:"flex items-center gap-2"},ld={class:"text-sm text-gray-400 min-w-[60px] text-center"},od={key:0,class:"absolute inset-0 pointer-events-none z-50"},sd={key:1,class:"absolute inset-0 z-[9999] select-none pointer-events-none"},ad={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},id={class:"relative w-[800px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-fuchsia-500/40 rounded-xl shadow-2xl"},dd={class:"p-4 space-y-3"},ud={class:"flex items-center gap-2"},cd={key:0,class:"text-center text-sm text-gray-400 py-6"},pd={key:1},fd={key:0,class:"text-center text-sm text-gray-400 py-6"},gd={key:1,class:"grid grid-cols-3 gap-3"},md={class:"aspect-video bg-gray-700/50 flex items-center justify-center"},yd=["src"],bd={key:1,class:"text-gray-400 text-xs"},xd={class:"p-3 space-y-1"},hd={class:"flex items-center justify-between"},vd=["title"],wd={class:"text-xs text-gray-500"},$d={class:"flex flex-wrap gap-1 mt-1"},Ed={class:"pt-2"},kd=["onClick"],Sd={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},Md={class:"relative w-[600px] max-w-[90vw] bg-gray-900/90 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl"},Cd={class:"flex items-center justify-between p-4 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-600/20 to-blue-600/20"},Nd={class:"p-4 space-y-3 max-h-[50vh] overflow-y-auto"},Id={key:0,class:"text-center text-sm text-gray-400 py-6"},Fd={key:1,class:"space-y-2"},jd=["title"],Ad=["onClick"],zd=50,Od=Dt({__name:"LowCodeBuilder",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(x){const o=x,e=Ml(),d=Il(),$=Ge(()=>{var n;return(n=o.projectId)!=null?n:e.params.id?String(e.params.id):void 0}),I=xe(null);async function H(){if($.value)try{const n=(await he()).transaction(["projects"],"readonly").objectStore("projects").get($.value);n.onsuccess=()=>{I.value=n.result}}catch(n){console.error("加载项目信息失败:",n)}}function ne(){if(!$.value)return;const n=o.isComponent?{path:`/project/${$.value}/preview`,query:{type:"component"}}:{path:`/project/${$.value}/preview`},l=d.resolve(n).href;window.open(l,"_blank")}async function he(){return new Promise((n,l)=>{const a="lowcode-projects",u="projects",c=indexedDB.open(a);c.onerror=()=>l(c.error),c.onupgradeneeded=()=>{const g=c.result;g.objectStoreNames.contains(u)||g.createObjectStore(u,{keyPath:"id"})},c.onsuccess=()=>{const g=c.result;if(g.objectStoreNames.contains(u))n(g);else{const S=g.version+1;g.close();const N=indexedDB.open(a,S);N.onerror=()=>l(N.error),N.onupgradeneeded=()=>{const M=N.result;M.objectStoreNames.contains(u)||M.createObjectStore(u,{keyPath:"id"})},N.onsuccess=()=>n(N.result)}}})}const C=rl({width:1024,height:576,backgroundUrl:"",backgroundColor:"#000000",globalFontFamily:"Arial, Helvetica, sans-serif",globalFontSize:14,globalColor:"#FFFFFF"}),ye=xe("GeneratedComponent"),W=xe(["Arial, Helvetica, sans-serif","PingFang SC","Microsoft YaHei","Roboto","Inter"]),X=xe([8,9,10,11,12,14,16,18,20,24,28,32,36,48,64]),ae=xe(["100","200","300","400","500","600","700","800","900"]),Ee=xe(["normal","italic","oblique"]),U=xe([]),p=xe(null),P=xe([]),V=xe({}),re=xe(null),R=xe([]),_=xe(!1);function T(){try{const n=JSON.parse(JSON.stringify(U.value));R.value.push(n),R.value.length>zd&&R.value.shift()}catch(n){console.warn("pushHistory 序列化失败：",n)}}function D(){R.value.length!==0&&(U.value=R.value.pop(),p.value=null,K.value=!1)}function ce(n){var g,S,N,M,m,s,k,L,de,ge,Ne,Me,Ce,ve,le;function l(oe){var te;if(!oe)return!1;const se=(te=oe.tagName)==null?void 0:te.toLowerCase();return oe.isContentEditable||!!oe.closest('[contenteditable="true"]')||se==="input"||se==="textarea"||se==="select"}const a=document.activeElement;if(l(a)||l(n.target))return;const u=n.metaKey||n.ctrlKey,c=n.key.toLowerCase();if(c==="arrowleft"||c==="arrowright"||c==="arrowup"||c==="arrowdown"){if(!p.value)return;const{el:oe}=Ze(p.value);if(!oe)return;be.shift=n.shiftKey,c==="arrowleft"&&(be.left=!0),c==="arrowright"&&(be.right=!0),c==="arrowup"&&(be.up=!0),c==="arrowdown"&&(be.down=!0);const se=n.shiftKey?10:1;J(c==="arrowleft"?-se:c==="arrowright"?se:0,c==="arrowup"?-se:c==="arrowdown"?se:0),Q!=null&&(clearTimeout(Q),Q=null),Q=window.setTimeout(()=>{h()},220),n.preventDefault();return}if(u&&c==="c"){if(Je.value){try{re.value=JSON.parse(JSON.stringify(Je.value))}catch{}n.preventDefault()}}else if(u&&c==="v"){if(re.value){const oe=re.value,se=tr(oe),{parentGroup:te}=Ze(oe.id);if(te){const Se=Number((S=(g=te.left)!=null?g:te.x)!=null?S:0),f=Number((M=(N=te.top)!=null?N:te.y)!=null?M:0),v=Number((m=te.width)!=null?m:0),F=Number((s=te.height)!=null?s:0),w=Se+v,j=f+F,Z=Number((k=oe.width)!=null?k:0),b=Number((L=oe.height)!=null?L:0);let G=Z,B=b;if(!G||!B)if(oe.type==="text"){const tt=Number((de=oe.fontSize)!=null?de:16),_e=String((Ne=(ge=oe.text)!=null?ge:oe.content)!=null?Ne:"").trim();G=Math.max(Z||50,Math.round((_e.length||2)*tt*.6)),B=Math.max(b||20,Math.round(tt*1.5))}else oe.type==="image"?(G=Z||200,B=b||150):oe.type==="chart"?(G=Z||240,B=b||160):oe.type==="line"?(G=Z||200,B=b||2):(G=Z||100,B=b||60);const q=10,me=Se+v/2,ie=f+F/2;let we=!1,Ue=w+q,Te=Math.round(ie-B/2);if(!we&&Ue+G<=C.width&&(se.left=Math.max(0,Math.min(Ue,Math.max(0,C.width-G))),se.top=Math.max(0,Math.min(Te,Math.max(0,C.height-B))),we=!0),Ue=Se-G-q,Te=Math.round(ie-B/2),!we&&Ue>=0&&(se.left=Math.max(0,Math.min(Ue,Math.max(0,C.width-G))),se.top=Math.max(0,Math.min(Te,Math.max(0,C.height-B))),we=!0),Ue=Math.round(me-G/2),Te=j+q,!we&&Te+B<=C.height&&(se.left=Math.max(0,Math.min(Ue,Math.max(0,C.width-G))),se.top=Math.max(0,Math.min(Te,Math.max(0,C.height-B))),we=!0),Ue=Math.round(me-G/2),Te=f-B-q,!we&&Te>=0&&(se.left=Math.max(0,Math.min(Ue,Math.max(0,C.width-G))),se.top=Math.max(0,Math.min(Te,Math.max(0,C.height-B))),we=!0),!we){const tt=Number((Ce=(Me=oe.left)!=null?Me:oe.x)!=null?Ce:0),_e=Number((le=(ve=oe.top)!=null?ve:oe.y)!=null?le:0),ot=Se+tt+q,Qe=f+_e+q;se.left=Math.max(0,Math.min(Math.round(ot),Math.max(0,C.width-G))),se.top=Math.max(0,Math.min(Math.round(Qe),Math.max(0,C.height-B)))}se.x=se.left,se.y=se.top}T(),U.value.push(se),p.value=se.id,n.preventDefault()}}else if(c==="delete"||c==="backspace"){if(p.value){T();const{el:oe,parentGroup:se}=Ze(p.value);oe&&se&&Array.isArray(se.children)?se.children=se.children.filter(te=>te.id!==oe.id):(U.value=U.value.filter(te=>te.id!==p.value),oe&&oe.type==="group"&&Jt(oe.id)),p.value=null,n.preventDefault()}}else u&&c==="z"&&(D(),n.preventDefault())}const be=rl({left:!1,right:!1,up:!1,down:!1,shift:!1});let Fe=null,y=0,Q=null;function J(n,l){var Ce,ve,le,oe,se,te,Se,f;const a=p.value;if(!a)return;const{el:u,parentGroup:c}=Ze(a);if(!u)return;const g=(le=(ve=u.width)!=null?ve:(Ce=V.value[a])==null?void 0:Ce.width)!=null?le:0,S=(te=(se=u.height)!=null?se:(oe=V.value[a])==null?void 0:oe.height)!=null?te:0;let N=C.width,M=C.height;c&&c.width&&c.height&&(N=Number(c.width)||N,M=Number(c.height)||M);let m=((Se=u.left)!=null?Se:0)+n,s=((f=u.top)!=null?f:0)+l;m=Math.round(m),s=Math.round(s),m=Math.max(0,Math.min(m,N-(g||0))),s=Math.max(0,Math.min(s,M-(S||0))),u.left=m,u.top=s,u.x=u.left,u.y=u.top;const k=u.left,L=u.top,de=k+(g||0),ge=L+(S||0),Ne=k+(g||0)/2,Me=L+(S||0)/2;Ke({left:k,top:L,right:de,bottom:ge,centerX:Ne,centerY:Me})}function h(){if(Fe!=null)return;y=Date.now(),T();const n=()=>{if(!be.left&&!be.right&&!be.up&&!be.down){Fe!=null&&cancelAnimationFrame(Fe),Fe=null,at();return}const l=Date.now()-y,a=l>1500?8:l>800?4:l>300?2:1,u=(be.shift?10:1)*a,c=(be.left?-u:0)+(be.right?u:0),g=(be.up?-u:0)+(be.down?u:0);J(c,g),Fe=requestAnimationFrame(n)};Fe=requestAnimationFrame(n)}function t(n){const l=n.key.toLowerCase();l==="shift"&&(be.shift=!1),l==="arrowleft"&&(be.left=!1),l==="arrowright"&&(be.right=!1),l==="arrowup"&&(be.up=!1),l==="arrowdown"&&(be.down=!1),Q!=null&&(clearTimeout(Q),Q=null),!be.left&&!be.right&&!be.up&&!be.down&&Fe==null&&T(),!be.left&&!be.right&&!be.up&&!be.down&&at()}const K=xe(!1),Y=xe({left:0,top:0,right:0,bottom:0,centerX:0,centerY:0});function qe(n){V.value[n.id]=n}function Le(n){return n==="pie"?{backgroundColor:"transparent",tooltip:{trigger:"item"},legend:{top:"5%",left:"center",textStyle:{color:"#fff"},show:!0},series:[{name:"分类占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#111",borderWidth:2},label:{show:!0,color:"#fff"},labelLine:{show:!0},data:[{value:1048,name:"A"},{value:735,name:"B"},{value:580,name:"C"},{value:484,name:"D"},{value:300,name:"E"}]}]}:n==="mix"?{backgroundColor:"transparent",color:["#00bcd4","#ff9800"],tooltip:{trigger:"axis"},legend:{textStyle:{color:"#fff"},show:!0},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"销量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}},{name:"均价",type:"line",smooth:!0,data:[30,40,45,50,49,60,70],lineStyle:{width:2}}]}:n==="bar"?{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"数量",type:"bar",data:[120,200,150,80,70,110,130],itemStyle:{borderRadius:[4,4,0,0]}}]}:{backgroundColor:"transparent",color:["#42b883"],tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"}},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#888"}},axisLabel:{color:"#ccc"}},series:[{name:"趋势",type:"line",smooth:!0,data:[150,230,224,218,135,147,260],lineStyle:{width:2}}]}}function Pe(n){var oe,se;const l=`${n}-${Date.now()}`,a=$t.value,u=it.value||1,c=(oe=a==null?void 0:a.clientWidth)!=null?oe:0,g=(se=a==null?void 0:a.clientHeight)!=null?se:0,S=a?(a.scrollLeft+c/2)/u:20,N=a?(a.scrollTop+g/2)/u:20,M=n==="chart"?240:n==="image"||n==="line"?200:n==="container"?240:void 0,m=n==="chart"?160:n==="image"?150:n==="line"?2:n==="container"?160:void 0,s=Math.round(S-(M?M/2:10)),k=Math.round(N-(m?m/2:10)),L=Math.max(0,Math.min(s,Math.max(0,C.width-(M!=null?M:0)))),de=Math.max(0,Math.min(k,Math.max(0,C.height-(m!=null?m:0)))),ge=(te,Se,f,v)=>{const F=Math.max(0,Math.min(te,Math.max(0,C.width-(f!=null?f:0)))),w=Math.max(0,Math.min(Se,Math.max(0,C.height-(v!=null?v:0))));return{cl:F,ct:w}},Ne=U.value.map(te=>{var w,j,Z,b,G,B;const Se=(w=te.width)!=null?w:0,f=(j=te.height)!=null?j:0,v=Number((b=(Z=te.left)!=null?Z:te.x)!=null?b:0),F=Number((B=(G=te.top)!=null?G:te.y)!=null?B:0);return{l:v,t:F,r:v+Se,b:F+f}}),Me=(te,Se,f,v)=>{const F=te+(f!=null?f:0),w=Se+(v!=null?v:0);for(const j of Ne)if(!(f===void 0||v===void 0)&&!(F<=j.l||w<=j.t||te>=j.r||Se>=j.b))return!0;return!1},Ce=24;let ve={cl:L,ct:de};if(M&&m&&Me(ve.cl,ve.ct,M,m)){let te=!1;for(let Se=1;Se<=20&&!te;Se++)for(const f of[[Se,0],[0,Se],[-Se,0],[0,-Se]]){const[v,F]=f,w=s+v*Ce,j=k+F*Ce,Z=ge(w,j,M,m);if(!Me(Z.cl,Z.ct,M,m)){ve=Z,te=!0;break}}}const le={id:l,type:n,left:ve.cl,top:ve.ct,autoSize:n==="text",width:M,height:m,text:n==="text"?"文字":n==="image"||n==="line"?"":"图表",className:"",zIndex:1,style:{}};n==="text"?Object.assign(le,{content:"文字",fontSize:16,fontWeight:"400",fontFamily:"Arial, Helvetica, sans-serif",color:"#ffffff",letterSpacing:"0px",lineHeight:"1.5",fontStyle:"normal",useGradient:!1,gradientStart:"#00A3FF",gradientEnd:"#ffffff",gradientDirection:"to right",x:ve.cl,y:ve.ct}):n==="image"&&(Object.assign(le,{src:"",borderRadius:0,x:ve.cl,y:ve.ct}),le.style={...le.style||{},objectFit:"contain"}),n==="chart"&&Object.assign(le,{elementId:`chart-${Date.now()}`,chartType:"line",chartOption:Le("line")}),n==="line"&&(le.autoSize=!1,le.style={...le.style||{},lineColor:"#ffffff",lineThickness:2,lineOrientation:"horizontal",lineStyle:"solid",lineDashLength:6,lineDashGap:4}),n==="container"&&(le.autoSize=!1,le.text="",le.elementId=`container-${Date.now()}`,le.style={...le.style||{},backgroundColor:"transparent",border:"1px dashed rgba(148,163,184,0.6)",borderRadius:"6px"}),T(),U.value.push(le),p.value=l}function Ye(n){const{el:l}=Ze(n.id);l&&(_.value||(T(),_.value=!0),l.left=n.left,l.top=n.top,l.x=n.left,l.y=n.top)}function rt(n){const{el:l}=Ze(n.id);l&&(_.value||(T(),_.value=!0),l.width=n.width,l.height=n.height,n.left!==void 0&&(l.left=n.left,l.x=n.left),n.top!==void 0&&(l.top=n.top,l.y=n.top))}function ut(n){p.value=n,ct()}function ct(){if(De(),!ft.value)return;const n=p.value;if(!n)return;const l=Re.value.find(g=>g.id===n);if(!l)return;const a=Re.value.filter(g=>g.id!==n),u={left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.centerX,centerY:l.centerY};Y.value={left:u.left,top:u.top,right:u.right,bottom:u.bottom,centerX:u.centerX,centerY:u.centerY},Ie.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1};const c=4;for(const g of a)Math.abs(u.centerX-g.centerX)<=c&&g.w>0&&(Ie.value.centerV=!0,Y.value.centerX=g.centerX),Math.abs(u.centerY-g.centerY)<=c&&g.h>0&&(Ie.value.centerH=!0,Y.value.centerY=g.centerY),Math.abs(u.left-g.left)<=c&&(Ie.value.left=!0,Y.value.left=g.left),Math.abs(u.right-g.right)<=c&&g.w>0&&(Ie.value.right=!0,Y.value.right=g.right),Math.abs(u.top-g.top)<=c&&(Ie.value.top=!0,Y.value.top=g.top),Math.abs(u.bottom-g.bottom)<=c&&g.h>0&&(Ie.value.bottom=!0,Y.value.bottom=g.bottom);K.value=Object.values(Ie.value).some(Boolean)}function St(){p.value=null,at()}const Ie=xe({centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1}),pe=xe({left:null,right:null,up:null,down:null}),pt=xe(!0),ft=xe(!0),bt=xe(!1),vt=Ge(()=>U.value.filter(n=>n.hidden));function Mt(n){const l=U.value.find(a=>a.id===n);l&&(l.hidden=!1,p.value=n,vl(()=>{const a=document.querySelector(`[data-el-id="${n}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"}),bt.value=!1}))}const He=xe(null),ke=xe(null),Re=Ge(()=>U.value.map(n=>{var c,g;const l=V.value[n.id];if(l)return{id:n.id,left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.centerX,centerY:l.centerY,w:l.width,h:l.height,type:n.type};const a=(c=n.width)!=null?c:0,u=(g=n.height)!=null?g:0;return{id:n.id,left:n.left,top:n.top,right:n.left+a,bottom:n.top+u,centerX:n.left+a/2,centerY:n.top+u/2,w:a,h:u,type:n.type}}));function Ke(n){_.value||(T(),_.value=!0),Y.value={left:n.left,top:n.top,right:n.right,bottom:n.bottom,centerX:n.centerX,centerY:n.centerY},Ie.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},pe.value={left:null,right:null,up:null,down:null};const l=.5,a=p.value,u=Re.value;function c(m,s,k,L){const de=Math.max(m,k);return Math.min(s,L)-de}let g=null,S=null,N=null,M=null;for(const m of u)if(!(!a||m.id===a)){if(Math.abs(n.centerX-m.centerX)<=l&&m.w>0&&(Ie.value.centerV=!0,Y.value.centerX=m.centerX),Math.abs(n.centerY-m.centerY)<=l&&m.h>0&&(Ie.value.centerH=!0,Y.value.centerY=m.centerY),Math.abs(n.left-m.left)<=l&&(Ie.value.left=!0,Y.value.left=m.left),Math.abs(n.right-m.right)<=l&&m.w>0&&(Ie.value.right=!0,Y.value.right=m.right),Math.abs(n.top-m.top)<=l&&(Ie.value.top=!0,Y.value.top=m.top),Math.abs(n.bottom-m.bottom)<=l&&m.h>0&&(Ie.value.bottom=!0,Y.value.bottom=m.bottom),c(n.top,n.bottom,m.top,m.bottom)>0){const s=n.left-m.right;s>=0&&(!g||s<g.gap)&&(g={gap:s,m});const k=m.left-n.right;k>=0&&(!S||k<S.gap)&&(S={gap:k,m})}if(c(n.left,n.right,m.left,m.right)>0){const s=n.top-m.bottom;s>=0&&(!N||s<N.gap)&&(N={gap:s,m});const k=m.top-n.bottom;k>=0&&(!M||k<M.gap)&&(M={gap:k,m})}}if(K.value=Object.values(Ie.value).some(Boolean),!pt.value){pe.value={left:null,right:null,up:null,down:null};return}if(g){const m=g.m,s=(Math.max(n.left,m.left)+Math.min(n.right,m.right))/2,k=(Math.max(n.top,m.top)+Math.min(n.bottom,m.bottom))/2;pe.value.left={gap:Math.floor(g.gap),exact:g.gap,refId:m.id,x:Math.round(s),y:Math.round(k)}}if(S){const m=S.m,s=(Math.max(n.left,m.left)+Math.min(n.right,m.right))/2,k=(Math.max(n.top,m.top)+Math.min(n.bottom,m.bottom))/2;pe.value.right={gap:Math.floor(S.gap),exact:S.gap,refId:m.id,x:Math.round(s),y:Math.round(k)}}if(N){const m=N.m,s=(Math.max(n.left,m.left)+Math.min(n.right,m.right))/2,k=(m.bottom+n.top)/2;pe.value.up={gap:Math.floor(N.gap),exact:N.gap,refId:m.id,x:Math.round(s),y:Math.round(k)}}if(M){const m=M.m,s=(Math.max(n.left,m.left)+Math.min(n.right,m.right))/2,k=(n.bottom+m.top)/2;pe.value.down={gap:Math.floor(M.gap),exact:M.gap,refId:m.id,x:Math.round(s),y:Math.round(k)}}ft.value||(Ie.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},K.value=!1)}function De(){if(!pt.value){pe.value={left:null,right:null,up:null,down:null};return}const n=p.value;if(!n){pe.value={left:null,right:null,up:null,down:null};return}const l=Re.value.find(s=>s.id===n);if(!l){pe.value={left:null,right:null,up:null,down:null};return}const a={left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.centerX,centerY:l.centerY},u=Re.value.filter(s=>s.id!==n);function c(s,k,L,de){const ge=Math.max(s,L);return Math.min(k,de)-ge}let g=null,S=null,N=null,M=null;for(const s of u){if(c(a.top,a.bottom,s.top,s.bottom)>0){const k=a.left-s.right;k>=0&&(!g||k<g.gap)&&(g={gap:k,m:s});const L=s.left-a.right;L>=0&&(!S||L<S.gap)&&(S={gap:L,m:s})}if(c(a.left,a.right,s.left,s.right)>0){const k=a.top-s.bottom;k>=0&&(!N||k<N.gap)&&(N={gap:k,m:s});const L=s.top-a.bottom;L>=0&&(!M||L<M.gap)&&(M={gap:L,m:s})}}const m={left:null,right:null,up:null,down:null};if(g){const s=g.m,k=(Math.max(a.left,s.left)+Math.min(a.right,s.right))/2,L=(Math.max(a.top,s.top)+Math.min(a.bottom,s.bottom))/2;m.left={gap:Math.floor(g.gap),exact:g.gap,refId:s.id,x:Math.round(k),y:Math.round(L)}}if(S){const s=S.m,k=(Math.max(a.left,s.left)+Math.min(a.right,s.right))/2,L=(Math.max(a.top,s.top)+Math.min(a.bottom,s.bottom))/2;m.right={gap:Math.floor(S.gap),exact:S.gap,refId:s.id,x:Math.round(k),y:Math.round(L)}}if(N){const s=N.m,k=(Math.max(a.left,s.left)+Math.min(a.right,s.right))/2,L=(s.bottom+a.top)/2;m.up={gap:Math.floor(N.gap),exact:N.gap,refId:s.id,x:Math.round(k),y:Math.round(L)}}if(M){const s=M.m,k=(Math.max(a.left,s.left)+Math.min(a.right,s.right))/2,L=(a.bottom+s.top)/2;m.down={gap:Math.floor(M.gap),exact:M.gap,refId:s.id,x:Math.round(k),y:Math.round(L)}}pe.value=m}function at(){_.value=!1,ft.value&&p.value?ct():K.value=!1,De()}function Ze(n){if(!n)return{el:null,parentGroup:null};const l=(a,u)=>{for(const c of a){if(c.id===n)return{el:c,parentGroup:u};if(c.type==="group"&&Array.isArray(c.children)){const g=l(c.children,c);if(g)return g}}return null};return l(U.value,null)||{el:null,parentGroup:null}}function gt(n){const l=pe.value[n];l&&(He.value=n,ke.value=l.gap)}function We(){var N,M,m,s,k;if(!He.value||ke.value==null){He.value=null,ke.value=null;return}const n=He.value,l=pe.value[n];if(!l){He.value=null,ke.value=null;return}const a=Re.value.find(L=>L.id===l.refId),u=ke.value,c=Je.value;if(!a||!c){He.value=null,ke.value=null;return}T();const g=(N=l.exact)!=null?N:l.gap,S=u-g;n==="left"?c.left=Math.round(((M=c.left)!=null?M:0)+S):n==="right"?c.left=Math.round(((m=c.left)!=null?m:0)-S):n==="up"?c.top=Math.round(((s=c.top)!=null?s:0)+S):n==="down"&&(c.top=Math.round(((k=c.top)!=null?k:0)-S)),He.value=null,ke.value=null,De()}yt(p,()=>{_.value||De()}),yt(V,()=>{_.value||De()},{deep:!0}),yt(pt,n=>{n?De():(He.value=null,ke.value=null,pe.value={left:null,right:null,up:null,down:null})}),yt(ft,n=>{n?ct():(Ie.value={centerV:!1,centerH:!1,left:!1,right:!1,top:!1,bottom:!1},K.value=!1)});const Je=Ge(()=>p.value?Ze(p.value).el:null);async function Ct(){return new Promise((n,l)=>{const a=indexedDB.open("lowcode-db",1);a.onupgradeneeded=()=>{const u=a.result;if(!u.objectStoreNames.contains("objects")){const c=u.createObjectStore("objects",{keyPath:"id"});try{c.createIndex("projectId","projectId",{unique:!1}),c.createIndex("name","name",{unique:!1})}catch{}}},a.onsuccess=()=>n(a.result),a.onerror=()=>l(a.error)})}async function Nt(){try{const n=(await Ct()).transaction(["objects"],"readonly").objectStore("objects").getAll();n.onsuccess=()=>{P.value=(n.result||[]).filter(l=>!l.projectId||l.projectId===(o.projectId||void 0))},n.onerror=()=>{console.warn("loadDatabaseObjects error",n.error)}}catch(n){console.warn("openDatabaseDB error",n)}}const It=Ge(()=>{const n={};for(const l of P.value)l&&l.name&&(n[l.name]=l.content);return n}),wt=xe({}),Ft=Ge(()=>{const n={...It.value};for(const l in wt.value)Object.assign(n,wt.value[l]);return n});function pr(n,l){const a={};for(const u of l)u&&u.name&&(a[u.name]=u.content);wt.value[n]=a}function Jt(n){wt.value[n]&&delete wt.value[n];const l=`component-fonts-${n}`,a=document.getElementById(l);a&&a.parentNode&&a.parentNode.removeChild(a)}function fr(n,l="#000000"){try{const a=String(n||"").trim();return/^#([0-9a-fA-F]{6})$/.test(a)?a:l}catch{return l}}function gr(){if(!p.value)return;T();const{el:n,parentGroup:l}=Ze(p.value);n&&l&&Array.isArray(l.children)?l.children=l.children.filter(a=>a.id!==n.id):(U.value=U.value.filter(a=>a.id!==p.value),n&&n.type==="group"&&Jt(n.id)),p.value=null}function qt(n){(!n.className||!n.className.trim())&&(n.className=`cls-${String(n.id).slice(0,8)}`)}function mr(n){try{qt(n);const l=String(n.className||"").trim();String(n.customClassCss||"").trim()||(n.customClassCss=`.${l} {
  
}`)}catch{}}function yr(n){const l=String(n||"").trim();return l?l.split(";").map(a=>{const u=a.trim();return u?/!important\s*$/.test(u)?u+";":u+" !important;":""}).filter(Boolean).join(`
`):""}function br(n){return String(n||"").replace(/\{([^}]*)\}/g,(l,a)=>`{
`+String(a||"").split(";").map(u=>{const c=u.trim();return c?c.startsWith("@")||!/:/.test(c)||/!important\s*$/.test(c)?c+";":c+" !important;":""}).filter(Boolean).join(`
`)+`
}`)}function xr(n){try{if(!n.enableClassStyle)return;qt(n);const l=String(n.customClassCss||"").trim();if(!l)return;const a=`custom-class-${n.id}`;let u=document.getElementById(a);if(u||(u=document.createElement("style"),u.id=a,document.head.appendChild(u)),/{[^}]*}/.test(l)){u.textContent=br(l);return}const c=yr(l);u.textContent=`.${String(n.className).trim()} {
${c}
}`}catch(l){console.warn("注入自定义类样式失败：",l)}}function Xt(n){try{const l=`custom-class-${n}`,a=document.getElementById(l);a&&a.remove()}catch{}}function Yt(n,l){for(const a of n)l(a),a.type==="group"&&Array.isArray(a.children)&&Yt(a.children,l)}let Gt=null;function Ut(){Gt&&clearTimeout(Gt),Gt=setTimeout(()=>{try{Yt(U.value,n=>{n.enableClassStyle&&n.customClassCss&&n.className?xr(n):Xt(n.id)})}catch(n){console.warn("刷新自定义类样式失败：",n)}},50)}async function hr(){var n,l,a,u,c,g,S,N,M,m;try{const s=Je.value;if(!s){alert("请先选中要保存的元素或分组");return}const k=ye.value||(s.type==="group"?"分组组件":"元素组件"),L=prompt("请输入组件名称",k);if(L===null)return;const de=(L||k).trim()||"未命名组件";let ge=[];if(s.type==="group"&&Array.isArray(s.children)){const f=Number((l=(n=s.left)!=null?n:s.x)!=null?l:0),v=Number((u=(a=s.top)!=null?a:s.y)!=null?u:0);ge=s.children.map(F=>{var q,me,ie,we,Ue,Te;const w=JSON.parse(JSON.stringify(F)),j=Number((me=(q=w.left)!=null?q:w.x)!=null?me:0),Z=Number((we=(ie=w.top)!=null?ie:w.y)!=null?we:0);w.left=f+j,w.top=v+Z,w.x=w.left,w.y=w.top;const b=V.value[F.id],G=Number(w.width||0),B=Number(w.height||0);if(!(G>0)){const tt=(()=>{var _e,ot,Qe,mt,ht;if(w.type==="text"){const Et=Number((_e=w.fontSize)!=null?_e:16),Ur=String((ot=w.text)!=null?ot:"").trim();return Math.max(50,Math.round((Ur.length||2)*Et*.6))}if(w.type==="image")return 100;if(w.type==="chart")return 240;if(w.type==="line"){const Et=Number((mt=(Qe=w.style)==null?void 0:Qe.lineThickness)!=null?mt:2);return(((ht=w.style)==null?void 0:ht.lineOrientation)||"horizontal")==="vertical"?Et:100}return 50})();w.width=Math.max(1,Math.round((Ue=b==null?void 0:b.width)!=null?Ue:tt))}if(!(B>0)){const tt=(()=>{var _e,ot,Qe,mt;if(w.type==="text"){const ht=Number((_e=w.fontSize)!=null?_e:16);return Math.max(20,Math.round(ht*1.5))}if(w.type==="image")return 100;if(w.type==="chart")return 160;if(w.type==="line"){const ht=Number((Qe=(ot=w.style)==null?void 0:ot.lineThickness)!=null?Qe:2);return(((mt=w.style)==null?void 0:mt.lineOrientation)||"horizontal")==="vertical"?100:ht}return 20})();w.height=Math.max(1,Math.round((Te=b==null?void 0:b.height)!=null?Te:tt))}return w.id=`${w.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,w})}else{const f=JSON.parse(JSON.stringify(s)),v=Number((g=(c=f.left)!=null?c:f.x)!=null?g:0),F=Number((N=(S=f.top)!=null?S:f.y)!=null?N:0);f.left=v,f.top=F,f.x=f.left,f.y=f.top;const w=V.value[s.id],j=Number(f.width||0),Z=Number(f.height||0);if(!(j>0)){const b=(()=>{var G,B,q,me,ie;if(f.type==="text"){const we=Number((G=f.fontSize)!=null?G:16),Ue=String((B=f.text)!=null?B:"").trim();return Math.max(50,Math.round((Ue.length||2)*we*.6))}if(f.type==="image")return 100;if(f.type==="chart")return 240;if(f.type==="line"){const we=Number((me=(q=f.style)==null?void 0:q.lineThickness)!=null?me:2);return(((ie=f.style)==null?void 0:ie.lineOrientation)||"horizontal")==="vertical"?we:100}return 50})();f.width=Math.max(1,Math.round((M=w==null?void 0:w.width)!=null?M:b))}if(!(Z>0)){const b=(()=>{var G,B,q,me;if(f.type==="text"){const ie=Number((G=f.fontSize)!=null?G:16);return Math.max(20,Math.round(ie*1.5))}if(f.type==="image")return 100;if(f.type==="chart")return 160;if(f.type==="line"){const ie=Number((q=(B=f.style)==null?void 0:B.lineThickness)!=null?q:2);return(((me=f.style)==null?void 0:me.lineOrientation)||"horizontal")==="vertical"?100:ie}return 20})();f.height=Math.max(1,Math.round((m=w==null?void 0:w.height)!=null?m:b))}f.id=`${f.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,ge=[f]}const Ne=Math.min(...ge.map(f=>{var v,F;return Number((F=(v=f.left)!=null?v:f.x)!=null?F:0)})),Me=Math.min(...ge.map(f=>{var v,F;return Number((F=(v=f.top)!=null?v:f.y)!=null?F:0)})),Ce=Math.max(...ge.map(f=>{var v,F,w;return Number((F=(v=f.left)!=null?v:f.x)!=null?F:0)+Number((w=f.width)!=null?w:0)})),ve=Math.max(...ge.map(f=>{var v,F,w;return Number((F=(v=f.top)!=null?v:f.y)!=null?F:0)+Number((w=f.height)!=null?w:0)})),le=Math.max(1,Math.round(Ce-Ne)),oe=Math.max(1,Math.round(ve-Me));ge=ge.map(f=>{var j,Z,b,G;const v=JSON.parse(JSON.stringify(f)),F=Number((Z=(j=v.left)!=null?j:v.x)!=null?Z:0)-Ne,w=Number((G=(b=v.top)!=null?b:v.y)!=null?G:0)-Me;return v.left=Math.max(0,Math.round(F)),v.top=Math.max(0,Math.round(w)),v.x=v.left,v.y=v.top,v});const se={width:le,height:oe,backgroundUrl:"",backgroundColor:"transparent",globalFontFamily:C.globalFontFamily,globalFontSize:C.globalFontSize,globalColor:C.globalColor},te=`${Date.now()}${Math.random().toString(36).slice(2,9)}`,Se={id:te,name:de,description:"",tags:[],elements:ge,config:se,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await Xe.init(),await Xe.saveComponent(JSON.parse(JSON.stringify(Se))),await Pt(`component-${te}`,{config:se,elements:ge,exportName:de}),alert("组件已保存到组件库")}catch(s){console.warn("保存组件失败：",s),alert("保存组件失败，请稍后重试")}}const vr=xe(null);function wr(n){var u;const l=(u=n.target.files)==null?void 0:u[0];if(!l)return;const a=new FileReader;a.onload=()=>{const c=String(a.result);C.backgroundUrl=c;const g=new Image;g.onload=()=>{vr.value={width:g.naturalWidth,height:g.naturalHeight},C.width=g.naturalWidth,C.height=g.naturalHeight},g.src=c},a.readAsDataURL(l)}function jt(n){var l;return n&&((l=n.split(",")[0])!=null?l:"").trim().replace(/^['"]|['"]$/g,"")||null}function xt(n){return{"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","image/avif":"avif","image/apng":"apng","image/x-icon":"ico","image/vnd.microsoft.icon":"ico","font/ttf":"ttf","font/otf":"otf","font/woff":"woff","font/woff2":"woff2","application/font-ttf":"ttf","application/font-otf":"otf","application/font-woff":"woff","application/font-woff2":"woff2","application/x-font-ttf":"ttf","application/x-font-otf":"otf","application/x-font-woff":"woff","application/x-font-woff2":"woff2","application/vnd.ms-fontobject":"eot","application/octet-stream":"bin"}[n]||"bin"}function Kt(n){var u;const l=/\.([A-Za-z0-9]+)$/.exec(n||"");if(!l)return null;const a=((u=l[1])!=null?u:"").toLowerCase();return a?["png","jpg","jpeg","gif","svg","webp","avif","apng","ico"].includes(a)?a==="jpeg"?"jpg":a:["ttf","otf","woff","woff2","eot"].includes(a)?a:null:null}async function At(n){try{const l="lowcode-icons",a="icons",u=await new Promise((c,g)=>{const S=indexedDB.open(l);S.onsuccess=()=>{const N=S.result;if(N.objectStoreNames.contains(a))c(N);else{const M=N.version+1;N.close();const m=indexedDB.open(l,M);m.onupgradeneeded=()=>{const s=m.result;s.objectStoreNames.contains(a)||s.createObjectStore(a,{keyPath:"id"})},m.onsuccess=()=>c(m.result),m.onerror=()=>g(m.error)}},S.onerror=()=>g(S.error)});return await new Promise((c,g)=>{const S=u.transaction(a,"readonly").objectStore(a).get(n);S.onsuccess=()=>c(S.result||null),S.onerror=()=>g(S.error)})}catch{return null}}function Zt(n){var l,a,u,c,g,S,N,M;try{const m=new Uint8Array(n),s=String.fromCharCode((l=m[0])!=null?l:0,(a=m[1])!=null?a:0,(u=m[2])!=null?u:0,(c=m[3])!=null?c:0);return s==="wOFF"?"woff":s==="wOF2"?"woff2":s==="OTTO"?"otf":(((g=m[0])!=null?g:0)===0&&((S=m[1])!=null?S:0)===1&&((N=m[2])!=null?N:0)===0&&((M=m[3])!=null?M:0)===0||s==="true"||s==="typ1","ttf")}catch{return"ttf"}}async function $r(n){const l=prompt("请输入导出名称",ye.value||"GeneratedComponent");if(l===null)return;const a=l.trim()||"GeneratedComponent";ye.value=a;function u(f){const v=new Set,F={};function w(Z){let b=Date.now(),G=`${Z}-${b}`;for(;v.has(G);)b+=1,G=`${Z}-${b}`;return G}function j(Z){const b=JSON.parse(JSON.stringify(Z)),G=String(b.id);let B=G;return v.has(B)&&(B=w(String(b.type||"el"))),v.add(B),F[G]=B,b.id=B,b.type==="group"&&Array.isArray(b.children)&&(b.children=b.children.map(q=>j(q))),b}return{normalized:f.map(Z=>j(Z)),remap:F}}const{normalized:c}=u(U.value),g=[],S=f=>{for(const v of f)v.type==="group"&&Array.isArray(v.children)?S(v.children):v.type==="image"&&(v.src||v.iconId)&&g.push(v)};S(c);const N={},M=new Map;let m=0;for(const f of g)try{let v;if(f.src)v=await(await fetch(String(f.src))).blob();else if(f.iconId){const b=f.iconId,G=await At(b);if(!G)throw new Error("icon record missing: "+b);v=new Blob([G.buffer],{type:String(G.mime||"image/png")})}else continue;let F=xt(v.type);if(F==="bin"&&f.iconId){const b=f.iconId,G=await At(b);if(G){const B=xt(String(G.mime||"")),q=Kt(String(G.originalName||""));F=B!=="bin"?B:q||F}F==="bin"&&(F="png")}const w=await v.arrayBuffer(),j=await crypto.subtle.digest("SHA-256",w),Z=Array.from(new Uint8Array(j)).map(b=>b.toString(16).padStart(2,"0")).join("");if(M.has(Z)){const{fileName:b}=M.get(Z);N[f.id]=b}else{const b=`${a}_img_${m}.${F}`;M.set(Z,{fileName:b,blob:v}),m++,N[f.id]=b}}catch(v){console.warn("导出图片失败：",v)}const s=Array.from(M.values());let k=null,L=null;if(C.backgroundUrl)try{const f=await(await fetch(String(C.backgroundUrl))).blob(),v=xt(f.type);k=`${a}_bg.${v}`,L=f}catch(f){console.warn("导出背景图片失败：",f)}const de=new Set,ge=jt(C.globalFontFamily);ge&&de.add(ge);const Ne=f=>{var v;for(const F of f)if(F.type==="group"&&Array.isArray(F.children))Ne(F.children);else if(F.type==="text"){const w=jt((v=F.style)==null?void 0:v.fontFamily);w&&de.add(w)}};Ne(U.value);const Me=[],Ce=[];if(de.size>0)try{const f="lowcode-fonts",v="fonts",F=await new Promise((b,G)=>{const B=indexedDB.open(f);B.onsuccess=()=>{const q=B.result;if(q.objectStoreNames.contains(v))b(q);else{const me=q.version+1;q.close();const ie=indexedDB.open(f,me);ie.onupgradeneeded=()=>{const we=ie.result;we.objectStoreNames.contains(v)||we.createObjectStore(v,{keyPath:"id"})},ie.onsuccess=()=>b(ie.result),ie.onerror=()=>G(ie.error)}},B.onerror=()=>G(B.error)}),w=await new Promise((b,G)=>{const B=F.transaction(v,"readonly").objectStore(v).getAll();B.onsuccess=()=>b(B.result),B.onerror=()=>G(B.error)}),j=$.value,Z=j?w.filter(b=>b.projectId===j):w.filter(b=>!b.projectId);for(const b of Z)if(de.has(b.name)){const G=new Blob([b.buffer],{type:b.mime});let B=xt(b.mime);if(B==="bin")try{B=Zt(b.buffer)}catch{B="ttf"}const q=b.name.replace(/[^A-Za-z0-9_\-]/g,"_"),me=`${a}_${q}.${B}`;Me.push({family:b.name,file:me}),Ce.push({file:me,blob:G})}}catch(f){console.warn("读取字体库失败：",f)}const ve=new ul.default,le=ve.folder(a),oe=le.folder("imgs");for(const f of s)oe.file(f.fileName,f.blob);L&&k&&oe.file(k,L);const se=le.folder("fonts");for(const f of Ce)se.file(f.file,f.blob);let te="";n==="vue2"?(te=ll(a,C,c,{imageFileNames:s.map(f=>f.fileName),imageFileMap:N,backgroundFileName:L&&k?k:null,fontFaces:Me,hideDirective:"if"},Ft.value),le.file("index.vue",te)):n==="vue3"?(te=ol(a,C,c,{imageFileNames:s.map(f=>f.fileName),imageFileMap:N,backgroundFileName:L&&k?k:null,fontFaces:Me,hideDirective:"if"}),le.file("index.vue",te)):n==="react"?(te=il(a,C,c,{imageFileNames:s.map(f=>f.fileName),imageFileMap:N,backgroundFileName:L&&k?k:null,fontFaces:Me}),le.file("index.jsx",te),le.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。")):(te=sl(a,C,c,{imageFileNames:s.map(f=>f.fileName),imageFileMap:N,backgroundFileName:L&&k?k:null,fontFaces:Me}),le.file("index.html",te));const Se=await ve.generateAsync({type:"blob"});(0,dl.saveAs)(Se,`${a}.zip`)}async function Er(){const n=prompt("请输入导出名称",ye.value||"GeneratedComponent");if(n===null)return;const l=n.trim()||"GeneratedComponent";ye.value=l;const a=[],u=f=>{for(const v of f)v.type==="group"&&Array.isArray(v.children)?u(v.children):v.type==="image"&&v.src&&a.push(v)};u(U.value);const c={},g=new Map;let S=0;for(const f of a)try{let v;if(f.src)v=await(await fetch(String(f.src))).blob();else if(f.iconId){const b=f.iconId,G=await At(b);if(!G)throw new Error("icon record missing: "+b);v=new Blob([G.buffer],{type:String(G.mime||"image/png")})}else continue;let F=xt(v.type);if(F==="bin"&&f.iconId){const b=f.iconId,G=await At(b);if(G){const B=xt(String(G.mime||"")),q=Kt(String(G.originalName||""));F=B!=="bin"?B:q||F}F==="bin"&&(F="png")}const w=await v.arrayBuffer(),j=await crypto.subtle.digest("SHA-256",w),Z=Array.from(new Uint8Array(j)).map(b=>b.toString(16).padStart(2,"0")).join("");if(g.has(Z)){const{fileName:b}=g.get(Z);c[f.id]=b}else{const b=`${l}_img_${S}.${F}`;g.set(Z,{fileName:b,blob:v}),S++,c[f.id]=b}}catch(v){console.warn("导出图片失败：",v)}const N=Array.from(g.values());let M=null,m=null;if(C.backgroundUrl)try{const f=await(await fetch(String(C.backgroundUrl))).blob(),v=xt(f.type);M=`${l}_bg.${v}`,m=f}catch(f){console.warn("导出背景图片失败：",f)}const s=new Set,k=jt(C.globalFontFamily);k&&s.add(k);const L=f=>{var v;for(const F of f)if(F.type==="group"&&Array.isArray(F.children))L(F.children);else if(F.type==="text"){const w=jt((v=F.style)==null?void 0:v.fontFamily);w&&s.add(w)}};L(U.value);const de=[],ge=[];if(s.size>0)try{const f="lowcode-fonts",v="fonts",F=await new Promise((b,G)=>{const B=indexedDB.open(f);B.onsuccess=()=>{const q=B.result;if(q.objectStoreNames.contains(v))b(q);else{const me=q.version+1;q.close();const ie=indexedDB.open(f,me);ie.onupgradeneeded=()=>{const we=ie.result;we.objectStoreNames.contains(v)||we.createObjectStore(v,{keyPath:"id"})},ie.onsuccess=()=>b(ie.result),ie.onerror=()=>G(ie.error)}},B.onerror=()=>G(B.error)}),w=await new Promise((b,G)=>{const B=F.transaction(v,"readonly").objectStore(v).getAll();B.onsuccess=()=>b(B.result),B.onerror=()=>G(B.error)}),j=$.value,Z=j?w.filter(b=>b.projectId===j):w.filter(b=>!b.projectId);for(const b of Z)if(s.has(b.name)){const G=new Blob([b.buffer],{type:b.mime});let B=xt(b.mime);if(B==="bin")try{B=Zt(b.buffer)}catch{B="ttf"}const q=b.name.replace(/[^A-Za-z0-9_\-]/g,"_"),me=`${l}_${q}.${B}`;de.push({family:b.name,file:me}),ge.push({file:me,blob:G})}}catch(f){console.warn("读取字体库失败：",f)}const Ne=new ul.default,Me=Ne.folder(`${l}_all`),Ce=[],ve={imageFileNames:N.map(f=>f.fileName),imageFileMap:c,backgroundFileName:m&&M?M:null,fontFaces:de,hideDirective:"if"},le=ll(l,C,U.value,ve,Ft.value);Ce.push({key:"vue2",file:"index.vue",content:le});const oe=ol(l,C,U.value,ve);Ce.push({key:"vue3",file:"index.vue",content:oe});const se=il(l,C,U.value,ve);Ce.push({key:"react",file:"index.jsx",content:se});const te=sl(l,C,U.value,ve);Ce.push({key:"html",file:"index.html",content:te});for(const f of Ce){const v=Me.folder(f.key);v.file(f.file,f.content),f.key==="react"&&v.file("README.md","# React 导出使用说明\n\n- 将本目录的 `imgs/` 与 `fonts/` 拷贝到 React 项目 `public/` 根目录：\n  - `public/imgs`\n  - `public/fonts`\n- 组件中图片路径为 `/imgs/...`，字体为 `/fonts/...`，确保开发与生产可访问。\n\n可选方案：若不使用 `public`，需自行改为通过打包管道解析资源（如 `new URL(path, import.meta.url).href` 或 import）。");const F=v.folder("imgs");for(const j of N)F.file(j.fileName,j.blob);m&&M&&F.file(M,m);const w=v.folder("fonts");for(const j of ge)w.file(j.file,j.blob)}const Se=await Ne.generateAsync({type:"blob"});(0,dl.saveAs)(Se,`${l}-all.zip`)}function kr(){confirm("确认清空当前画布与元素吗？")&&(U.value=[],p.value=null)}const it=xe(1),$t=xe(null);function Sr(){it.value=Math.min(2,+(it.value+.1).toFixed(2))}function Mr(){it.value=Math.max(.2,+(it.value-.1).toFixed(2))}function Qt(){const n=$t.value;if(!n)return;const l=n.clientWidth-16,a=n.clientHeight-16,u=l/C.width,c=a/C.height;it.value=+Math.max(.2,Math.min(2,Math.min(u,c))).toFixed(2)}Wr(async()=>{Qt(),await Nt()});const er=xe([]);function tr(n){const l=JSON.parse(JSON.stringify(n));let a=Date.now();function u(g){return a+=1,`${g}-${a}`}function c(g){g.id=u(String(g.type||"el")),g.type==="chart"&&g.elementId&&(g.elementId=String(g.elementId)+"_"+String(a%1e3)),g.type==="group"&&Array.isArray(g.children)&&g.children.forEach(S=>c(S))}return c(l),l.left=(n.left||0)+10,l.top=(n.top||0)+10,l.x=l.left,l.y=l.top,l.zIndex=(n.zIndex||1)+1,l}function Cr(){var c,g,S,N,M,m,s,k,L,de,ge,Ne,Me,Ce,ve;if(!Je.value)return;let n=Je.value;const l=Ze(n.id);l.parentGroup&&(n=l.parentGroup);const a=tr(n),{parentGroup:u}=Ze(n.id);if(u){const le=Number((g=(c=u.left)!=null?c:u.x)!=null?g:0),oe=Number((N=(S=u.top)!=null?S:u.y)!=null?N:0),se=Number((M=u.width)!=null?M:0),te=Number((m=u.height)!=null?m:0),Se=le+se,f=oe+te,v=Number((s=n.width)!=null?s:0),F=Number((k=n.height)!=null?k:0);let w=v,j=F;if(!w||!j)if(n.type==="text"){const ie=Number((L=n.fontSize)!=null?L:16),we=String((ge=(de=n.text)!=null?de:n.content)!=null?ge:"").trim();w=Math.max(v||50,Math.round((we.length||2)*ie*.6)),j=Math.max(F||20,Math.round(ie*1.5))}else n.type==="image"?(w=v||200,j=F||150):n.type==="chart"?(w=v||240,j=F||160):n.type==="line"?(w=v||200,j=F||2):(w=v||100,j=F||60);const Z=10,b=le+se/2,G=oe+te/2;let B=!1,q=Se+Z,me=Math.round(G-j/2);if(!B&&q+w<=C.width&&(a.left=Math.max(0,Math.min(q,Math.max(0,C.width-w))),a.top=Math.max(0,Math.min(me,Math.max(0,C.height-j))),B=!0),q=le-w-Z,me=Math.round(G-j/2),!B&&q>=0&&(a.left=Math.max(0,Math.min(q,Math.max(0,C.width-w))),a.top=Math.max(0,Math.min(me,Math.max(0,C.height-j))),B=!0),q=Math.round(b-w/2),me=f+Z,!B&&me+j<=C.height&&(a.left=Math.max(0,Math.min(q,Math.max(0,C.width-w))),a.top=Math.max(0,Math.min(me,Math.max(0,C.height-j))),B=!0),q=Math.round(b-w/2),me=oe-j-Z,!B&&me>=0&&(a.left=Math.max(0,Math.min(q,Math.max(0,C.width-w))),a.top=Math.max(0,Math.min(me,Math.max(0,C.height-j))),B=!0),!B){const ie=Number((Me=(Ne=n.left)!=null?Ne:n.x)!=null?Me:0),we=Number((ve=(Ce=n.top)!=null?Ce:n.y)!=null?ve:0),Ue=le+ie+Z,Te=oe+we+Z;a.left=Math.max(0,Math.min(Math.round(Ue),Math.max(0,C.width-w))),a.top=Math.max(0,Math.min(Math.round(Te),Math.max(0,C.height-j)))}a.x=a.left,a.y=a.top}T(),U.value.push(a),p.value=a.id}const zt=xe(!1),Vt=xe([]),Lt=xe(""),Rt=xe(!1),rr=Ge(()=>{const n=Lt.value.trim().toLowerCase();return n?Vt.value.filter(l=>l.name.toLowerCase().includes(n)||(l.description||"").toLowerCase().includes(n)||Array.isArray(l.tags)&&l.tags.some(a=>a.toLowerCase().includes(n))):Vt.value});async function nr(){try{Rt.value=!0,await Xe.init(),Vt.value=(await Xe.getAllComponents()||[]).sort((n,l)=>(l.updatedAt||0)-(n.updatedAt||0))}catch(n){console.warn("加载组件缓存失败：",n)}finally{Rt.value=!1}}async function Nr(){await nr(),zt.value=!0}function lr(){zt.value=!1}const st=xe(!1);let nt=null;function Ir(){st.value=!0,nt&&(clearTimeout(nt),nt=null)}function Fr(){nt&&clearTimeout(nt),nt=setTimeout(()=>{st.value=!1,nt=null},120)}function jr(){st.value=!0,nt&&(clearTimeout(nt),nt=null)}function Ar(){st.value=!1,nt&&(clearTimeout(nt),nt=null)}function zr(n){const l=[],a=[],u=[],c=[];function g(s){var de,ge,Ne,Me,Ce;const k=Number(s.width||0),L=Number(s.height||0);if(k>0&&L>0)return{w:k,h:L};if(s.type==="text"){const ve=Number((de=s.fontSize)!=null?de:16),le=String((ge=s.text)!=null?ge:"").trim(),oe=Math.max(50,Math.round((le.length||2)*ve*.6)),se=Math.max(20,Math.round(ve*1.5));return{w:k||oe,h:L||se}}if(s.type==="image")return{w:k||100,h:L||100};if(s.type==="chart")return{w:k||240,h:L||160};if(s.type==="line"){const ve=Number((Me=(Ne=s.style)==null?void 0:Ne.lineThickness)!=null?Me:2);return(((Ce=s.style)==null?void 0:Ce.lineOrientation)||"horizontal")==="vertical"?{w:k||ve,h:L||100}:{w:k||100,h:L||ve}}return{w:k||50,h:L||20}}for(const s of n){const k=Number(s.left||s.x||0),L=Number(s.top||s.y||0),{w:de,h:ge}=g(s);l.push(k),a.push(L),u.push(k+(de||0)),c.push(L+(ge||0))}const S=l.length?Math.min(...l):0,N=a.length?Math.min(...a):0,M=u.length?Math.max(...u):S,m=c.length?Math.max(...c):N;return{minX:S,minY:N,maxX:M,maxY:m,width:Math.max(0,M-S),height:Math.max(0,m-N)}}async function Or(n){var l,a,u,c,g,S,N,M,m,s;try{const k=await sr(`component-${n.id}`),L=JSON.parse(JSON.stringify((k==null?void 0:k.elements)||n.elements||[]));if(!L||L.length===0){console.warn("该组件没有可插入的元素");return}const de=$t.value,ge=it.value||1,Ne=(l=de==null?void 0:de.clientWidth)!=null?l:0,Me=(a=de==null?void 0:de.clientHeight)!=null?a:0,Ce=de?(de.scrollLeft+Ne/2)/ge:20,ve=de?(de.scrollTop+Me/2)/ge:20,le=zr(L),oe=le.minX+le.width/2,se=le.minY+le.height/2,te=Math.round(Ce-oe),Se=Math.round(ve-se),f=U.value.reduce((F,w)=>Math.max(F,Number(w.zIndex||0)),0);let v=null;if(L.length===1){const F=L[0];if(!F){console.warn("单元素组件插入失败：源元素不存在");return}const w=F,j=JSON.parse(JSON.stringify(w));j.id=`${w.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;const Z=Number((c=(u=j.left)!=null?u:j.x)!=null?c:0),b=Number((S=(g=j.top)!=null?g:j.y)!=null?S:0);j.left=Math.round(Z+te),j.top=Math.round(b+Se),j.x=j.left,j.y=j.top;const{w:G,h:B}=(function(){var ie,we,Ue,Te,tt;const q=Number(j.width||0),me=Number(j.height||0);if(q>0&&me>0)return{w:q,h:me};if(j.type==="text"){const _e=Number((ie=j.fontSize)!=null?ie:16),ot=String((we=j.text)!=null?we:"").trim(),Qe=Math.max(50,Math.round((ot.length||2)*_e*.6)),mt=Math.max(20,Math.round(_e*1.5));return{w:q||Qe,h:me||mt}}if(j.type==="image")return{w:q||100,h:me||100};if(j.type==="chart")return{w:q||240,h:me||160};if(j.type==="line"){const _e=Number((Te=(Ue=j.style)==null?void 0:Ue.lineThickness)!=null?Te:2);return(((tt=j.style)==null?void 0:tt.lineOrientation)||"horizontal")==="vertical"?{w:q||_e,h:me||100}:{w:q||100,h:me||_e}}return{w:q||50,h:me||20}})();if(j.width=G,j.height=B,j.type==="image"&&!(j.src||"").startsWith("data:")&&j.iconId)try{Ot(j.iconId).then(q=>{q&&(j.src=q)}).catch(()=>{})}catch{}j.zIndex=Math.max(1,f+1),T(),U.value=U.value.concat(j),p.value=j.id,v=j.id}else{const F=`group-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,w=[];for(const Z of L){const b=JSON.parse(JSON.stringify(Z));b.id=`${Z.type}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;const G=Number((M=(N=b.left)!=null?N:b.x)!=null?M:0),B=Number((s=(m=b.top)!=null?m:b.y)!=null?s:0);b.left=Math.round(G-le.minX),b.top=Math.round(B-le.minY),b.x=b.left,b.y=b.top;const{w:q,h:me}=(function(){var Ue,Te,tt,_e,ot;const ie=Number(b.width||0),we=Number(b.height||0);if(ie>0&&we>0)return{w:ie,h:we};if(b.type==="text"){const Qe=Number((Ue=b.fontSize)!=null?Ue:16),mt=String((Te=b.text)!=null?Te:"").trim(),ht=Math.max(50,Math.round((mt.length||2)*Qe*.6)),Et=Math.max(20,Math.round(Qe*1.5));return{w:ie||ht,h:we||Et}}if(b.type==="image")return{w:ie||100,h:we||100};if(b.type==="chart")return{w:ie||240,h:we||160};if(b.type==="line"){const Qe=Number((_e=(tt=b.style)==null?void 0:tt.lineThickness)!=null?_e:2);return(((ot=b.style)==null?void 0:ot.lineOrientation)||"horizontal")==="vertical"?{w:ie||Qe,h:we||100}:{w:ie||100,h:we||Qe}}return{w:ie||50,h:we||20}})();if(b.width=q,b.height=me,b.type==="image"&&!(b.src||"").startsWith("data:")&&b.iconId)try{Ot(b.iconId).then(ie=>{ie&&(b.src=ie)}).catch(()=>{})}catch{}w.push(b)}const j={id:F,type:"group",left:Math.round(le.minX+te),top:Math.round(le.minY+Se),width:Math.max(1,Math.round(le.width)),height:Math.max(1,Math.round(le.height)),zIndex:Math.max(1,f+1),className:n.name?`component-${n.name.replace(/[^A-Za-z0-9_-]/g,"-")}`:void 0,children:w,componentId:n.id,editable:!0,style:{backgroundColor:"transparent"}};T(),U.value=U.value.concat(j),p.value=j.id,v=F}try{if(v){const F=await Xe.getFontsByComponentId(n.id);if(Array.isArray(F)&&F.length>0){let w=document.getElementById(`component-fonts-${v}`);w||(w=document.createElement("style"),w.id=`component-fonts-${v}`,document.head.appendChild(w));const j=[];for(const Z of F){const b=String(Z.name||"").replace(/[^A-Za-z0-9_\-]/g,"_"),G=Z.bufferBase64;G&&j.push(`@font-face { font-family: '${b}'; src: url('${G}'); font-weight: normal; font-style: normal; font-display: swap; }`)}w.textContent=j.join(`
`)}}}catch(F){console.warn("注入组件字体失败：",F)}try{if(v){const F=await Xe.getDatabaseObjectsByComponentId(n.id);Array.isArray(F)&&F.length>0&&pr(v,F.map(w=>({name:w.name,content:w.content})))}}catch(F){console.warn("注入组件数据库对象失败：",F)}await Xe.incrementUsageCount(n.id),zt.value=!1}catch(k){console.warn("插入组件失败：",k)}}const or=()=>$.value?`lowcode-builder-state-${$.value}`:"lowcode-builder-state-v1",Tt=()=>$.value?o.isComponent?`component-${$.value}`:`project-${$.value}`:"default";async function Pt(n,l){try{const a=JSON.parse(JSON.stringify(l));if(n.startsWith("component-")){const u=n.replace(/^component-/,"");await Xe.saveBuilderStateForComponent(u,a)}else if(n.startsWith("project-")){const u=n.replace(/^project-/,"");await Xe.saveBuilderStateForProject(u,a)}else await Xe.saveBuilderStateForProject(n,a)}catch(a){console.warn("保存构建器状态失败：",a)}}async function sr(n){try{if(n.startsWith("component-")){const l=n.replace(/^component-/,"");return await Xe.getBuilderStateForComponent(l)}else if(n.startsWith("project-")){const l=n.replace(/^project-/,"");return await Xe.getBuilderStateForProject(l)}return await Xe.getBuilderStateForProject(n)}catch(l){return console.warn("恢复构建器状态失败：",l),null}}let Ht=null;function Wt(){Ht&&clearTimeout(Ht),Ht=setTimeout(()=>{const n={config:C,elements:U.value,exportName:ye.value};try{const l=async()=>{if(await Pt(Tt(),n),o.isComponent&&$.value)try{const a=String($.value),u=await Xe.getComponent(a),c={id:a,name:ye.value||(u==null?void 0:u.name)||"未命名组件",description:(u==null?void 0:u.description)||"",tags:(u==null?void 0:u.tags)||[],elements:U.value,config:C,usageCount:(u==null?void 0:u.usageCount)||0,createdAt:(u==null?void 0:u.createdAt)||Date.now(),updatedAt:Date.now()};await Xe.saveComponent(JSON.parse(JSON.stringify(c))),dr()}catch(a){console.warn("同步保存组件记录失败：",a)}};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{l()}):l()}catch(l){console.warn("保存失败：",l)}},400)}yt(C,Wt,{deep:!0}),yt(U,Wt,{deep:!0}),yt(ye,Wt),yt(U,()=>{Ut()},{deep:!0});async function Br(){try{const n="lowcode-icons",l="icons",a=await new Promise((g,S)=>{const N=indexedDB.open(n);N.onsuccess=()=>{const M=N.result;if(M.objectStoreNames.contains(l))g(M);else{const m=M.version+1;M.close();const s=indexedDB.open(n,m);s.onupgradeneeded=()=>{const k=s.result;k.objectStoreNames.contains(l)||k.createObjectStore(l,{keyPath:"id"})},s.onsuccess=()=>g(s.result),s.onerror=()=>S(s.error)}},N.onerror=()=>S(N.error)}),u=await new Promise((g,S)=>{const N=a.transaction(l,"readonly").objectStore(l).getAll();N.onsuccess=()=>g(N.result),N.onerror=()=>S(N.error)}),c=$.value;er.value=(c?u.filter(g=>g.projectId===c):u.filter(g=>!g.projectId)).map(g=>{const S=new Blob([g.buffer],{type:g.mime}),N=URL.createObjectURL(S);return{id:g.id,url:N,name:g.name}})}catch(n){console.warn("图标库初始化失败：",n)}}async function Ot(n){try{const l="lowcode-icons",a="icons",u=await new Promise((S,N)=>{const M=indexedDB.open(l);M.onsuccess=()=>{const m=M.result;if(m.objectStoreNames.contains(a))S(m);else{const s=m.version+1;m.close();const k=indexedDB.open(l,s);k.onupgradeneeded=()=>{const L=k.result;L.objectStoreNames.contains(a)||L.createObjectStore(a,{keyPath:"id"})},k.onsuccess=()=>S(k.result),k.onerror=()=>N(k.error)}},M.onerror=()=>N(M.error)}),c=await new Promise((S,N)=>{const M=u.transaction(a,"readonly").objectStore(a).get(n);M.onsuccess=()=>S(M.result),M.onerror=()=>N(M.error)});if(!c||!c.buffer)return null;const g=new Blob([c.buffer],{type:c.mime||"application/octet-stream"});return await new Promise((S,N)=>{const M=new FileReader;M.onload=()=>S(String(M.result)),M.onerror=()=>N(M.error),M.readAsDataURL(g)})}catch(l){return console.warn("读取图标数据失败：",l),null}}async function ar(){const n=U.value.filter(l=>l.type==="image");for(const l of n){if((l.src||"").startsWith("data:")||!l.iconId)continue;const a=await Ot(l.iconId);a&&(l.src=a)}}async function Dr(){try{const n="lowcode-fonts",l="fonts",a=await new Promise((c,g)=>{const S=indexedDB.open(n);S.onsuccess=()=>{const N=S.result;if(N.objectStoreNames.contains(l))c(N);else{const M=N.version+1;N.close();const m=indexedDB.open(n,M);m.onupgradeneeded=()=>{const s=m.result;s.objectStoreNames.contains(l)||s.createObjectStore(l,{keyPath:"id"})},m.onsuccess=()=>c(m.result),m.onerror=()=>g(m.error)}},S.onerror=()=>g(S.error)}),u=await new Promise((c,g)=>{const S=a.transaction(l,"readonly").objectStore(l).getAll();S.onsuccess=()=>c(S.result),S.onerror=()=>g(S.error)});if(u.length>0){let c=document.querySelector("style[data-font-lib]");c||(c=document.createElement("style"),c.setAttribute("data-font-lib",""),document.head.appendChild(c));const g=[],S=[],N=$.value,M=N?u.filter(s=>s.projectId===N):u.filter(s=>!s.projectId);for(const s of M){const k=new Blob([s.buffer],{type:s.mime}),L=URL.createObjectURL(k),de=s.name;S.push(de),g.push(`@font-face { font-family: '${de}'; src: url('${L}'); font-weight: normal; font-style: normal; }`)}c.textContent=g.join(`
`);const m=new Set([...W.value,...S]);W.value=Array.from(m)}}catch(n){console.warn("字体库初始化失败：",n)}}Wr(async()=>{await H(),await Dr(),await Br();try{if(o.isComponent&&$.value){const n=String($.value);if(!await Xe.getComponent(n)){const l={id:n,name:ye.value||"未命名组件",description:"",tags:[],elements:[],config:C,usageCount:0,createdAt:Date.now(),updatedAt:Date.now()};await Xe.saveComponent(JSON.parse(JSON.stringify(l)))}}}catch(n){console.warn("预创建组件记录失败：",n)}try{const n=await sr(Tt());if(n){n.config&&Object.assign(C,n.config),Array.isArray(n.elements)&&(U.value=n.elements),typeof n.exportName=="string"&&n.exportName&&(ye.value=n.exportName),await ar();try{U.value=U.value.map(l=>{if(l.type==="chart"&&l.style&&typeof l.style.border=="string"&&l.style.border.includes("dashed")){const a={...l,style:{...l.style}};return delete a.style.border,a}return l})}catch{}}else{const l=localStorage.getItem(or());if(l){const a=JSON.parse(l);a&&a.config&&Object.assign(C,a.config),Array.isArray(a==null?void 0:a.elements)&&(U.value=a.elements),typeof(a==null?void 0:a.exportName)=="string"&&a.exportName&&(ye.value=a.exportName),await ar();try{U.value=U.value.map(u=>{if(u.type==="chart"&&u.style&&typeof u.style.border=="string"&&u.style.border.includes("dashed")){const c={...u,style:{...u.style}};return delete c.style.border,c}return u})}catch{}await Pt(Tt(),{config:C,elements:U.value,exportName:ye.value});try{localStorage.removeItem(or())}catch{}}}}catch(n){console.warn("恢复失败：",n)}Ut(),window.addEventListener("keydown",ce),window.addEventListener("keyup",t)}),_r(()=>{window.removeEventListener("keydown",ce),window.removeEventListener("keyup",t),dr()});let ir=0;async function Gr(n,l){var a,u,c;try{const g=C.width||n.clientWidth||800,S=C.height||n.clientHeight||600,N=(a=l==null?void 0:l.maxWidth)!=null?a:420,M=(u=l==null?void 0:l.scale)!=null?u:Math.min(1,N/g),m=(c=l==null?void 0:l.quality)!=null?c:.85,s=n.cloneNode(!0);s.style.transform="none",s.style.transformOrigin="top left",s.style.width=`${g}px`,s.style.height=`${S}px`;const k=new XMLSerializer().serializeToString(s),L=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${Math.round(g*M)}" height="${Math.round(S*M)}">
  <foreignObject width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml" style="transform: scale(${M}); transform-origin: top left;">${k}</div>
  </foreignObject>
</svg>`,de="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(L),ge=new Image;return await new Promise(Ne=>{ge.onload=()=>{try{const Me=document.createElement("canvas");Me.width=ge.width,Me.height=ge.height;const Ce=Me.getContext("2d");if(!Ce)return Ne(null);Ce.drawImage(ge,0,0);const ve=Me.toDataURL("image/jpeg",m);Ne(ve)}catch{Ne(null)}},ge.onerror=()=>Ne(null),ge.src=de})}catch{return null}}async function dr(){try{const n=Date.now();if(n-ir<5e3||(ir=n,!o.isComponent||!$.value))return;const l=$t.value;if(!l)return;const a=l.firstElementChild;if(!a)return;const u=await Gr(a,{maxWidth:420,quality:.8});if(!u)return;const c=String($.value),g=await Xe.getComponent(c);if(!g)return;const S={...g,previewDataUrl:u,updatedAt:Date.now()};await Xe.saveComponent(JSON.parse(JSON.stringify(S)))}catch(n){console.warn("生成缩略图失败：",n)}}return(n,l)=>{var a,u,c,g,S,N,M,m;return z(),O(Bt,null,[r("div",Yi,[l[30]||(l[30]=Tr('<div class="absolute inset-0 opacity-10" data-v-37742cc4><div class="absolute top-10 left-10 w-32 h-32 border border-cyan-400 rotate-45 animate-pulse" data-v-37742cc4></div><div class="absolute top-32 right-20 w-24 h-24 border border-purple-400 rounded-full animate-spin" style="animation-duration:20s;" data-v-37742cc4></div><div class="absolute bottom-20 left-1/4 w-40 h-40 border border-blue-400 rotate-12 animate-bounce" style="animation-duration:3s;" data-v-37742cc4></div><div class="absolute bottom-32 right-1/3 w-28 h-28 border border-green-400 rounded-lg rotate-45 animate-pulse" style="animation-delay:1s;" data-v-37742cc4></div></div><div class="absolute inset-0 opacity-5" style="background-image:linear-gradient(cyan 1px, transparent 1px), linear-gradient(90deg, cyan 1px, transparent 1px);background-size:50px 50px;" data-v-37742cc4></div>',2)),r("div",Ki,[dt(Eo,{exportName:ye.value,config:C,fontLibrary:W.value,spacingEnabled:pt.value,alignmentEnabled:ft.value,"onUpdate:exportName":l[0]||(l[0]=s=>ye.value=s),"onUpdate:configWidth":l[1]||(l[1]=s=>C.width=s),"onUpdate:configHeight":l[2]||(l[2]=s=>C.height=s),"onUpdate:backgroundColor":l[3]||(l[3]=s=>C.backgroundColor=s),"onUpdate:globalFontFamily":l[4]||(l[4]=s=>C.globalFontFamily=s),"onUpdate:globalFontSize":l[5]||(l[5]=s=>C.globalFontSize=s),"onUpdate:globalColor":l[6]||(l[6]=s=>C.globalColor=s),"onUpdate:spacingEnabled":l[7]||(l[7]=s=>pt.value=s),"onUpdate:alignmentEnabled":l[8]||(l[8]=s=>ft.value=s),onBackgroundFileChange:wr,onOpenPreview:ne,onDownloadByFormat:l[9]||(l[9]=s=>$r(s)),onDownloadAllFormats:Er,onResetCanvas:kr},null,8,["exportName","config","fontLibrary","spacingEnabled","alignmentEnabled"]),r("div",Zi,[r("div",Qi,[r("div",ed,[r("div",td,[r("button",{onMouseenter:Ir,onMouseleave:Fr,onClick:l[10]||(l[10]=s=>st.value=!0),class:"px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-cyan-500/25"}," 插入元素 ",32),ue(r("div",{onMouseenter:jr,onMouseleave:Ar,class:"absolute left-0 top-full w-72 p-3 bg-gray-900/95 backdrop-blur-md border border-cyan-500/40 rounded-xl shadow-2xl z-50"},[r("div",rd,[r("button",{onClick:l[11]||(l[11]=s=>{Pe("text"),st.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded"},"文本"),r("button",{onClick:l[12]||(l[12]=s=>{Pe("image"),st.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500 text-white rounded"},"图片"),r("button",{onClick:l[13]||(l[13]=s=>{Pe("chart"),st.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-500 hover:to-red-500 text-white rounded"},"图表"),r("button",{onClick:l[14]||(l[14]=s=>{Pe("line"),st.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded"},"线条"),r("button",{onClick:l[15]||(l[15]=s=>{Pe("container"),st.value=!1}),class:"px-3 py-2 text-xs bg-gradient-to-r from-slate-600 to-gray-700 hover:from-slate-500 hover:to-gray-600 text-white rounded col-span-2"},"容器")])],544),[[Cl,st.value]])]),r("button",{onClick:l[16]||(l[16]=s=>bt.value=!0),class:"px-4 py-2 bg-gradient-to-r from-gray-600 to-slate-700 hover:from-gray-500 hover:to-slate-600 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-gray-500/25"}," 隐藏元素 "),r("button",{onClick:Nr,class:"px-4 py-2 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg shadow-pink-500/25"}," 插入组件 ")]),r("div",nd,[r("button",{onClick:Mr,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...l[28]||(l[28]=[r("span",{class:"text-gray-300"},"-",-1)])]),r("span",ld,et(Math.round(it.value*100))+"%",1),r("button",{onClick:Sr,class:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors duration-200"},[...l[29]||(l[29]=[r("span",{class:"text-gray-300"},"+",-1)])]),r("button",{onClick:Qt,class:"px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg text-xs text-gray-300 transition-colors duration-200"}," 适应 ")])]),r("div",{ref_key:"canvasScrollRef",ref:$t,class:"flex-1 overflow-auto bg-gray-800/30 p-4 min-h-0 custom-scrollbar"},[r("div",{class:"relative border border-gray-600/50 bg-gray-100 shadow-2xl mx-auto",onMousedown:fl(St,["self"]),style:lt({width:`${C.width}px`,height:`${C.height}px`,backgroundColor:C.backgroundColor||"transparent",backgroundImage:C.backgroundUrl?`url(${C.backgroundUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`scale(${it.value})`,transformOrigin:"top left"})},[K.value?(z(),O("div",od,[Ie.value.left?(z(),O("div",{key:0,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:lt([{"border-width":"0.5px"},{left:`${Y.value.left}px`}])},null,4)):ee("",!0),Ie.value.right?(z(),O("div",{key:1,class:"absolute top-0 bottom-0 border-l border-dashed border-orange-400/70",style:lt([{"border-width":"0.5px"},{left:`${Y.value.right}px`}])},null,4)):ee("",!0),Ie.value.top?(z(),O("div",{key:2,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:lt([{"border-width":"0.5px"},{top:`${Y.value.top}px`}])},null,4)):ee("",!0),Ie.value.bottom?(z(),O("div",{key:3,class:"absolute left-0 right-0 border-t border-dashed border-orange-400/70",style:lt([{"border-width":"0.5px"},{top:`${Y.value.bottom}px`}])},null,4)):ee("",!0),Ie.value.centerV?(z(),O("div",{key:4,class:"absolute top-0 bottom-0 border-l border-dashed border-blue-400/60",style:lt([{"border-width":"0.5px"},{left:`${Y.value.centerX}px`}])},null,4)):ee("",!0),Ie.value.centerH?(z(),O("div",{key:5,class:"absolute left-0 right-0 border-t border-dashed border-blue-400/60",style:lt([{"border-width":"0.5px"},{top:`${Y.value.centerY}px`}])},null,4)):ee("",!0)])):ee("",!0),pt.value&&(pe.value.left||pe.value.right||pe.value.up||pe.value.down)?(z(),O("div",sd,[pe.value.left&&He.value!=="left"?(z(),O("div",{key:0,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:lt({left:`${pe.value.left.x-14}px`,top:`${pe.value.left.y-14}px`}),onDblclick:l[17]||(l[17]=s=>gt("left"))},et(pe.value.left.gap)+"px ",37)):ee("",!0),pe.value.right&&He.value!=="right"?(z(),O("div",{key:1,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:lt({left:`${pe.value.right.x-14}px`,top:`${pe.value.right.y-14}px`}),onDblclick:l[18]||(l[18]=s=>gt("right"))},et(pe.value.right.gap)+"px ",37)):ee("",!0),pe.value.up&&He.value!=="up"?(z(),O("div",{key:2,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:lt({left:`${pe.value.up.x-14}px`,top:`${pe.value.up.y-18}px`}),onDblclick:l[19]||(l[19]=s=>gt("up"))},et(pe.value.up.gap)+"px ",37)):ee("",!0),pe.value.down&&He.value!=="down"?(z(),O("div",{key:3,class:"absolute text-[10px] px-1.5 py-0.5 rounded bg-gray-900/80 border border-orange-400/60 text-orange-200 cursor-pointer pointer-events-auto",style:lt({left:`${pe.value.down.x-14}px`,top:`${pe.value.down.y-18}px`}),onDblclick:l[20]||(l[20]=s=>gt("down"))},et(pe.value.down.gap)+"px ",37)):ee("",!0),He.value==="left"?ue((z(),O("input",{key:4,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:lt({left:`${(((a=pe.value.left)==null?void 0:a.x)||0)-28}px`,top:`${(((u=pe.value.left)==null?void 0:u.y)||0)-14}px`}),"onUpdate:modelValue":l[21]||(l[21]=s=>ke.value=s),onKeydown:Vr(We,["enter"])},null,36)),[[$e,ke.value,void 0,{number:!0}]]):ee("",!0),He.value==="right"?ue((z(),O("input",{key:5,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:lt({left:`${(((c=pe.value.right)==null?void 0:c.x)||0)-28}px`,top:`${(((g=pe.value.right)==null?void 0:g.y)||0)-14}px`}),"onUpdate:modelValue":l[22]||(l[22]=s=>ke.value=s),onKeydown:Vr(We,["enter"])},null,36)),[[$e,ke.value,void 0,{number:!0}]]):ee("",!0),He.value==="up"?ue((z(),O("input",{key:6,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:lt({left:`${(((S=pe.value.up)==null?void 0:S.x)||0)-28}px`,top:`${(((N=pe.value.up)==null?void 0:N.y)||0)-18}px`}),"onUpdate:modelValue":l[23]||(l[23]=s=>ke.value=s),onKeydown:Vr(We,["enter"])},null,36)),[[$e,ke.value,void 0,{number:!0}]]):ee("",!0),He.value==="down"?ue((z(),O("input",{key:7,type:"number",class:"absolute w-14 h-6 px-1 text-[10px] rounded bg-gray-900/90 border border-orange-400/80 text-orange-100 focus:outline-none pointer-events-auto",style:lt({left:`${(((M=pe.value.down)==null?void 0:M.x)||0)-28}px`,top:`${(((m=pe.value.down)==null?void 0:m.y)||0)-18}px`}),"onUpdate:modelValue":l[24]||(l[24]=s=>ke.value=s),onKeydown:Vr(We,["enter"])},null,36)),[[$e,ke.value,void 0,{number:!0}]]):ee("",!0)])):ee("",!0),(z(!0),O(Bt,null,_t(U.value,s=>(z(),pl(Fl,{key:s.id,element:s,selected:s.id===p.value,"selected-id":p.value,config:C,zoom:it.value,dbMap:Ft.value,"metrics-map":V.value,onSelect:ut,"onUpdate:position":Ye,"onUpdate:size":rt,onShowGuidelines:Ke,onHideGuidelines:at,onReportMetrics:qe},null,8,["element","selected","selected-id","config","zoom","dbMap","metrics-map"]))),128))],36)],512)]),dt(Xi,{selectedEl:Je.value,config:C,fontLibrary:W.value,fontSizeLibrary:X.value,fontWeightOptions:ae.value,fontStyleOptions:Ee.value,databaseObjects:P.value,dbMap:Ft.value,iconLibrary:er.value,defaultChartOption:Le,safeHex:fr,initCustomClassSkeleton:mr,refreshAllCustomClassCss:Ut,removeCustomClassCssForElement:Xt,getIconDataUrlById:Ot,onDuplicateSelected:Cr,onRemoveSelected:gr,onSaveSelectedAsComponent:hr},null,8,["selectedEl","config","fontLibrary","fontSizeLibrary","fontWeightOptions","fontStyleOptions","databaseObjects","dbMap","iconLibrary"])])]),zt.value?(z(),O("div",ad,[r("div",{class:"absolute inset-0 bg-black/60",onClick:lr}),r("div",id,[r("div",{class:"flex items-center justify-between p-4 border-b border-fuchsia-500/30 bg-gradient-to-r from-fuchsia-600/20 to-pink-600/20"},[l[31]||(l[31]=r("h3",{class:"text-lg font-bold text-pink-300"},"插入组件",-1)),r("button",{onClick:lr,class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",dd,[r("div",ud,[ue(r("input",{"onUpdate:modelValue":l[25]||(l[25]=s=>Lt.value=s),type:"text",placeholder:"搜索名称、描述或标签",class:"flex-1 px-3 py-2 bg-gray-800/60 border border-fuchsia-500/30 rounded-lg text-gray-100 placeholder-gray-400 focus:border-fuchsia-400 focus:ring-1 focus:ring-fuchsia-400 focus:outline-none transition-all duration-200"},null,512),[[$e,Lt.value]]),r("button",{onClick:nr,class:"px-3 py-2 bg-pink-600/70 hover:bg-pink-600 text-white rounded"},"刷新")]),Rt.value?(z(),O("div",cd,"正在加载组件...")):(z(),O("div",pd,[rr.value.length===0?(z(),O("div",fd,"暂无匹配的组件")):(z(),O("div",gd,[(z(!0),O(Bt,null,_t(rr.value,s=>(z(),O("div",{key:s.id,class:"bg-gray-800/60 border border-pink-500/20 rounded-lg overflow-hidden"},[r("div",md,[s.previewDataUrl?(z(),O("img",{key:0,src:s.previewDataUrl,alt:"预览",class:"max-w-full max-h-full object-contain"},null,8,yd)):(z(),O("div",bd,"无预览"))]),r("div",xd,[r("div",hd,[r("div",{class:"text-sm text-gray-100 font-medium truncate",title:s.name},et(s.name),9,vd),r("div",wd,et(s.usageCount||0)+" 次",1)]),r("div",$d,[(z(!0),O(Bt,null,_t(s.tags||[],k=>(z(),O("span",{key:k,class:"px-1.5 py-0.5 text-[10px] rounded bg-pink-600/30 text-pink-200"},et(k),1))),128))]),r("div",Ed,[r("button",{onClick:k=>Or(s),class:"w-full px-3 py-1.5 bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-500 hover:to-fuchsia-500 text-white rounded text-sm transition"}," 插入到画布 ",8,kd)])])]))),128))]))]))])])])):ee("",!0),bt.value?(z(),O("div",Sd,[r("div",{class:"absolute inset-0 bg-black/60",onClick:l[26]||(l[26]=s=>bt.value=!1)}),r("div",Md,[r("div",Cd,[l[32]||(l[32]=r("h3",{class:"text-lg font-bold text-cyan-300"},"隐藏元素列表",-1)),r("button",{onClick:l[27]||(l[27]=s=>bt.value=!1),class:"px-3 py-1 bg-gray-700/60 hover:bg-gray-600/60 rounded text-sm text-gray-200"},"关闭")]),r("div",Nd,[vt.value.length===0?(z(),O("div",Id,"暂无隐藏元素")):(z(),O("div",Fd,[(z(!0),O(Bt,null,_t(vt.value,s=>(z(),O("div",{key:s.id,class:"flex items-center justify-between bg-gray-800/60 border border-cyan-500/20 rounded-lg px-3 py-2"},[r("div",{class:"text-sm text-gray-100 truncate",title:s.hiddenLabel||s.className||s.id},et(s.hiddenLabel||s.className||s.id),9,jd),r("button",{onClick:k=>Mt(s.id),class:"px-3 py-1 bg-cyan-600/70 hover:bg-cyan-600 text-white rounded text-sm"},"取消隐藏并定位",8,Ad)]))),128))]))])])])):ee("",!0)],64)}}}),Bd=Jr(Od,[["__scopeId","data-v-37742cc4"]]),Dd=Dt({__name:"index",props:{projectId:{},currentProject:{},isComponent:{type:Boolean}},setup(x){const o=x;return(e,d)=>(z(),pl(Bd,{"project-id":o.projectId,"current-project":o.currentProject,"is-component":o.isComponent},null,8,["project-id","current-project","is-component"]))}}),Hd=Dd;export{Hd as default};
