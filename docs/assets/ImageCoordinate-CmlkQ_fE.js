import{E as c,O as p,ct as g,d as m,f as u,l as r,lt as d,o as f}from"./codemirror-B25QCqWr.js";import{n as v,t as C}from"./index-BvtxZ7eM.js";var k={name:"ImageCoordinate",data(){return{imageUrl:null,clickPoints:[],imageNaturalWidth:0,imageNaturalHeight:0,showCrosshair:!1,crosshairPosition:{x:0,y:0},currentPosition:{x:null,y:null,realX:null,realY:null}}},methods:{triggerFileInput(){this.$refs.fileInput.click()},handleImageUpload(o){const t=o.target.files[0];if(t){if(!t.type.match("image.*")){v("请上传图片文件","warning");return}this.clickPoints=[],this.imageUrl=URL.createObjectURL(t),this.$nextTick(()=>{const s=this.$refs.imageElement;s.onload=()=>{this.imageNaturalWidth=s.naturalWidth,this.imageNaturalHeight=s.naturalHeight}})}},getCoordinates(o){const t=o.target.getBoundingClientRect(),s=Math.round(o.clientX-t.left),n=Math.round(o.clientY-t.top),e=this.$refs.imageElement,i=this.imageNaturalWidth/e.width,l=this.imageNaturalHeight/e.height,a=Math.round(s*i),h=Math.round(n*l);this.clickPoints.push({x:s,y:n,realX:a,realY:h})},copyCoordinate(o){const t=`X: ${o.realX}, Y: ${o.realY}`;navigator.clipboard.writeText(t).then(()=>{v("坐标已复制到剪贴板","success")}).catch(s=>{console.error("复制失败:",s),v("复制失败，请手动复制","error")})},removePoint(o){this.clickPoints.splice(o,1)},clearAllPoints(){this.clickPoints=[]},exportCoordinates(o){let t="",s="";const n=this.clickPoints.map((e,i)=>({id:i+1,x:e.realX,y:e.realY}));if(o==="json"){t=JSON.stringify(n,null,2),s="coordinates.json";const e=new Blob([t],{type:"application/json"});this.downloadFile(e,s)}else if(o==="csv"){t=`index,x,y
`,n.forEach(i=>{t+=`${i.id},${i.x},${i.y}
`}),s="coordinates.csv";const e=new Blob([t],{type:"text/csv"});this.downloadFile(e,s)}v(`已导出为 ${s}`,"success")},downloadFile(o,t){const s=document.createElement("a");s.href=URL.createObjectURL(o),s.download=t,s.click(),URL.revokeObjectURL(s.href)},updateCrosshair(o){const t=o.target.getBoundingClientRect(),s=Math.round(o.clientX-t.left),n=Math.round(o.clientY-t.top);this.crosshairPosition={x:s,y:n},this.showCrosshair=!0;const e=this.$refs.imageElement;if(e){const i=this.imageNaturalWidth/e.width,l=this.imageNaturalHeight/e.height,a=Math.round(s*i),h=Math.round(n*l);this.currentPosition={x:s,y:n,realX:a,realY:h}}},hideCrosshair(){this.showCrosshair=!1,this.currentPosition={x:null,y:null,realX:null,realY:null}}}},x={class:"image-coordinate-container"},y={class:"upload-section"},P={key:0,class:"image-section"},b={key:0,class:"position-info"},_={class:"position-box"},X=["src"],Y={key:0,class:"crosshair-container"},w={key:1,class:"coordinates-section"},U={class:"coordinates-list"},N={class:"coordinate-actions"},I=["onClick"],M=["onClick"],E={class:"export-actions"};function R(o,t,s,n,e,i){return c(),u("div",x,[t[9]||(t[9]=r("div",{class:"tool-header"},[r("h2",null,"图片坐标拾取工具"),r("p",null,"上传图片，点击获取坐标位置")],-1)),r("div",y,[r("input",{type:"file",ref:"fileInput",accept:"image/*",onChange:t[0]||(t[0]=(...l)=>i.handleImageUpload&&i.handleImageUpload(...l)),class:"file-input"},null,544),r("button",{class:"upload-btn",onClick:t[1]||(t[1]=(...l)=>i.triggerFileInput&&i.triggerFileInput(...l))},"上传图片")]),e.imageUrl?(c(),u("div",P,[e.currentPosition.x!==null?(c(),u("div",b,[r("div",_,[r("span",null,"X: "+d(e.currentPosition.realX),1),r("span",null,"Y: "+d(e.currentPosition.realY),1)])])):m("",!0),r("div",{class:"image-container",ref:"imageContainer",onMousemove:t[3]||(t[3]=(...l)=>i.updateCrosshair&&i.updateCrosshair(...l)),onMouseleave:t[4]||(t[4]=(...l)=>i.hideCrosshair&&i.hideCrosshair(...l))},[r("img",{src:e.imageUrl,onClick:t[2]||(t[2]=(...l)=>i.getCoordinates&&i.getCoordinates(...l)),ref:"imageElement",class:"target-image",alt:"上传的图片"},null,8,X),(c(!0),u(f,null,p(e.clickPoints,(l,a)=>(c(),u("div",{key:a,class:"point-marker",style:g({left:`${l.x}px`,top:`${l.y}px`})},d(a+1),5))),128)),e.showCrosshair?(c(),u("div",Y,[r("div",{class:"crosshair-full-horizontal",style:g({top:`${e.crosshairPosition.y}px`})},null,4),r("div",{class:"crosshair-full-vertical",style:g({left:`${e.crosshairPosition.x}px`})},null,4),r("div",{class:"crosshair-center",style:g({left:`${e.crosshairPosition.x}px`,top:`${e.crosshairPosition.y}px`})},null,4)])):m("",!0)],544),e.clickPoints.length>0?(c(),u("div",w,[t[8]||(t[8]=r("h3",null,"坐标点列表",-1)),r("div",U,[(c(!0),u(f,null,p(e.clickPoints,(l,a)=>(c(),u("div",{key:a,class:"coordinate-item"},[r("span",null,"点 "+d(a+1)+": X: "+d(l.realX)+", Y: "+d(l.realY)+" (原始尺寸坐标)",1),r("div",N,[r("button",{onClick:h=>i.copyCoordinate(l),class:"action-btn"}," 复制 ",8,I),r("button",{onClick:h=>i.removePoint(a),class:"action-btn delete-btn"}," 删除 ",8,M)])]))),128))]),r("div",E,[r("button",{onClick:t[5]||(t[5]=l=>i.exportCoordinates("json")),class:"export-btn"}," 导出 JSON "),r("button",{onClick:t[6]||(t[6]=l=>i.exportCoordinates("csv")),class:"export-btn"}," 导出 CSV "),r("button",{onClick:t[7]||(t[7]=(...l)=>i.clearAllPoints&&i.clearAllPoints(...l)),class:"clear-btn"}," 清除所有点 ")])])):m("",!0)])):m("",!0)])}var F=C(k,[["render",R],["__scopeId","data-v-46a99459"]]);export{F as default};
